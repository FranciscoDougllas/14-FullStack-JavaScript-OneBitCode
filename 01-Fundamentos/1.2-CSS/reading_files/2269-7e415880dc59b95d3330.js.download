"use strict";(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([[2269],{40179:(e,t,n)=>{n.d(t,{MW:()=>i});var r=n(81089),o=n(50732),i={adminMarkAsRead:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.adminMarkAsRead({id:t}))},memberMarkAsRead:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.memberMarkAsRead({id:t}))},previewChat:function(e){var t=e.community_bot_profile_id;return(0,r.Cu)(o.av.communityInbox.preview(),{community_bot_profile_id:t})}}},86649:(e,t,n)=>{n.d(t,{x6:()=>i,_u:()=>a,gX:()=>s});var r=n(81089),o=n(50732),i=function(e){var t=e.spaceId,n=e.payload;return(0,r.Cu)(o.av.imagePosts.create(t),n)},a=function(e){var t=e.spaceId,n=e.postSlug,i=e.payload;return(0,r.aU)(o.av.imagePosts.update(t,n),i)},s=function(e){var t=e.spaceId,n=e.postSlug,i=e.payload;return(0,r.aU)(o.av.imagePosts.duplicate(t,n),i)}},82066:(e,t,n)=>{n.d(t,{g:()=>i});var r=n(81089),o=n(50732),i=function(e){var t=e.entityId,n=e.entityType,i=void 0===n?"CommunityMember":n,a=e.mode,s=void 0===a?"view":a;return(0,r.Cu)(o.av.masquerading.masquerades.create({entityId:t,entityType:i,mode:s}),{method:"POST"})}},4524:(e,t,n)=>{n.d(t,{O:()=>i});var r=n(81089),o=n(81649),i={create:function(e){var t=e.blobSignedId;return(0,r.Cu)(o.a.mediaTranscodings.create(),{blob_signed_id:t})}}},21937:(e,t,n)=>{n.d(t,{W:()=>l});var r=n(81089),o=n(50732);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={index:function(e){var t=e.filters,n=e.order,i=e.page,s=e.perPage,l=e.searchKey,c=l?{search_key:l}:{};return function(){return(0,r.UT)(o.av.admin.paywalls.charges.index({params:a({filters:t,page:i,per_page:s,order:n},c)}))}},refundCharge:function(e){var t=e.chargeProcessorId,n=e.params;return(0,r.Cu)(o.av.admin.paywalls.charges.refunds({chargeProcessorId:t}),n)}}},12114:(e,t,n)=>{n.d(t,{vk:()=>v});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(88767),l=n(3209),c=n(81089),u=n(50732);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.params,n=void 0===t?{}:t,r=e.isCalendarView,d=void 0!==r&&r,f=(0,l.d)(),v=f.removeRecord,h=f.findAndReplaceRecord,b=["all","events",n,{type:d?"calendar":"default"}],g=(0,s.useQueryClient)(),y=function(){var e,t=(e=o().mark((function e(t){var n,r,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(i.length>1&&void 0!==i[1]?i[1]:{}).refetch,r=t,void 0!==n&&!n){e.next=6;break}return e.next=5,g.fetchQuery(u.av.posts.show({spaceId:t.space_id,postSlug:t.slug,spaceSlug:t.space_slug}));case 5:r=e.sent;case 6:return e.abrupt("return",h(r,b));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),_=(0,s.useInfiniteQuery)(b,(function(e){var t,r=e.pageParam;return t=void 0===r?1:r,(0,c.UT)(u.av.events.allEvents({params:m({page:t,per_page:d?120:20},n)}))}),{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,a.flatten)(n.map((function(e){return e.records}))),pageParams:n.map((function(e){return e.page})),pagesList:n}},keepPreviousData:d,getNextPageParam:function(e){return e.has_next_page?Number(e.page)+1:void 0}}),x=_.data,j=(x=void 0===x?{}:x).pages,w=void 0===j?[]:j,O=x.pagesList,S=void 0===O?[]:O,P=_.isLoading,C=_.refetch,k=_.hasNextPage,N=_.fetchNextPage,I=S[S.length-1];(0,i.useEffect)((function(){d&&I&&I.count>I.page*I.per_page&&N()}),[I,d,N]);var A=S.map((function(e){return e.records.map((function(e){return e.id}))}));return{events:w,pagesList:S,isLoading:P,refetchAllEvents:C,hasNextPage:k,fetchNextPage:N,perPageEventIds:A,onEventChange:y,onEventDestroy:function(e){v(e,b)}}}},45824:(e,t,n)=>{n.d(t,{R:()=>d});var r=n(94184),o=n.n(r),i=n(85893),a=["children","className"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=function(e){var t=e.children,n=e.className,r=void 0===n?"":n,s=u(e,a);return(0,i.jsx)("div",l(l({},s),{},{className:o()("bg-secondary text-dark mx-6 mb-6 rounded-lg p-4 text-center text-sm",r),children:t}))}},47774:(e,t,n)=>{n.d(t,{k:()=>g});var r=n(64687),o=n.n(r),i=n(86013),a=n(96486),s=n(24185),l=n(98338),c=n(94281),u=n(81786),d=n(50732),m=n(59887),f=n(54030),p=n(74666),v=n(18605),h=n(85893);function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var g=function(e){var t=e.communityMemberId,n=e.shouldAutoNavigate,r=void 0===n||n,g=e.showIcon,y=void 0===g||g,_=e.onClick,x=void 0===_?a.noop:_,j=e.variant,w=void 0===j?"button":j,O=(0,s.k6)(),S=(0,l.wh)().isViewOnlyMasquerading,P=(0,m.pB)().findOrCreateChatRoom,C=(0,f.ef)(),k=function(){var e,n=(e=o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P({kind:p.g8,community_member_ids:[t]});case 2:n=e.sent,null===x||void 0===x||x(n),r&&O.push((0,d.co)({url:(0,d.so)({uuid:n})}));case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,h.jsx)(c.T,{placement:"bottom",content:(0,i.t)("post.share.message"),interactive:!1,disabled:"icon"!==w,children:(0,h.jsxs)(u.z,{variant:"secondary",onClick:S?a.noop:k,"aria-label":(0,i.t)("post.share.message"),"data-testid":"chat-button",children:[y&&(0,h.jsx)(v.JO,{type:"16-message",size:16,useWithFillCurrentColor:!0,"aria-hidden":!0}),!C&&"icon"!==w&&(0,h.jsx)("span",{className:"ml-1",children:(0,i.t)("message")})]})})}},44951:(e,t,n)=>{n.d(t,{f:()=>v});var r=n(86013),o=n(96486),i=n(11049),a=n(21451),s=n(44032),l=n(17845),c=n(9141),u=n(85893);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){var t=e.chatRoom,n=e.currentParticipant,d=e.handleSubmit,m=e.messageId,f=e.isEditMessage,p=void 0!==f&&f,v=e.isInitialPage,h=void 0!==v&&v,b=e.message,g=e.onConfirm,y=void 0===g?o.noop:g,_=e.participants,x=e.repliesCount,j=(0,i.dd)(),w=(0,a._q)().deleteRichTextMessage;return(0,u.jsxs)(s.c,{isOpen:j.visible,onClose:j.visible?j.hide:o.noop,onConfirm:function(){w({chatRoomUuid:t.uuid,messageId:m}),j.hide(),y()},confirmText:(0,r.t)("delete"),confirmVariant:"danger",title:(0,r.t)("messaging.delete_message.title"),children:[(0,u.jsx)("div",{className:"mb-6",children:(0,l.eB)(x)}),(0,u.jsx)("div",{className:"border-primary w-full rounded-md border py-5",children:(0,u.jsx)(c.t,{isModal:!0,handleSubmit:d,currentParticipant:n,message:b,isInitialPage:h,isEditMessage:p,chatRoom:t,participants:_})})]})},p=i.gk.create((function(e){return(0,u.jsx)(f,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),v=function(){return(0,i.dd)(p)}},90156:(e,t,n)=>{n.d(t,{P:()=>N});var r=n(67294),o=n(94184),i=n.n(o),a=n(69293),s=n(35102),l=n(17845),c=n(20640),u=n.n(c),d=n(86013),m=n(96486),f=n(88767),p=n(24185),v=n(34334),h=n(43990),b=n(94281),g=n(98338),y=n(59887),_=n(66965),x=n(54482),j=n(27025),w=n(69647),O=n(85893),S=function(e){var t=e.isPinned,n=void 0!==t&&t,r=e.setEditMessageId,o=e.currentParticipant,i=void 0===o?{}:o,a=e.toggleDeleteConfirmationModal,s=e.message,c=e.chatRoom,S=e.isMessageThread,P=void 0!==S&&S,C=e.canUserModifyMessage,k=void 0!==C&&C,N=e.setUnreadMessageFlow,I=void 0===N?m.noop:N,A=e.isLiveStream,E=void 0!==A&&A,T=e.chatRoomUrl,M=void 0===T?"":T,L=e.messagesContainerId,R=void 0===L?"":L,D=e.setActiveMessageId,F=(0,p.TH)().pathname,U=(0,g.wh)().currentCommunity,B=void 0===U?{}:U,z=F.includes("/messages"),H=(0,y.aK)().appendUnreadChatRoomUuids,Z=s.id,q=s.chat_room_participant_id,V=s.parent_message_id,W=i.admin,Q=q===i.id,$=(0,w.p)(),G="direct"==c.chat_room_kind,J=(0,g.L2)().data,K=(0,_.L)([null===J||void 0===J?void 0:J.id]).refetchSpaceNotifications,Y=(0,f.useQueryClient)(),X=Q||c.lesson||E,ee=(0,f.useMutation)((function(e){return v.MS.markAsUnread({uuid:c.uuid,chat_room:e})}),{onSuccess:function(){I(!0),Y.invalidateQueries((0,h.S)(c.uuid)),J?K():Y.invalidateQueries(y.Nh),$.success((0,d.t)("messaging.actions.mark_as_unread_success"))},onError:function(){$.error((0,d.t)("messaging.actions.mark_as_unread_error"))}}).mutate,te=(0,f.useMutation)((function(e){return v.MS.pinMessage({uuid:c.uuid,chat_room:e})}),{onError:function(){$.error((0,d.t)("messaging.actions.pin_error"))}}).mutate,ne=[{value:"edit-message",label:(0,d.t)("edit"),onClick:function(){return r(Z)},hide:!Q},{value:"pin-message",label:n?(0,d.t)("unpin"):(0,d.t)("pin"),onClick:function(){return e=Z,void te({pinned_message_id:n?null:e});var e},hide:!k||P||!W&&!G},{value:"unread-message",label:(0,d.t)("unread"),onClick:function(){return ee({message_id:Z}),void(z&&B.id&&H(B.id,c.uuid))},hide:X},{value:"copy-link",label:(0,d.t)("messaging.actions.copy_link"),onClick:function(){var e=(0,l.Q1)({id:Z,parentMessageId:V,chatRoomUrl:M});u()(e),$.success((0,d.t)("messaging.actions.copy_link_success"))},hide:E},{value:"delete-message",label:(0,d.t)("delete"),onClick:a,color:"text-v2-danger",hide:!k}];if(ne.every((function(e){return e.hide})))return null;var re=R&&document.getElementById(R)||(0,l.j_)(),oe=(0,l.h7)(Z,P);return(0,O.jsx)(j.Lt,{direction:"bottom-end",button:(0,O.jsx)(j.Lt.MenuButton,{onClick:function(){return D(oe)},children:(0,O.jsx)(b.T,{content:(0,d.t)("messaging.more_actions"),children:(0,O.jsx)(x.h,{name:"16-menu-dots-horizontal",ariaLabel:(0,d.t)("messaging.more_actions")})})}),options:ne,dataTestId:"message-actions",appendTo:re})},P=n(48121),C=n(58974),k=function(e){var t=e.message,n=void 0===t?{}:t,r=e.chatRoom,o=e.isMessageThread,i=void 0!==o&&o,a=e.chatThreadsEnabled,s=void 0!==a&&a,c=e.isParentMessage,u=void 0!==c&&c,f=e.isRenderedOnHeader,v=void 0!==f&&f,h=e.currentParticipant,_=e.onBookmarkToggle,j=e.setActiveMessageId,w=n.id,S=n.embedded,k=(0,y.KR)().removeThreadIdUrlParam,N=(0,y.xX)(),I=N.openThreadsRailbar,A=N.setMessageHighlightId,E=N.isLiveStream,T=N.isCourseSpace,M=N.isDrawer,L=E||T,R=window.location.href.includes("threads"),D=(0,m.isFunction)(_)&&!L,F=u&&i&&!v&&!L&&!M,U=(0,p.k6)(),B=(h||{}).community_member_id,z=((0,g.wh)().currentCommunitySettings||{}).chat_reactions_enabled,H=(0,m.throttle)((function(){A(w),(0,l.o7)(w,(function(){(0,m.delay)((function(){return A(null)}),5e3)}))}),5e3,{leading:!0,trailing:!1});return(0,O.jsxs)(O.Fragment,{children:[z&&B&&(0,O.jsx)(P.D,{reactions:n.reactions,currentCommunityMemberId:B,reactionableId:n.id,reactionableType:"chat_room_message",setActiveMessageId:j,isMessageThread:i}),D&&(0,O.jsx)(C.e,{bookmarkType:"message",record:n,onSuccess:function(){return _(n.id)}}),s&&!i&&(0,O.jsx)(b.T,{content:(0,d.t)("messaging.reply_in_threads"),dataTestId:"reply-thread",interactive:!1,children:(0,O.jsx)(x.h,{name:"16-open-threads",ariaLabel:(0,d.t)("messaging.reply_in_threads"),onClick:function(){k(),I(n,r)},iconSize:16})}),F&&(0,O.jsx)(b.T,{content:(0,d.t)(S?"messaging.open_in_space":"messaging.open_in_messages"),interactive:!1,children:(0,O.jsx)(x.h,{name:"16-open-in-space",ariaLabel:(0,d.t)(S?"messaging.open_in_space":"messaging.open_in_messages"),onClick:function(){R||v?U.push((0,l.ZZ)(r,n)):H()},iconSize:16})})]})},N=function(e){var t=e.isPinned,n=void 0!==t&&t,o=e.setEditMessageId,c=e.currentParticipant,u=void 0===c?{}:c,d=e.toggleDeleteConfirmationModal,m=e.message,f=e.chatRoom,p=e.isMessageThread,v=void 0!==p&&p,h=e.canUserModifyMessage,b=void 0!==h&&h,g=e.chatThreadsEnabled,y=void 0!==g&&g,_=e.isParentMessage,x=void 0!==_&&_,j=e.isPinnedMessageAtTop,w=void 0!==j&&j,P=e.isRenderedOnHeader,C=void 0!==P&&P,N=e.onBookmarkToggle,I=e.setUnreadMessageFlow,A=e.isLiveStream,E=void 0!==A&&A,T=e.chatRoomUrl,M=e.messagesContainerId,L=(0,r.useRef)(null),R=(0,s.f4)(),D=R.activeMessageId,F=R.setActiveMessageId,U="message-actions-".concat(m.id);(0,a.Z)(L,(function(){F(null)}));var B=(0,l.XE)({activeMessageId:D,id:m.id,isMessageThread:v});return(0,O.jsx)("div",{className:"absolute right-0 top-0 mb-3",children:(0,O.jsx)("div",{id:U,className:i()("border-primary bg-primary -mt-2 mr-4 flex rounded-md border",{"!mt-2":w,invisible:!D||!B,"group-hover/action:visible":!D||B}),children:(0,O.jsx)("div",{ref:L,children:(0,O.jsxs)("div",{className:"flex min-h-[34px] items-center justify-around space-x-1 px-1",children:[(0,O.jsx)(k,{message:m,isMessageThread:v,chatThreadsEnabled:y,chatRoom:f,isParentMessage:x,isRenderedOnHeader:C,currentParticipant:u,onBookmarkToggle:N,setActiveMessageId:F}),u&&(0,O.jsx)(S,{isPinned:n,setEditMessageId:o,currentParticipant:u,toggleDeleteConfirmationModal:d,message:m,chatRoom:f,isMessageThread:v,canUserModifyMessage:b,setUnreadMessageFlow:I,isLiveStream:E,chatRoomUrl:T,setActiveMessageId:F,messagesContainerId:M})]})})})})}},9141:(e,t,n)=>{n.d(t,{t:()=>V});var r=n(94184),o=n.n(r),i=n(86013),a=n(96486),s=n(64660),l=n(388),c=n(67294),u=n(98338),d=n(94281),m=n(83783),f=n(12700),p=n(85893);function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e){var t=e.reaction,n=e.currentCommunityMemberId,r=e.reactionableId,s=e.reactionableType,l=(0,u.wh)().isViewOnlyMasquerading,h=t.emoji,b=t.count,g=t.community_member_ids,y=m.V[h],_=v((0,c.useState)([]),2),x=_[0],j=_[1],w=g.includes(n),O=function(e,t,n,r){var o=e.findIndex((function(e){return e.id===n}));-1!==o&&(e.splice(o,1),e.unshift({id:n,full_name:(0,i.t)("reactions.you")}));var a=e.map((function(e){return e.full_name}));return r>5?a.join(", ")+" ".concat((0,i.t)("reactions.and")," ").concat(r-5," ").concat((0,i.t)("reactions.more_reacted_with")," :").concat(t,":"):a.join(", ").replace(/,([^,]*)$/," ".concat((0,i.t)("reactions.and"),"$1"))+" ".concat((0,i.t)("reactions.reacted_with")," :").concat(t,":")}(x,h,n,b),S=(0,f.z)({currentCommunityMemberId:n,emoji:h,reactionableId:r,reactionableType:s,setCommunityMembers:j,communityMemberIds:g}),P=S.addReaction,C=S.removeReaction,k=S.fetchCommunityMembers,N=S.isLoading;if(!y)return null;var I=(0,p.jsxs)("button",{type:"button",className:o()("text-default border-primary relative flex cursor-pointer gap-1 rounded-full border px-2 py-0.5 text-xs font-semibold",{"!border-circle text-brand hover:border-brand bg-circle/5":w,"hover:border-gray-400":n&&!w}),onClick:l?a.noop:function(){if(n&&!N){var e,t,o,i=(o=r,(t=s)in(e={emoji:h})?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e);w?C(i):P(i)}},onMouseEnter:function(){return k()},"data-testid":"reaction-content",children:[(0,p.jsx)("div",{children:y}),(0,p.jsx)("div",{children:b})]});return x.length>0?(0,p.jsx)(d.T,{placement:"top",content:O,interactive:!1,children:I}):(0,p.jsx)("div",{children:I})},g=n(48121),y=function(e){var t=e.reactions,n=void 0===t?[]:t,r=e.currentCommunityMemberId,o=e.reactionableId,i=e.reactionableType;return 0===n.length?null:(0,p.jsxs)("div",{className:"my-2 flex flex-wrap gap-1",children:[n.map((function(e){return(0,p.jsx)(b,{reaction:e,currentCommunityMemberId:r,reactionableId:o,reactionableType:i},e.emoji)})),r&&(0,p.jsx)(g.D,{reactions:n,currentCommunityMemberId:r,reactionableId:o,reactionableType:i,showBorder:!0})]})},_=n(41320),x=n(18605),j=n(64422),w=n(39997),O=n(17845),S=n(53731),P="text-sm font-normal whitespace-pre-line chat-message-word-wrap text-darkest",C=function(e,t,n){return(0,p.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:t},n)},k=function(e){var t=e.body,n=e.isPinnedMessageAtTop,r=void 0!==n&&n;return(0,p.jsx)("div",{className:o()(P,{"pinned-message-body":r}),"data-testid":"message-text",children:(0,p.jsx)(S.Z,{componentDecorator:C,children:t})})},N=n(78417),I=n(8246),A=n(66422),E=function(e){var t=e.editedAt,n=e.isInitialPage,r=void 0!==n&&n,a=e.isPinnedMessageAtTop,s=void 0!==a&&a,l=e.rich_text_body,c=e.chatRoomAccessArr;return l?(0,p.jsx)(N.S,{renderFunc:function(){return(0,p.jsx)(I.Z.LabelSm,{color:"text-v2-danger",children:(0,i.t)("messaging.message_error")})},children:(0,p.jsx)("div",{className:o()(P,{"pinned-message-body":s}),"data-testid":"message-text",children:(0,p.jsx)(A.T,{editable:!1,rich_text_body:l,shouldScrollIntoView:r,shouldRefetch:!0,isUpdate:s,editedAt:t,chatRoomAccessArr:c})})}):null},T=function(e){var t,n=e.message,r=e.isInitialPage,o=void 0!==r&&r,i=e.isPinnedMessageAtTop,a=void 0!==i&&i;return(a?!(!(t=n.rich_text_body)||0===t.body.content.length):Boolean(n.rich_text_body))?(0,p.jsx)(E,{rich_text_body:n.rich_text_body,isInitialPage:o,isPinnedMessageAtTop:a,editedAt:n.edited_at,chatRoomAccessArr:n.embedded_chat_message_access}):(0,p.jsx)(k,{body:n.body,isPinnedMessageAtTop:a})},M=n(20640),L=n.n(M),R=n(40160),D=n(50732),F=n(88884),U=n(73890),B=n(69647),z=function(e){var t=e.message,n=e.chatRoom,r=e.chatRoomUrl,a=void 0===r?"":r,s=e.isParentMessage,l=void 0!==s&&s,c=e.isMessageThread,u=void 0!==c&&c,d=e.isRenderedOnHeader,m=void 0!==d&&d,f=window.location.href.includes("threads"),v=t.id,h=t.sent_at,b=t.parent_message_id,g=(0,F.H)(h),y=g.day,_=g.time,x=(0,U.TF)(h),j=(0,B.p)(),w=function(){return u?l?"".concat(y," at ").concat(_):x:_};return f||m?(0,p.jsx)(R.rU,{to:(0,D.co)({url:(0,O._z)(n,t),hash:l?(0,O.uo)(t):(0,O.d6)(t),search:l?"":"message_id=".concat(t.id)}),className:o()({"inline-flex flex-row items-center":m}),children:(0,p.jsx)("span",{className:"text-light inline cursor-pointer text-xs hover:underline",children:v?w():(0,i.t)("messaging.sending")})}):(0,p.jsx)("button",{type:"button",className:o()("inline min-w-fit text-xs font-medium text-gray-400",{"hover:underline":v}),onClick:function(){var e=(0,O.Q1)({id:v,parentMessageId:b,chatRoomUrl:a});L()(e),j.success((0,i.t)("messaging.actions.copy_link_success"))},children:v?w():(0,i.t)("messaging.sending")})},H=n(24185),Z=function(e){var t=e.chatRoom,n=e.isRenderedOnHeader,r=void 0!==n&&n,o=e.message,a=e.onDelete,s=e.onSubmit,l=(0,H.TH)().pathname,c=o.rich_text_body||{body:o.body},u=(0,O.$S)(t),d=(0,O.C9)(t),m=l.includes("/messages"),f=(0,O.jr)(m,r);return(0,p.jsxs)("div",{className:"chat-message-word-wrap text-dark mb-1 whitespace-pre-line text-sm font-normal","data-testid":"message-text",children:[(0,p.jsx)(A.T,{autofocus:!0,editable:!0,rich_text_body:c,onSubmit:s,onDelete:a,isUpdate:!0,chatProps:{isThread:!!o.parent_message_id,isDirectMessaging:u,isChatAdminOrModerator:d},portalTargetId:f}),(0,p.jsxs)("div",{className:"-mt-5 text-xs",children:[(0,i.t)("messaging.esc_to")," ",(0,p.jsx)("span",{className:"font-semibold",children:(0,i.t)("cancel")})," ",(0,i.t)("messaging.bullet")," ",(0,i.t)("messaging.enter_to")," ",(0,p.jsx)("span",{className:"font-semibold",children:(0,i.t)("save")})]})]})},q=function(e){var t=e.role;return(0,p.jsx)(d.T,{placement:"top",content:(0,i.t)("live_roles.".concat(t)),children:(0,p.jsx)(x.JO,{type:t,size:16,className:"-ml-1 -mt-1"})})},V=function(e){var t=e.chatRoom,n=e.chatRoomUrl,r=e.currentParticipant,c=void 0===r?{}:r,d=e.handleSubmit,m=e.isEditMessage,f=void 0!==m&&m,v=e.isInitialPage,h=void 0!==v&&v,b=e.isMessageThread,g=void 0!==b&&b,S=e.isModal,P=void 0!==S&&S,C=e.isParentMessage,k=void 0!==C&&C,N=e.isPinned,I=void 0!==N&&N,A=e.isPinnedMessageAtTop,E=void 0!==A&&A,M=e.isRenderedOnHeader,L=void 0!==M&&M,R=e.message,D=e.messageBodyClassName,F=e.participants,U=void 0===F?[]:F,B=e.roles,H=void 0===B?{}:B,V=e.toggleDeleteConfirmationModal,W=void 0===V?a.noop:V,Q=(0,s.r)(),$=R.chat_room_participant_id,G=U.find((function(e){return e.id===$})),J=(0,O.cY)(null===G||void 0===G?void 0:G.community_member_id,H),K=(0,a.isEmpty)(G),Y=null===G||void 0===G?void 0:G.user_public_uid,X=((0,u.wh)().currentCommunitySettings||{}).chat_reactions_enabled,ee=(c||{}).community_member_id,te=(0,_.x)().isLiveStream,ne=function(){Y&&Q.show({memberPublicId:G.user_public_uid,params:{shouldOpenInNewTab:te}})};return(0,p.jsxs)("div",{className:o()({"ml-1 flex w-[98%] justify-start py-3 pl-5":!L,"flex w-full justify-start px-5 py-1.5":L}),children:[(0,p.jsx)("button",{type:"button",className:o()("mr-3 self-start",{"cursor-default":!Y}),"aria-label":(0,i.t)("messaging.open_member_profile_button_aria_label",{name:null===G||void 0===G?void 0:G.name}),onClick:ne,children:K?(0,p.jsx)(w.qE,{}):(0,p.jsx)(l.C,{communityMemberId:G.community_member_id,name:G.name,publicUid:G.user_public_uid,headline:G.headline,avatarURL:G.avatar_url,disabled:!Y,children:(0,p.jsx)(j.s,{src:G.avatar_url,name:G.name,size:"9"})})}),(0,p.jsxs)("div",{className:o()("w-full overflow-x-auto",D),children:[(0,p.jsxs)("div",{className:"mb-px flex items-center gap-2",children:[(0,p.jsx)("button",{type:"button",className:o()("text-darkest truncate text-left text-sm font-semibold",{"cursor-default":!Y}),onClick:ne,"data-testid":"number-of-replies",children:K?(0,p.jsx)(w.X2,{md:!0}):(0,p.jsxs)(p.Fragment,{children:[G.id===(null===c||void 0===c?void 0:c.id)?(0,i.t)("messaging.you"):G.name," ",(0,p.jsx)("span",{className:"font-normal",children:G.deleted_at?(0,i.t)("messaging.removed_or_left"):""})]})}),J&&(0,x.Er)(J)&&(0,p.jsx)(q,{role:J}),I&&(0,p.jsx)(x.JO,{type:"pin","aria-label":(0,i.t)("messaging.pinned_message"),"aria-hidden":!1}),(0,p.jsx)(z,{chatRoom:t,message:R,chatRoomUrl:n,isParentMessage:k,isMessageThread:g,isRenderedOnHeader:L})]}),!P&&f?(0,p.jsx)(Z,{message:R,onSubmit:d,onDelete:W,chatRoom:t,isRenderedOnHeader:L}):(0,p.jsx)(T,{message:R,isInitialPage:h,isPinnedMessageAtTop:E}),X&&(0,p.jsx)(y,{reactions:R.reactions,currentCommunityMemberId:ee,reactionableId:R.id,reactionableType:"chat_room_message"})]})]})}},33437:(e,t,n)=>{n.d(t,{J:()=>i});var r=n(86013),o=n(85893),i=function(e){var t=e.showDateChangeLine,n=void 0!==t&&t,i=e.showUnreadMessageLine,a=void 0!==i&&i,s=e.day;return n&&a?(0,o.jsxs)("div",{id:"unread-message-breakpoint",className:"before:border-v2-danger relative z-0 mx-5 flex items-center justify-center before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:[(0,o.jsx)("span",{className:"text-disabled bg-primary absolute border-none px-[15px] py-[5px] text-xs font-bold uppercase",children:s}),(0,o.jsx)("span",{className:"text-v2-danger border-none py-[5px] pl-[10px] text-xs font-semibold uppercase",children:(0,r.t)("messaging.new")})]}):n?(0,o.jsx)("div",{className:"before:border-primary relative z-0 mx-5 flex items-center justify-center before:absolute before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,o.jsx)("span",{className:"bg-primary text-disabled border-none px-[15px] py-[5px] text-xs font-bold uppercase",children:s})}):a?(0,o.jsx)("div",{id:"unread-message-breakpoint",className:"before:border-v2-danger relative z-0 mx-5 flex items-center justify-center before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,o.jsx)("span",{className:"text-v2-danger border-none py-[5px] pl-[10px] text-xs font-semibold uppercase",children:(0,r.t)("messaging.new")})}):null}},64088:(e,t,n)=>{n.d(t,{R:()=>x});var r=n(67294),o=n(94184),i=n.n(o),a=n(95172),s=n(24185),l=n(35102),c=n(21451),u=n(41320),d=n(86013),m=n(85893),f=function(){return(0,m.jsx)("div",{id:"unread-thread-message-breakpoint",className:"relative flex items-center justify-center z-0 mx-5 before:w-full before:m-0 before:border-t before:border-solid before:border-v2-danger before:z-[-1] before:content-['']",children:(0,m.jsx)("span",{className:"text-v2-danger border-none py-[5px] pl-[10px] text-xs font-semibold uppercase",children:(0,d.t)("messaging.new")})})},p=n(17845),v=n(44951),h=n(90156),b=n(9141),g=n(13079);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t=e.chatRoom,n=e.chatThreadsEnabled,o=void 0!==n&&n,d=e.currentParticipant,_=e.isInitialPage,x=void 0!==_&&_,j=e.isParentMessage,w=void 0!==j&&j,O=e.isRenderedOnHeader,S=void 0!==O&&O,P=e.isUnreadMessageLineEnabled,C=void 0!==P&&P,k=e.lastReadMessageId,N=e.message,I=e.onBookmarkToggle,A=e.participants,E=e.roles,T=void 0===E?{}:E,M=e.setUnreadMessageFlow,L=e.isLiveStream,R=void 0!==L&&L,D=e.chatRoomUrl,F=(0,c._q)().updateRichTextMessage,U=(0,u.x)().messageHighlightId,B="/threads"===(0,s.TH)().pathname,z=(0,l.f4)().activeMessageId,H=y((0,r.useState)(null),2),Z=H[0],q=H[1],V=N.id,W=N.replies_count,Q=!!V&&Z===V,$=(0,g.O5)({message:N,chatRoom:t}).canUserModifyMessage,G=!!d,J=function(){return q(null)};(0,a.y1)("esc",J,{enabled:Q,enableOnContentEditable:!0},[Q]);var K=function(e){var n=e.body,r=e.attachments,o=void 0===r?[]:r;F({chatRoomUuid:t.uuid,messageId:V,rich_text_body:{body:n,attachments:o}}),J()},Y=(0,v.f)(),X=function(){Y.visible?Y.hide():Y.show({chatRoom:t,currentParticipant:d,handleSubmit:K,isEditMessage:Q,isInitialPage:x,message:N,messageId:V,participants:A,repliesCount:W})},ee=C&&k===N.id,te=(0,p.XE)({activeMessageId:z,id:V,isMessageThread:!0});return(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{id:"thread-".concat(V),className:i()("group/action bg-primary relative flex w-full flex-col",{relative:!w||B,"hover:bg-secondary":!z&&G,"!bg-secondary":Q||te,"message-highlight":(0,p.DH)({id:V,messageHighlightId:U,isParentMessage:w})}),"data-testid":"message-item",children:[(0,m.jsx)(b.t,{isModal:!1,handleSubmit:K,currentParticipant:d,message:N,isInitialPage:x,isEditMessage:Q,toggleDeleteConfirmationModal:X,isPinned:!1,roles:T,isParentMessage:w,chatRoom:t,chatRoomUrl:D,participants:A,isMessageThread:!0,isRenderedOnHeader:S,messageBodyClassName:"mr-4"}),G&&(0,m.jsx)(h.P,{isPinned:!1,setEditMessageId:q,chatRoom:t,toggleDeleteConfirmationModal:X,message:N,currentParticipant:d,canUserModifyMessage:$,chatThreadsEnabled:o,isParentMessage:w,isRenderedOnHeader:S,isMessageThread:!0,onBookmarkToggle:I,setUnreadMessageFlow:M,chatRoomUrl:D,isLiveStream:R})]}),ee&&(0,m.jsx)(f,{})]})};x.displayName="MessageItem"},13079:(e,t,n)=>{n.d(t,{O5:()=>i,Sh:()=>v,O1:()=>b});var r=n(96486),o=n(74666),i=function(e){var t=e.message,n=e.chatRoom,i=t.id,a=t.chat_room_participant_id,s=n.current_participant,l=void 0===s?{}:s,c=n.chat_room_kind===o.g8,u=a===(null===l||void 0===l?void 0:l.id),d=!(0,r.isNull)(i),m=null===l||void 0===l?void 0:l.admin;c&&(m=!1);var f=Boolean(d&&u),p=Boolean(d&&(u||m));return{canUserDeleteMessage:p,canUserEditMessage:f,canUserModifyMessage:f||p}},a=n(67294),s=n(95172),l=n(98338),c=n(88884),u=n(59887),d=n(17845),m=n(44951);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function(e){var t=e.chatRoom,n=e.chatThreadsEnabled,o=void 0!==n&&n,p=e.currentParticipant,v=e.isInitialPage,h=void 0!==v&&v,b=e.isLastMessage,g=void 0!==b&&b,y=e.message,_=e.participants,x=e.prevDayRef,j=(0,l.wh)().isViewOnlyMasquerading,w=(0,u._q)().updateRichTextMessage,O=(0,u.ub)(),S=O.setScrollInfo,P=O.calculateScrollInfo,C=f((0,a.useState)(null),2),k=C[0],N=C[1],I=y.id,A=y.sent_at,E=y.replies_count,T=(0,c.H)(A).day,M=!(0,r.isFunction)(x)&&(null===x||void 0===x?void 0:x.current)!==T;x&&!(0,r.isFunction)(x)&&(x.current=T);var L=!(j||!I)&&k===I,R=(0,m.f)(),D=i({message:y,chatRoom:t}).canUserModifyMessage,F=!L&&(D||o),U=function(){return N(null)};(0,a.useEffect)((function(){L&&g&&(0,d.o7)(I)}),[L]),(0,s.y1)("esc",U,{enabled:L,enableOnContentEditable:!0},[L]);var B=function(e){S(P({event:e}))},z=function(e){var n=e.body,r=e.attachments,o=void 0===r?[]:r;w({chatRoomUuid:t.uuid,messageId:I,rich_text_body:{body:n,attachments:o}}),B("messageUpdated"),U()};return{canUserModifyMessage:D,day:T,handleSubmit:z,id:I,isDayChange:M,isEditMessage:L,isViewOnlyMasquerading:j,setEditMessageId:N,shouldShowMessageActions:F,shouldShowRepliesBlock:o&&E>0,toggleDeleteConfirmationModal:function(){R.visible?R.hide():R.show({chatRoom:t,currentParticipant:p,handleSubmit:z,isEditMessage:L,isInitialPage:h,message:y,messageId:I,participants:_,onConfirm:function(){B("messageDeleted")},repliesCount:E})}}},h=n(24185),b=function(){var e=(0,h.k6)(),t=function(t){var n=t.id;e.push({hash:"message_".concat(n)})};return{redirectToMessage:t,handlePinnedMessage:function(e){document.getElementById(e.id)?(0,d.o7)(e.id):t(e)}}}},18953:(e,t,n)=>{n.d(t,{G:()=>c});var r=n(86013),o=n(59887),i=n(25680),a=n(8246),s=n(17845),l=n(85893),c=function(e){var t=e.chatRoomUuid,n=e.userList,c=(0,o.uk)(t),u=c.chatParticipants,d=n||u;if(c.isLoading)return null;var m=(0,s.jo)(d);return(0,l.jsxs)("div",{className:"block px-5 py-4",children:[(0,l.jsx)("div",{className:"mb-2 flex space-x-2","data-testid":"participants",children:d.map((function(e){var t=e.name,n=e.avatar_url,r=e.id,o=e.status;return(0,l.jsx)(i.g,{src:n,name:t,size:"10",status:o},r)}))}),(0,l.jsx)(a.Z.LabelLg,{weight:"medium",color:"text-darkest",dataTestId:"start-conversation",children:(0,r.t)("messaging.start_conversation")}),(0,l.jsxs)(a.Z.BodyMd,{"data-testid":"start-conversation-message",children:[(0,r.t)("messaging.direct_message_history")," ",m]})]})}},12064:(e,t,n)=>{n.d(t,{Q1:()=>r,XE:()=>o,h7:()=>i,j_:()=>a});var r=function(e){var t=e.id,n=e.parentMessageId,r=e.chatRoomUrl;return window.location.protocol+"//"+window.location.host+(r||window.location.pathname)+(n?"?message_id=".concat(t,"#message_").concat(n):"#message_".concat(t))},o=function(e){var t=e.activeMessageId,n=e.id,r=e.isMessageThread;return t===i(n,void 0!==r&&r)},i=function(e,t){return"".concat(t?"thread-":"message-").concat(String(e))},a=function(){return document.getElementById("threads-scroll-view")||document.getElementById("message-thread-scroll-view")||document.getElementById("message-scroll-view")||document.body}},17845:(e,t,n)=>{n.d(t,{UT:()=>h,cj:()=>A,XE:()=>E.XE,nR:()=>C,h7:()=>E.h7,uo:()=>O,ZZ:()=>P,_z:()=>w,d6:()=>S,Q1:()=>E.Q1,j_:()=>E.j_,eB:()=>j,YQ:()=>b,jo:()=>m,jr:()=>I,cY:()=>p,C9:()=>N,$S:()=>k,o7:()=>f,uR:()=>_,DH:()=>x,Pd:()=>g,PM:()=>y});var r=n(86013),o=n(96486),i=n(74666),a=n(50732),s=n(43760);function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}s.Mz,s.Q_;var m=function(e){var t="";return e.forEach((function(n,r){t=r==e.length-1?t+n.name+".":r==e.length-2?t+n.name+" and ":t+n.name+", "})),t},f=function(e,t){var n=document.getElementById(e),r=setTimeout((function(){null===n||void 0===n||n.scrollIntoView({behavior:"smooth"}),null===t||void 0===t||t()}),100);return function(){return clearTimeout(r)}},p=function(e,t){for(var n=0,r=Object.entries(t||[]);n<r.length;n++){var o=c(r[n],2),i=o[0],a=o[1];if(Array.isArray(a)&&a.includes(e))return i}},v=function(e,t){return e.sender.id===t.id},h=function(e){var t=e.calculateScrollInfo,n=e.chatRoomMessages,r=e.currentParticipant,i=e.isInitialPageLoaded,a=void 0===i||i,s=e.lastMessage,c=e.setChatRoomMessages,u=e.setFirstMessageId,d=e.setMessagesHasPrevPage,m=e.setScrollInfo;if(null!=s&&a){var f=l(n);f.length>80&&(c(f=f.slice(-60)),u(f[0].id),d(!0));var p=(0,o.last)(f);if((null===p||void 0===p?void 0:p.id)!=s.id&&!function(e,t){return e&&!!e.id&&(null===e||void 0===e?void 0:e.creation_uuid)===(null===t||void 0===t?void 0:t.creation_uuid)}(p,s)){m(t({event:v(s,r)?"messageSent":"messageReceived"}));var h=l(f);return!function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).some((function(t){return t.creation_uuid===e.creation_uuid&&(!e.id||!t.id)}))}(h,s)?h.push(s):h=h.map((function(e){return e.creation_uuid===s.creation_uuid&&!function(e){return!!e.id}(e)?s:e})),h}}},b=function(){return(window.location.hash||"").split("#message_")[1]},g=function(e,t){return e&&t},y=function(e){var t=e.id,n=e.isPinned,r=e.disableUnreadMessageLine,i=e.unreadMessageId;return!(0,o.isNull)(t)&&!n&&!r&&i===t},_=function(e){var t=e.id,n=e.messageHashId,r=e.messageHighlightId;return n&&t==n||r&&t==r},x=function(e){var t=e.id,n=e.messageHighlightId;return!e.isParentMessage&&n&&t==n},j=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)>0?"".concat((0,r.t)("messaging.delete_message.description")," ").concat((0,r.t)("messaging.delete_message.threads")):(0,r.t)("messaging.delete_message.description")},w=function(e,t){if((0,o.isEmpty)(e))return"";var n=e.embedded_space,r=e.uuid,i=(n||{}).slug;return t.embedded?(0,a.kr)({spaceSlug:i}):(0,a.so)({uuid:r})},O=function(e){return"message_".concat(e.id)},S=function(e){return"message_".concat(e.parent_message_id)},P=function(e,t){var n=w(e,t);return"".concat(n,"#message_").concat(t.id)},C=function(e,t){var n=[];return e.map((function(e){var r=e.chat_room_participant_id;t.find((function(e){return(null===e||void 0===e?void 0:e.id)===r}))||n.includes(r)||n.push(r)})),n},k=function(e){return Boolean((null===e||void 0===e?void 0:e.chat_room_kind)===i.g8)},N=function(e){var t=(e||{}).current_participant,n=void 0===t?{}:t;return Boolean((null===n||void 0===n?void 0:n.admin)||(null===n||void 0===n?void 0:n.moderator))},I=function(e,t){var n=null;return e?n="fullscreen-modal-body":t&&(n="chat-threads-header"),n},A=function(e){var t,n,r=e.searchInputClientHeight,o=void 0===r?0:r,i=e.footerClientHeight,a=void 0===i?0:i,l=e.isSmOrMdScreen,c=void 0!==l&&l,u=e.isLiveStream,d=void 0!==u&&u,m=e.isInCourseSpace,f=void 0!==m&&m,p=e.isDrawer,v=void 0!==p&&p,h=e.isMessagingModalOpen,b=void 0!==h&&h,g=a;return o&&(g+=o),t=document.getElementById("mobile-bottom-toolbar"),Boolean(t)&&(g+=s.Q_),!f&&(n=document.getElementById("bookmarks-bar"),Boolean(n))&&(g+=40),c?g+=d||f||v?s.Mz:64+s.Mz:d?g=96:f?g=document.getElementById("lesson-hello-bar")?112:s.Mz:v&&(g=s.Mz),b&&(g=function(e){return e<20?100:e}(g)),g},E=n(12064)},30984:(e,t,n)=>{n.d(t,{x:()=>ie});var r=n(67294),o=n(96486),i=n(43990),a=n(34914),s=n(98338),l=n(59887),c=n(21451),u=n(94810),d=n(18953),m=n(85893),f=function(e){var t=e.userList;return(0,m.jsxs)("div",{children:[(0,m.jsx)(d.G,{userList:t}),(0,m.jsx)(u.Fx,{userList:t,isChatPreview:!0,portalTargetId:"fullscreen-modal-body"})]})},p=n(64687),v=n.n(p),h=n(94184),b=n.n(h),g=n(86013),y=n(24185),_=n(90789),x=n(54030),j=n(14692),w=n(35102),O=n(277),S=n(91008),P=n(40533),C=n(66965),k=n(4404),N=n(43760),I=n(45824),A=n(50732),E=n(17845),T=n(90156),M=n(9141),L=n(33437),R=n(12064),D=n(13079),F=function(e){var t=e.children,n=e.id,r=e.isEditMessage,o=void 0!==r&&r,i=e.isPinned,a=void 0!==i&&i,s=e.isPinnedMessageAtTop,c=void 0!==s&&s,u=e.message,d=e.messageHashId,f=e.shouldShowMessageActions,p=void 0!==f&&f,v=e.shouldShowRepliesBlock,h=void 0!==v&&v,g=(0,l.xX)().messageHighlightId,y=(0,D.O1)().handlePinnedMessage,_=(0,w.f4)().activeMessageId,x=(0,R.XE)({activeMessageId:_,id:u.id,isMessageThread:!1});return c?(0,m.jsx)("button",{type:"button",id:"pinned","data-testid":"message-item",className:b()("group/action bg-primary relative flex w-full cursor-pointer flex-col text-left",{"hover:bg-secondary":!_&&p,"!bg-secondary":o||x,"!bg-message-highlight":a,"pb-2":h}),onClick:function(){o||y(u)},children:t}):(0,m.jsx)("div",{id:n,"data-testid":"message-item",className:b()("group/action bg-primary relative flex w-full flex-col text-left",{"hover:bg-secondary":!_&&p,"!bg-secondary":o||x,"!bg-message-highlight":a,"message-highlight":(0,E.uR)({id:n,messageHashId:d,messageHighlightId:g}),"pb-2":h}),children:t})},U=n(18605),B=n(73890),z=n(41320),H=n(8246),Z=n(64422),q=function(e){var t=e.avatars,n=void 0===t?[]:t;return(0,m.jsx)("div",{className:b()("bg-primary isolate flex items-center space-x-1 rounded-lg md:justify-center"),children:n.map((function(e){var t=e.id,n=e.name,r=e.avatar_url;return(0,m.jsx)(Z.s,{size:"6",src:r,name:n},t)}))})},V=function(e){var t=e.message,n=e.chatRoom,r=e.isMinimal,o=void 0!==r&&r,i=(0,z.x)().openThreadsRailbar,a=t.replies_count,s=t.last_reply_at,l=(0,S.K)().removeThreadIdUrlParam;return(0,m.jsx)("button",{type:"button",className:"hover:border-primary hover:bg-primary group -mt-2 ml-[72px] max-w-sm cursor-pointer rounded-md border border-transparent p-1 md:mr-0 hover:md:mr-[30px]",onClick:function(){l(),i(t,n)},children:(0,m.jsxs)("div",{className:"flex items-center justify-between","data-testid":"replies-block",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)(q,{avatars:t.thread_participants_preview}),(0,m.jsx)(H.Z.LabelSm,{weight:"semibold",children:1===a?(0,g.t)("threads.one_reply"):(0,g.t)("threads.many_replies",{count:a})}),s&&(0,m.jsx)("div",{className:"leading-none group-hover:hidden",children:(0,m.jsxs)(H.Z.LabelXs,{color:"text-light",weight:"medium",children:[!o&&(0,g.t)("last_reply")," ",(0,B.TF)(s)]})}),(0,m.jsx)("div",{className:"hidden leading-none group-hover:block",children:(0,m.jsx)(H.Z.LabelXs,{color:"text-light",weight:"medium",children:(0,g.t)("messaging.view_thread")})})]}),(0,m.jsx)("div",{className:"hidden group-hover:block",children:(0,m.jsx)(U.JO,{type:"20-chevron-right",className:"text-gray-400"})})]})})},W=(0,r.forwardRef)((function(e,t){var n=e.chatRoom,r=e.chatThreadsEnabled,i=void 0!==r&&r,a=e.currentParticipant,s=e.disableUnreadMessageLine,l=void 0!==s&&s,c=e.displayDayChange,u=void 0!==c&&c,d=e.isInitialPage,f=void 0!==d&&d,p=e.isLastMessage,v=void 0!==p&&p,h=e.isParentMessage,b=void 0!==h&&h,g=e.isPinned,y=void 0!==g&&g,_=e.isPinnedMessageAtTop,x=void 0!==_&&_,j=e.message,w=e.messageBodyClassName,S=e.messageHashId,P=e.onBookmarkToggle,C=e.participants,k=e.roles,N=void 0===k?{}:k,I=e.setUnreadMessageFlow,R=e.unreadMessageId,U=e.isLiveStream,B=e.isInCourseSpace,z=e.messagesContainerId,H=(0,D.Sh)({chatRoom:n,chatThreadsEnabled:i,currentParticipant:a,isInitialPage:f,isLastMessage:v,message:j,participants:C,prevDayRef:t}),Z=H.canUserModifyMessage,q=H.day,W=H.handleSubmit,Q=H.id,$=H.isDayChange,G=H.isEditMessage,J=H.isViewOnlyMasquerading,K=H.setEditMessageId,Y=H.shouldShowMessageActions,X=H.shouldShowRepliesBlock,ee=H.toggleDeleteConfirmationModal,te=(0,O.q)().isMessaging?(0,A.so)(n):"";return(0,m.jsxs)("div",{children:[(0,m.jsx)(L.J,{showDateChangeLine:(0,E.Pd)(u,$),showUnreadMessageLine:(0,E.PM)({id:Q,isPinned:y,disableUnreadMessageLine:l,unreadMessageId:R}),day:q}),(0,m.jsxs)(F,{isPinnedMessageAtTop:x,id:Q,shouldShowMessageActions:Y,isEditMessage:G,isPinned:y,messageHashId:S,shouldShowRepliesBlock:X,message:j,children:[(0,m.jsx)(M.t,{isModal:!1,handleSubmit:W,currentParticipant:a,message:j,isInitialPage:f,isEditMessage:G,toggleDeleteConfirmationModal:J?o.noop:ee,isPinned:y,roles:N,isParentMessage:b,chatRoom:n,isPinnedMessageAtTop:x,participants:C,messageBodyClassName:w,chatRoomUrl:te}),(0,m.jsx)(T.P,{isPinned:y,setEditMessageId:K,chatRoom:n,toggleDeleteConfirmationModal:J?o.noop:ee,message:j,currentParticipant:a,canUserModifyMessage:Z,chatThreadsEnabled:i,isParentMessage:b,isPinnedMessageAtTop:x,onBookmarkToggle:P,setUnreadMessageFlow:I,isLiveStream:U,messagesContainerId:z,chatRoomUrl:te}),X&&(0,m.jsx)(V,{message:j,chatRoom:n,isMinimal:U||B})]})]})}));function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}W.displayName="MessageItem";N.Mz,N.Q_;var X=function(e){var t=e.chatRoom,n=e.displayDayChange,i=void 0===n||n,a=e.isChatPreview,d=e.isChatSpace,f=e.isInCourseSpace,p=e.chatUserSearchRef,h=e.isLiveStream,N=e.isDrawer,A=e.roles,T=void 0===A?{}:A,M=e.messageBodyClassName,L=(0,E.YQ)(),R=K((0,r.useState)(L),2),D=R[0],F=R[1],U=K((0,r.useState)(!1),2),B=U[0],z=U[1],H=(0,S.K)().openThreadsRailbarOnThreadsNotification,Z=(0,s.L2)().data,q=K((0,r.useState)(!1),2),V=q[0],Q=q[1],G=(0,C.L)([null===Z||void 0===Z?void 0:Z.id]).refetchSpaceNotifications,Y=(0,j.h4)().spaces,X=(0,_.Xd)(Y,null===Z||void 0===Z?void 0:Z.id),ee=(0,y.k6)(),te=K((0,r.useState)(!0),2),ne=te[0],re=te[1],oe=K((0,r.useState)(!0),2),ie=oe[0],ae=oe[1],se=(0,x.ef)();(0,P.t)();var le=(0,l.uk)(t.uuid,{shouldDisableCache:!0,per_page:20}).chatParticipants,ce=(0,O.q)().isMessaging,ue=t.uuid,de=t.last_message,me=t.current_participant,fe=void 0===me?{}:me,pe=t.unread_messages_count,ve=t.pinned_message,he=t.first_unread_message_id,be=(0,r.createRef)(null),ge=(0,l.ub)(),ye=ge.fetchChatMessagesFirstPage,_e=ge.adjustScroller,xe=ge.calculateScrollInfo,je=ge.setUnreadMessageFlow,we=ge.scrollerId,Oe=(0,w.f4)(),Se=Oe.hasNextPage,Pe=Oe.chatRoomMessages,Ce=void 0===Pe?[]:Pe,ke=Oe.isLoading,Ne=Oe.setChatRoomMessages,Ie=Oe.setScrollInfo,Ae=Oe.isInitialPageLoaded,Ee=Oe.shouldShowLatestMessageBtn,Te=Oe.setShouldShowLatestMessageBtn,Me=Oe.setFirstMessageId,Le=Oe.setHasPrevPage,Re=(0,l.Bk)(Ce,Ne),De=!d&&0===Ce.length,Fe=(0,r.useMemo)((function(){return!(0,o.isEmpty)(fe)&&!fe.deleted_at}),[fe]),Ue=K((0,r.useState)(),2),Be=Ue[0],ze=Ue[1],He=(0,r.useRef)(null),Ze=ne&&ie;(0,r.useEffect)((function(){F(L)}),[L]),(0,r.useEffect)((function(){ye(ue,D||he),ae(!0),re(!0)}),[ue,D,he]),(0,r.useEffect)((function(){D&&Ze&&!ke&&((0,E.o7)(D),H({messageHashId:D,chatRoomMessages:Ce,chatRoom:t}))}),[D,ke,Ze]),(0,r.useEffect)((function(){Ze&&D||!Ae||(0,o.defer)(_e),B&&!Se&&d&&null!==de&&void 0!==de&&de.id&&qe((function(){return z(!1)}))}),[Ce,D,Ae]);var qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.noop;if(!Se){var t=(0,E.UT)({lastMessage:de,chatRoomMessages:Ce,currentParticipant:fe,setScrollInfo:Ie,calculateScrollInfo:xe,isInitialPageLoaded:Ae,setChatRoomMessages:Ne,setFirstMessageId:Me,setMessagesHasPrevPage:Le});t&&(Ne(t),e())}};(0,r.useEffect)((function(){qe()}),[de]),(0,r.useEffect)((function(){var e=function(){var e,t,n=(0,E.cj)({searchInputClientHeight:null===p||void 0===p||null===(e=p.current)||void 0===e?void 0:e.clientHeight,footerClientHeight:null===He||void 0===He||null===(t=He.current)||void 0===t?void 0:t.clientHeight,isSmOrMdScreen:se,isChatSpace:d,isLiveStream:h,isInCourseSpace:f,isDrawer:N});ze(n)};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[p,De,Fe,h,f,se,He,d,N]),(0,r.useEffect)((function(){Q(!((d||ce)&&Fe))}),[Fe,d,ce]);var Ve=(0,o.uniqBy)(Ce,"id"),We=(0,o.sortBy)(Ve,"sent_at"),Qe=Ee||Se&&Ae,$e=Qe&&D&&pe>0,Ge=(0,r.useMemo)((function(){return(0,E.nR)(Ve,le)}),[Ve,le]);(0,l.gJ)({uuid:t.uuid,ids:Ge,enabled:Boolean(le.length&&Ge.length)});var Je=function(){var e,n=(e=v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(d&&(null===X||void 0===X?void 0:X.unread_content_count)>0)){e.next=5;break}return e.next=3,(0,c.tF)(t.uuid);case 3:e.sent&&G();case 5:D?ee.push():ye(ue);case 6:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){J(i,r,o,a,s,"next",e)}function s(e){J(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,m.jsxs)("div",$($({id:"scrollWrapper",className:"flex grow flex-col overflow-y-auto border-r-0","data-testid":"chat-room-wrapper"},Be&&{style:{height:"calc(100dvh - ".concat(Be,"px)")}}),{},{children:[$e&&(0,m.jsx)("div",{className:"relative top-2 z-50 m-auto h-0",children:(0,m.jsx)(u.E0,{label:(0,g.t)("messaging.unread_messages",{unread_count:pe}),onClick:function(){Te(!1),Je()}})}),Ae?(0,m.jsxs)(m.Fragment,{children:[ve&&(0,m.jsx)(W,{message:ve,currentParticipant:fe,isPinned:!0,roles:T,chatRoom:t,chatThreadsEnabled:!a,isLiveStream:h,isInCourseSpace:f,isPinnedMessageAtTop:!0,participants:le,messageBodyClassName:M,onBookmarkToggle:Re,setUnreadMessageFlow:je,messagesContainerId:we}),(0,m.jsx)(u.Qk,{isLastPage:ne,isFirstPage:ie,setIsLastPage:re,setIsFirstPage:ae,chatRoomUuid:t.uuid,componentId:we,children:We.map((function(e){var n;return(0,m.jsx)(W,{message:e,displayDayChange:i,ref:be,currentParticipant:fe,isInitialPage:Ze,isLastMessage:(null===(n=(0,o.last)(Ce))||void 0===n?void 0:n.id)===e.id,messageHashId:D,roles:T,isPinned:(null===ve||void 0===ve?void 0:ve.id)===e.id,disableUnreadMessageLine:V,unreadMessageId:he,chatRoom:t,chatThreadsEnabled:!a,isLiveStream:h,participants:le,messageBodyClassName:M,onBookmarkToggle:Re,setUnreadMessageFlow:je,isInCourseSpace:f,messagesContainerId:we},e.id)}))})]}):(0,m.jsx)("div",{id:we,className:"overflow-hidden pt-0",children:(0,m.jsx)(k.gi,{variant:"chat-room",hideMessageBox:!0})}),Qe&&(0,m.jsx)("div",{className:"relative bottom-8 m-auto h-0",children:(0,m.jsx)(u.E0,{label:(0,g.t)("messaging.latest_messages"),onClick:function(){Te(!1),Je()}})}),Fe?(0,m.jsxs)("div",{ref:He,className:b()("bg-primary fixed z-[9] w-full md:static md:bottom-auto md:z-auto md:w-auto md:bg-auto",{"bottom-0":!De,"bottom-16":De||d,"rounded-b-lg":h}),children:[!ke&&De&&(0,m.jsx)(u.GW,{isLiveStream:h,isInCourseSpace:f,isMessaging:ce,chatRoomUuid:t.uuid}),(0,m.jsx)(u.Fx,{spaceId:null===Z||void 0===Z?void 0:Z.id,chatRoom:t,onClick:function(){(D||Se)&&(z(!0),Je())},isChatPreview:a,isLiveStream:h,isChatSpace:d,isInCourseSpace:f,isLoading:d&&!Ae,participants:le})]}):(0,m.jsx)(I.R,{children:(0,g.t)("community_member.join_space_to_message")})]}))};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oe(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ie=function(e){var t=e.uuid,n=e.displayDayChange,d=void 0===n||n,p=e.onNewChatMessage,v=e.isChatSpace,h=void 0!==v&&v,b=e.chatUserSearchRef,g=e.isLiveStream,y=void 0!==g&&g,_=e.isInCourseSpace,x=void 0!==_&&_,j=e.isDrawer,w=void 0!==j&&j,O=e.roles,S=void 0===O?{}:O,P=e.messageBodyClassName,C=void 0===P?"":P,k=e.isChatPreview,N=e.userList,I=void 0===N?[]:N,A=e.isChatRoomLoading,E=void 0!==A&&A,T=e.isMessaging,M=void 0!==T&&T,L=(0,l.ub)(),R=L.chatRoomMessages,D=L.onEventReceive,F=(0,l.QP)().onReactionWebsocketEvent,U=(0,s.N3)(),B=(0,c._q)(),z=B.chatRooms,H=B.setChatRooms,Z=B.onEventReceive,q=B.onEmbedEventReceive,V=B.fetchChatRoomForUuid,W=(0,i.m)(t),Q=W.chatRoom,$=W.onEventReceive,G=V(z,t),J=(0,r.useRef)([]);return(0,r.useEffect)((function(){J.current=z}),[z]),(0,r.useEffect)((function(){Q&&!G&&H([Q].concat(re(z)))}),[Q,G,z,H]),(0,a.s)({channel:"Chats::RoomChannel",chat_room_uuid:null===Q||void 0===Q?void 0:Q.uuid,onMessageReceive:function(e){"newMessage"===e.event&&(Z(e,null===U||void 0===U?void 0:U.id,J.current,t===(null===Q||void 0===Q?void 0:Q.uuid)),p&&null!==e&&void 0!==e&&e.json_message&&p(e.json_message)),D(e,R),$(e)},canCreateConnection:Boolean((null===Q||void 0===Q?void 0:Q.uuid)&&(null===U||void 0===U?void 0:U.id))},[null===Q||void 0===Q?void 0:Q.uuid,null===U||void 0===U?void 0:U.id]),(0,a.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){F(e),q(e)},community_member_id:null===U||void 0===U?void 0:U.id,canCreateConnection:(null===Q||void 0===Q?void 0:Q.uuid)&&(null===U||void 0===U?void 0:U.id)},[null===Q||void 0===Q?void 0:Q.uuid,null===U||void 0===U?void 0:U.id]),G?(0,m.jsx)(X,{chatRoom:te(te({},G),{},{first_unread_message_id:null===Q||void 0===Q?void 0:Q.first_unread_message_id,current_participant:Q?Q.current_participant:G.current_participant,pinned_message:null===Q||void 0===Q?void 0:Q.pinned_message}),mobileViewSection:o.noop,displayDayChange:d,isChatSpace:h,chatUserSearchRef:b,isLiveStream:y,isInCourseSpace:x,isDrawer:w,roles:S,messageBodyClassName:C,isChatPreview:k}):M?"new"!==t||0!==I.length&&!E?(0,m.jsx)(f,{userList:I}):(0,m.jsx)(u.Fx,{onClick:o.noop,disabled:!0}):null}},72772:(e,t,n)=>{n.d(t,{I:()=>R});var r=n(86013),o=n(96486),i=n(24185),a=n(59887),s=n(34334),l=n(86732),c=n(25233),u=n(41320),d=n(49142),m=n(43760),f=n(67294),p=n(35102),v=n(34914),h=n(98338),b=n(50732),g=n(277),y=n(4404),_=n(45824),x=n(64088),j=n(17845),w=n(94810),O=n(58783),S=n(72934),P=n(85893),C=function(e){var t=e.children,n=e.isLastPage,r=e.isFirstPage,o=e.setIsFirstPage,i=e.setIsLastPage,a=e.chatRoomUuid,s=e.parentMessage,l=(0,O.T)().fetchChatMessages,c=(0,p.qN)(),u=c.hasNextPage,d=c.hasPrevPage,m=c.isLoading,f=c.firstMessageId,v=c.lastMessageId;return(0,P.jsx)(S.Y,{shouldShowPrevLoader:!n,shouldShowNextLoader:!r,hasNextPage:u,hasPrevPage:d,onNextPage:function(e){l({chatRoomUuid:a,id:e,previousPerPage:0,nextPerPage:20,parentMessage:s}),o(!1)},onPrevPage:function(e){l({chatRoomUuid:a,id:e,parentMessage:s}),i(!1)},firstItemId:f,lastItemId:v,componentId:"message-thread-scroll-view",isLoading:m,children:t})},k=function(e){var t=e.count;return(0,P.jsx)("div",{id:"replies-message-line",className:"before:border-primary relative z-0 mx-5 flex items-center justify-start before:absolute before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,P.jsx)("span",{className:"bg-primary w-[68px] border-none py-0.5 pr-[10px] text-xs text-gray-400",children:1===t?(0,r.t)("threads.one_reply"):(0,r.t)("threads.many_replies",{count:t})})})};function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=function(e){var t=e.parentMessage,n=e.chatRoom,i=N((0,f.useState)(!0),2),s=i[0],l=i[1],c=N((0,f.useState)(!0),2),u=c[0],d=c[1],m=N((0,f.useState)(0),2),O=m[0],S=m[1],I=N((0,f.useState)(!1),2),A=I[0],E=I[1],T=(0,a.KR)().removeThreadIdUrlParam,M=(0,a.uk)(n.uuid).chatParticipants,L=(0,h.L2)().data,R=(0,p.qN)(),D=R.chatMessages,F=R.setChatMessages,U=R.hasPrevPage,B=R.hasNextPage,z=R.isLoading,H=R.totalMessagesCount,Z=R.metaData,q=(0,a.Tl)(),V=q.fetchChatMessages,W=q.onEventReceive,Q=q.adjustScroller,$=q.isInitialPageLoaded,G=(0,a.NF)().handleReactionFromWebsocket,J=(0,a.Bk)(D,F).onBookmarkToggle,K=(0,a.xX)(),Y=K.messageHighlightId,X=K.isLiveStream,ee=(0,g.q)().isMessaging,te=(0,j.YQ)(),ne=Number(te)!==Y,re=ee?(0,b.so)(n):"",oe=n.current_participant,ie=(0,a.Lx)(n),ae=ie.canSendMessage,se=ie.canParticipantsMessage;(0,f.useEffect)((function(){var e={chatRoomUuid:n.uuid,isInitialPage:!0,parentMessage:t};return Y&&ne&&(e.id=Y,e.nextPerPage=20),V(e),function(){return S(0)}}),[t,null===n||void 0===n?void 0:n.uuid]),(0,v.s)({channel:"Chats::RoomChannel",chat_room_uuid:null===n||void 0===n?void 0:n.uuid,onMessageReceive:function(e){var n=e.event,r=e.json_message;if("newMessage"===n){if(null===r||void 0===r||!r.parent_message_id||r.parent_message_id!==t.id)return;S((function(e){return e+1}))}else"deletedMessage"===n&&S((function(e){return e-1}));W(e,D,oe)},canCreateConnection:Boolean(null===n||void 0===n?void 0:n.uuid)},[null===n||void 0===n?void 0:n.uuid]),(0,f.useEffect)((function(){$&&Y&&ne&&(0,j.o7)(Y)}),[$,Y]),(0,f.useEffect)((function(){!$||Y&&ne||(0,o.defer)(Q)}),[D,$,Y]);var le=(0,o.uniqBy)(D,"id"),ce=(0,o.sortBy)(le,"sent_at"),ue=(Z||{}).last_read_message_id,de=(0,o.last)(ce),me=(0,f.useMemo)((function(){return(0,j.nR)(le,M)}),[le,M]);(0,a.gJ)({uuid:n.uuid,ids:me,enabled:Boolean(M.length&&me.length)}),(0,f.useEffect)((function(){if(!z&&$){var e=!(0,o.isNull)(ue),t=ue!==(null===de||void 0===de?void 0:de.id);E(e&&t)}}),[ue,$,t.id,z]),(0,v.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){"createReaction"!==e.event&&"destroyReaction"!==e.event||G(e)},community_member_id:null===oe||void 0===oe?void 0:oe.community_member_id,canCreateConnection:Boolean(null===oe||void 0===oe?void 0:oe.community_member_id)},[null===oe||void 0===oe?void 0:oe.community_member_id]);var fe=H+O;return $?(0,P.jsx)("div",{id:"scrollWrapper",className:"flex h-full grow flex-col border-r-0",children:(0,P.jsxs)(C,{isLastPage:s,isFirstPage:u,setIsLastPage:l,setIsFirstPage:d,chatRoomUuid:n.uuid,parentMessage:t,children:[!U&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(x.R,{message:t,currentParticipant:oe,chatRoom:n,participants:M,isLiveStream:X,isParentMessage:!0,chatThreadsEnabled:!0,chatRoomUrl:re}),fe>0&&(0,P.jsx)(k,{count:fe})]}),ce.map((function(e){return(0,P.jsx)(x.R,{message:e,displayDayChange:!1,currentParticipant:oe,chatRoom:n,chatRoomUrl:re,chatThreadsEnabled:!0,isUnreadMessageLineEnabled:A,lastReadMessageId:ue,participants:M,isLiveStream:X,onBookmarkToggle:J},e.id)})),!B&&(ae?(0,P.jsx)(w.Fx,{chatRoom:n,parentMessageId:t.id,onClick:T,spaceId:null===L||void 0===L?void 0:L.id,portalTargetId:"rail-content",participants:M,messageBoxId:"threadsMessageTextBox"+String(t.id)}):(0,P.jsx)(_.R,{className:"mt-2",children:se?(0,r.t)("community_member.join_space_to_message"):(0,r.t)("community_member.messaging_disabled")}))]})}):(0,P.jsx)("div",{id:"message-thread-scroll-view",children:(0,P.jsx)(y.gi,{variant:"chat-thread"})})},E=n(54030),T=n(54482),M=n(8246),L=function(e){var t=e.title,n=e.onClose,o=(0,E.kK)(),i=(0,a.xX)(),s=i.isCourseSpace,l=i.isLiveStream,c=i.isDrawer;return o?(0,P.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,P.jsx)(T.h,{name:"16-arrow-left",onClick:n,iconClassName:"!text-dark",className:"flex-none",ariaLabel:(0,r.t)("close")}),(0,P.jsx)("div",{className:"flex-auto text-center",children:(0,P.jsx)(M.Z.TitleSm,{as:"h2",weight:"semibold",children:t})})]}):l||s||c?(0,P.jsxs)("div",{className:"flex w-full items-center justify-start",children:[(0,P.jsx)(T.h,{name:"20-back",onClick:n,iconSize:20,buttonSize:20,iconClassName:"!text-dark !h-5 !w-5",className:"mr-3 h-8 w-8 flex-none",ariaLabel:(0,r.t)("back")}),(0,P.jsx)(M.Z.TitleSm,{as:"h2",weight:"semibold",children:t})]}):(0,P.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,P.jsx)(M.Z.TitleSm,{as:"h2",weight:"semibold",children:t}),(0,P.jsx)(T.h,{name:"20-close",iconSize:20,onClick:n,iconClassName:"!text-dark",ariaLabel:(0,r.t)("close")})]})},R=function(){var e=(0,d.T)(),t=e.ref,n=e.height,f=(0,i.k6)(),p=(0,u.x)(),v=p.closeThreadsRailbar,h=p.parentMessage,b=p.chatRoom,g=void 0===b?{}:b,y=p.messageHighlightId,_=p.setMessageHighlightId,x=p.shouldShowRailBar,j=p.isCourseSpace,w=p.isDrawer,O=(0,a.rZ)(),S=O.unreadChatThreadIds,C=O.isUnreadThreadFlow;if(!x||(0,o.isEmpty)(g))return null;var k=j?"portal":w?"drawer":"header";return(0,P.jsxs)(l.x,{position:k,noBorderLeft:j,children:[(0,P.jsx)("div",{ref:t,children:(0,P.jsx)(m.S0.Header,{children:(0,P.jsx)(L,{title:(0,r.t)("messaging.thread"),onClose:function(){y&&(f.push({search:(0,c.iO)("message_id")}),_(null)),h.chat_thread_id&&S.includes(h.chat_thread_id)&&!C&&(0,s.ex)(h.chat_thread_id),v()}})})}),(0,P.jsx)(m.S0.Content,{heightGap:n,isCourseSpace:j,noPadding:!0,children:(0,P.jsx)(A,{parentMessage:h,chatRoom:g})})]})}},66438:(e,t,n)=>{n.d(t,{h:()=>l});var r=n(96486),o=n(18605),i=n(54030),a=n(8246),s=n(85893),l=function(e){var t=e.title,n=e.memberCount,l=e.isDirect,c=e.description,u=e.onClose,d=void 0===u?r.noop:u,m=Boolean(!l&&c),f=(0,i.BT)();return(0,s.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsx)(a.Z.TitleSm,{as:"h2",weight:"semibold",children:t}),f?(0,s.jsx)("button",{type:"submit",onClick:d,children:(0,s.jsx)(o.JO,{type:"close-v2",className:"text-dark mr-1 mt-2.5",useWithFillCurrentColor:!0})}):(0,s.jsx)(s.Fragment,{children:!l&&(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"text-default mr-2 pb-0.5",children:(0,s.jsx)(a.Z.LabelSm,{weight:"medium",children:n})}),(0,s.jsx)(o.JO,{type:"space-chat-members",className:"text-dark",useWithFillCurrentColor:!0})]})})]}),m&&(0,s.jsx)("div",{className:"text-default whitespace-pre-line",children:(0,s.jsx)(a.Z.BodySm,{children:c})})]})}},32535:(e,t,n)=>{n.d(t,{F2:()=>o,bb:()=>i});var r=n(74666),o=function(){var e=[],t=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){n.admin?e.push(n):t.push(n)})),[].concat(e,t)},i=function(e){var t=[],n=[],o=[];return e.filter((function(e){return!e.deleted_at})).forEach((function(e){e.status===r.eh.online?t.push(e):e.status===r.eh.idle?o.push(e):n.push(e)})),{onlineParticipants:[].concat(t,o),offlineParticipants:n}}},98819:(e,t,n)=>{n.d(t,{F:()=>N});var r=n(64687),o=n.n(r),i=n(67294),a=n(24185),s=n(74666),l=n(66422),c=n(98338),u=n(95287),d=n(59887),m=n(21451),f=n(96486),p=n(18738),v=n(34914);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t,n=e.enabled,r=e.chatRoomUuid,o=e.currentParticipant,a=e.parentMessageId,s=e.editorRef,l=e.participants,u=void 0===l?[]:l,d=e.messageBoxId,m=y((0,i.useState)(new Set),2),h=m[0],g=m[1],_=(0,i.useRef)(new Map),x=(0,c.N3)(),j=(0,i.useRef)(!1),w=function(e){_.current.has(e)&&clearTimeout(_.current.get(e));var t=setTimeout((function(){return S(e)}),3e4);_.current.set(e,t)},O=function(e){_.current.has(e)&&(clearTimeout(_.current.get(e)),_.current.delete(e))},S=function(e){O(e),g((function(t){var n=new Set(t);return n.delete(e),n}))},P=function(e){var t=e.enabled,n=e.chatRoomUuid,r=e.isThread,o=e.currentCommunityMember,i=e.onMessageReceive,a=r?"Chats::CommunityMemberThreadsChannel":"Chats::RoomChannel",s=r?{community_member_id:null===o||void 0===o?void 0:o.id}:{chat_room_uuid:n},l=r?Boolean(null===o||void 0===o?void 0:o.id):Boolean(n),c=b(b({channel:a,canCreateConnection:t&&l},s),{},{onMessageReceive:i}),u=(0,v.s)(c);return{subscription:null===u||void 0===u?void 0:u.subscription}}({enabled:n,chatRoomUuid:r,isThread:!!a,currentCommunityMember:x,onMessageReceive:function(e){var t=!(0,f.isUndefined)(a)&&a===e.parent_message_id||(0,f.isUndefined)(a)&&(0,f.isNull)(e.parent_message_id);g((function(n){var r=new Set(n);if(t&&e.chat_room_participant_id!==o.id){var i=e.chat_room_participant_id;"typing"===e.event?(w(i),r.add(e.chat_room_participant_id)):"stopTyping"===e.event&&(O(i),r.delete(e.chat_room_participant_id))}return r}))}}),C=P.subscription,k=function(){j.current&&N()},N=function(){C.perform("stop_typing",{chat_room_uuid:r,community_member_id:null===x||void 0===x?void 0:x.id,parent_message_id:a}),j.current=!1};(0,i.useEffect)((function(){var e=s.current;return n&&e&&e.on("update",(function(e){var t=e.transaction;null!==t&&void 0!==t&&t.docChanged&&(j.current||(C.perform("typing",{chat_room_uuid:r,community_member_id:null===x||void 0===x?void 0:x.id,parent_message_id:a}),j.current=!0))})),function(){n&&e&&e.off("update")}}),[null===s||void 0===s?void 0:s.current]);var I=document.getElementById(d);null===I||void 0===I||I.addEventListener("keyup",(function(e){t&&clearTimeout(t),"Enter"===(null===e||void 0===e?void 0:e.key)&&k(),t=setTimeout(k,3e3)}));var A=document.getElementById("tiptap-send");null===A||void 0===A||A.addEventListener("click",(function(){t&&clearTimeout(t),k()}));var E=Array.from(h).filter((function(e){return!u.some((function(t){return t.id===e}))})),T=u.filter((function(e){return h.has(e.id)})).map((function(e){return e.name}));return(0,p.g)({uuid:r,ids:E,enabled:E.length>0}),{typingUserNames:T,isTyping:T.length>0}},j=n(17845),w=n(86013),O=n(8246),S=n(78712),P=n(85893),C=function(e){var t=e.typingUserNames,n="";return 1===t.length?n=(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(O.Z.LabelXs,{as:"span",weight:"medium",children:t[0]})," ",(0,P.jsx)(O.Z.LabelXs,{as:"span",children:(0,w.t)("messaging.is_typing")})]}):2===t.length?n=(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(O.Z.LabelXs,{as:"span",weight:"medium",children:t[0]})," ",(0,P.jsx)(O.Z.LabelXs,{as:"span",children:(0,w.t)("and")})," ",(0,P.jsx)(O.Z.LabelXs,{as:"span",weight:"medium",children:t[1]})," ",(0,P.jsx)(O.Z.LabelXs,{as:"span",children:(0,w.t)("messaging.are_typing")})]}):t.length>2&&(n=(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(O.Z.LabelXs,{as:"span",weight:"medium",children:t[0]})," ",(0,P.jsxs)(O.Z.LabelXs,{as:"span",children:[(0,w.t)("and")," ",t.length-1," ",(0,w.t)("others")," ",(0,w.t)("messaging.are_typing")]})]})),(0,P.jsx)("div",{className:"flex items-center",children:n&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("img",{loading:"eager",src:S,className:"mt-1.5 w-6",alt:""}),(0,P.jsx)("span",{children:n})]})})};function k(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var N=function(e){var t=e.onClick,n=e.autoFocus,r=void 0!==n&&n,f=e.disabled,p=void 0!==f&&f,v=e.spaceId,h=e.chatRoom,b=e.isChatPreview,g=e.parentMessageId,y=e.userList,_=void 0===y?[]:y,w=e.isLiveStream,O=void 0!==w&&w,S=e.isChatSpace,N=void 0!==S&&S,I=e.isInCourseSpace,A=void 0!==I&&I,E=e.portalTargetId,T=void 0===E?"chat-threads-header":E,M=e.isLoading,L=void 0!==M&&M,R=e.participants,D=void 0===R?[]:R,F=e.messageBoxId,U=void 0===F?"tiptapMessageTextBox":F,B=(0,a.UO)().uuid,z=(0,c.wh)().currentCommunityMember,H=(0,m._q)().sendRichTextMessage,Z=(0,a.k6)(),q=(0,d.pB)().findOrCreateChatRoom,V=(0,i.useRef)(null),W=function(){var e,t=(e=o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.richTextBody,r=_.length>1?s.RN:s.g8,e.next=4,q({kind:r,community_member_ids:_.map((function(e){return e.id})),rich_text_body:n,shouldNavigate:!0});case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){k(i,r,o,a,s,"next",e)}function s(e){k(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();(0,u.P4)()&&(r=!1);var Q=(0,j.$S)(h),$=(0,j.C9)(h),G=(0,c.wh)().isViewOnlyMasquerading,J=(h||{}).current_participant,K=void 0===J?{}:J,Y=x({enabled:!(b||A),chatRoomUuid:null===h||void 0===h?void 0:h.uuid,currentParticipant:K,editorRef:V,participants:D,parentMessageId:g,messageBoxId:U}),X=Y.isTyping,ee=Y.typingUserNames;return(0,P.jsxs)("div",{className:"bg-primary relative px-5 pt-2",children:[(0,P.jsx)(l.T,{autofocus:r,disabled:p||G,onSubmit:function(e){var n=e.body,r=e.attachments,o=e.localAttachments,i=e.localSgidToObjectMap;p||(null===t||void 0===t||t(),h?(H({chatRoom:h,rich_text_body:{body:n,attachments:r},localAttachments:o,currentCommunityMember:z,localSgidToObjectMap:i,parentMessageId:g}),!b||"new"!=B&&B||Z.push("/messages/".concat(h.uuid))):W({richTextBody:{body:n,attachments:r}}))},spaceId:v,id:U,editorRef:V,portalTargetId:T,isLiveStream:O,isChatSpace:N,shouldShowTextModifiersMenu:!L,chatProps:{disableGroupMentions:O||A,isThread:!!g,isDirectMessaging:Q,isChatAdminOrModerator:$,chatParticipantsCount:null===h||void 0===h?void 0:h.chat_room_participants_count,isTyping:X}}),X&&(0,P.jsx)(C,{typingUserNames:ee})]})}},64797:(e,t,n)=>{n.d(t,{s:()=>a});var r=n(86013),o=n(44032),i=n(85893),a=function(e){var t=e.shouldShowConfirmationModal,n=e.toggleConfirmationModal,a=e.handleSubmit,s=e.chatParticipantsCount;return(0,i.jsx)(o.c,{isOpen:t,onClose:n,onConfirm:function(){a(!0),n()},confirmText:(0,r.t)("send"),title:(0,r.t)("messaging.send_group_message.title",{participants_count:s}),children:(0,i.jsx)("div",{className:"mb-6",children:(0,r.t)("messaging.send_group_message.description")})})}},17214:(e,t,n)=>{n.d(t,{u:()=>s});var r=n(67294),o=n(86013),i=n(44032),a=n(85893),s=function(e){var t=e.shouldShowPrivateMessageConfirmationModal,n=e.togglePrivateMessageConfirmationModal,s=e.handleSubmit,l=e.shouldShowPrivateMessageConfirmationOnSubmit,c=e.setShouldShowPrivateMessageConfirmationOnSubmit;return(0,r.useEffect)((function(){l||(s(!0),n())}),[l,s,n]),(0,a.jsx)(i.c,{isOpen:t,onClose:n,onConfirm:function(){c(!1)},confirmText:(0,o.t)("send"),title:(0,o.t)("messaging.share_private_message.title"),cancelText:(0,o.t)("messaging.edit_message"),children:(0,a.jsx)("div",{className:"mb-6",children:(0,o.t)("messaging.share_private_message.description")})})}},94810:(e,t,n)=>{n.d(t,{Qk:()=>d,E0:()=>m,GW:()=>a,Fx:()=>s.F});var r=n(86013),o=n(18953),i=n(85893),a=function(e){var t=e.isLiveStream,n=void 0!==t&&t,a=e.isInCourseSpace,s=void 0!==a&&a,l=e.isMessaging,c=void 0!==l&&l,u=e.chatRoomUuid;return c?(0,i.jsx)(o.G,{chatRoomUuid:u}):n?(0,i.jsxs)("div",{className:"block px-5 py-4",children:[(0,i.jsx)("div",{className:"text-darkest text-lg font-medium",children:(0,r.t)("messaging.live_stream_start_conversation")}),(0,i.jsx)("div",{className:"text-dark",children:(0,r.t)("messaging.live_stream_start_conversation_description")})]}):s?(0,i.jsxs)("div",{className:"block px-5 py-4",children:[(0,i.jsx)("div",{className:"text-darkest text-lg font-medium",children:(0,r.t)("messaging.course_lesson_chat_start_conversation")}),(0,i.jsx)("div",{className:"text-dark",children:(0,r.t)("messaging.course_lesson_chat_start_conversation_description")})]}):null},s=n(98819),l=n(35102),c=n(94739),u=n(72934),d=function(e){var t=e.children,n=e.isLastPage,r=e.isFirstPage,o=e.setIsFirstPage,a=e.setIsLastPage,s=e.chatRoomUuid,d=e.componentId,m=void 0===d?"message-scroll-view":d,f=(0,c.u)().fetchChatMessages,p=(0,l.f4)(),v=p.hasNextPage,h=p.hasPrevPage,b=p.isLoading,g=p.firstMessageId,y=p.lastMessageId;return(0,i.jsx)("div",{className:"flex h-auto grow flex-col overflow-auto",children:(0,i.jsx)(u.Y,{shouldShowPrevLoader:!n,shouldShowNextLoader:!r,hasNextPage:v,hasPrevPage:h,onNextPage:function(e){f({chatRoomUuid:s,id:e,previousPerPage:0,nextPerPage:20}),o(!1)},onPrevPage:function(e){f({chatRoomUuid:s,id:e}),a(!1)},firstItemId:g,lastItemId:y,componentId:m,isLoading:b,children:t})})},m=function(e){var t=e.label,n=e.onClick;return(0,i.jsx)("button",{type:"submit",className:"bg-brand rounded-2xl px-2.5 py-1 text-xs font-semibold leading-5 text-white hover:opacity-90",onClick:n,children:t})}},74131:(e,t,n)=>{n.d(t,{z:()=>u,E:()=>d});var r=n(67294),o=n(88767),i=n(81089),a=n(50732);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){return["commentHierarchy",e.postId,e.id]},d=function(e){var t=e.postId,n=e.id,s=e.postCommentsClosed,c=(0,o.useQueryClient)(),d=(0,r.useMemo)((function(){return u({postId:t,id:n})}),[t,n]);(0,r.useEffect)((function(){c.removeQueries(d)}),[s,c,d]);var m=(0,o.useQuery)(d,(function(){return(0,i.UT)(a.av.comments.commentHierarchy({postId:t,id:n}))}),{cacheTime:0}),f=m.data,p=m.isLoading;return{comment:f,isLoading:p,updateQueryData:function(e){return c.setQueryData(d,l(l({},e),{},{replies:f.replies}))}}}},92041:(e,t,n)=>{n.d(t,{k:()=>y,w:()=>_});var r=n(67294),o=n(96486),i=n(43063),a=n.n(i),s=n(45578),l=n.n(s),c=n(88767),u=n(81089),d=n(50732);function m(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g="comments_list",y=function(e){var t=e.postId,n=e.parentCommentId;return[g,t,n].filter(Boolean)},_=function(e){var t=e.postId,n=e.parentCommentId,i=e.preloaded,s=void 0!==i&&i,h=e.preloadedComments,b=void 0===h?[]:h,g=e.preloadedCommentsTotalCount,_=void 0===g?0:g,x=e.postCommentsClosed,j=v((0,r.useState)(b||[]),2),w=j[0],O=j[1],S=v((0,r.useState)(x),2),P=S[0],C=S[1],k=(0,c.useInfiniteQuery)(y({postId:t,parentCommentId:n}),(function(e){var r=e.pageParam,o={per_page:10,page:void 0===r?1:r},i=n?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({parent_comment_id:n},o):o;return(0,u.UT)(d.av.comments.index({postId:t,params:i}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},onSuccess:function(e){var t=e.pages;O(l()((0,o.flatMap)(t,(function(e){return e.records})),"id"))},initialData:function(){if(s)return{pages:[{records:b,page:0,has_next_page:_>b.length}],pageParams:[]}},cacheTime:0,staleTime:1/0,notifyOnChangeProps:"tracked"}),N=k.isLoading,I=k.isFetchingNextPage,A=k.hasNextPage,E=k.fetchNextPage,T=k.remove;(0,r.useEffect)((function(){s||P===x||(C(x),O([]),T())}),[s,P,x,T]);return{comments:w,isLoading:N,isFetchingNextPage:I,hasNextPage:A,fetchNextPage:E,addCommentToList:function(e){return O((function(t){return[].concat(m(t),[e])}))},updateCommentInList:function(e){return O((function(t){return t.map((function(t){return t.id===e.id?e:t}))}))},removeCommentFromList:function(e){var t=e.id;return O((function(e){return a()(e,["id",t])}))}}}},17373:(e,t,n)=>{n.d(t,{q:()=>r,Q:()=>o});var r="#comment_wrapper_",o="#all_comments"},32209:(e,t,n)=>{n.d(t,{G:()=>a});var r=n(66422),o=n(7074),i=n(85893),a=function(e){var t=e.tiptapBody;return"post"===(null===t||void 0===t?void 0:t.format)?(0,i.jsx)(o.R,{readOnly:!0,value:t.body,sgidToObjectMap:t.sgids_to_object_map,inlineAttachments:t.inline_attachments,openInternalLinksInCurrentTab:!0,disabledExtensions:["cta"]}):(0,i.jsx)(r.T,{type:"comment",editable:!1,rich_text_body:t,openInternalLinksInCurrentTab:!0})}},55004:(e,t,n)=>{n.d(t,{z:()=>d,E:()=>m});var r=n(67294),o=n(88767),i=n(81089),a=n(50732),s=n(5036);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){var t=e.postId,n=e.id,r=e.usedIn,o=void 0===r?null:r;return[s.bx,t,"hierarchy",n,o]},m=function(e){var t=e.postId,n=e.id,s=e.postCommentsClosed,l=e.postLikingDisabled,u=e.usedIn,m=(0,o.useQueryClient)(),f=(0,r.useMemo)((function(){return d({postId:t,id:n,usedIn:u})}),[t,n,u]);(0,r.useEffect)((function(){m.removeQueries(f)}),[s,l,m,f]);var p=(0,o.useQuery)(f,(function(){return(0,i.UT)(a.av.comments.commentHierarchy({postId:t,id:n}))}),{cacheTime:0}),v=p.data,h=p.isLoading;return{comment:v,isLoading:h,updateQueryData:function(e){return m.setQueryData(f,c(c({},e),{},{replies:v.replies}))}}}},5036:(e,t,n)=>{n.d(t,{bx:()=>g,kW:()=>_,wS:()=>x});var r=n(67294),o=n(96486),i=n(43063),a=n.n(i),s=n(45578),l=n.n(s),c=n(88767),u=n(81089),d=n(50732);function m(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g="comments",y="list",_=function(e){var t=e.postId,n=e.parentCommentId,r=e.usedIn;return[g,t,y,n,void 0===r?null:r].filter(Boolean)},x=function(e){var t=e.postId,n=e.parentCommentId,i=e.preloaded,s=void 0!==i&&i,h=e.preloadedComments,b=void 0===h?[]:h,g=e.preloadedCommentsTotalCount,y=void 0===g?0:g,x=e.postCommentsClosed,j=e.postLikingDisabled,w=e.usedIn,O=void 0===w?"post":w,S=v((0,r.useState)(b||[]),2),P=S[0],C=S[1],k=v((0,r.useState)(x),2),N=k[0],I=k[1],A=v((0,r.useState)(j),2),E=A[0],T=A[1],M=(0,c.useInfiniteQuery)(_({postId:t,parentCommentId:n,usedIn:O}),(function(e){var r=e.pageParam,o={per_page:10,page:void 0===r?1:r},i=n?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({parent_comment_id:n},o):o;return(0,u.UT)(d.av.comments.index({postId:t,params:i}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},onSuccess:function(e){var t=e.pages;C(l()((0,o.flatMap)(t,(function(e){return e.records})),"id"))},initialData:function(){if(s)return{pages:[{records:b,page:0,has_next_page:y>b.length}],pageParams:[]}},cacheTime:0,staleTime:1/0,notifyOnChangeProps:"tracked"}),L=M.isLoading,R=M.isFetchingNextPage,D=M.hasNextPage,F=M.fetchNextPage,U=M.remove,B=x!==N||j!==E;(0,r.useEffect)((function(){!s&&B&&(I(x),T(j),C([]),U())}),[s,B,x,j,U]);return{comments:P,isLoading:L,isFetchingNextPage:R,hasNextPage:D,fetchNextPage:F,addCommentToList:function(e){return C((function(t){return[].concat(m(t),[e])}))},updateCommentInList:function(e){return C((function(t){return t.map((function(t){return t.id===e.id?e:t}))}))},removeCommentFromList:function(e){var t=e.id;return C((function(e){return a()(e,["id",t])}))}}}},97910:(e,t,n)=>{n.d(t,{q:()=>r,Q:()=>o});var r="#comment_wrapper_",o="#all_comments"},64660:(e,t,n)=>{n.d(t,{r:()=>j});var r=n(11049),o=n(25362),i=n(86013),a=n(35102),s=n(59903),l=n(42599),c=n(69733),u=n(82177),d=n(90673),m=n(8246),f=n(30984),p=n(72772),v=n(59887),h=n(277),b=n(85893),g=function(e){var t=e.uuid;return(0,b.jsx)("div",{className:"flex grow flex-col overflow-auto",children:(0,b.jsx)(h.A,{chatRoomUuid:t,isMessaging:!0,children:(0,b.jsxs)(v.G5,{isDrawer:!0,children:[(0,b.jsx)(f.x,{uuid:t,displayDayChange:!0,displayRoomName:!1,isDrawer:!0}),(0,b.jsx)("div",{id:"rail-bar-drawer"}),(0,b.jsx)(p.I,{})]})})})},y={page_name:l.$q.PROFILE_VIEW},_=function(e){var t,n=e.memberPublicId,r=(0,a.nC)(),l=r.liveChatRoomUuid,f=r.setLiveChatRoomUuid,p=(0,o.dd)(),v=(0,c.P)({publicId:n,params:y}).getProfileInfoQuery,h=v.data,_=v.isLoading,x=function(){f(null),p.remove()};return(0,b.jsxs)(u.u_,{isOpen:p.visible,onClose:x,contentPortalId:"post-modal-portal",children:[(0,b.jsx)(u.u_.Overlay,{}),(0,b.jsxs)(u.u_.Content,{size:"full",className:"max-w-screen-xl",children:[(0,b.jsxs)("div",{className:"border-primary text-dark flex justify-between border-b !px-9 !py-4",children:[(0,b.jsx)(m.Z.TitleSm,{weight:"semibold",children:l?null!==(t=null===h||void 0===h?void 0:h.name)&&void 0!==t?t:"":(0,i.t)("profile")}),(0,b.jsx)(d.o,{onClick:x})]}),l?(0,b.jsx)(g,{uuid:l}):(0,b.jsx)(u.u_.Body,{className:"!md:px-9 !md:pt-9 grid grid-flow-row-dense grid-cols-12 gap-x-6 !overflow-hidden !pb-0 !pt-6",children:(0,b.jsx)(s.o,{member:h,isLoading:_,onClose:function(){return p.remove()}})})]})]})},x=r.gk.create((function(e){var t=e.memberPublicId,n=e.params;return(0,b.jsx)(_,{memberPublicId:t,params:n})})),j=function(){return(0,r.dd)(x)}},21918:(e,t,n)=>{n.d(t,{C:()=>P});var r=n(51705),o=n(93289),i=n(38313),a=n(86013),s=n(62261),l=n(87218),c=n(34398),u=n(11049),d=n(82177),m=n(75336),f=n(41982),p=n(11355),v=n(64422),h=n(8246),b=n(85893);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=function(e){var t=e.member,n=t.name,r=t.avatar_url,o=t.rsvp_status,i=t.public_uid,a=(0,p.O)({public_uid:i});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"hover:bg-secondary group flex h-14 items-center rounded-md px-2",children:[(0,b.jsx)("div",{className:"mr-3",children:(0,b.jsx)("a",y(y({},a),{},{title:n,children:(0,b.jsx)(v.s,{src:r,name:n,size:"8"})}))}),(0,b.jsx)("div",{className:"w-full",children:(0,b.jsx)("a",y(y({},a),{},{title:n,children:(0,b.jsx)(f.Y,{children:(0,b.jsx)(h.Z.LabelSm,{weight:"semibold",children:n})})}))}),(0,b.jsx)("div",{className:"mx-2 flex w-24 shrink-0 justify-end",children:(0,b.jsx)(m.j,{rsvpStatus:o})})]}),(0,b.jsx)("hr",{})]})};function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){var t=e.event,n=(0,u.dd)(),r=(0,l.V)(t,c.a.PARTICIPANT),o=r.records,i=r.fetchPrevPage,m=r.fetchNextPage,f=r.hasPrevPage,p=r.hasNextPage,v=r.totalRecordCount,h=r.totalConfirmedRecordCount,g=r.startRecordNumber,y=r.endRecordNumber,_=r.resetPage;return(0,b.jsxs)(d.u_,{isOpen:n.visible,onClose:function(){_(),n.hide()},children:[(0,b.jsx)(d.u_.Overlay,{}),(0,b.jsxs)(d.u_.Content,{children:[(0,b.jsxs)(d.u_.Header,{children:[(0,b.jsxs)(d.u_.Title,{size:"sm",className:"text-center",children:[h," ",(0,a.t)("events.attendees")]}),(0,b.jsx)(d.u_.HeaderActions,{children:(0,b.jsx)(d.u_.CloseButton,{onClick:n.hide})})]}),(0,b.jsx)(d.u_.Body,{className:"overflow-y-auto md:!px-6",children:(0,b.jsxs)("div",{children:[(null===o||void 0===o?void 0:o.length)>0&&(0,b.jsx)("div",{className:"flex w-full flex-col",children:null===o||void 0===o?void 0:o.map((function(e){return(0,b.jsx)(x,{member:e},e.id)}))}),v>0&&(0,b.jsx)(s.t,{startRecordNumber:g,endRecordNumber:y,totalRecordCount:v,fetchPrevPage:i,fetchNextPage:m,hasPrevPage:f,hasNextPage:p})]})})]})]})},S=u.gk.create((function(e){return(0,b.jsx)(O,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),P=function(e){var t=e||{},n=t.event_setting_attributes,a=t.event_attendees,s=t.slug,l=t.space_slug,c=(0,r.ou)(e),d=(0,r.sN)(e),m=(0,i.Z)(),f=(0,u.dd)(S),p=a||{},v=p.records,h=p.count,b=n||{},g=b.hide_attendees;if(b.rsvp_disabled||g)return null;return{attendees:v,totalCount:h,canManageEvent:c,handleAttendeesClick:function(){l&&s&&(d?m.show({event:e,defaultSection:o.SA.people}):f.show({event:e}))},canUpdateEvent:d}}},81360:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(94184),o=n.n(r),i=n(86013),a=n(58837),s=n(73890),l=n(85327),c=n(85893),u=function(e){var t=e.startsAt,n=e.endsAt,r=e.status,u=(void 0===r?null:r)===l.Q_.DRAFT,d=(0,a.aA)(n),m=null;return m=!(0,a.aA)(t)||d||u?u?(0,i.t)("events.details.draft"):d?(0,i.t)("events.details.finished",{time_string:(0,s.TF)(n)}):(0,i.t)("events.details.starts",{time_string:(0,s.TF)(t)}):(0,i.t)("events.details.in_progress"),(0,c.jsx)("div",{className:o()("event-counter-badge",{"event-counter-badge--finished":d,"event-counter-badge--draft":u}),children:"".concat(m)})}},67907:(e,t,n)=>{n.d(t,{t:()=>m});var r=n(67294),o=n(86013),i=n(44032),a=n(29614),s=n(85327),l=n(85893);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d="events.delete.recurring_event_modal",m=function(e){var t=e.show,n=void 0!==t&&t,u=e.onConfirm,m=e.onCloseModal,f=c((0,r.useState)(),2),p=f[0],v=f[1];return(0,l.jsx)(i.c,{title:(0,o.t)("".concat(d,".title")),isOpen:n,confirmText:(0,o.t)("".concat(d,".accept")),cancelText:(0,o.t)("".concat(d,".cancel")),onClose:m,onCancel:m,onConfirm:function(){u(p)},confirmVariant:"danger",size:"sm",children:(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsx)(a.S,{defaultChecked:s.HA.CURRENT,name:"recurring_event_settings.frequency_edit",options:[{label:(0,o.t)("".concat(d,".this_event")),value:s.HA.CURRENT},{label:(0,o.t)("".concat(d,".this_and_following")),value:s.HA.REMAINING},{label:(0,o.t)("".concat(d,".all_events")),value:s.HA.ALL}],size:"sm",onChange:function(e){v(e)}})})})}},55299:(e,t,n)=>{n.d(t,{E:()=>g,e:()=>x});var r,o,i=n(67294),a=n(83894),s=n(87536),l=n(85327),c=n(42991),u=n(58837),d=n(20846);function m(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b="events.recurring",g=function(e){var t=e.startsAt,n=e.firstLetterCapital,r=void 0===n||n?"frequencies_capital_letter":"frequencies",o=new Date(t).getDate(),i=(0,d.UZ)(t),a=(0,d.ZY)(t),s=(0,d.cz)(t),u=(0,d.Rc)(t);return[{label:(0,c.t)("".concat(b,".").concat(r,".daily"),{dayName:i}),value:l.PB.DAILY},{label:(0,c.t)("".concat(b,".").concat(r,".weekday"),{dayName:i}),value:l.PB.WEEKDAY},{label:(0,c.t)("".concat(b,".").concat(r,".weekly"),{dayName:i}),value:l.PB.WEEKLY},{label:(0,c.t)("".concat(b,".").concat(r,".bi_weekly"),{dayName:i}),value:l.PB.BI_WEEKLY},{label:(0,c.t)("".concat(b,".").concat(r,".monthly"),{dayNumberWithOrdinal:u}),value:l.PB.MONTHLY_WEEK_BASED},{label:(0,c.t)("".concat(b,".").concat(r,".monthly"),{dayNumberWithOrdinal:s}),value:l.PB.MONTHLY},{label:(0,c.t)("".concat(b,".").concat(r,".annually"),{monthName:a,dayNumber:o}),value:l.PB.ANNUALLY}]},y=(h(r={},l.PB.DAILY,60),h(r,l.PB.WEEKDAY,90),h(r,l.PB.WEEKLY,360),h(r,l.PB.BI_WEEKLY,720),h(r,l.PB.MONTHLY,720),h(r,l.PB.MONTHLY_WEEK_BASED,720),h(r,l.PB.ANNUALLY,3600),r),_=(h(o={},l.PB.DAILY,60),h(o,l.PB.WEEKDAY,60),h(o,l.PB.WEEKLY,52),h(o,l.PB.BI_WEEKLY,52),h(o,l.PB.MONTHLY,24),h(o,l.PB.MONTHLY_WEEK_BASED,24),h(o,l.PB.ANNUALLY,10),o),x=function(){var e=(0,s.Gc)().setValue,t=(0,s.qo)({name:"event_setting_attributes.starts_at"}),n=(0,s.qo)({name:"recurring_setting_attributes.range_type"}),r=(0,s.qo)({name:"recurring_setting_attributes.frequency"}),o=(0,s.qo)({name:"event_type"}),d=f((0,i.useState)(!0),2),p=d[0],v=d[1],h=f((0,i.useState)(),2),x=h[0],j=h[1],w=f((0,i.useState)(),2),O=w[0],S=w[1],P=f((0,i.useState)(),2),C=P[0],k=P[1],N=(0,i.useMemo)((function(){return{label:(0,c.t)("".concat(b,".does_not_repeat")),value:!1}}),[]),I=f((0,i.useState)([N]),2),A=I[0],E=I[1],T=[{label:(0,c.t)("".concat(b,".ending.on_day")),value:l.pd.ON},{label:(0,c.t)("".concat(b,".ending.after")),value:l.pd.AFTER}];return(0,i.useEffect)((function(){var e=g({startsAt:t}),n=[N].concat(m(e));E(n),k(t)}),[t,N]),(0,i.useEffect)((function(){v(Boolean(r))}),[r]),(0,i.useEffect)((function(){if(n==l.pd.ON&&r){e("recurring_setting_attributes.occurrences",null);var o=(0,u.Xz)(t,y[r]);j((0,a.default)(o))}else n==l.pd.AFTER&&r&&(e("recurring_setting_attributes.ends_at",null),S(_[r]))}),[n,r,t,e]),{endsAtMaxDate:x,endsAfterMaxOccurrences:O,isRecurringEvent:o===l.E_.RECURRING,frequencyOptions:A,endingOptions:T,endsAtMinDate:C,endsOnValue:n,showRecurringFields:p}}},28199:(e,t,n)=>{n.d(t,{Bq:()=>i,mv:()=>a,oL:()=>l,Mk:()=>c,S2:()=>u});var r=n(85239),o=n(85327);var i={VIRTUAL:"virtual",IN_PERSON:"in_person",TBD:"tbd",LIVE_STREAM:"live_stream",LIVE_ROOM:"live_room"},a=function(e){return(null===e||void 0===e?void 0:e.status)===o.Q_.DRAFT},s=function(e){var t,n;return null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t||null===(n=t.live_stream_room_setting_attributes)||void 0===n?void 0:n.stream_status},l=function(e){return s(e)===r.LV.ENDED},c=function(e){return s(e)===r.LV.BACKSTAGE},u=function(e){return s(e)===r.LV.LIVE}},13972:(e,t,n)=>{n.d(t,{D:()=>b});var r=n(86013),o=n.n(r),i=n(88767),a=n(24185),s=n(38313),l=n(62057),c=n(98338),u=n(81089),d=n(50732),m=n(81786),f=n(67687),p=n(47839),v=n(69647),h=n(85893),b=function(e){var t=e.event,n=e.onClose,r=e.show,b=(0,a.k6)(),g=(0,v.p)(),y=g.success,_=g.error,x=(0,c.nT)(),j=x.isLoading,w=x.helpers,O=w.findById,S=w.spacesWithEventCreationAllowed;if(j)return null;var P=S(),C=(0,c.L2)().data,k=(0,s.Z)(),N=(0,i.useMutation)((function(e){return(0,u.t5)(d.av.events.duplicate({spaceId:t.space_id,slug:t.slug}),{method:"PUT",body:JSON.stringify({event:{event_id:t.id,space_id:e.space_id}}),forReactQuery:!0})}),{onSuccess:function(e){var t=O(e.space_id);b.push((0,d.Xq)({spaceSlug:t.slug,eventSlug:e.slug})),setTimeout((function(){return k.show({event:e})}),500),y(o().t("event_duplicated_successfully"))},onError:function(){_(o().t("event_duplication_failed"))}});return(0,h.jsx)(p.u,{overflowVisible:!0,title:o().t("duplicate_event_title",{event_title:t.name}),show:r,onClose:n,children:(0,h.jsxs)(f.l,{onSubmit:N.mutate,defaultValues:{space_id:null===C||void 0===C?void 0:C.id},children:[(0,h.jsx)(f.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,description:o().t("duplicate_event_to_space"),rules:{required:o().t("events.create.form.space_required_error")},children:(0,h.jsx)(l.M,{spaces:P,name:"space_id",variant:"form-input",defaultValue:null===C||void 0===C?void 0:C.id})}),(0,h.jsx)("p",{className:"modal__small text-dark mb-4",children:o().t("attendees_wont_be_duplicated")}),(0,h.jsx)(m.z,{type:"submit",variant:"primary",children:o().t("duplicate")})]})})}},18274:(e,t,n)=>{n.d(t,{E:()=>l});var r=n(86013),o=n(52995),i=n(27025),a=n(50702),s=n(85893),l=function(e){var t=e.canEdit,n=e.event,l=n.pinned_at_top_of_space,c=(0,a.B)(n).onPinToTop;return t?(0,s.jsx)(i.Lt.ItemLink,{onClick:c,children:(0,s.jsx)(o.sI,{label:(0,r.t)("pin_to_space"),field:"pin_to_top",value:l,variant:"small"})}):null}},50702:(e,t,n)=>{n.d(t,{B:()=>b});var r=n(64687),o=n.n(r),i=n(88767),a=n(57594),s=n(27034),l=n(34398),c=n(97659),u=n(38313),d=n(98338),m=n(1881),f=n(69647);function p(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e,t){var n=(0,d.wh)().isViewOnlyMasquerading,r=(0,s.q)(),h=(0,u.Z)(),b=(e||{}).policies||{},g=b.can_destroy_post,y=b.can_update_post,_=b.can_duplicate_post,x=e.pinned_at_top_of_space,j=(0,f.p)(),w=j.success,O=j.error,S=v((0,m.k)(!1),2),P=S[0],C=S[1],k=v((0,m.k)(),2),N=k[0],I=k[1],A=v((0,m.k)(),2),E=A[0],T=A[1],M=C,L=(0,i.useMutation)((function(t){return a.S.destroy({event:e,params:{delete_mode:t}})}),{onSuccess:function(){t(e.id),w((0,l.Km)(e)),r()},onError:function(){return O(I18n.t("event_dropdown_actions.delete_failed"))}}),R=function(){var t,n=(t=o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.S.pin({event:e,formData:{pin_to_top:!0,is_pinned:!x}});case 2:t.sent.ok?(w(I18n.t(x?"event_unpinned":"event_pinned")),r({shouldInvalidateHomePagePosts:!0})):O(I18n.t(x?"event_unpinned_error":"event_pinned_error"));case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();return{canEdit:y,onEdit:function(){y&&!n&&h.show({event:e})},canDelete:g,canDuplicate:_,onDelete:L.mutate,onPinToTop:R,onDuplicate:M,onDeleteClickHandler:function(){n||((0,c.H3)(e)?T(!0):I(!0))},showDuplicateEventModal:P,showConfirmationModal:N,toggleConfirmationModal:I,isRecurringModalOpen:E,setIsRecurringModalOpen:T}}},58350:(e,t,n)=>{n.d(t,{i:()=>P});var r=n(86013),o=n(99658),i=n(98338),a=n(54030),s=n(18605),l=n(27025),c=n(8246),u=n(92385),d=n(90789),m=n(81786),f=n(52995),p=n(67294),v=n(20640),h=n.n(v),b=n(50732),g=n(69647);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O=n(85893),S=function(e){var t=e.getSharePostLink,n=e.post,o=e.sharePostData,a=function(e){var t=e.post,n=e.getSharePostLink,o=e.sharePostData,a=(0,g.p)().success,s=(0,i.wh)().currentCommunity,l=(0,i.L2)().data,c=j((0,p.useState)({post:{show_post_teaser:!(null===t||void 0===t||!t.show_post_teaser),share_to_web:!(null===t||void 0===t||!t.share_post_enabled),share_post_enabled:!(null===t||void 0===t||!t.share_post_enabled),minimal_layout:!(null===t||void 0===t||!t.minimal_layout)}}),2),u=c[0],d=c[1],m=(0,b.LM)({spaceSlug:null===t||void 0===t?void 0:t.space_slug,slug:null===t||void 0===t?void 0:t.slug});return(0,p.useEffect)((function(){t.share_post_enabled&&!o&&n({postId:null===t||void 0===t?void 0:t.id,body:u})}),[null===t||void 0===t?void 0:t.share_post_enabled,o,u,n,null===t||void 0===t?void 0:t.id]),{onClickCopyLink:function(e){h()(e||window.location.origin+m),a((0,r.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){d((function(r){var o={post:_(_({},r.post),e)};return n({postId:null===t||void 0===t?void 0:t.id,body:o}),o}))},formData:u,currentCommunity:s,currentSpace:l}}({post:n,getSharePostLink:t,sharePostData:o}),v=a.onClickCopyLink,y=a.onChange,x=a.formData,w=a.currentCommunity,S=a.currentSpace,P=(0,d.$n)(S)||(0,d.WB)(S)||(null===w||void 0===w?void 0:w.is_private);return w.is_private||null!==S&&void 0!==S&&S.is_private?(0,O.jsxs)("div",{children:[(0,O.jsx)(l.Lt.ItemLink,{onClick:function(){y({share_to_web:!x.post.share_to_web})},children:(0,O.jsx)(f.sI,{label:(0,r.t)("post.share.share_to_web"),tooltipText:(0,r.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:x.post.share_to_web,variant:"small"})}),x.post.share_to_web&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{className:"flex flex-row items-center",children:(0,O.jsx)("div",{className:"mb-2 mt-1 flex-1 px-5",children:(0,O.jsx)(u.I,{disabled:!0,value:null===o||void 0===o?void 0:o.share_post_link,rightAddon:(0,O.jsx)("button",{type:"button",onClick:function(){return v(null===o||void 0===o?void 0:o.share_post_link)},children:(0,O.jsx)(s.JO,{type:"20-copy"})})})})}),P&&(0,O.jsx)("div",{className:"flex flex-row items-center",children:(0,O.jsx)("div",{className:"mb-2 mt-1 flex-1 px-5",children:(0,O.jsx)(c.Z.LabelSm,{children:null!==w&&void 0!==w&&w.is_private&&"open"==(null===S||void 0===S?void 0:S.visibility)?(0,r.t)("post.share.share_to_web_open_content_warning"):(0,d.$n)(S)?(0,r.t)("post.share.share_to_web_secret_content_warning"):(0,r.t)("post.share.share_to_web_private_content_warning")})})}),!(null!==w&&void 0!==w&&w.is_private)&&(0,O.jsx)(l.Lt.ItemLink,{onClick:function(){return y({minimal_layout:!x.post.minimal_layout})},children:(0,O.jsx)(f.sI,{label:(0,r.t)("post.share.minimal_layout"),tooltipText:(0,r.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:x.post.minimal_layout,variant:"small"})})]})]}):(0,O.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,O.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,O.jsx)(c.Z.LabelMd,{weight:"bold",children:(0,r.t)("post.share.share_to_web")}),(0,O.jsx)(c.Z.LabelSm,{children:(0,r.t)("post.share.post_is_public")})]}),(0,O.jsx)("div",{children:(0,O.jsx)(m.z,{type:"button",variant:"secondary",onClick:function(){return v(null)},children:(0,r.t)("copy_link")})})]})},P=function(e){var t=e.onChange,n=e.button,u=(0,o.m)({onChangeSharePost:t}),d=u.showShareOnWebOptions,m=u.post,f=u.getSharePostLink,p=u.sharePostData,v=(0,a.kK)(),h=(0,i.L2)().data,b=null!==n&&void 0!==n?n:(0,O.jsx)(s.JO,{type:"16-share",size:20});return d(h)?(0,O.jsx)(l.Lt,{size:"extra-large",direction:"bottom-end",menuButtonEl:"button",className:"w-full",buttonClassName:"w-full focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-1 md:p-1 hover:bg-tertiary rounded group flex items-center",button:v?b:(0,O.jsx)(c.Z.LabelSm,{weight:"medium",color:"text-default group-hover:text-dark",children:(0,r.t)("post.share.title")}),children:(0,O.jsx)(S,{post:m,getSharePostLink:f,sharePostData:p})}):null}},54429:(e,t,n)=>{n.d(t,{c:()=>x});var r=n(86013),o=n(34398),i=n(92312),a=n(33071),s=n(82177),l=n(81786),c=n(8246),u=n(18605),d=n(95132),m=n(39639),f=n(9578),p=n(65341),v=n(85893);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){var t=e.event,n=e.label,r=(0,a.n)().selfUpdateCalendarEnabled,o=(t||{}).event_setting_attributes||{},i=o.starts_at,s=o.ends_at,l=o.time_zone,h=(0,d.N)(i,l),g=h.dayOfMonth,y=h.shortMonthString,_=(0,m.Dk)(i,l),x=(0,m.Dk)(s,l);return(0,v.jsxs)(v.Fragment,{children:[!r&&(0,v.jsxs)("div",{className:"bg-primary border-primary flex w-full rounded-md border shadow",children:[(0,v.jsxs)("div",{className:"event-confirmation__date-picker",children:[(0,v.jsx)(u.JO,{type:"calendar",className:"icon"}),"".concat(g," ").concat(y,", ").concat(_," - ").concat(x)]}),(0,v.jsx)("div",{className:"event-confirmation__date-button",children:(0,v.jsx)(f.a,b({},(0,p.q)(t,n)))})]}),r&&(0,v.jsx)("div",{className:"bg-tertiary flex w-fit items-center justify-center rounded-md",children:(0,v.jsxs)("div",{className:"flex px-4 py-2",children:[(0,v.jsx)(u.JO,{type:"16-calendar",className:"text-default mr-2 h-4 !w-4 font-medium",size:16}),(0,v.jsx)(c.Z.LabelSm,{weight:"medium",color:"text-default",children:"".concat(g," ").concat(y,", ").concat(_," - ").concat(x)})]})})]})},_=function(e){var t=e.recurringEvent||{},n=t.starts_at,r=t.ends_at,o=t.time_zone,i=(0,d.N)(n,o),a=i.dayOfMonth,s=i.shortMonthString,l=(0,m.Dk)(n,o),f=(0,m.Dk)(r,o);return(0,v.jsx)("div",{className:"bg-tertiary flex w-fit items-center justify-center rounded-md",children:(0,v.jsxs)("div",{className:"flex px-4 py-2",children:[(0,v.jsx)(u.JO,{type:"16-calendar",className:"text-default mr-2 h-4 !w-4 font-medium",size:16}),(0,v.jsx)(c.Z.LabelSm,{weight:"medium",color:"text-default",children:"".concat(a," ").concat(s,", ").concat(l," - ").concat(f)})]})})},x=function(e){var t=e.event,n=e.events,u=void 0===n?[]:n,d=e.show,m=e.onClose,f=e.shouldShowConfirmationDate,p=void 0===f||f,h=e.isRecurring,b=void 0!==h&&h,g=e.eventsCount,x=t||{},j=x.name,w=x.event_setting_attributes||{},O=w.confirmation_message_title,S=w.confirmation_message_description,P=w.confirmation_message_button_title,C=w.confirmation_message_button_link,k=w.enable_custom_thank_you_message,N=!(0,o.yl)(t)&&b,I=(0,a.n)().selfUpdateCalendarEnabled;return(0,v.jsxs)(s.u_,{isOpen:!!d,onClose:m,children:[(0,v.jsx)(s.u_.Overlay,{}),(0,v.jsxs)(s.u_.Content,{children:[(0,v.jsx)(s.u_.Header,{className:"flex w-full !justify-end pb-0 md:!pb-0",children:(0,v.jsx)(s.u_.HeaderActions,{children:(0,v.jsx)(s.u_.CloseButton,{onClick:m})})}),(0,v.jsxs)(s.u_.Body,{className:"mb-8 !overflow-visible pt-0",children:[!I&&(0,v.jsxs)("div",{className:"event-confirmation",children:[(0,v.jsx)("h2",{children:(0,r.t)("events.notifications.event_setting_attributes.clap")}),(0,v.jsx)("h3",{children:O||(0,r.t)("events.notifications.event_setting_attributes.confirmation_message_title_placeholder",{event_name:j})}),(0,v.jsx)("p",{children:b?S||(0,r.t)("events.rsvp.recurring_modal.confirmation_description",{events:"".concat(g," ").concat(1===g?(0,r.t)("events.rsvp.recurring_modal.event"):(0,r.t)("events.rsvp.recurring_modal.events"))}):S||(0,r.t)("events.notifications.event_setting_attributes.confirmation_message_description_placeholder")}),p&&(0,v.jsx)(y,{event:t,label:b?(0,r.t)("add_all_events_to_calendar"):""})]}),I&&(0,v.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,v.jsx)("h2",{className:"mb-4 mt-0",children:(0,r.t)("events.notifications.event_setting_attributes.clap")}),(0,v.jsx)("div",{className:"mb-4",children:(0,v.jsx)(c.Z.TitleSm,{weight:"bold",color:"text-default",children:k?O:(0,r.t)("events.notifications.event_setting_attributes.thank_you_message")})}),(0,v.jsx)("div",{className:"mb-6",children:k?S:(0,v.jsx)(c.Z.TitleMd,{color:"text-darkest",children:j})}),p&&!N&&(0,v.jsx)(y,{event:t,label:b?(0,r.t)("add_all_events_to_calendar"):""}),p&&N&&u.map((function(e,t){return(0,v.jsx)("div",{className:"pb-2",children:(0,v.jsx)(_,{recurringEvent:e})},e.id||t)})),(0,v.jsx)("div",{children:(0,v.jsx)("div",{className:"mb-12 mt-6",children:(0,v.jsx)(c.Z.BodyMd,{color:"text-light",children:(0,r.t)("events.notifications.event_setting_attributes.calendar_invite_message")})})})]})]}),!I&&(0,v.jsx)(s.u_.Footer,{children:(0,v.jsx)(l.z,{variant:"primary",full:!0,onClick:function(){C&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank";if(window&&window.open&&(0,i._)(e)){e.match(/^https?:\/\//i)||(e="http://".concat(e));var n=window.open(e,t);n&&n.focus()}}(C),m()},children:P||(0,r.t)("events.notifications.event_setting_attributes.confirmation_message_button_title_placeholder")})})]})]})}},13238:(e,t,n)=>{n.d(t,{u:()=>s});var r=n(8246),o=n(23893),i=n(60949),a=n(85893),s=function(e){var t=e.event,n=e.onChange,s=e.buttonText,l=(0,i.j)({event:t}),c=l.isRecurringRsvpOpen,u=l.openRecurringRsvpModal,d=l.onRecurringModalCose;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{type:"submit",onClick:u,children:(0,a.jsx)(r.Z.LabelSm,{weight:"medium",color:"text-link",children:s})}),(0,a.jsx)(o.O,{event:t,show:c,onClose:d,onChange:n,eventRsvpedByDefault:!1})]})}},80712:(e,t,n)=>{n.d(t,{n:()=>u});var r=n(86013),o=n(8246),i=n(98338),a=n(39068),s=n(50732),l=n(81786),c=n(85893),u=function(e){var t=e.event,n=(0,i.wh)().currentCommunityMember,u=(0,a.vb)(n),d=t.community_member_id==n.id,m=!u&&!d,f=u?(0,r.t)("events.locations.limit_exceeded.admin_message"):(0,r.t)("events.locations.limit_exceeded.non_admin_owner_message");return(0,c.jsxs)("div",{className:"flex flex-col",children:[u&&(0,c.jsx)("div",{className:"my-2",children:(0,c.jsx)(l.z,{variant:"primary",onClick:function(){var e=(0,s.f$)();window.open(e,"_blank")},children:(0,r.t)("events.locations.limit_exceeded.upgrade")})}),(u||d)&&(0,c.jsx)(o.Z.BodySm,{children:f}),m&&(0,c.jsx)(o.Z.BodySm,{children:(0,r.t)("events.locations.limit_exceeded.member_message")})]})}},60949:(e,t,n)=>{n.d(t,{j:()=>y});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(88767),l=n(10281),c=n(98881),u=n(47259),d=n(98338),m=n(14337);function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t=e.event,n=e.onClose,r=void 0===n?a.noop:n,p=e.onChange,g=void 0===p?a.noop:p,y=e.eventRsvpedByDefault,_=void 0===y||y,x=b((0,i.useState)(),2),j=x[0],w=x[1],O=b((0,i.useState)(),2),S=O[0],P=O[1],C=b((0,i.useState)(),2),k=C[0],N=C[1],I=(0,s.useQueryClient)(),A=(0,d.xJ)(),E=(0,u.S)(t)?"host":"participant",T=(0,m.K)({event:t}),M=T.isLoading,L=T.events,R=T.fetchEvents,D=T.onRecurringRsvpSubmit,F=(0,c.i)(),U=F.canUsersSignUp,B=F.userSignUpUrl,z=function(){var e,n=(e=o().mark((function e(){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.entries(S).filter((function(e){return b(e,2)[1]})).map((function(e){return b(e,1)[0]})),i=n.find((function(e){return e.id===t.id})),e.next=4,D({eventIds:n,role:E});case 4:g(v(v({},t),{},{rsvped_event:Boolean(i)})),H(),r();case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}(),H=function(){I.invalidateQueries("posts")};return(0,i.useEffect)((function(){if(L){var e={};L.forEach((function(n){e["".concat(n.id)]=!(!_||n.id!==t.id)||n.rsvped_event})),P(e)}}),[L]),(0,i.useEffect)((function(){S&&N(Object.values(S).filter((function(e){return e})).length)}),[S]),{isLoading:M,events:L.filter((function(e){return!e.rsvp_limit_reached})),eventsState:S,isRecurringRsvpOpen:j,eventsSelectedCount:k,fetchEvents:R,onSubmit:z,onCheckboxChange:function(e){var t=e.name,n=e.value;P((function(e){return v(v({},e),{},h({},t,n))}))},onSelectAllClickHandler:function(){P((function(e){for(var t={},n=Object.entries(e),r=n.every((function(e){return e[1]})),o=0,i=n;o<i.length;o++){t[b(i[o],1)[0]]=!r}return t}))},openRecurringRsvpModal:function(){A?w((function(e){return!e})):window.location.href=(0,l.U)(U,B,!0)},onRecurringModalCose:function(){w(!1)}}}},23893:(e,t,n)=>{n.d(t,{O:()=>j});var r=n(67294),o=n(94184),i=n.n(o),a=n(86013),s=n(96486),l=n(34398),c=n(8246),u=n(39639),d=n(33071),m=n(8097),f=n(67687),p=n(13288),v=n(20816),h=n(54429),b=n(20516),g=n(4187),y=n(85893),_=function(e){var t=e.id,n=e.name,r=e.date,o=e.time,i=e.value,a=e.onChange;return(0,y.jsx)("li",{children:(0,y.jsxs)("label",{className:"m-0 flex items-center justify-between pr-1",htmlFor:t,children:[(0,y.jsxs)("div",{className:"leading-none",children:[(0,y.jsx)("div",{children:(0,y.jsx)(c.Z.LabelSm,{weight:"semibold",children:r})}),(0,y.jsx)("div",{className:"text-gray-500",children:(0,y.jsx)(c.Z.LabelXs,{children:o})})]}),(0,y.jsx)(g.X,{id:t,name:n,isFormItem:!1,checked:i,onChange:function(e){return a({name:n,value:e.target.checked})},option:{value:"",label:""}})]})})},x=n(60949),j=function(e){var t=e.event,n=e.eventRsvpedByDefault,o=void 0!==n&&n,g=e.onChange,j=e.onClose,w=e.show,O=void 0!==w&&w,S="events.rsvp.recurring_modal",P=(0,x.j)({event:t,onClose:j,onChange:g,eventRsvpedByDefault:o}),C=P.isLoading,k=P.events,N=P.eventsState,I=P.eventsSelectedCount,A=P.fetchEvents,E=P.onSubmit,T=P.onCheckboxChange,M=P.onSelectAllClickHandler,L=(0,b.q)(t),R=L.shouldShowConfirmation,D=L.setShouldShowConfirmation;(0,r.useEffect)((function(){O&&A()}),[O]);var F=t||{},U=F.event_setting_attributes,B=F.recurring_setting_attributes,z=U||{},H=z.starts_at,Z=z.time_zone_abbreviations,q=z.time_zone,V=z.start_date,W=(B||{}).frequency,Q=(0,v.O)({startsAt:V,frequency:W,firstLetterCapital:!1}).label,$="".concat((0,u.Dk)(H,q)," ").concat(Z,"."),G=(0,d.n)().selfUpdateCalendarEnabled,J=k.filter((function(e){var t;return null!==(t=null===N||void 0===N?void 0:N[e.id])&&void 0!==t&&t}));return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(m.W,{size:"md",title:t.name,actionText:G?(0,a.t)("".concat(S,".confirm_attendance")):(0,a.t)("".concat(S,".rsvp")),actionVariant:"primary",isOpen:!!O,onClose:function(){j()},onAction:function(){E(),D(!0)},disabled:C||0===I,children:[(0,y.jsxs)("div",{className:"mt-2.5 text-center text-gray-500",children:[(0,y.jsxs)(c.Z.BodyMd,{children:[(0,a.t)("".concat(S,".description_line_1"))," ",Q," ",(0,a.t)("".concat(S,".at"))," ",$]}),(0,y.jsx)(c.Z.BodyMd,{children:(0,a.t)("".concat(S,".description_line_2"))})]}),C&&(0,y.jsx)(p.a,{}),N&&!C&&(0,y.jsxs)(f.l,{defaultValues:N,onSubmit:s.noop,children:[(0,y.jsxs)("div",{className:"mt-7 flex items-center justify-between text-gray-500",children:[(0,y.jsxs)(c.Z.LabelSm,{weight:"medium",children:[null===k||void 0===k?void 0:k.length," ",(0,a.t)("".concat(S,".events"))]}),(0,y.jsx)("button",{type:"button",className:"text-circle",onClick:M,children:(0,y.jsx)(c.Z.LabelSm,{weight:"medium",children:(0,a.t)("".concat(S,".select_all"))})})]}),(0,y.jsx)("div",{className:"mt-4 overflow-auto md:max-h-80",children:(0,y.jsx)("ul",{className:i()("flex list-none flex-col gap-4",{"pr-4":(null===k||void 0===k?void 0:k.length)>6}),children:k.map((function(e){var t=e.id,n=e.starts_at,r=e.start_date,o=e.ends_at,i=e.time_zone,a=e.time_zone_abbreviations;return(0,y.jsx)(_,{id:"".concat(t),name:"".concat(t),date:r,time:"".concat((0,u.Dk)(n,i)," - ").concat((0,u.Dk)(o,i)," ").concat(a),value:N["".concat(t)],onChange:T},t)}))})})]})]}),!(0,l.yl)(t)&&(0,y.jsx)(h.c,{event:t,events:J,shouldShowConfirmationDate:!0,isRecurring:!0,eventsCount:I,show:R,onClose:function(){D(!1)}})]})}},71076:(e,t,n)=>{n.d(t,{w:()=>L});var r=n(34398),o=n(43535),i=n(33071),a=n(85327),s=n(54429),l=n(86013),c=n(81786),u=n(82177),d=n(8246),m=n(85893),f=function(e){var t=e.isOpen,n=e.onClose,r=e.toggleRsvp;return(0,m.jsxs)(u.u_,{title:(0,l.t)("events.rsvp.unrsvp_modal.title"),isOpen:!!t,onClose:n,children:[(0,m.jsx)(u.u_.Overlay,{}),(0,m.jsxs)(u.u_.Content,{children:[(0,m.jsxs)(u.u_.Header,{children:[(0,m.jsx)(u.u_.Title,{size:"md",className:"text-center",children:(0,l.t)("events.rsvp.unrsvp_modal.title")}),(0,m.jsx)(u.u_.HeaderActions,{children:(0,m.jsx)(u.u_.CloseButton,{onClick:n})})]}),(0,m.jsx)(u.u_.Body,{children:(0,m.jsx)("div",{className:"px-6 pb-4 pt-5 text-center",children:(0,m.jsx)(d.Z.BodyMd,{size:"text-sm",children:(0,l.t)("events.rsvp.unrsvp_modal.description")})})}),(0,m.jsxs)(u.u_.Footer,{className:"space-y-2",children:[(0,m.jsx)(c.z,{variant:"circle",full:!0,large:!0,onClick:function(){r(),n()},className:"h-10",children:(0,l.t)("events.rsvp.unrsvp_modal.confirm_button")}),(0,m.jsx)(c.z,{variant:"secondary",full:!0,large:!0,onClick:n,className:"h-10",children:(0,l.t)("events.rsvp.unrsvp_modal.decline_button")})]})]})]})},p=n(79579),v=n(94184),h=n.n(v),b=n(62596),g=function(){return(0,m.jsx)("img",{loading:"lazy",src:b,alt:(0,l.t)("events.rsvp.attending")})},y=function(e){var t=e.confirmed,n=e.full,r=e.toggleRsvp,o=e.declineInvite,s=e.rsvpStatus,u=e.loading,d=e.paidEvent,f=e.variant,p=void 0===f?"primary":f,v=e.isRsvpDisabled,b=void 0!==v&&v,y=e.detailsPage,_=void 0!==y&&y,x=s==a._w.INVITED,j=(0,i.n)().selfUpdateCalendarEnabled;return(0,m.jsxs)(m.Fragment,{children:[x&&(0,m.jsxs)("div",{className:h()("flex gap-x-2 gap-y-3",{"flex-wrap":_}),children:[(0,m.jsx)(c.z,{variant:"primary",full:n,onClick:r,disabled:u,className:h()("!font-semibold",{"!rounded-full":j}),children:(0,l.t)("events.rsvp.invite.accept")}),(0,m.jsx)(c.z,{variant:"secondary",full:n,onClick:o,disabled:u,className:h()("!ml-0 !font-semibold",{"!border-primary":"secondary"===p,"!rounded-full":j}),children:(0,l.t)("events.rsvp.invite.decline")})]}),!t&&!x&&(0,m.jsx)(c.z,{variant:p,full:n,onClick:r,disabled:u||b,className:h()("!font-semibold",{"!border-primary":"secondary"===p}),children:d?(0,l.t)("events.rsvp.buy_ticket"):(0,l.t)("events.rsvp.rsvp")}),t&&(0,m.jsx)(g,{})]})},_=n(67294),x=n(72510),j=n(47031),w=n(13342),O=n(71714),S=n(36589),P=function(e){var t=e.label,n=e.renderIcon;return(0,m.jsxs)("div",{className:"rsvp-radio__button__label",children:[n,(0,m.jsx)("span",{className:"button-text !text-dark",children:t})]})},C=function(e){var t=e.renderIcon,n=e.label,r=e.value,o=e.disabled,i=e.onClick;return(0,m.jsx)(x.v.Item,{disabled:o,children:function(e){return(0,m.jsxs)("button",{type:"submit",className:h()("rsvp-radio__list__option",{"rsvp-radio__list__option--active":e,"rsvp-radio__list__option--disabled":o}),onClick:i,children:[(0,m.jsxs)("div",{className:"rsvp-radio__list__option__label",children:[t,(0,m.jsx)("span",{className:"label-text",children:n})]}),(0,m.jsx)("input",{type:"radio",checked:r,readOnly:!0})]})}},"rsvp-attending")};function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e){var t=e.confirmed,n=e.full,r=e.toggleRsvp,o=e.loading,a=e.setShouldShowUnrsvpConfirmation,s=e.showUnrsvpPopup,c=(0,l.t)("events.rsvp.attending"),u=(0,l.t)("events.rsvp.not_attending"),d=(0,S.I)().isV3Enabled,f=(0,i.n)().selfUpdateCalendarEnabled,p=function(e){e!==t&&(!e&&s?a(!0):r())};return(0,m.jsx)("div",{className:h()("rsvp-radio",{"rsvp-radio--full":n}),children:(0,m.jsx)(x.v,{children:function(e){var n=e.open;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(x.v.Button,{className:h()("rsvp-radio__button !border-primary",{"rsvp-radio__button--open":n,"!rounded-2xl":d,"!rounded-full":f}),children:[t?(0,m.jsx)(P,{label:c,renderIcon:(0,m.jsx)(g,{})}):(0,m.jsx)(P,{label:u}),(0,m.jsx)("span",{className:"button-icon-container",children:(0,m.jsx)(w.Z,{className:"button-icon","aria-hidden":"true"})})]}),(0,m.jsx)(j.u,N(N({as:_.Fragment,show:n},O.SP),{},{children:(0,m.jsxs)(x.v.Items,{static:!0,className:"rsvp-radio__list",children:[(0,m.jsx)(C,{label:c,value:t,disabled:o,onClick:function(){return p(!0)}},"rsvp-attending"),(0,m.jsx)(C,{label:u,value:!t,disabled:o,onClick:function(){return p(!1)}},"rsvp-not-attending")]})}))]})}})})};function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){var t=e.event,n=e.onChange,l=e.toggleRecurringRsvp,c=e.full,u=e.variant,d=void 0===u?"primary":u,v=e.detailsPage,h=void 0!==v&&v,b=(0,p.O)(t,n),g=b.toggleRsvp,_=b.declineInvite,x=b.loading,j=b.showConfirmation,w=b.dismissConfirmation,O=b.dismissUnrsvpConfirmation,S=b.eventEnded,P=b.confirmed,C=b.rsvpStatus,k=b.setShouldShowUnrsvpConfirmation,N=b.shouldShowUnrsvpConfirmation,I=(0,i.n)().selfUpdateCalendarEnabled,E=t.event_type,M=t.invited_attendee,L=E===a.E_.RECURRING,R=t||{},D=R.event_setting_attributes,F=R.paywall_attributes,U=(D||{}).rsvp_limit_reached,B=L&&!(0,r.yl)(t),z=C===a._w.INVITED,H={confirmed:P,rsvpStatus:C,full:c,toggleRsvp:B&&!M?l:g,declineInvite:_,loading:x,paidEvent:(0,r.yl)(t),setShouldShowUnrsvpConfirmation:k,showUnrsvpPopup:(0,r.yl)(t)&&!(null!==F&&void 0!==F&&F.invited)};if(S)return null;var Z=!C||z;return(0,m.jsxs)(o.T,{children:[Z?(0,m.jsx)(y,T(T({},H),{},{variant:d,isRsvpDisabled:U,detailsPage:h})):(0,m.jsx)(A,T({},H)),!L&&(0,m.jsx)(s.c,{event:t,show:j,onClose:w}),P&&(0,r.yl)(t)&&(0,m.jsx)(f,{isOpen:N,onClose:O,toggleRsvp:g}),P&&M&&I&&(0,m.jsx)(s.c,{event:t,show:j,onClose:w})]})}},79579:(e,t,n)=>{n.d(t,{O:()=>y});var r=n(64687),o=n.n(r),i=n(86013),a=n(10281),s=n(50732),l=n(57594),c=n(98881),u=n(34398),d=n(98338),m=n(69647),f=n(20516);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)}))}}var y=function(e,t){var n=(0,f.q)(e),r=n.currentUser,p=n.error,h=n.hasEventEnded,b=n.isConfirmed,y=n.isLoading,_=n.isUnconfirmed,x=n.role,j=n.setShouldShowConfirmation,w=n.shouldShowConfirmation,O=n.setIsLoading,S=n.rsvpStatus,P=n.ticketData,C=n.setShouldShowUnrsvpConfirmation,k=n.shouldShowUnrsvpConfirmation,N=(0,m.p)(),I=(0,d.wh)().currentCommunityMember,A=(0,c.i)(),E=A.canUsersSignUp,T=A.userSignUpUrl,M=function(){var t=g(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return O(!0),t.prev=1,t.next=4,l.S.addToCalendar({event:e,params:{role:x}});case 4:N.success((0,i.t)("add_to_calendar_success")),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),p(t.t0.message),console.error((0,i.t)("add_to_calendar_failure"));case 11:O(!1);case 12:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(){return t.apply(this,arguments)}}(),L=function(t){fetch(t).then((function(e){return e.blob()})).then((function(t){var n=window.URL.createObjectURL(t),r="event-".concat(e.slug,".ics"),o=document.createElement("a");o.href=n,o.setAttribute("download",r),document.body.appendChild(o),o.click(),o.remove(),window.URL.revokeObjectURL(n)})).catch((function(e){p(e.message),console.error("useEventRsvp - could not download - ",t)}))},R=function(){var n=g(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l.S.unRsvp({event:e,params:{role:x}});case 3:t(v(v({},e),{},{rsvped_event:!1,rsvp_status:"no"})),n.next=10;break;case 6:n.prev=6,n.t0=n.catch(0),p(n.t0.message),console.error("useEventRsvp - could not decline - ",null===e||void 0===e?void 0:e.slug);case 10:O(!1);case 11:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(){return n.apply(this,arguments)}}(),D=function(){var n=g(o().mark((function n(){var i,s,c;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!y){n.next=2;break}return n.abrupt("return");case 2:if(r&&I){n.next=5;break}return(0,u.yl)(e)?window.location.href=e.paywall_attributes.checkout_url:window.location.href=(0,a.U)(E,T),n.abrupt("return");case 5:return i=(0,u.yl)(e)&&!S,s=i||_?l.S.rsvp:l.S.unRsvp,O(!0),n.prev=8,n.next=11,s({event:e,params:{role:x}});case 11:null!==(c=n.sent)&&void 0!==c&&c.redirect_url?window.location.href=c.redirect_url:(j(_),t(v(v({},e),{},{rsvped_event:_,rsvp_status:_?"yes":"no"}))),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(8),p(n.t0.message),console.error("useEventRsvp - could not rsvp - ",null===e||void 0===e?void 0:e.slug);case 19:O(!1);case 20:case"end":return n.stop()}}),n,null,[[8,15]])})));return function(){return n.apply(this,arguments)}}(),F=function(){var n=g(o().mark((function n(){var a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!y){n.next=2;break}return n.abrupt("return");case 2:if(r){n.next=6;break}return p((0,i.t)("log_in_to_perform_action",{action:(0,i.t)("events.rsvp.rsvp")})),window.location.href=s.$T.signIn({params:{post_login_redirect:window.location.href}}),n.abrupt("return");case 6:return n.next=8,l.S.rsvp({event:e});case 8:(a=n.sent).ok&&(null!==a&&void 0!==a&&a.redirect_url?window.location.href=a.redirect_url:t(v(v({},e),{},{rsvped_event:!0})));case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return{toggleRsvp:D,addToCalendar:M,downloadCalendar:function(){L(s.av.events.downloadCalendar({spaceId:e.space_id,slug:e.slug,params:{}}))},declineInvite:R,loading:y,confirmed:b,rsvpStatus:S,showConfirmation:w,dismissConfirmation:function(){return j(!1)},dismissUnrsvpConfirmation:function(){return C(!1)},eventEnded:h,rsvpWhileJoiningEvent:F,ticketData:P,setShouldShowUnrsvpConfirmation:C,shouldShowUnrsvpConfirmation:k}}},20516:(e,t,n)=>{n.d(t,{q:()=>u});var r=n(67294),o=n(98338),i=n(58837),a=n(69647),s=n(47259);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e){var t=e||{},n=t.rsvp_status,c=t.attendee_role,u=t.event_setting_attributes,d=t.paywall_attributes,m=(u||{}).ends_at,f=(0,i.aA)(m),p=l((0,r.useState)(!1),2),v=p[0],h=p[1],b=l((0,r.useState)(!1),2),g=b[0],y=b[1],_="CALENDAR_EVENT_".concat(e.id),x=l((0,r.useState)("true"===window.sessionStorage.getItem(_)),2),j=x[0],w=x[1],O=(0,o.xJ)(),S=(0,a.p)().error,P="yes"===n,C=!n||"yes"!==n,k=(0,s.S)(e);return{currentUser:O,error:S,hasEventEnded:f,isConfirmed:P,isLoading:v,isUnconfirmed:C,role:c||(k?"host":"participant"),setShouldShowConfirmation:function(e){try{window.sessionStorage.setItem(_,e)}catch(S){console.error("Error accessing session storage",S)}w(e)},shouldShowConfirmation:j,setIsLoading:h,rsvpStatus:n,ticketData:d,setShouldShowUnrsvpConfirmation:y,shouldShowUnrsvpConfirmation:g}}},39753:(e,t,n)=>{n.d(t,{P:()=>i});var r=n(28199),o=n(58837),i=function(e){var t=e||{},n=t.event_setting_attributes,i=t.policies,a=n||{},s=a.starts_at,l=a.location_type,c=a.live_stream_slug,u=i||{},d=u.can_manage_post,m=u.can_update_post,f=(0,o.Gs)(s,20),p=[r.Bq.LIVE_STREAM,r.Bq.LIVE_ROOM].includes(l);return{issueCreatingLive:f&&p&&!!!c&&d,canCreateLive:d||m}}},29832:(e,t,n)=>{n.d(t,{y:()=>c});var r=n(86013),o=n(88767),i=n(34334),a=n(34398),s=n(50732),l=n(69647),c=function(e){var t=(0,l.p)();return(0,o.useMutation)((function(){return i.S1.createLiveRoomForEvent({event:e})}),{onSuccess:function(t){var n=((t||{}).event_setting_attributes||{}).live_stream_slug;if(n){var r=s.dE.room({roomSlug:n});(0,a.L6)(e)&&(r=s.dE.publicRoom({roomSlug:n})),window.open(r,"_blank")}},onError:function(){t.error((0,r.t)("events.can_not_create_live_room_for_event"))}})}},34267:(e,t,n)=>{n.d(t,{Y:()=>$});var r=n(94184),o=n.n(r),i=n(86013),a=n(28175),s=n.n(a),l=n(55652),c=n(8246),u=n(98338),d=n(58837),m=n(39639),f=n(9578),p=n(88326),v=n(4404),h=n(46476),b=n(21918),g=n(85893),y=function(e){var t=e.event,n=e.size,r=void 0===n?"md":n,o=(0,b.C)(t)||{},i=o.attendees,a=o.totalCount,s=o.handleAttendeesClick;return null!==i&&void 0!==i&&i.length?(0,g.jsx)("button",{type:"button",onClick:s,children:(0,g.jsx)(h.v,{users:i,totalCount:a,size:r})}):null},_=n(65341),x=n(85327),j=n(20816),w=n(67294),O=n(37054),S=n(51705),P=n(81786),C=["places"],k={streetViewControl:!1,mapTypeControl:!1,scrollWheel:!1,fullscreenControl:!1,panControl:!1,rotateControl:!1,gestureHandling:"none",clickableIcons:!1,controlSize:25,disableDoubleClickZoom:!0,draggableCursor:"arrow",draggingCursor:"arrow",keyboardShortcuts:!1},N=function(e){var t=e.serializedLocation,n=(0,O.Ji)({id:"google-map-script",googleMapsApiKey:window.GOOGLE_MAPS_API_KEY,libraries:C}).isLoaded,r=(0,w.useMemo)((function(){return(0,S.qO)(t)}),[t]),o=(0,w.useMemo)((function(){return function(e){var t,n,r,o;return null!==e&&void 0!==e&&e.geometry?{lat:null===e||void 0===e||null===(t=e.geometry)||void 0===t||null===(n=t.location)||void 0===n?void 0:n.lat,lng:null===e||void 0===e||null===(r=e.geometry)||void 0===r||null===(o=r.location)||void 0===o?void 0:o.lng}:null}(r)}),[r]);return n?(0,g.jsxs)("div",{className:"in-person-location",children:[o&&(0,g.jsx)(O.b6,{mapContainerClassName:"in-person-location__map-container",zoom:15,options:k,center:o,children:(0,g.jsx)(O.Jx,{cursor:"arrow",position:o})}),(0,g.jsxs)("div",{className:"in-person-location__location",children:[(0,g.jsxs)("div",{className:"info",children:[(null===r||void 0===r?void 0:r.name)&&(0,g.jsx)("p",{className:"name",children:null===r||void 0===r?void 0:r.name}),r.formatted_address&&(0,g.jsx)("p",{children:r.formatted_address})]}),r.url&&(0,g.jsx)("div",{className:"view-map-button",children:(0,g.jsx)(P.z,{variant:"secondary",onClick:function(){window.open(r.url,"_blank")},full:!0,children:(0,i.t)("events.rsvp.view_map")})})]})]}):null},I=(0,w.memo)(N),A=n(13238),E=n(39753),T=n(34398),M=n(28736),L=n(50732),R=n(28199),D=n(80712),F=n(29832),U=function(e){var t=e.event,n=(0,u.wh)().currentUser,r=(0,M.IO)(),o=r.isMonthlyHourLimitReached,a=r.isStorageLimitReached,s=!!n,l=(t||{}).event_setting_attributes||{},d=l.location_type,m=l.live_stream_slug,f=l.live_stream_room_setting_attributes,p=(0,E.P)(t)||{},v=p.issueCreatingLive,h=p.canCreateLive,b=(0,F.y)(t),y=h&&(v||(0,R.oL)(t)),_=m&&((0,R.Mk)(t)||(0,R.S2)(t));return o||(null===f||void 0===f?void 0:f.recording_enabled)&&a?(0,g.jsx)(D.n,{event:t}):(0,g.jsxs)(g.Fragment,{children:[y&&(0,g.jsx)("div",{className:"my-2",children:(0,g.jsx)(P.z,{variant:"primary",onClick:b.mutate,disabled:(0,R.mv)(t)||b.isLoading||b.isSuccess,children:(0,i.t)("events.locations.create_".concat(d))})}),_?(0,g.jsx)("div",{className:"mt-2",children:(0,g.jsx)(P.z,{variant:"primary",onClick:function(){var e=L.dE.room({roomSlug:m});(0,T.L6)(t)&&!s&&(e=L.dE.publicRoom({roomSlug:m})),window.open(e,"_blank")},children:(0,i.t)("events.locations.".concat(d,"_link"))})}):(0,g.jsx)(c.Z.BodySm,{children:(0,i.t)("events.locations.".concat(d,"_not_available"))})]})},B=n(23893),z=n(60949),H=n(71076);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W={validate:{url:function(e){return/^[^A-Z]/.test(e)}}},Q=function(e){var t=e.onChange,n=e.isMinimal,r=void 0!==n&&n,a=(0,u.Zh)(),h=a.record,w=a.isUsedInMinimalTipTapViewModal,O=h||{},S=O.event_type,P=O.event_setting_attributes,C=O.rsvped_event,k=O.recurring_setting_attributes,N=O.upcoming_occurrences_count,E=((0,b.C)(h)||{}).totalCount,T=(k||{}).frequency,M=(0,z.j)({event:h}),L=M.isRecurringRsvpOpen,R=M.openRecurringRsvpModal,D=M.onRecurringModalCose,F=(0,l.C)(),Z=P||{},V=Z.starts_at,Q=Z.ends_at,$=Z.time_zone_abbreviations,G=Z.start_date,J=Z.time_zone,K=Z.location_type,Y=Z.in_person_location,X=Z.virtual_location_url,ee=Z.rsvp_disabled,te=Z.hide_attendees,ne=Z.hide_location_from_non_attendees,re=(0,j.O)({startsAt:V,frequency:T}).label;if(!P)return(0,g.jsx)(v.gi,{variant:"right-sidebar"});var oe=!!Q&&(0,d.aA)(Q),ie=S===x.E_.RECURRING,ae=h.rsvped_event,se=q({event:h,onChange:t,full:!r},ie&&{toggleRecurringRsvp:ae?function(){F.show({event:h,onChange:t})}:R});return(0,g.jsxs)(p.s,{withBorder:!r,isUsedInMinimalTipTapViewModal:w,className:o()({"lg:mb-12":!r,"!my-5":w}),children:[(0,g.jsxs)("div",{className:o()("rsvp-section",{"rsvp-section--minimal":r}),children:[!oe&&!ee&&(0,g.jsx)("div",{className:"rsvp-section__button",children:(0,g.jsx)(H.w,q({},se))}),(0,g.jsxs)("div",{className:"rsvp-section__section rsvp-section__section-date","data-testid":"event-date",children:[(0,g.jsx)(c.Z.LabelMd,{weight:"semibold",children:ie?(0,i.t)("events.rsvp.date"):(0,i.t)("events.rsvp.date_and_time")}),(0,g.jsxs)("div",{className:"rsvp-section__section__details",children:[(0,g.jsx)("div",{children:(0,g.jsx)(c.Z.LabelSm,{children:G})}),(0,g.jsx)("div",{children:(0,g.jsxs)(c.Z.LabelSm,{children:[" ","".concat((0,m.Dk)(V,J)," - ").concat((0,m.Dk)(Q,J)," ").concat($)]})})]}),(0,g.jsxs)("div",{className:"rsvp-section__section__footer",children:[!oe&&(0,g.jsx)(f.a,q({},(0,_.q)(h))),ie&&N>0&&(0,g.jsxs)("div",{className:"mt-2 lg:mt-4",children:[(0,g.jsx)("div",{children:(0,g.jsx)(c.Z.LabelSm,{children:re})}),(0,g.jsx)(A.u,{event:h,onChange:t,buttonText:(0,i.t)("events.rsvp.show_all_events")})]})]})]}),(!ne||C)&&(0,g.jsxs)("div",{className:"rsvp-section__section rsvp-section__section-location","data-testid":"event-location",children:[(0,g.jsx)(c.Z.LabelMd,{weight:"semibold",children:(0,i.t)("events.rsvp.location")}),!oe||"live_stream"!==K&&"live_room"!==K?(0,g.jsxs)(g.Fragment,{children:["virtual"===K&&(0,g.jsx)("div",{className:"rsvp-section__section__details rsvp-section__section__details--truncate text-dark",children:X?(0,g.jsx)(s(),{options:W,children:X}):(0,g.jsx)(c.Z.BodyMd,{children:(0,i.t)("events.locations.virtual")})}),"in_person"===K&&(0,g.jsx)("div",{className:"rsvp-section__section__details",children:(0,g.jsx)(I,{serializedLocation:Y})}),"tbd"===K&&(0,g.jsx)("div",{className:"rsvp-section__section__details",children:(0,i.t)("events.rsvp.tbd")}),[x.Bq.LIVE_STREAM,x.Bq.LIVE_ROOM].includes(K)&&(0,g.jsx)("div",{className:"rsvp-section__section__details text-dark",children:(0,g.jsx)(U,{event:h})})]}):(0,g.jsx)("div",{className:"rsvp-section__section__details",children:(0,i.t)("events.ended")})]}),!!E&&!ee&&!te&&(0,g.jsxs)("div",{className:"rsvp-section__section rsvp-section__section-attendees",children:[!r&&(0,g.jsx)("div",{className:"lg:mb-2",children:(0,g.jsx)(c.Z.LabelMd,{weight:"semibold",children:(0,i.t)("events.rsvp.attendees")})}),(0,g.jsx)("div",{className:"rsvp-section__section__details",children:(0,g.jsx)(y,{event:h,size:"md"})})]}),r&&0==E&&(0,g.jsx)("div",{className:"rsvp-section__section rsvp-section__section-attendees",children:(0,g.jsx)("p",{className:"rsvp-section__no-attendees",children:(0,i.t)("events.rsvp.first_to_attend")})})]}),(0,g.jsx)(B.O,{event:h,show:L,onClose:D,onChange:t})]})},$=function(e){var t=e.onChange,n=e.insidePost,r=void 0!==n&&n,i=(0,u.Zh)().isUsedInMinimalTipTapViewModal;return(0,g.jsx)("section",{className:o()("right-sidebar-container",{"right-sidebar-container--insidePost":r,"!block":i}),children:(0,g.jsx)(Q,{onChange:t})})}},65341:(e,t,n)=>{n.d(t,{q:()=>c});var r=n(58837),o=n(20846),i=n(51705),a=n(50732),s=n(85327);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(e,t){var n,c=e||{},u=c.name,d=c.calendar_description,m=c.event_setting_attributes,f=c.rsvped_event,p=c.slug,v=c.space_slug,h=c.event_type,b=c.recurring_setting_attributes,g=m||{},y=g.calendar_starts_at,_=g.calendar_ends_at,x=g.location_type,j=g.in_person_location,w=g.virtual_location_url,O=g.hide_location_from_non_attendees,S=g.start_date,P=g.event_recurrences,C=g.calendar_time_zone,k=!O||f,N=(0,i.qO)(j),I=h===s.E_.RECURRING,A="".concat(window.location.origin).concat((0,a.LM)({spaceSlug:v,slug:p})),E=I?"".concat(window.location.origin,"/c/").concat(v):A,T=(l(n={},s.Bq.VIRTUAL,w),l(n,s.Bq.IN_PERSON,null!==N&&void 0!==N&&N.name?null===N||void 0===N?void 0:N.name.concat(", ",null===N||void 0===N?void 0:N.formatted_address):null===N||void 0===N?void 0:N.formatted_address),l(n,s.Bq.LIVE_STREAM,E),l(n,s.Bq.LIVE_ROOM,E),l(n,s.Bq.TBD,""),n);return{label:t,title:u,description:d,location:k?T[x]:"",startTime:y,endTime:_,recurring:I?function(){switch(null===b||void 0===b?void 0:b.frequency){case s.PB.DAILY:return{repeat:s.PB.DAILY,count:P};case s.PB.WEEKDAY:return{repeat:s.PB.WEEKLY,count:P,byDay:s.o};case s.PB.WEEKLY:return{repeat:s.PB.WEEKLY,count:P,byDay:(0,o.mM)(S)};case s.PB.BI_WEEKLY:return{repeat:s.PB.WEEKLY,count:P,byDay:(0,o.mM)(S),interval:2};case s.PB.MONTHLY:return{repeat:s.PB.MONTHLY,count:P};case s.PB.MONTHLY_WEEK_BASED:return{repeat:s.PB.MONTHLY,count:P,byDay:(0,r.tX)(S)};case s.PB.ANNUALLY:return{repeat:s.PB.YEARLY,count:P};default:return{}}}():{},timeZone:C}}},85327:(e,t,n)=>{n.d(t,{Bq:()=>o,gP:()=>i,E_:()=>a,PB:()=>s,pd:()=>l,HA:()=>c,Q_:()=>u,_w:()=>d,o:()=>m});var r=n(86013),o={VIRTUAL:"virtual",IN_PERSON:"in_person",TBD:"tbd",LIVE_STREAM:"live_stream",LIVE_ROOM:"live_room"},i={virtual:(0,r.t)("events.location_types.virtual"),in_person:(0,r.t)("events.location_types.in_person"),tbd:(0,r.t)("events.location_types.tbd"),live_stream:(0,r.t)("events.location_types.live_stream"),live_room:(0,r.t)("events.location_types.live_room")},a={SINGLE:"single",RECURRING:"recurring"},s={DAILY:"daily",WEEKDAY:"weekday",WEEKLY:"weekly",BI_WEEKLY:"bi_weekly",MONTHLY:"monthly",MONTHLY_WEEK_BASED:"monthly_weekday_based",ANNUALLY:"annually",YEARLY:"yearly"},l={ON:"on",NEVER:"never",AFTER:"after"},c={CURRENT:"current",REMAINING:"remaining",ALL:"all"},u={PUBLISHED:"published",DRAFT:"draft"},d={INVITED:"invited"},m=["MO","TU","WE","TH","FR"]},98881:(e,t,n)=>{n.d(t,{i:()=>i});var r=n(98338),o=n(68997),i=function(){var e=(0,r.wh)().currentCommunity,t=(0,o.pn)(e),n=e||{},i=n.private_sign_up_url,a=n.is_private;return{canUsersSignUp:n.show_signup_link||a&&!!i,userSignUpUrl:i||t}}},73490:(e,t,n)=>{n.d(t,{m:()=>i});var r=n(24185),o=n(98338),i=function(){var e,t=(0,o.nT)(),n=(0,r.UO)().spaceSlug,i=(t.helpers.spacesWithPostCreationAllowed()||[]).filter((function(e){return"event"===e.post_type})),a=(null===(e=i.find((function(e){return e.slug===n})))||void 0===e?void 0:e.id)||null;return{spaces:i,spaceId:a}}},27034:(e,t,n)=>{n.d(t,{q:()=>o});var r=n(88767),o=function(){var e=(0,r.useQueryClient)();return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.shouldInvalidateHomePagePosts,r=void 0!==n&&n,o=t.shouldInvalidateAllEvents,i=void 0!==o&&o;e.invalidateQueries("post-show"),e.invalidateQueries("posts"),e.invalidateQueries("space-show",{refetchInactive:!0}),i&&e.invalidateQueries(["all","events","calendar-view"]),r&&e.invalidateQueries("home-page-posts")}}},47259:(e,t,n)=>{n.d(t,{S:()=>o});var r=n(98338),o=function(e){var t=(0,r.wh)().currentCommunityMember;return!(!e||!t)&&(null===e||void 0===e?void 0:e.community_member_id)===(null===t||void 0===t?void 0:t.id)}},20816:(e,t,n)=>{n.d(t,{O:()=>i});var r=n(86013),o=n(55299),i=function(e){var t=e.startsAt,n=e.frequency,i=e.firstLetterCapital,a=void 0===i||i,s=e.frequencyFirstLetterCapital,l=void 0!==s&&s,c=e.includeRepeatsOn,u=void 0===c||c;if(!t||!n)return{label:""};var d=(0,o.E)({startsAt:t,firstLetterCapital:l}).find((function(e){return e.value===n})),m=(0,r.t)("events.recurring.".concat(a?"frequencies_capital_letter":"frequencies",".repeats"));return{label:d&&u?"".concat(m," ").concat(d.label):d.label}}},75336:(e,t,n)=>{n.d(t,{j:()=>a});var r=n(86013),o=n(4848),i=n(85893),a=function(e){var t=e.rsvpStatus;if(!t)return null;var n="yes"===t?"success":"default",a="yes"===t?(0,r.t)("events.rsvp.attending"):"invited"===t?(0,r.t)("events.rsvp.invited"):(0,r.t)("events.rsvp.not_attending");return(0,i.jsx)(o.O,{variant:n,children:a})}},62261:(e,t,n)=>{n.d(t,{t:()=>s});var r=n(86013),o=n(81786),i=n(8246),a=n(85893),s=function(e){var t=e.startRecordNumber,n=e.endRecordNumber,s=e.totalRecordCount,l=e.fetchPrevPage,c=e.fetchNextPage,u=e.hasPrevPage,d=e.hasNextPage;return(0,a.jsxs)("div",{className:"flex h-16 w-full items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-end",children:[(0,a.jsx)("div",{children:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("events.edit_modal.pagination.showing")})}),(0,a.jsx)("div",{className:"mx-1",children:(0,a.jsxs)(i.Z.LabelSm,{weight:"semibold",children:[t,"-",n]})}),(0,a.jsx)("div",{className:"mr-1",children:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("events.edit_modal.pagination.of")})}),(0,a.jsx)("div",{children:(0,a.jsx)(i.Z.LabelSm,{weight:"semibold",children:s})})]}),(u||d)&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(o.z,{variant:"secondary",type:"button",className:"mr-3",disabled:!u,onClick:l,children:(0,r.t)("events.edit_modal.pagination.previous")}),(0,a.jsx)(o.z,{variant:"secondary",type:"button",disabled:!d,onClick:c,children:(0,r.t)("events.edit_modal.pagination.next")})]})]})}},87218:(e,t,n)=>{n.d(t,{V:()=>m});var r=n(67294),o=n(86013),i=n(88767),a=n(34334),s=n(81649),l=n(69647),c=n(34398);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.a.PARTICIPANT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,d=e||{},m=d.space_id,f=d.slug,p=(0,l.p)(),v=p.error,h=p.success,b=u((0,r.useState)(1),2),g=b[0],y=b[1],_=(0,i.useQuery)(s.a.eventAttendees.index({spaceId:m,slug:f,params:{page:g,role:t,per_page:n}}),{keepPreviousData:!0,enabled:!!e}),x=_.isLoading,j=_.isFetching,w=_.data,O=_.refetch,S=_.remove,P=(null===w||void 0===w?void 0:w.records)||[],C=null===w||void 0===w?void 0:w.count,k=null===w||void 0===w?void 0:w.total_confirmed_record_count,N=null===w||void 0===w?void 0:w.page_count,I=C?Math.ceil(C/10):0,A=g>1,E=!(null===w||void 0===w||!w.has_next_page),T=10*(g-1)+1,M=T+N-1,L=(0,i.useMutation)((function(t){return a.S1.bulkRsvp({event:e,params:t})}),{onSuccess:function(){y(1),S(),h((0,o.t)("events.edit_modal.people.add_attendees_success"))},onError:function(){v((0,o.t)("events.edit_modal.people.add_attendees_error"))}}),R=L.isLoading,D=L.mutateAsync;return{page:g,records:P,totalRecordCount:C,totalConfirmedRecordCount:k,pageRecordCount:N,pageCount:I,hasPrevPage:A,hasNextPage:E,startRecordNumber:T,endRecordNumber:M,isLoading:x,isFetching:j,isAdding:R,addAttendeesAsync:D,refetch:O,fetchNextPage:function(){y(g+1)},fetchPrevPage:function(){y(Math.max(g-1,1))},resetPage:function(){y(1)}}}},93289:(e,t,n)=>{n.d(t,{SA:()=>o,Bq:()=>i,E_:()=>a,Mj:()=>s,pd:()=>l,HA:()=>c,Q_:()=>u,a:()=>d,n4:()=>m});var r=n(86013),o={overview:(0,r.t)("events.edit_modal.overview.title"),people:(0,r.t)("events.edit_modal.people.title"),basicInfo:(0,r.t)("events.create.form.basic_info"),details:(0,r.t)("events.edit_modal.details.title"),notifications:(0,r.t)("events.edit_modal.notifications.title"),email:(0,r.t)("events.edit_modal.email.title"),advancedOptions:(0,r.t)("events.edit_modal.advanced_options.title")},i={VIRTUAL:"virtual",IN_PERSON:"in_person",TBD:"tbd",LIVE_STREAM:"live_stream",LIVE_ROOM:"live_room"},a={SINGLE:"single",RECURRING:"recurring"},s={FREE:"free",PAID:"paid"},l={ON:"on",NEVER:"never",AFTER:"after"},c={CURRENT:"current",REMAINING:"remaining",ALL:"all"},u={PUBLISHED:"published",DRAFT:"draft"},d={PARTICIPANT:"participant",COHOST:"cohost",HOST:"host"},m={ATTENDEES:"attendees",COHOSTS:"cohosts"}},97659:(e,t,n)=>{n.d(t,{mv:()=>a,s9:()=>s,f0:()=>l,dy:()=>c,L6:()=>u,UJ:()=>d,VL:()=>m,Rv:()=>f,yl:()=>p,hA:()=>v,H3:()=>h,Km:()=>b});var r=n(58837),o=n(85239),i=n(93289),a=function(e){return(null===e||void 0===e?void 0:e.status)===i.Q_.DRAFT},s=function(e){return(null===e||void 0===e?void 0:e.status)===i.Q_.PUBLISHED},l=function(e){return(null===e||void 0===e?void 0:e.event_type)===i.E_.RECURRING},c=function(e){var t;return(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.location_type)===i.Bq.LIVE_ROOM},u=function(e){var t,n;return function(e){var t;return(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.location_type)===i.Bq.LIVE_STREAM}(e)&&(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t||null===(n=t.live_stream_room_setting_attributes)||void 0===n?void 0:n.access_type)===o._d.PUBLIC_STREAM},d=function(e){return[i.Bq.LIVE_STREAM,i.Bq.LIVE_ROOM].includes(e)},m=function(e){var t;return(0,r.aA)(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.ends_at)},f=function(e){var t;return e&&(0,r.aA)(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.starts_at)},p=function(e){var t;return(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.ticket_type)==i.Mj.PAID},v=function(e){var t;return e&&(null===e||void 0===e||null===(t=e.paywall_attributes)||void 0===t?void 0:t.published)},h=function(e){return l(e)&&!p(e)},b=function(e){var t=l(e),n=t?I18n.t("events.recurring_deletion_successful"):I18n.t("event_dropdown_actions.delete_successful");return function(e){return m(e)||a(e)}(e)&&(n=t?I18n.t("events.recurring_draft_deletion_successful"):I18n.t("event_dropdown_actions.draft_delete_successful")),n}},34398:(e,t,n)=>{n.d(t,{a:()=>r.a,E_:()=>r.E_,Bq:()=>r.Bq,n4:()=>r.n4,HA:()=>r.HA,pd:()=>r.pd,SA:()=>r.SA,Q_:()=>r.Q_,Mj:()=>r.Mj,Km:()=>o.Km,hA:()=>o.hA,VL:()=>o.VL,Rv:()=>o.Rv,mv:()=>o.mv,UJ:()=>o.UJ,dy:()=>o.dy,yl:()=>o.yl,L6:()=>o.L6,s9:()=>o.s9,f0:()=>o.f0});var r=n(93289),o=n(97659)},8761:(e,t,n)=>{n.d(t,{G:()=>cr});var r=n(94184),o=n.n(r),i=n(54030),a=n(31611),s=n(55531),l=n(93228),c=n(67687),u=n(86013),d=n(54482),m=n(8246),f=n(64687),p=n.n(f),v=n(67294),h=n(96486);function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var g=function(){var e=(0,v.useRef)(null),t=function(){var t,n=(t=p().mark((function t(n,r){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,h.isFunction)(e.current)){t.next=6;break}return t.next=3,e.current();case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:r(n);case 7:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e,t){return n.apply(this,arguments)}}();return{validateAndSetCurrentSection:t,triggerValidationRef:e}},y=n(34398),_=n(85893),x=function(e){var t=e.isOpen,n=e.handleClose,r=e.isEditMode,o=(0,a.eW)(),i=o.currentSection,c=o.setCurrentSection,f=g().validateAndSetCurrentSection;return i===y.SA.overview?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(s.x.HeaderContent,{children:(0,_.jsx)(m.Z.TitleSm,{truncate:!0,weight:"semibold",children:(0,u.t)("edit_event")})}),(0,_.jsx)(l.o,{onClick:n,isVisible:t,className:"!pr-0"})]}):(0,_.jsx)(s.x.HeaderContent,{children:(0,_.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[r&&(0,_.jsx)(d.h,{name:"16-arrow-left",onClick:function(){f(y.SA.overview,c)},ariaLabel:(0,u.t)("back")}),(0,_.jsx)(m.Z.TitleSm,{truncate:!0,weight:"semibold",children:r?(0,u.t)("edit_event"):(0,u.t)("events.create.title")}),(0,_.jsx)(l.o,{onClick:n,isVisible:t})]})})},j=n(81786),w=n(44032),O=n(29614);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C="events.edit.recurring_event_modal",k=function(e){var t=e.show,n=void 0!==t&&t,r=e.onConfirm,o=e.onCloseModal,i=e.isPublishing,a=void 0!==i&&i,s=e.showCurrentOptionOnly,l=e.shouldHideAllEventOption,c=S((0,v.useState)(),2),d=c[0],m=c[1],f=[{label:(0,u.t)("".concat(C,".this_event")),value:y.HA.CURRENT},{label:(0,u.t)("".concat(C,".this_and_following")),value:y.HA.REMAINING},{label:(0,u.t)("".concat(C,".all_events")),value:y.HA.ALL}],p=f.filter((function(e){return e.value!==y.HA.ALL})),h=f.filter((function(e){return e.value===y.HA.CURRENT})),b=(0,v.useMemo)((function(){var e=f;return s?e=h:l&&(e=p),e}),[s,l]);return(0,_.jsx)(w.c,{title:a?(0,u.t)("".concat(C,".title_publish")):(0,u.t)("".concat(C,".title")),isOpen:n,confirmText:(0,u.t)("".concat(C,".accept")),cancelText:(0,u.t)("".concat(C,".cancel")),onClose:o,onCancel:o,onConfirm:function(){r(d)},size:"sm",children:(0,_.jsx)("div",{className:"mt-6",children:(0,_.jsx)(O.S,{defaultChecked:y.HA.CURRENT,name:"recurring_event_settings.frequency_edit",options:b,size:"sm",onChange:function(e){m(e)}})})})},N=["onEditModeConfirm","isRecurringEvent","isPublishing","children","isStartsAtDirty","shouldHideAllEventOption"];function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var R=function(e){var t=e.onEditModeConfirm,n=e.isRecurringEvent,r=void 0!==n&&n,o=e.isPublishing,i=void 0!==o&&o,a=e.children,s=e.isStartsAtDirty,l=e.shouldHideAllEventOption,c=L(e,N),u=T((0,v.useState)(!1),2),d=u[0],m=u[1];return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(j.z,A(A({type:"button",onClick:function(){r?m(!0):t(y.HA.CURRENT)}},c),{},{children:a})),(0,_.jsx)(k,{show:d,onConfirm:function(e){m(!1),t(e)},onCloseModal:function(){return m(!1)},isPublishing:i,showCurrentOptionOnly:s,shouldHideAllEventOption:l})]})},D=n(50732),F=n(18605),U=function(e){var t=e.event,n=e.isEventDraft,r=t||{},o=r.slug,i=r.space_slug;return(0,_.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center whitespace-nowrap",onClick:function(){window.open((0,D.LM)({spaceSlug:i,slug:o}),"_blank")},children:[(0,_.jsx)(m.Z.LabelSm,{weight:"medium",children:(0,u.t)(n?"events.edit_modal.preview":"events.edit_modal.overview.view_event")}),(0,_.jsx)(F.JO,{type:"16-arrow-top-right",size:16})]})},B=function(e){var t=e.event,n=e.onPublish,r=e.className,i=(0,a.eW)().isSaving,s=(0,y.mv)(t);return(0,_.jsxs)(a.h4.Actions,{className:o()("justify-between px-5 pb-6 pt-2 md:justify-end md:p-0",r),children:[t&&(0,_.jsx)(U,{event:t,isEventDraft:s}),s&&(0,_.jsx)(R,{variant:"circle",disabled:i,onEditModeConfirm:n,isRecurringEvent:(0,y.f0)(t),isPublishing:!0,children:(0,u.t)("events.edit_modal.buttons.publish")})]})},z=n(15897),H=function(e){var t=e.onChangeSection,n=(0,a.eW)(),r=n.sections,o=n.currentSection,i=n.setCurrentSection,s=r.map((function(e){return{value:e,label:e}}));return(0,_.jsx)(a.h4.Actions,{className:"items-center justify-center",children:(0,_.jsx)(z.S,{value:o,onChange:function(e){t(e,i)},options:s})})},Z=n(94353),q=n(41982);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $=function(e){var t=e.event,n=e.isCreating,r=e.isEditMode,o=e.actionsProps,s=(0,a.eW)().title,l=(0,y.s9)(t)?(0,u.t)("events.badge_status.published"):(0,u.t)("events.badge_status.draft");return(0,i.kK)()?(0,_.jsxs)("div",{className:"flex w-full flex-col gap-4 px-5 py-4",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between",children:[r&&(0,_.jsx)(Z.g,{label:l}),r&&(0,_.jsx)(B,W(W({},o),{},{className:"inline-flex lg:hidden"}))]}),(0,_.jsx)(m.Z.TitleSm,{truncate:!0,weight:"semibold",children:s})]}):(0,_.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-4",children:[(0,_.jsx)(q.Y,{className:"flex",children:!n&&s&&(0,_.jsxs)("div",{className:"flex items-center gap-2",children:[(0,_.jsx)(m.Z.TitleSm,{truncate:!0,weight:"semibold",children:s}),(0,_.jsx)("div",{className:"flex items-center",children:r&&(0,_.jsx)(Z.g,{label:l})})]})}),r&&(0,_.jsx)(B,W(W({},o),{},{className:"lg:hidden"}))]})};function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=function(e){var t=e.isOpen,n=e.isEditMode,r=e.isCreating,o=e.event,a=e.onPublish,l=e.validateAndSetCurrentSection,c=e.handleClose,u={event:o,isEditMode:n,onPublish:a};return(0,i.kK)()?(0,_.jsx)(x,{isOpen:t,isEditMode:n,handleClose:c}):(0,_.jsxs)(s.x.HeaderContent,{children:[(0,_.jsx)($,{event:o,isCreating:r,isEditMode:n,actionsProps:u}),n&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(s.x.HeaderContent.Navigation,{children:(0,_.jsx)(H,{event:o,onPublish:a,onChangeSection:l})}),(0,_.jsx)(B,J(J({},u),{},{className:"hidden lg:flex"}))]})]})},X=n(87536),ee=n(85327),te=["children","name","rules","tooltipText","hidePlaceholder","placeholder","inlineReverse","translationRoot","hideLabel","className"];function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ie(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var ae=function(e){var t=e.children,n=e.name,r=e.rules,o=void 0===r?{}:r,i=e.tooltipText,a=e.hidePlaceholder,s=void 0!==a&&a,l=e.placeholder,u=e.inlineReverse,d=void 0!==u&&u,m=e.translationRoot,f=void 0===m?"events.edit_modal":m,p=e.hideLabel,v=void 0!==p&&p,h=e.className,b=void 0===h?"":h,g=ie(e,te);return(0,_.jsx)(c.l.Item,re(re({name:n,hideDescription:!0,translationRoot:f,rules:o,hideBorder:!0,fullWidth:!0,hidePlaceholder:s,placeholder:l,tooltipText:i,inlineReverse:d,hideLabel:v,className:b},g),{},{children:t}))},se=function(){return(0,_.jsx)("div",{className:"w-[100px]",children:(0,_.jsx)(c.l.Item,{name:"event_setting_attributes.rsvp_limit",hideLabel:!0,hideBorder:!0,placeholder:(0,u.t)("events.edit_modal.event_setting_attributes.rsvp_limit_placeholder"),rules:{required:(0,u.t)("events.edit_modal.event_setting_attributes.rsvp_limit_required"),min:{value:1,message:(0,u.t)("events.edit_modal.event_setting_attributes.rsvp_limit_error")}},children:(0,_.jsx)(c.l.Input,{})})})},le=function(e){var t=e.event,n=(0,X.qo)({name:"event_setting_attributes.rsvp_limit_enabled",defaultValue:(null===t||void 0===t?void 0:t.event_setting_attributes.rsvp_limit_enabled)||!1});return(0,_.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,_.jsx)("div",{className:"mb-0 mt-6 md:mb-3 md:mt-8",children:(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.edit_modal.advanced_options.attendees")})}),["hide_from_featured_areas","event_setting_attributes.rsvp_disabled","event_setting_attributes.hide_attendees","event_setting_attributes.rsvp_limit_enabled"].map((function(e){return(0,_.jsx)(ae,{name:e,tooltipText:(0,u.t)("events.edit_modal.".concat(e,"_tooltip")),inlineReverse:!0,className:"!pb-0",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})},e)})),n&&(0,_.jsx)(se,{})]})},ce=n(74666),ue=n(20292),de=n(10647),me=n(74338),fe=function(){return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"md:mb-3",children:(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.edit_modal.advanced_options.meta_tags")})}),(0,_.jsxs)("div",{className:"pb-4",children:[(0,_.jsx)(ae,{name:"meta_tag_attributes.meta_title",hidePlaceholder:!0,label:(0,u.t)("events.edit_modal.meta_tag_attributes.meta_title"),tooltipText:(0,u.t)("events.edit_modal.meta_tag_attributes.meta_title_description",{obj:"event"}),children:(0,_.jsx)(c.l.Input,{})}),(0,_.jsx)(ae,{name:"meta_tag_attributes.meta_description",hidePlaceholder:!0,label:(0,u.t)("events.edit_modal.meta_tag_attributes.meta_description"),tooltipText:(0,u.t)("events.edit_modal.meta_tag_attributes.meta_description_description"),children:(0,_.jsx)(c.l.Input,{variant:"textarea"})}),(0,_.jsx)(ae,{name:"meta_tag_attributes.opengraph_title",hidePlaceholder:!0,label:(0,u.t)("events.edit_modal.meta_tag_attributes.opengraph_title"),tooltipText:(0,u.t)("events.edit_modal.meta_tag_attributes.opengraph_title_description",{obj:"event"}),children:(0,_.jsx)(c.l.Input,{})}),(0,_.jsx)(ae,{name:"meta_tag_attributes.opengraph_description",hidePlaceholder:!0,label:(0,u.t)("events.edit_modal.meta_tag_attributes.opengraph_description"),tooltipText:(0,u.t)("events.edit_modal.meta_tag_attributes.opengraph_description_description"),children:(0,_.jsx)(c.l.Input,{variant:"textarea"})}),(0,_.jsx)("div",{className:"mt-4 grid grid-cols-1",children:(0,_.jsxs)("div",{className:"w-full",children:[(0,_.jsx)(ue.Q,{field:"hide_location_from_non_attendees",label:(0,u.t)("events.edit_modal.meta_tag_attributes.opengraph_image"),description:" "}),(0,_.jsx)(de.D,{name:"meta_tag_attributes[opengraph_image]",alt:(0,u.t)("spaces.form.edit.options.seo.opengraph_image.label"),className:"relative",showAddCoverBtn:!0,aspectRatio:ce.pI.OPEN_GRAPH,changeImageText:(0,u.t)("spaces.form.edit.options.seo.opengraph_image.change"),customAddCoverBtn:(0,_.jsx)(me.Z,{title:(0,u.t)("spaces.form.edit.options.seo.opengraph_image.add"),description:(0,u.t)("spaces.form.edit.options.seo.opengraph_image.description")})})]})})]})]})},pe=function(){return(0,_.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,_.jsx)("div",{className:"mb-0 mt-6 md:mb-3 md:mt-8",children:(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.edit_modal.advanced_options.permissions")})}),["hide_meta_info","is_comments_disabled","is_liking_disabled"].map((function(e){return(0,_.jsx)(ae,{name:e,tooltipText:(0,u.t)("events.edit_modal.".concat(e,"_tooltip")),inlineReverse:!0,className:"!pb-0",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})},e)}))]})},ve=function(e){var t=e.event;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(m.Z.TitleXl,{children:(0,u.t)("events.edit_modal.advanced_options.title")}),(0,_.jsx)(pe,{}),(0,_.jsx)(le,{event:t}),(0,_.jsx)(fe,{})]})},he=n(90789),be=n(98338),ge=n(73490),ye=n(23529),_e=n(62057),xe=function(e){var t=e.event,n=e.canCreateTopics,r=e.requireTopicSelection,o=(0,ge.m)().spaces,i=!!t,a=i?"w-full pr-0 md:pr-2 md:w-1/2":"w-full",s=r?{required:(0,u.t)("events.create.form.topics_required_error")}:{required:!1},l=(0,(0,X.Gc)().getValues)("space_id");return(0,_.jsxs)("div",{className:"my-6 md:my-8",children:[(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.create.form.event_name")}),(0,_.jsxs)("div",{className:"flex flex-col items-stretch gap-2 md:flex-row",children:[(0,_.jsx)("div",{className:a,children:(0,_.jsx)(ae,{name:"name",rules:{required:(0,u.t)("events.create.form.name_required_error"),maxLength:{value:255,message:(0,u.t)("events.create.form.name_length_error")}},placeholder:(0,u.t)("events.create.form.name_placeholder"),translationRoot:"events.create.form",children:(0,_.jsx)(c.l.Input,{autoFocus:!0,"data-testid":"event-title"})})}),i&&(0,_.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,_.jsx)(ae,{name:"slug",hidePlaceholder:!0,rules:{maxLength:{value:255,message:(0,u.t)("events.create.form.slug_length_error")}},tooltipText:(0,u.t)("events.edit_modal.slug_tooltip",{url:window.location.origin}),children:(0,_.jsx)(c.l.Input,{})})})]}),(0,_.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[(0,_.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,_.jsx)(ae,{name:"space_id",rules:{required:(0,u.t)("events.create.form.space_required_error")},translationRoot:"events.create.form",children:(0,_.jsx)(_e.M,{spaces:o,name:"space_id",variant:"form-input",dropdownClassName:"!top-[100%] -mt-1"})})}),(0,_.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,_.jsx)(ae,{name:"user_id",translationRoot:"events.create.form",children:(0,_.jsx)(c.l.CommunityMemberSelect,{name:"user_id",dropdownClassName:"!top-[93px]",direction:"down",valueField:"user_id",hideIcon:!0})})})]}),(0,_.jsx)("div",{className:"flex flex-col items-stretch md:flex-row",children:(0,_.jsx)(ae,{name:"topics",tooltipText:(0,u.t)("events.edit_modal.topics_tooltip"),rules:s,children:(0,_.jsx)(ye.w,{containerClassName:"bg-primary border-primary rounded-md border",name:"topics",spaceId:l,creatable:n})})})]})},je=n(55299),we=n(58837),Oe=n(6934),Se=n(58249),Pe=function(e){var t=e.event,n=(0,je.e)(),r=n.endsAtMaxDate,o=n.endsAfterMaxOccurrences,i=n.frequencyOptions,a=n.endingOptions,s=n.endsAtMinDate,l=n.endsOnValue,d=n.showRecurringFields,f=t&&(0,y.VL)(t),p=((0,y.mv)(t)||(0,y.s9)(t))&&(0,y.f0)(t);return(0,_.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.create.form.date_and_time")}),(0,_.jsx)("div",{className:"flex flex-col items-stretch md:flex-row",children:(0,_.jsx)("div",{className:"w-full",children:(0,_.jsx)(ae,{label:(0,u.t)("events.create_modal.event_setting_attributes.starts_at",{timeZone:(0,we.ED)(we.tq)}),translationRoot:"events.create.form",children:(0,_.jsx)(Oe.D,{startsAtConfig:{name:"event_setting_attributes.starts_at",minDate:new Date},endsAtConfig:{name:"event_setting_attributes.ends_at"},durationConfig:{name:"event_setting_attributes.duration_in_seconds"},disabled:f})})})}),(0,_.jsx)("div",{className:"flex items-stretch",children:(0,_.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,_.jsx)(ae,{name:"recurring_setting_attributes.frequency",translationRoot:"events.create.form",children:(0,_.jsx)(c.l.AnimatedSelect,{fullWidth:!0,options:i,disabled:!!t,dataTestId:"event-repeats"})})})}),(0,_.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[d&&(0,_.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,_.jsx)(ae,{name:"recurring_setting_attributes.range_type",translationRoot:"events.create.form",children:(0,_.jsx)(c.l.AnimatedSelect,{fullWidth:!0,options:a,disabled:p,dataTestId:"event-ends"})})}),d&&(0,_.jsxs)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:[(!l||l===ee.pd.ON)&&(0,_.jsx)("div",{className:"mt-0 flex items-end md:mt-7",children:(0,_.jsx)(ae,{name:"recurring_setting_attributes.ends_at",hideLabel:!0,rules:{required:(0,u.t)("events.create.form.ends_at_required")},translationRoot:"events.create.form",children:(0,_.jsx)(Se.x,{name:"recurring_setting_attributes.ends_at",minDate:new Date(s),maxDate:new Date(r),disabled:p,dataTestId:"recurring_event_ends_at",datePlaceholder:(0,u.t)("events.create.form.recurring_setting_attributes.date_placeholder"),timePlaceholder:(0,u.t)("events.create.form.recurring_setting_attributes.time_placeholder")})})}),l===ee.pd.AFTER&&(0,_.jsx)("div",{className:"flex items-end",children:(0,_.jsx)("div",{className:"grow",children:(0,_.jsx)(ae,{name:"recurring_setting_attributes.occurrences",rules:{required:!p&&(0,u.t)("events.create.form.occurrences_required"),max:{value:o,message:(0,u.t)("events.create.form.max_occurrences_error")}},translationRoot:"events.create.form",children:(0,_.jsx)(c.l.Input,{type:"number",min:1,max:o,autoFocus:!0,disabled:p,"data-testid":"event-occurrences",customOpacity:"70"})})})})]})]})]})},Ce=n(42658),ke=function(){return(0,Ce.H)("location-picker-z-index-override"),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(ae,{name:"event_setting_attributes.in_person_location",variant:"extra-bottom-margin",translationRoot:"events.create.form",rules:{required:(0,u.t)("events.create_modal.event_setting_attributes.location_address_required_error")},children:(0,_.jsx)(c.l.LocationPicker,{autoFocus:!0})}),(0,_.jsx)(ae,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})})]})},Ne=n(58356),Ie=n(28736),Ae=n(85239),Ee=n(33071),Te=n(27025),Me=function(e){var t=e.name,n=e.roomType,r=void 0===n?Ae.H0.STREAM:n,o=(0,ge.m)().spaces,i=(0,Ie.oQ)().config,a=null===i||void 0===i?void 0:i.live_room_participants_capacity,s=(0,X.Gc)(),l=s.control,c=s.getValues,d=s.setValue,f=c("space_id"),p=c("event_setting_attributes.ticket_type"),h=o.find((function(e){return e.id==f})),b=h?h.visibility:"open",g=[{value:Ae._d.SECRET,label:(0,u.t)("events.create.form.".concat(b,".access_type_secret")),description:(0,_.jsx)(m.Z.LabelSm,{children:(0,u.t)("events.create.form.".concat(b,".access_type_secret_label"))})}];p==y.Mj.FREE&&g.push({value:Ae._d.OPEN,label:(0,u.t)("events.create.form.".concat(b,".access_type_space")),description:(0,_.jsx)(m.Z.LabelSm,{children:(0,u.t)("events.create.form.".concat(b,".access_type_space_label"),{maxCapacity:a})})}),r===Ae.H0.STREAM&&p==y.Mj.FREE&&g.push({value:Ae._d.PUBLIC_STREAM,label:(0,u.t)("events.create.form.".concat(b,".access_type_public")),description:(0,_.jsx)(m.Z.LabelSm,{children:(0,u.t)("events.create.form.".concat(b,".access_type_public_label"))})}),(0,v.useEffect)((function(){"paid"==p&&d("event_setting_attributes.live_stream_room_setting_attributes.access_type",Ae._d.SECRET,{shouldDirty:!0})}),[p,d]);return(0,_.jsx)(X.Qr,{control:l,name:t,render:function(e){var t=e.field,n=t.onChange,r=function(e){return g.find((function(t){return t.value===e}))}(t.value)||g[0];return(0,_.jsx)(Te.Lt,{direction:"bottom-start",linkType:"button",button:(0,_.jsx)(Te.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,_.jsxs)("div",{className:"flex justify-between",children:[(0,_.jsx)("div",{className:"content-start",children:(0,_.jsx)(m.Z.LabelMd,{children:null===r||void 0===r?void 0:r.label})}),(0,_.jsx)("div",{className:"flex content-end",children:(0,_.jsx)(F.JO,{type:"cheveron-down"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:Te.wk.EXTRA_LARGE,onChange:n,options:g,labelWeight:"semibold"})}})},Le=function(e){var t,n,r,o=e.recordingEnabled,i=e.showRecordingToggle,a=void 0!==i&&i,s=e.showAddonsLimits,l=void 0!==s&&s,d=e.roomTypeOverride,f=e.event,p=(0,Ie.tm)(),h=p.streamingHoursAvailable,b=p.recordingHoursAvailable,g=p.streamingTotalPlanHours,x=p.recordingTotalPlanHours,j=(0,Ee.n)().limitUrlSharingEnabled,w=!!f,O=(0,Ie.Yq)().currentQuantity,S=(0,Ie.$v)().currentQuantity,P=l&&C||l&&!h,C=o&&!b,k=(0,X.Gc)(),N=k.watch,I=k.setValue,A=N("event_setting_attributes.live_stream_room_setting_attributes.access_type"),E=N("event_setting_attributes.ticket_type"),T=A===Ae._d.PUBLIC_STREAM,M="event_setting_attributes.live_stream_room_setting_attributes.limit_url_sharing",L=(0,v.useRef)(null===f||void 0===f||null===(t=f.event_setting_attributes)||void 0===t?void 0:t.ticket_type),R=w&&L.current==E?null===f||void 0===f||null===(n=f.event_setting_attributes)||void 0===n||null===(r=n.live_stream_room_setting_attributes)||void 0===r?void 0:r.limit_url_sharing:E===y.Mj.PAID;return(0,v.useEffect)((function(){A===Ae._d.PUBLIC_STREAM&&I(M,!1,{shouldDirty:!0})}),[A,I]),(0,v.useEffect)((function(){I(M,R,{shouldDirty:!0})}),[E,I]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"flex items-stretch",children:[(0,_.jsx)("div",{className:"w-1/2 pr-2",children:(0,_.jsx)(ae,{name:"event_setting_attributes.live_stream_room_setting_attributes.view_type",labelClassName:"mb-3 text-lg",translationRoot:"events.create.form",children:(0,_.jsx)(Ne.bW,{roomType:d})})}),(0,_.jsx)("div",{className:"w-1/2 pl-2",children:(0,_.jsx)(ae,{name:"event_setting_attributes.live_stream_room_setting_attributes.access_type",labelClassName:"mb-3 text-lg",translationRoot:"events.create.form",children:(0,_.jsx)(Me,{roomType:d})})})]}),a&&(0,_.jsxs)("div",{className:"mt-4",children:[(0,_.jsx)(ae,{name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled",tooltipText:(0,u.t)("events.create_modal.event_setting_attributes.recording_enabled_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})}),o&&(0,_.jsx)(ae,{name:"event_setting_attributes.live_stream_room_setting_attributes.auto_post_recording_enabled",tooltipText:(0,u.t)("events.create_modal.event_setting_attributes.auto_post_recording_enabled_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})}),(0,_.jsx)(ae,{name:"event_setting_attributes.live_stream_room_setting_attributes.mute_on_join",inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})}),(0,_.jsx)(ae,{name:"event_setting_attributes.live_stream_room_setting_attributes.hide_participants_list",tooltipText:(0,u.t)("events.create.form.event_setting_attributes.live_stream_room_setting_attributes.hide_participants_list_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})})]}),(0,_.jsx)(ae,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})}),j&&!T&&(0,_.jsx)(ae,{name:M,translationRoot:"events.create.form",tooltipText:(0,u.t)("events.create_modal.event_setting_attributes.limit_url_sharing_tooltip"),inlineReverse:!0,className:"!pt-1",labelClassName:"!font-normal",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})}),P?(0,_.jsxs)("div",{className:"mt-12",children:[C&&(0,_.jsx)("div",{className:"px-1 text-justify",children:(0,_.jsx)(m.Z.BodyXs,{children:(0,u.t)("live_streams.form.upgrade_recording_hours_label",{hours:x+O})})}),!h&&(0,_.jsx)("div",{className:"px-1 text-justify",children:(0,_.jsx)(m.Z.BodyXs,{children:(0,u.t)("live_streams.form.upgrade_streaming_hours_label",{hours:g+S})})})]}):null]})},Re=n(4079),De=function(){return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(ae,{name:"event_setting_attributes.virtual_location_url",rules:{required:(0,u.t)("events.create_modal.event_setting_attributes.virtual_location_required_error"),pattern:{value:Re.lu,message:(0,u.t)("events.create.form.virtual_location_url_error")}},translationRoot:"events.create.form",children:(0,_.jsx)(c.l.Input,{"data-testid":"url-event-location"})}),(0,_.jsx)(ae,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})})]})},Fe=n(79090),Ue=function(e){var t,n,r=e.setLocationType,o=e.event,i=!!o,a=(0,Fe.Y)().setRecordingEnabled,s=(0,X.Gc)().setValue,l=(0,X.qo)({name:"event_setting_attributes.location_type"}),c=(0,X.qo)({name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled"}),u=(0,X.qo)({name:"event_setting_attributes.ticket_type"}),d=(0,v.useRef)(null===o||void 0===o||null===(t=o.event_setting_attributes)||void 0===t?void 0:t.ticket_type),m=i&&d.current==u?null===o||void 0===o||null===(n=o.event_setting_attributes)||void 0===n?void 0:n.hide_location_from_non_attendees:u===y.Mj.PAID;(0,v.useEffect)((function(){[y.Bq.TBD,y.Bq.IN_PERSON].includes(l)||s("event_setting_attributes.hide_location_from_non_attendees",m,{shouldDirty:!0})}),[u,s,l]),(0,v.useEffect)((function(){r(l)}),[l,r]),(0,v.useEffect)((function(){return a(c)}),[c,a]);var f=l===y.Bq.LIVE_ROOM?Ae.H0.CONFERENCE:Ae.H0.STREAM;switch(l){case y.Bq.IN_PERSON:return(0,_.jsx)(ke,{});case y.Bq.VIRTUAL:return(0,_.jsx)(De,{});case y.Bq.LIVE_ROOM:case y.Bq.LIVE_STREAM:return(0,_.jsx)(Le,{recordingEnabled:c,showRecordingToggle:!0,roomTypeOverride:f,event:o});case y.Bq.TBD:default:return null}},Be=function(e){var t=e.event,n=e.setRecordingEnabled,r=e.setLocationType,o=(0,be.wh)().currentCommunity.supports_live_streams,i=[{label:(0,u.t)("events.create_modal.event_setting_attributes.location_type_in_person"),value:y.Bq.IN_PERSON},{label:(0,u.t)("events.create_modal.event_setting_attributes.location_type_virtual"),value:y.Bq.VIRTUAL},{label:(0,u.t)("events.create_modal.event_setting_attributes.location_type_live_stream"),value:y.Bq.LIVE_STREAM,hidden:!o},{label:(0,u.t)("events.create_modal.event_setting_attributes.location_type_live_room"),value:y.Bq.LIVE_ROOM,hidden:!o},{label:(0,u.t)("events.create_modal.event_setting_attributes.location_type_tbd"),value:y.Bq.TBD}];return(0,_.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.create.form.event_location")}),(0,_.jsx)("div",{className:"flex items-stretch",children:(0,_.jsx)("div",{className:"w-full",children:(0,_.jsx)(ae,{name:"event_setting_attributes.location_type",placeholder:(0,u.t)("events.create_modal.event_setting_attributes.location_type_placeholder"),rules:{required:(0,u.t)("events.create_modal.event_setting_attributes.location_required_error")},translationRoot:"events.create.form",children:(0,_.jsx)(c.l.AnimatedSelect,{fullWidth:!0,options:i,allowEmpty:!0,dataTestId:"event-location"})})})}),(0,_.jsx)(Ue,{setRecordingEnabled:n,setLocationType:r,event:t})]})},ze=n(68997),He=n(25676),Ze=function(){return(0,_.jsx)("div",{className:"bg-tertiary mb-16 mt-5 flex h-[208px] w-full items-center justify-center rounded-xl",children:(0,_.jsxs)("div",{className:"flex w-[300px] flex-col space-y-6 text-center",children:[(0,_.jsx)(m.Z.LabelLg,{weight:"medium",children:(0,u.t)("events.create.form.connect_to_stripe_description")}),(0,_.jsx)("div",{className:"mx-6",children:(0,_.jsx)(He.Q,{href:"/settings/paywalls",variant:"circle",full:!0,children:(0,u.t)("events.create.form.connect_to_stripe")})})]})})},qe=n(96146),Ve=n(53242),We=n(13288),Qe=n(56421),$e=n(31018),Ge=function(e){var t=e.name,n=e.labelKey,r=e.placeholder,i=e.currency,a=e.isDisabled,s=(0,X.Gc)().formState.errors[t];if(!i)return null;var l=(0,Qe.Bj)(i,{amountInCents:!0}),d=(0,u.t)("settings.paywalls.modal.tabs.pricing.add_price_modal.field_errors.amount",{min:(0,$e.I)(i,i.min_charge_amount,{amountInCents:!0,includeCurrencyCode:!1}),max:(0,$e.I)(i,i.max_charge_amount,{amountInCents:!0,includeCurrencyCode:!1})});return(0,_.jsx)(c.l.Item,{name:t,className:o()({"border-red-500":s},"m-0 grow"),label:(0,u.t)("events.create.form.paywall_attributes.".concat(n)),placeholder:r||l(0),rules:{validate:{bounds:function(e){var t=(0,Qe.LG)(e);return!isNaN(t)&&t>=(null===i||void 0===i?void 0:i.min_charge_amount)&&t<=(null===i||void 0===i?void 0:i.max_charge_amount)||d}}},transformValue:l,labelClassName:"mb-2 text-sm font-semibold leading-5 tighter normal-case text-dark",labelWrapperClassName:"m-0",errorClassName:"mt-1 text-red-500 text-sm",hideDescription:!0,hideBorder:!0,children:(0,_.jsx)(c.l.Input,{"data-testid":"ticket-price",disabled:a})})},Je=function(e){var t,n=e.event,r=(0,X.Gc)().watch,o=!!n,i=n&&(0,y.Rv)(n),a=r("event_setting_attributes.ticket_type"),s=(0,y.yl)(n)||"paid"==a,l=(0,y.hA)(n),d=o&&s&&l&&!(0,y.mv)(n)||i||(0,y.f0)(n),m=r("paywall_attributes.currency_id")||(null===n||void 0===n||null===(t=n.paywall_attributes)||void 0===t?void 0:t.currency_id),f=(0,Ve.K)(),p=f.data;if(f.isLoading)return(0,_.jsx)(We.a,{});var v=null===p||void 0===p?void 0:p.find((function(e){return e.id.toString()===(null===m||void 0===m?void 0:m.toString())}));return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[(0,_.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,_.jsx)(Ge,{name:"paywall_attributes.price_amount",labelKey:"price",currency:v,placeholder:(0,u.t)("events.create.form.paywall_attributes.price_placeholder"),isDisabled:i})}),(0,_.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,_.jsx)(qe.H,{formItemName:"paywall_attributes.currency_id",formItemTranslationRoot:"events.create.form",disabled:d,markDefaultCurrencyDirty:!0})})]}),(0,_.jsx)("div",{className:"flex flex-col items-stretch",children:(0,_.jsx)(ae,{name:"paywall_attributes.description",rules:{maxLength:{value:16777215,message:(0,u.t)("events.create.form.paywall_attributes.description_length_error")}},placeholder:(0,u.t)("events.create.form.paywall_attributes.description_placeholder"),translationRoot:"events.create.form",children:(0,_.jsx)(c.l.TextArea,{"data-testid":"event-paywall-description",disabled:i})})})]})},Ke=function(e){var t=e.event,n=(0,be.wh)().currentCommunity,r=(0,X.qo)({name:"event_setting_attributes.ticket_type"});return r===y.Mj.FREE?(0,_.jsx)("null",{}):r!==y.Mj.PAID||(0,ze.qF)(n)?(0,_.jsx)(Je,{event:t}):(0,_.jsx)(Ze,{})},Ye=function(e){var t=e.event,n=(0,X.Gc)().watch,r=(0,y.Rv)(t)||(0,y.f0)(t),o=n("event_setting_attributes.ticket_type"),i=n("event_setting_attributes.location_type"),a=o==y.Mj.PAID&&[y.Bq.LIVE_STREAM,y.Bq.LIVE_ROOM].includes(i),s=[{label:(0,u.t)("events.create_modal.event_setting_attributes.free_event"),value:y.Mj.FREE},{label:(0,u.t)("events.create_modal.event_setting_attributes.paid_event"),value:y.Mj.PAID}];return(0,_.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.create.form.event_ticket")}),(0,_.jsx)("div",{className:"flex items-stretch",children:(0,_.jsx)("div",{className:"w-full",children:(0,_.jsx)(ae,{name:"event_setting_attributes.ticket_type",placeholder:(0,u.t)("events.create_modal.event_setting_attributes.ticket_type_placeholder"),rules:{required:(0,u.t)("events.create_modal.event_setting_attributes.ticket_type_required_error")},translationRoot:"events.create.form",children:(0,_.jsx)(c.l.AnimatedSelect,{fullWidth:!0,options:s,dataTestId:"event-ticket-type",disabled:r})})})}),a&&(0,_.jsxs)("div",{className:"bg-tertiary my-2.5 flex h-14 w-full flex-none items-center justify-start gap-x-3 rounded-lg",children:[(0,_.jsx)(F.JO,{type:"24-info",size:24,className:"ms-3"}),(0,_.jsx)(m.Z.LabelSm,{color:"bg-tertiary",children:(0,u.t)("events.create.form.event_setting_attributes.live_stream_room_setting_attributes.paid_event_warning_msg")})]}),(0,_.jsx)(Ke,{event:t})]})};function Xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rt=function(e){var t,n,r=(0,be.wh)().currentCommunity,o=(0,X.Gc)(),i=o.setValue,a=o.getValues,s=(0,v.useRef)(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.location_type),l=null===(n=a().event_setting_attributes)||void 0===n?void 0:n.location_type,c=(0,ge.m)().spaces,u=(0,X.qo)({name:"space_id"}),d=(null===c||void 0===c?void 0:c.find((function(e){return e.id===u})))||null,m=["private","secret"].includes(null===d||void 0===d?void 0:d.visibility)?Ae._d.SECRET:Ae._d.OPEN,f=(0,v.useMemo)((function(){var t;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){nt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({access_type:m,view_type:Ae.Bk.GRID,recording_enabled:r.live_stream_recording_enabled,auto_post_recording_enabled:r.live_stream_auto_post_recording_enabled,room_type:Ae.H0.STREAM},null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.live_stream_room_setting_attributes)}),[r,e,m]);return(0,v.useEffect)((function(){(0,y.UJ)(l)&&s.current!==l&&(Object.entries(f).forEach((function(e){var t=Xe(e,2),n=t[0],r=t[1];i("event_setting_attributes.live_stream_room_setting_attributes.".concat(n),r,{shouldDirty:!0,shouldTouch:!0})})),s.current=l)}),[l,f,i]),{space:d}},ot=function(e){var t=e.event,n=e.setLocationType,r=rt(t).space,o=((0,be.wh)().currentCommunityMember||{}).is_admin;return(0,_.jsxs)(_.Fragment,{children:[t&&(0,_.jsx)(m.Z.TitleXl,{children:(0,u.t)("events.create.form.basic_info")}),(0,_.jsx)(xe,{event:t,canCreateTopics:(0,he.Y_)(r),requireTopicSelection:null===r||void 0===r?void 0:r.require_topic_selection}),(0,_.jsx)(Pe,{event:t}),(0,_.jsx)(Be,{event:t,setLocationType:n}),o&&(0,_.jsx)(Ye,{event:t})]})},it=n(23127),at=function(){return(0,_.jsxs)("div",{className:"create-event-details__cover-image",children:[(0,_.jsx)("label",{children:(0,u.t)("events.create.form.cover_image")}),(0,_.jsx)(de.D,{name:"cover_image",alt:"",customAspectRatioHelpText:(0,u.t)("image_upload.recommended_size_event_cover"),showAddCoverBtn:!0,customAddCoverBtn:(0,_.jsxs)("div",{className:"create-event-details__cover-image-add",children:[(0,_.jsx)("div",{className:"create-event-details__cover-image-add__icon-wrapper",children:(0,_.jsx)(F.JO,{type:"plus-big",viewBox:"0 0 20 20"})}),(0,_.jsx)("span",{className:"text-dark font-semibold",children:(0,u.t)("events.create.form.cover_image_upload")}),(0,_.jsx)("span",{className:"text-light mt-1 text-sm",children:(0,u.t)("events.create.form.event_cover_image_recommended_size")})]})})]})},st=function(){var e=(0,v.useRef)();return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(m.Z.TitleXl,{children:(0,u.t)("events.edit_modal.details.title")}),(0,_.jsxs)("div",{className:"my-8",children:[(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.edit_modal.details.cover_image")}),(0,_.jsx)(at,{})]}),(0,_.jsxs)("div",{className:"mb-8 mt-6 md:mt-12",children:[(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.edit_modal.details.description")}),(0,_.jsx)(ae,{name:"body",hideLabel:!0,children:(0,_.jsx)("div",{className:"trix-v2 event-description-wrapper trix-v2--modal-3 mt-2",children:(0,_.jsx)(it.O,{placeholder:(0,u.t)("events.edit_modal.details.description_placeholder"),id:"event-details-body",ref:e,name:"body"})})})]})]})},lt=n(51420),ct=n(67937),ut=n(20336),dt=n(7490),mt=n(26022),ft=n(52701),pt=n(74287),vt=n(36298),ht=n(33180),bt=n(8097);function gt(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var yt=function(e){var t=e.shouldShowConfirmationModal,n=e.toggleConfirmationModal,r=e.handleSubmit,o=e.isLoading,i=function(){var e,t=(e=p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:n();case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){gt(i,r,o,a,s,"next",e)}function s(e){gt(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,_.jsx)(bt.W,{isOpen:t,onClose:n,onAction:i,actionText:(0,u.t)("scheduled_emails.delete.email"),title:(0,u.t)("scheduled_emails.delete.modal_title"),size:"sm",actionVariant:"danger",disabled:o,children:(0,_.jsx)("div",{className:"my-4 text-center",children:(0,u.t)("scheduled_emails.delete.modal_description")})})};function _t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jt=function(){var e=_t((0,v.useState)(!1),2),t=e[0],n=e[1];return{isOpen:t,openModal:function(){n(!0)},closeModal:function(){n(!1)}}},wt=n(88767),Ot=(0,v.createContext)({scheduledEmailList:[],isLoading:!1,hasScheduledEmails:function(){return!1},refetch:function(){return new Promise((function(e){return e}))}});Ot.displayName="ScheduledEmailContext";var St=function(e){var t,n=e.event,r=e.children,o=(0,ht.T)().getScheduledEmailList,i=String((null===n||void 0===n?void 0:n.id)||""),a=null===n||void 0===n||null===(t=n.event_setting_attributes)||void 0===t?void 0:t.starts_at,s=a?new Date(a):void 0,l=new Date,c=(0,wt.useQuery)(["scheduled-email-list",i,a],(function(){return o({record_id:i,scheduled_email_type:"event"})})),u=c.data,d=c.isLoading,m=c.refetch,f={scheduledEmailList:(null===u||void 0===u?void 0:u.records)||[],isLoading:d,maxDate:s,minDate:l,refetch:m,hasScheduledEmails:function(){var e;return!(null===u||void 0===u||null===(e=u.records)||void 0===e||!e.length)}};return(0,_.jsx)(Ot.Provider,{value:f,children:r})},Pt=function(){var e=(0,v.useContext)(Ot);if(void 0===e)throw new Error("useScheduledEmailContext must be used within a ScheduledEmailProvider");return e};function Ct(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function kt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ct(i,r,o,a,s,"next",e)}function s(e){Ct(i,r,o,a,s,"throw",e)}a(void 0)}))}}var Nt=function(e){var t=e.scheduledEmail,n=e.disabled,r=jt(),o=r.isOpen,i=r.closeModal,a=r.openModal,s=jt(),l=s.isOpen,c=s.closeModal,m=s.openModal,f=Pt(),v=f.refetch,h=f.maxDate,b=f.minDate,g=(0,ht.T)(),y=g.destroyScheduledEmail,x=g.isDestroyLoading,j=function(){var e=kt(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(),e.next=3,null===v||void 0===v?void 0:v();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=kt(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:return c(),e.next=5,null===v||void 0===v?void 0:v();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(Te.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,_.jsx)(d.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,ariaLabel:(0,u.t)("events.event_actions"),dataTestId:"action-more",disabled:n}),transitionWrapperClassName:"z-50",size:"small",children:[(0,_.jsx)(Te.Lt.ItemWithLink,{onClick:a,linkType:"button",children:(0,u.t)("edit")}),(0,_.jsx)(Te.Lt.ItemWithLink,{onClick:m,linkType:"button",children:(0,_.jsx)("span",{className:"text-v2-danger",children:(0,u.t)("delete")})})]}),(0,_.jsx)(pt.D,{isOpen:o,onClose:j,scheduledEmail:t,maxDate:h,minDate:b}),(0,_.jsx)(yt,{shouldShowConfirmationModal:l,toggleConfirmationModal:c,handleSubmit:w,isLoading:x})]})},It=function(e){var t=e.scheduledEmail,n=t.scheduled_at,r=t.metadata,i=t.subject,a=r.send_to,s=(0,(0,X.Gc)().getValues)("event_setting_attributes.send_email_reminder")?"":"text-gray-400";return(0,_.jsxs)("div",{className:o()("border-primary flex items-center gap-3 border-b py-4",s),children:[(0,_.jsx)("div",{className:"bg-tertiary flex h-12 w-12 items-center justify-center rounded-lg",children:(0,_.jsx)(F.JO,{type:"16-email",size:16})}),(0,_.jsxs)("div",{className:"grow",children:[(0,_.jsx)(m.Z.LabelMd,{weight:"semibold",color:s,children:i}),(0,_.jsxs)("div",{children:[(0,_.jsxs)(m.Z.LabelSm,{weight:"medium",color:s,children:[(0,u.t)("events.edit_modal.email.to",{send_to:(0,u.t)("scheduled_emails.form.".concat(a))}),(0,u.t)("events.edit_modal.email.separator")]}),(0,_.jsx)(m.Z.LabelSm,{weight:"medium",color:s||"text-light",children:(0,u.t)("events.edit_modal.email.scheduled_at",{scheduled_at:n&&(0,vt.w)({dateTime:new Date(n),format:vt.f.short_date_at_short_time})})})]})]}),(0,_.jsx)(Nt,{scheduledEmail:t})]})},At=function(){var e=Pt(),t=e.isLoading,n=e.scheduledEmailList;return t?(0,_.jsx)(We.a,{}):n&&0!==n.length?(0,_.jsx)(_.Fragment,{children:n.map((function(e){return(0,_.jsx)(It,{scheduledEmail:e},e.id)}))}):null};function Et(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function Tt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Et(i,r,o,a,s,"next",e)}function s(e){Et(i,r,o,a,s,"throw",e)}a(void 0)}))}}var Mt="event_setting_attributes.send_email_reminder",Lt=function(e){var t,n,r=e.event,o=jt(),i=o.isOpen,a=o.openModal,s=o.closeModal,l=Pt(),d=l.refetch,f=l.hasScheduledEmails,h=l.maxDate,b=l.minDate,g=(0,X.Gc)(),x=g.getValues,w=g.setValue,O=(0,v.useMemo)((function(){return(0,lt.AW)((0,u.t)("events.edit_modal.email.email_body_default_text",{event_name:null===r||void 0===r?void 0:r.name}).replace(/[{}]/g,(function(e){return"".concat(e).concat(e)})),[ut.Z,mt.Z,ft.Z,ct.ZP,dt.Z])}),[null===r||void 0===r?void 0:r.name]),S=(0,we.ZX)(null===r||void 0===r||null===(t=r.event_setting_attributes)||void 0===t||null===(n=t.starts_at)||void 0===n?void 0:n.toString(),-3600),P={record_id:String(null===r||void 0===r?void 0:r.id),scheduled_email_type:"event",scheduled_at:S,subject:(0,u.t)("events.edit_modal.email.default_subject").replace(/[{}]/g,(function(e){return"".concat(e).concat(e)})),email_body:{body:O},enabled:(0,y.s9)(r),metadata:{send_to:"going",email_type:"reminder"}},C=function(){var e=Tt(p().mark((function e(){var t,n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(),e.next=3,d();case 3:r=e.sent,0===(null===(t=r.data)||void 0===t||null===(n=t.records)||void 0===n?void 0:n.length)&&w(Mt,!1,{shouldDirty:!0});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=x(Mt),N=function(){var e=Tt(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,0)}));case 2:if(k=x(Mt)){e.next=5;break}return e.abrupt("return");case 5:if(!f()){e.next=7;break}return e.abrupt("return");case 7:a();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,_.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,_.jsx)(m.Z.TitleXl,{children:(0,u.t)("events.edit_modal.email.long_title")}),(0,_.jsxs)("div",{className:"md:my-3",children:[(0,_.jsx)(ae,{name:"event_setting_attributes.send_in_app_notification_reminder",tooltipText:(0,u.t)("events.edit_modal.event_setting_attributes.send_in_app_notification_reminder_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,_.jsx)(c.l.ToggleSwitch,{name:"event_setting_attributes.send_in_app_notification_reminder",variant:"small"})}),(0,_.jsx)(ae,{name:Mt,tooltipText:(0,u.t)("events.edit_modal.event_setting_attributes.send_scheduled_email_tooltip"),inlineReverse:!0,className:"!pb-0 [&>p]:absolute [&>p]:left-0 [&>p]:top-full [&>p]:!mt-0",rules:{validate:{bounds:function(e){return!(e&&!f())||(0,u.t)("events.scheduled_email_error")}}},children:(0,_.jsx)(c.l.ToggleSwitch,{name:Mt,variant:"small",onClick:N})})]}),(0,_.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.edit_modal.email.schedule")})}),(0,_.jsx)(At,{}),(0,_.jsx)(j.z,{type:"button",variant:"secondary",onClick:a,className:"mt-4 min-w-[96px]",disabled:!k,children:(0,u.t)("events.edit_modal.email.add_reminder")}),(0,_.jsx)(pt.D,{isOpen:i,onClose:C,scheduledEmail:P,maxDate:h,minDate:b})]})},Rt=function(e){var t=e.event;return(0,_.jsx)(St,{event:t,children:(0,_.jsx)(Lt,{event:t})})},Dt=n(14135),Ft=function(){return(0,_.jsxs)(Dt.t,{backgroundNone:!0,className:"!p-0 md:!px-4 md:!py-2",children:[(0,_.jsx)(ae,{name:"event_setting_attributes.confirmation_message_title",hideLabel:!0,children:(0,_.jsx)(c.l.Input,{})}),(0,_.jsx)(ae,{name:"event_setting_attributes.confirmation_message_description",hideLabel:!0,children:(0,_.jsx)(c.l.TextArea,{})}),(0,_.jsx)(ae,{name:"event_setting_attributes.confirmation_message_button_title",hideLabel:!0,children:(0,_.jsx)(c.l.Input,{})}),(0,_.jsx)(ae,{name:"event_setting_attributes.confirmation_message_button_link",hideLabel:!0,children:(0,_.jsx)(c.l.Input,{})})]})},Ut=function(e){var t=e.event,n=(0,X.qo)({name:"event_setting_attributes.enable_custom_thank_you_message",defaultValue:(null===t||void 0===t?void 0:t.event_setting_attributes.enable_custom_thank_you_message)||!1});return(0,_.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,_.jsx)(m.Z.TitleXl,{children:(0,u.t)("events.edit_modal.notifications.title")}),(0,_.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.edit_modal.notifications.publish")})}),(0,_.jsx)(ae,{name:"event_setting_attributes.send_publish_email",tooltipText:(0,u.t)("events.edit_modal.event_setting_attributes.send_publish_email_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})}),(0,_.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.edit_modal.notifications.confirmation")})}),(0,_.jsx)(ae,{name:"event_setting_attributes.send_email_confirmation",tooltipText:(0,u.t)("events.edit_modal.event_setting_attributes.send_email_confirmation_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})}),(0,_.jsx)(ae,{name:"event_setting_attributes.send_in_app_notification_confirmation",tooltipText:(0,u.t)("events.edit_modal.event_setting_attributes.send_in_app_notification_confirmation_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})}),(0,_.jsx)(ae,{name:"event_setting_attributes.enable_custom_thank_you_message",tooltipText:(0,u.t)("events.edit_modal.event_setting_attributes.enable_custom_thank_you_message_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,_.jsx)(c.l.ToggleSwitch,{variant:"small"})}),n&&(0,_.jsx)(Ft,{})]})},Bt=n(46476),zt=n(87218),Ht=function(e){var t=e.event,n=e.onClick,r=(0,zt.V)(t,y.a.PARTICIPANT,3),o=r.records,i=r.totalRecordCount,a=i||(0,u.t)("events.edit_modal.overview.zero");return(0,_.jsxs)("button",{type:"button",className:"border-primary flex h-full w-full cursor-pointer flex-col justify-between rounded-lg border p-4",onClick:n,"aria-label":(0,u.t)("events.edit_modal.overview.rsvps"),children:[(0,_.jsxs)("div",{className:"mb-2 flex w-full items-start justify-between",children:[(0,_.jsx)(m.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,u.t)("events.edit_modal.overview.rsvps")}),(0,_.jsx)(Bt.v,{users:o,totalCount:i,size:"md"})]}),(0,_.jsx)(m.Z.TitleMd,{children:a})]})},Zt=function(e){var t=e.event,n=e.onClick,r=(0,zt.V)(t,y.a.COHOST,3),o=r.records,i=r.totalRecordCount,a=i||(0,u.t)("events.edit_modal.overview.zero");return(0,_.jsxs)("button",{type:"button",className:"border-primary flex h-full w-full cursor-pointer flex-col justify-between rounded-lg border p-4",onClick:n,"aria-label":(0,u.t)("events.edit_modal.overview.cohosts"),children:[(0,_.jsxs)("div",{className:"mb-2 flex w-full items-start justify-between",children:[(0,_.jsx)(m.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,u.t)("events.edit_modal.overview.cohosts")}),(0,_.jsx)(Bt.v,{users:o,totalCount:i,size:"md"})]}),(0,_.jsx)(m.Z.TitleMd,{children:a})]})},qt=n(39639),Vt=n(64422),Wt=function(e){var t=e.name,n=e.avatarUrl,r=e.email,o=e.rsvpDate,i=(0,qt.ie)(o,{year:"numeric",month:"short",day:"numeric"});return(0,_.jsxs)("tr",{children:[(0,_.jsxs)("td",{className:"flex items-center pt-6",children:[(0,_.jsx)("div",{className:"mr-4",children:(0,_.jsx)(Vt.s,{name:t,src:n,size:"8"})}),(0,_.jsx)(m.Z.LabelSm,{weight:"semibold",color:"text-dark",children:t})]}),(0,_.jsx)("td",{className:"hidden pt-6 md:[display:revert]",children:(0,_.jsx)(m.Z.LabelSm,{color:"text-light",children:r})}),(0,_.jsx)("td",{className:"pt-6",children:(0,_.jsx)(m.Z.LabelSm,{color:"text-light",children:i})})]})},Qt=function(){return(0,_.jsx)("div",{className:"flex h-64 w-full flex-col items-center justify-center",children:(0,_.jsx)(m.Z.TitleSm,{weight:"semibold",children:(0,u.t)("events.edit_modal.overview.empty_rsvp")})})},$t=function(e){var t=e.event,n=(0,zt.V)(t,y.a.PARTICIPANT,10),r=n.isLoading,o=n.records;return(0,_.jsxs)("div",{className:"border-primary w-full rounded-lg border p-4",children:[(0,_.jsx)(m.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,u.t)("events.edit_modal.overview.latest_rsvps")}),(null===o||void 0===o?void 0:o.length)>0&&(0,_.jsxs)("table",{className:"mt-6 w-full",children:[(0,_.jsxs)("thead",{className:"text-xxs text-light uppercase",children:[(0,_.jsx)("th",{children:(0,u.t)("events.edit_modal.overview.name")}),(0,_.jsx)("th",{className:"hidden md:[display:revert]",children:(0,u.t)("events.edit_modal.overview.email")}),(0,_.jsx)("th",{children:(0,u.t)("events.edit_modal.overview.rsvp_date")})]}),(0,_.jsx)("tbody",{children:o.map((function(e){return(0,_.jsx)(Wt,{name:e.name,avatarUrl:e.avatar_url,email:e.email,rsvpDate:e.rsvp_date},e.id)}))})]}),!r&&!(null!==o&&void 0!==o&&o.length)&&(0,_.jsx)(Qt,{})]})},Gt=n(95132),Jt=n(20640),Kt=n.n(Jt),Yt=n(69647),Xt=function(e){var t=e.label,n=void 0===t?(0,u.t)("share_link.label"):t,r=e.link,o=void 0===r?window.location.href:r,i=(0,Yt.p)().success;return(0,_.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center",onClick:function(){Kt()(o),i((0,u.t)("share_link.copied"),{duration:"short",shouldUseProgress:!1})},children:[(0,_.jsx)(m.Z.LabelSm,{weight:"medium",children:n}),(0,_.jsx)(F.JO,{type:"16-copy",size:16,className:"ml-1","aria-hidden":!0})]})},en=function(e){var t=e.event||{},n=t.slug,r=t.space_slug,o=(0,D.LM)({spaceSlug:r,slug:n}),i="".concat(window.location.origin).concat(o);return(0,_.jsx)(Xt,{label:(0,u.t)("events.edit_modal.overview.copy_url"),link:i})},tn=function(e){var t=e.event||{},n=t.share_uid,r=t.space_slug,o=(0,D.LM)({spaceSlug:r,slug:n}),i="".concat(window.location.origin).concat(o);return(0,_.jsx)(Xt,{label:(0,u.t)("events.edit_modal.overview.copy_public_url"),link:i})},nn=function(e){var t,n,r,o=e.event,i=null===o||void 0===o||null===(t=o.event_setting_attributes)||void 0===t?void 0:t.live_stream_slug,a=null===o||void 0===o||null===(n=o.event_setting_attributes)||void 0===n||null===(r=n.live_stream_room_setting_attributes)||void 0===r?void 0:r.limit_url_sharing,s=D.dE.room({roomSlug:i}),l=window.location.origin,c=(0,Ee.n)().limitUrlSharingEnabled;return i?(0,_.jsxs)("div",{className:"flex",children:[c&&a?null:(0,_.jsx)(Xt,{label:(0,u.t)("events.edit_modal.overview.copy_live_room_url"),link:l+s}),(0,y.L6)(o)&&(0,_.jsx)("div",{className:"ml-3",children:(0,_.jsx)(Xt,{label:(0,u.t)("events.edit_modal.overview.copy_live_stream_url"),link:l+D.dE.publicRoom({roomSlug:i})})})]}):null},rn=function(e){var t=e.event||{},n=t.slug,r=t.space_slug;return(0,_.jsxs)("button",{type:"button",className:"flex items-center",onClick:function(){window.open((0,D.LM)({spaceSlug:r,slug:n}),"_blank")},children:[(0,_.jsx)(m.Z.LabelSm,{weight:"medium",children:(0,u.t)("events.edit_modal.overview.view_event")}),(0,_.jsx)(F.JO,{type:"16-arrow-top-right",size:16,"aria-hidden":!0})]})},on=function(e){var t=e.event,n=function(e){var t,n,r=(0,X.Gc)(),o=r.formState.dirtyFields,i=(0,r.watch)(),a=i.name,s=i.event_setting_attributes,l=(null===o||void 0===o||null===(t=o.event_setting_attributes)||void 0===t?void 0:t.duration_in_seconds)||(null===o||void 0===o||null===(n=o.event_setting_attributes)||void 0===n?void 0:n.starts_at),c=e||{},u=c.event_setting_attributes,d=c.share_post_enabled,m=(null===s||void 0===s?void 0:s.starts_at)||(null===u||void 0===u?void 0:u.starts_at),f=l?(0,we.ZX)(m,null===s||void 0===s?void 0:s.duration_in_seconds):null===u||void 0===u?void 0:u.ends_at,p=null===u||void 0===u?void 0:u.time_zone_abbreviations,v=null===u||void 0===u?void 0:u.time_zone,h=(0,Gt.N)(m,v);return{name:a,startsAt:m,endsAt:f,timeZoneAbbreviations:p,timeZone:v,dayOfMonth:h.dayOfMonth,shortMonthString:h.shortMonthString,sharePostEnabled:d}}(t),r=n.name,o=n.startsAt,a=n.endsAt,s=n.timeZoneAbbreviations,l=n.timeZone,c=n.dayOfMonth,u=n.shortMonthString,d=n.sharePostEnabled;return(0,i.kK)()?null:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(m.Z.TitleXl,{children:r}),(0,_.jsx)("div",{className:"mt-4",children:(0,_.jsxs)("div",{className:"flex items-center",children:[(0,_.jsx)(F.JO,{type:"16-calendar",size:16,className:"mr-3"}),(0,_.jsx)(m.Z.LabelSm,{children:"".concat(u," ").concat(c," \xb7 ").concat((0,qt.Dk)(o,l)," - ").concat((0,qt.Dk)(a,l),"  ").concat(s)})]})}),(0,_.jsxs)("div",{className:"mt-7 flex items-center",children:[(0,_.jsx)("div",{className:"mr-3",children:(0,_.jsx)(rn,{event:t})}),(0,_.jsx)("div",{className:"mr-3",children:(0,_.jsx)(en,{event:t})}),d&&(0,_.jsx)("div",{className:"mr-3",children:(0,_.jsx)(tn,{event:t})}),(0,_.jsx)("div",{className:"mr-3",children:(0,_.jsx)(nn,{event:t})})]})]})},an=function(e){var t=e.event,n=(0,a.eW)().setCurrentSection,r=function(){return n(y.SA.people)};return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(on,{event:t}),(0,_.jsxs)("div",{className:"my-4 flex flex-col items-stretch gap-4 md:my-6 md:flex-row",children:[(0,_.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-3",children:(0,_.jsx)(Ht,{event:t,onClick:r})}),(0,_.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-3",children:(0,_.jsx)(Zt,{event:t,onClick:r})})]}),(0,_.jsx)("div",{className:"mt-4 md:my-6",children:(0,_.jsx)($t,{event:t})})]})},sn=n(62557),ln=n(34334),cn=function(e){var t=function(e){var t=(0,Yt.p)(),n=t.success,r=t.error,o=(0,wt.useMutation)((function(){return ln.S1.downloadCSV({event:e})}),{onSuccess:function(e){return n(null===e||void 0===e?void 0:e.message)},onError:function(){return r((0,u.t)("something_went_wrong"))}}).mutate;return function(e){e.preventDefault(),o()}}(e.event);return(0,_.jsxs)(j.z,{onClick:t,variant:"link",className:"!text-dark !flex !items-center !px-0 !text-sm !font-normal",children:[(0,_.jsx)("span",{className:"mr-2",children:(0,u.t)("events.edit_modal.people.download_csv")}),(0,_.jsx)(F.JO,{type:"download",size:20})]})},un=n(22001),dn=function(){return(0,_.jsx)("div",{className:"mb-4",children:(0,_.jsx)(m.Z.LabelSm,{children:(0,u.t)("events.edit_modal.people.add_attendees_warning_message")})})},mn=function(e,t){var n=(0,Yt.p)(),r=n.success,o=n.error,i=(0,wt.useQueryClient)();return{removeCohostMutation:(0,wt.useMutation)((function(t){return ln.S1.removeAttendeeById({event:e,attendeeId:t,forReactQuery:!0})}),{onSuccess:function(){r((0,u.t)("events.event_attendee_deleted")),i.invalidateQueries("events-people-cohost"),i.invalidateQueries("events-people-participant"),t&&t()},onError:function(){return o((0,u.t)("events.can_not_delete_event_attendee"))}})}},fn=function(e){var t=e.event,n=e.attendeeId,r=e.onRemove,o=e.accessType,i=e.setSelectedAttendeeId,a=e.setShouldShowAttendeeRemovalConfirmation,s=mn(t,r).removeCohostMutation,l="invited"==o||!(0,y.yl)(t),c=l?(0,u.t)("remove_member"):(0,u.t)("manage_attendee");return(0,_.jsx)(Te.Lt,{direction:"bottom-end",className:"flex justify-end",button:(0,_.jsx)(Te.Lt.MenuButton,{className:"invisible w-full group-hover:visible",children:(0,_.jsx)(F.JO,{type:"20-menu-dots-horizontal",size:20,className:"text-dark"})}),children:(0,_.jsx)(Te.Lt.Item,{onClick:function(){return e=n,void(l?s.mutate(e):(i(e),a(!0)));var e},children:(0,_.jsx)(Te.Lt.ItemLink,{type:"button",children:c})})})},pn=n(99663),vn=n(16979),hn=n(82177),bn=function(e){var t=e.isOpen,n=void 0!==t&&t,r=e.onClose,o=e.removeAttendeeMutation,i=e.attendeeId,a=e.charge,s=(null===a||void 0===a?void 0:a.amount_to_refund_raw)>0,l=(0,vn.q)(),c=function(e){o(e),r()},d=function(){c(i)};return(0,_.jsxs)(hn.u_,{title:(0,u.t)("events.rsvp.remove_member_modal.title"),isOpen:n,onClose:r,children:[(0,_.jsx)(hn.u_.Overlay,{}),(0,_.jsxs)(hn.u_.Content,{children:[(0,_.jsxs)(hn.u_.Header,{children:[(0,_.jsx)(hn.u_.Title,{size:"md",className:"text-center",children:(0,u.t)("events.rsvp.remove_member_modal.title")}),(0,_.jsx)(hn.u_.HeaderActions,{children:(0,_.jsx)(hn.u_.CloseButton,{onClick:r})})]}),(0,_.jsx)(hn.u_.Body,{children:(0,_.jsx)("div",{className:"px-6 pb-4 pt-5 text-center",children:(0,_.jsx)(m.Z.BodyMd,{size:"text-sm",children:(0,u.t)("events.rsvp.remove_member_modal.description")})})}),(0,_.jsxs)(hn.u_.Footer,{className:"space-y-2",children:[(0,_.jsx)(j.z,{variant:"secondary",full:!0,large:!0,onClick:function(){return c(i)},className:"h-10",children:(0,u.t)("events.rsvp.remove_member_modal.remove_button")}),s&&(0,_.jsx)(j.z,{variant:"secondary",full:!0,large:!0,onClick:function(){return l.show({charge:a,onSuccess:r})},className:"h-10",children:(0,u.t)("events.rsvp.remove_member_modal.refund_button")}),s&&(0,_.jsx)(j.z,{variant:"danger",full:!0,large:!0,onClick:function(){return l.show({charge:a,onSuccess:d})},className:"h-10",children:(0,u.t)("events.rsvp.remove_member_modal.remove_and_refund_button")}),!s&&(0,_.jsx)(j.z,{variant:"secondary",full:!0,large:!0,onClick:r,className:"h-10",children:(0,u.t)("events.rsvp.remove_member_modal.decline_button")})]})]})]})},gn=n(75336);function yn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return _n(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xn=function(e){var t=e.records,n=e.event,r=e.onChange,o=mn(n,r).removeCohostMutation,i=yn((0,v.useState)(null),2),a=i[0],s=i[1],l=yn((0,v.useState)(!1),2),c=l[0],u=l[1];if(null===t||void 0===t||!t.length)return null;var d=t.find((function(e){return e.id===a})),f=null===d||void 0===d?void 0:d.charge;return(0,_.jsxs)("div",{className:"flex w-full flex-col",children:[(null===t||void 0===t?void 0:t.length)>0&&(0,_.jsx)("hr",{}),null===t||void 0===t?void 0:t.map((function(e){var t,o,i=e.id,a=e.avatar_url,l=e.name,c=e.email,d=e.rsvp_date,f=e.rsvp_status,p=e.public_uid,h=e.access_type;return(0,_.jsxs)(v.Fragment,{children:[(0,_.jsxs)("div",{className:"hover:bg-secondary group flex h-14 items-center rounded-md px-2",children:[(0,_.jsx)("div",{className:"mr-3",children:(0,_.jsx)(pn.o,{member:{name:l,public_uid:p},children:(0,_.jsx)(Vt.s,{src:a,name:l,size:"8"})})}),(0,_.jsx)("div",{className:"w-1/2 shrink-0 md:w-1/3",children:(0,_.jsx)(pn.o,{member:{name:l,public_uid:p},children:(0,_.jsx)(q.Y,{children:(0,_.jsx)(m.Z.LabelSm,{weight:"semibold",children:l})})})}),(0,_.jsx)("div",{className:"hidden w-1/4 shrink-0 md:[display:revert]",children:(0,_.jsx)(q.Y,{children:(0,_.jsx)(m.Z.LabelSm,{children:c})})}),(0,_.jsx)("div",{className:"w-1/2 text-right md:w-1/4",children:(0,_.jsx)(m.Z.LabelSm,{children:(t=d,(0,qt.ie)(t,{day:"numeric",month:"long",year:"numeric",timeZone:o}))})}),(0,_.jsx)("div",{className:"mx-2 flex w-24 shrink-0 justify-end",children:(0,_.jsx)(gn.j,{rsvpStatus:f})}),(0,_.jsx)("div",{className:"flex-1",children:(0,_.jsx)(fn,{event:n,attendeeId:i,onRemove:r,accessType:h,setSelectedAttendeeId:s,setShouldShowAttendeeRemovalConfirmation:u})})]}),(0,_.jsx)("hr",{})]},i)})),(0,y.yl)(n)&&(0,_.jsx)(bn,{isOpen:c,onClose:function(){return u(!1)},removeAttendeeMutation:o.mutate,attendeeId:a,charge:f})]})},jn=n(62261);function wn(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var On=function(e){var t=e.event,n=(0,zt.V)(t,y.a.PARTICIPANT),r=n.records,o=n.refetch,i=n.fetchPrevPage,a=n.fetchNextPage,s=n.hasPrevPage,l=n.hasNextPage,c=n.totalRecordCount,d=n.totalConfirmedRecordCount,f=n.addAttendeesAsync,v=n.startRecordNumber,h=n.endRecordNumber,b=(0,X.Gc)().resetField,g=function(){var e,t=(e=p().mark((function e(t){var n,r,o,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t&&null!==(n=t.spaces_ids)&&void 0!==n&&n.length||null!==t&&void 0!==t&&null!==(r=t.space_groups_ids)&&void 0!==r&&r.length||null!==t&&void 0!==t&&null!==(o=t.member_tags_ids)&&void 0!==o&&o.length||null!==t&&void 0!==t&&null!==(i=t.members_ids)&&void 0!==i&&i.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,f({invited_entities_ids:t});case 5:b("attendee_invite_attributes.invited_entities_ids"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){wn(i,r,o,a,s,"next",e)}function s(e){wn(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,_.jsxs)("div",{className:"flex h-full flex-col items-stretch pt-4",children:[(0,_.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,_.jsx)(m.Z.LabelMd,{weight:"semibold",children:"".concat(d||0," ").concat((0,u.t)("events.edit_modal.people.attendees"))}),(0,_.jsx)(ae,{name:"attendee_invite_attributes.invited_entities_ids",className:"!w-auto",hideLabel:!0,children:(0,_.jsx)(un.lH,{variant:un.ZC.BUTTON,buttonLabel:(0,u.t)("events.edit_modal.people.add_attendees"),selectionLabel:(0,u.t)("events.edit_modal.people.attendees_selection_label"),searchPlaceholder:(0,u.t)("events.edit_modal.people.attendees_placeholder"),modalSaveButtonLabel:(0,u.t)("save"),onModalSave:g,renderAfterSelection:(0,_.jsx)(dn,{}),includeAllResultTypes:!0})})]}),(0,_.jsx)("div",{className:"mt-4"}),(null===r||void 0===r?void 0:r.length)>0&&(0,_.jsx)(xn,{event:t,records:r,fetchNextPage:a,hasNextPage:l,onChange:o}),c>0&&(0,_.jsx)(jn.t,{startRecordNumber:v,endRecordNumber:h,totalRecordCount:c,fetchPrevPage:i,fetchNextPage:a,hasPrevPage:s,hasNextPage:l})]})},Sn=n(93664),Pn=function(e){var t=e.setIsLimitReached,n=e.initialCohostQuantity,r=void 0===n?1:n,o=e.shouldDisplayDisabledSearchMessage,i=void 0!==o&&o,a=((0,Sn.B)().selectionState||{}).memberCount+r||1,s=(0,Ie.oQ)().config,l=null===s||void 0===s?void 0:s.live_stream_max_host_capacity,c=a>=l;return(0,v.useEffect)((function(){l&&(a<=l-Ae.ln?t(!1):t(!0))}),[a,l]),(0,_.jsxs)("div",{className:"mb-4 text-center",children:[(0,_.jsx)("div",{children:(0,_.jsx)(m.Z.LabelSm,{weight:c?"medium":"normal",children:(0,u.t)("live_streams.room.cohosts_counter_message",{count:Math.min(a,l),hostCapacity:l})})}),i&&(0,_.jsx)("div",{children:(0,_.jsx)(m.Z.LabelSm,{children:(0,u.t)("live_streams.room.cohosts_disable_search_message")})})]})};function Cn(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function kn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var In=function(e){var t=e.event,n=kn((0,v.useState)(!1),2),r=n[0],o=n[1],i=(0,zt.V)(t,y.a.COHOST),a=i.records,s=i.refetch,l=i.fetchPrevPage,c=i.fetchNextPage,d=i.hasPrevPage,f=i.hasNextPage,h=i.totalRecordCount,b=i.totalConfirmedRecordCount,g=i.addAttendeesAsync,x=i.startRecordNumber,j=i.endRecordNumber,w=(0,X.Gc)().resetField,O=function(){var e,t=(e=p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t&&t.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,g({community_member_ids:t,role:y.a.COHOST});case 5:w("attendee_invite_attributes.invited_cohost_ids"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Cn(i,r,o,a,s,"next",e)}function s(e){Cn(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),S=function(e){var t=(0,(0,X.Gc)().watch)().event_setting_attributes,n=(e||{}).event_setting_attributes;return{locationType:(null===t||void 0===t?void 0:t.location_type)||(null===n||void 0===n?void 0:n.location_type),formEventData:t,eventData:n}}(t),P=S.locationType,C=r,k=null===a||void 0===a?void 0:a.map((function(e){return e.community_member_id})),N=P===ee.Bq.LIVE_STREAM||P===ee.Bq.LIVE_ROOM;return(0,_.jsxs)("div",{className:"flex h-full flex-col items-stretch pt-4",children:[(0,_.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,_.jsx)(m.Z.LabelMd,{weight:"semibold",children:"".concat(b||0," ").concat((0,u.t)("events.edit_modal.people.cohosts"))}),(0,_.jsx)(ae,{name:"attendee_invite_attributes.invited_cohost_ids",className:"!w-auto",hideLabel:!0,children:(0,_.jsx)(un.lH,{variant:un.ZC.BUTTON,countLabel:(0,u.t)("events.edit_modal.people.cohosts_added_label"),selectionLabel:(0,u.t)("events.edit_modal.people.cohosts_selection_label"),searchPlaceholder:(0,u.t)("events.edit_modal.people.cohosts_placeholder"),disableSearch:C,excludedMemberIds:k,modalSaveButtonLabel:(0,u.t)("save"),allowCurrentCommunityMember:!0,onModalSave:O,renderAfterSelection:N?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(dn,{}),(0,_.jsx)(Pn,{setIsLimitReached:o,initialCohostQuantity:h+Ae.ln,shouldDisplayDisabledSearchMessage:C})]}):(0,_.jsx)(dn,{})})})]}),(0,_.jsx)("div",{className:"mt-4"}),(null===a||void 0===a?void 0:a.length)>0&&(0,_.jsx)(xn,{event:t,records:a,fetchNextPage:c,hasNextPage:f,onChange:s}),h>0&&(0,_.jsx)(jn.t,{startRecordNumber:x,endRecordNumber:j,totalRecordCount:h,fetchPrevPage:l,fetchNextPage:c,hasPrevPage:d,hasNextPage:f})]})},An=function(e){var t=e.event,n=e.currentTab;switch(null===n||void 0===n?void 0:n.key){case y.n4.COHOSTS:return(0,_.jsx)(In,{event:t});case y.n4.ATTENDEES:default:return(0,_.jsx)(On,{event:t})}};function En(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function Tn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Mn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ln=function(e){var t=[{label:(0,u.t)("events.edit_modal.people.attendees"),key:y.n4.ATTENDEES}];e||t.push({label:(0,u.t)("events.edit_modal.people.cohosts"),key:y.n4.COHOSTS});var n=t.find((function(e){return e.label===(0,u.t)("events.edit_modal.people.attendees")})),r=Tn((0,v.useState)(n),2),o=r[0],i=r[1],a=function(){var e,n=(e=p().mark((function e(n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.find((function(e){return e.label===n})),i(r);case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){En(i,r,o,a,s,"next",e)}function s(e){En(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return n.apply(this,arguments)}}();return{tabs:t,currentTab:o,onTabClick:a}},Rn=function(e){var t=e.event,n=(0,y.dy)(t),r=Ln(n),o=r.onTabClick,i=r.currentTab,a=r.tabs,s=(null===i||void 0===i?void 0:i.key)===y.n4.ATTENDEES;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(m.Z.TitleXl,{children:(0,u.t)("events.create.form.people")}),(null===i||void 0===i?void 0:i.label)&&(0,_.jsxs)("div",{className:"relative",children:[(0,_.jsx)(sn.m,{variant:"underline",className:"sticky",wrapperClassName:"overflow-x-auto overflow-y-hidden",controlled:!0,activeTab:i.label,onClick:o,options:a}),s&&(0,_.jsx)("div",{className:"absolute bottom-2 right-0",children:(0,_.jsx)(cn,{event:t})})]}),(0,_.jsx)(An,{event:t,currentTab:i})]})},Dn=n(71069),Fn=function(e){var t,n,r,o=e.event,i=e.triggerValidationRef,s=e.setValueRef,l=e.setIsDirty,c=e.setLocationType,u=e.locationType,d=e.isLiveLocation,m=e.setStartsAtDirty,f=e.setPaywallAttributesDirty,p=(0,a.eW)().currentSection,h=(0,X.Gc)(),b=h.trigger,g=h.setValue,x=h.formState.dirtyFields;(0,v.useEffect)((function(){i&&b&&(i.current=b)}),[i,b]),(0,v.useEffect)((function(){s&&g&&(s.current=g)}),[s,g]);var j=Object.values(x),w=!(null===x||void 0===x||null===(t=x.event_setting_attributes)||void 0===t||!t.starts_at),O=!(null===x||void 0===x||null===(n=x.paywall_attributes)||void 0===n||!n.price_amount)||!(null===x||void 0===x||null===(r=x.paywall_attributes)||void 0===r||!r.description);(0,v.useEffect)((function(){var e=null===j||void 0===j?void 0:j.some((function(e){return!!e}));l(e)}),[l,j]),(0,v.useEffect)((function(){m(w)}),[m,w]),(0,v.useEffect)((function(){f(O)}),[f,O]);var S=(0,Fe.Y)().limitsReachedIsOpen;return(0,_.jsxs)(_.Fragment,{children:[d&&S&&(0,_.jsx)(Dn.l,{roomType:function(){switch(u){case ee.Bq.LIVE_STREAM:return Ae.H0.STREAM;case ee.Bq.LIVE_ROOM:return Ae.H0.CONFERENCE}}()}),(0,_.jsxs)("div",{className:"p-4 md:p-6 lg:py-8",children:[p===y.SA.overview&&(0,_.jsx)(an,{event:o}),p===y.SA.people&&(0,_.jsx)(Rn,{event:o}),p===y.SA.basicInfo&&(0,_.jsx)(ot,{event:o,setLocationType:c}),p===y.SA.details&&(0,_.jsx)(st,{}),p===y.SA.notifications&&(0,_.jsx)(Ut,{event:o}),p===y.SA.email&&(0,_.jsx)(Rt,{event:o}),p===y.SA.advancedOptions&&(0,_.jsx)(ve,{event:o})]})]})},Un=function(e){var t=e.event,n=e.isCreating,r=e.isDirty,o=e.onSubmit,i=e.locationType,s=e.isStartsAtDirty,l=e.shouldHideAllEventOption,c=(0,a.eW)(),d=c.isSaving,m=c.onExit,f=(0,Fe.Y)(),p=f.streamingHoursAvailable,v=f.limitsReachedOnOpen,h=f.recordingHoursReached,b=function(e){e.preventDefault(),v()},g=i===ee.Bq.LIVE_STREAM||i===ee.Bq.LIVE_ROOM;return(0,_.jsx)(_.Fragment,{children:!n&&(0,_.jsxs)("div",{className:"ml-auto flex space-x-4",children:[g&&!p&&h?(0,_.jsxs)("div",{className:"flex justify-start",children:[(0,_.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:b,children:(0,u.t)("live_streams.form.two_upgrades")}),(0,_.jsx)("p",{children:(0,u.t)("live_streams.form.included")})]}):!g||p&&!h?null:(0,_.jsxs)("div",{className:"flex justify-start",children:[(0,_.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:b,children:(0,u.t)("live_streams.form.one_upgrade")}),(0,_.jsx)("p",{children:(0,u.t)("live_streams.form.included")})]}),r&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(j.z,{type:"button",onClick:m,variant:"secondary",children:(0,u.t)("cancel")}),(0,_.jsx)(R,{type:"submit",variant:"circle",disabled:d,onEditModeConfirm:o,isRecurringEvent:(0,y.f0)(t),isStartsAtDirty:s,shouldHideAllEventOption:l,children:t?(0,u.t)("save_changes"):(0,u.t)("save_draft")})]})]})})},Bn=function(){return(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center py-52",children:[(0,_.jsx)("div",{className:"override-svg-width",children:(0,_.jsx)(We.a,{})}),(0,_.jsx)("div",{className:"mb-4 text-center",children:(0,_.jsx)(m.Z.TitleMd,{children:(0,u.t)("events.create_modal.creating_event")})}),(0,_.jsx)("div",{className:"mb-4 text-center",children:(0,_.jsx)(m.Z.LabelMd,{children:(0,u.t)("events.create_modal.creating_event_message")})})]})},zn={strategy:"fixed",modifiers:[{name:"offset",options:{offset:[0,-1]}}]},Hn=function(e){var t,n=e.event,r=function(e){var t,n=e||{},r=n.slug,o=n.space_slug,i=(0,Yt.p)().success,a=(0,D.LM)({spaceSlug:o,slug:r}),s="".concat(window.location.origin).concat(a),l=null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.live_stream_slug,c=D.dE.room({roomSlug:l}),d=window.location.origin;return{onViewEvent:function(){window.open(a,"_blank")},onCopyLink:function(e){Kt()(e),i((0,u.t)("share_link.copied"),{duration:"short",shouldUseProgress:!1})},eventUrl:s,liveRoomUrl:"".concat(d).concat(c),publicLiveRoomUrl:"".concat(d).concat(D.dE.publicRoom({roomSlug:l}))}}(n),o=r.onViewEvent,i=r.onCopyLink,a=r.eventUrl,s=r.liveRoomUrl,l=null===n||void 0===n||null===(t=n.event_setting_attributes)||void 0===t?void 0:t.live_stream_slug,c=window.location.origin+D.dE.publicRoom({roomSlug:l}),m=(0,y.dy)(n)?(0,u.t)("events.edit_modal.overview.copy_live_room_url"):(0,u.t)("events.edit_modal.overview.copy_live_stream_url"),f=(0,y.dy)(n)?s:c,p=[{label:(0,u.t)("events.edit_modal.overview.view_event"),onClick:o,iconName:"16-arrow"},{label:(0,u.t)("events.edit_modal.overview.copy_url"),onClick:function(){return i(a)},iconName:"16-copy"},{label:m,onClick:function(){return i(f)},iconName:"16-copy",disabled:!l}];return(0,_.jsx)(Te.Lt,{size:"medium",direction:"bottom-start",button:(0,_.jsx)(d.h,{name:"16-menu-dots-horizontal",className:"!text-dark",ariaLabel:(0,u.t)("options_dropdown")}),buttonWrapperClassName:"flex items-center ml-4",popperOptions:zn,transitionWrapperClassName:"z-30",dataTestId:"user-profile",children:p.map((function(e){return(0,_.jsx)(v.Fragment,{children:!e.disabled&&(0,_.jsx)(Te.Lt.ItemWithLink,{onClick:e.onClick,children:(0,_.jsxs)("div",{className:"text-dark flex items-center justify-between",children:[e.label,(0,_.jsx)(F.JO,{size:16,type:e.iconName,className:"text-dark"})]})})},e.label)}))})},Zn=function(e){var t,n,r,o,i,s,l,c,d,f,p=e.validateAndSetCurrentSection,v=e.event,h=e.isEditMode,b=e.title,g=(0,a.eW)(),x=g.sections,j=g.setCurrentSection,w=g.currentSection,O=x.filter((function(e){return e!==y.SA.overview})).map((function(e){return{value:e,label:e}})),S=(0,y.s9)(v)?(0,u.t)("events.badge_status.published"):(0,u.t)("events.badge_status.draft"),P=null===v||void 0===v||null===(t=v.event_setting_attributes)||void 0===t?void 0:t.starts_at,C=(0,we.ZX)(P,(null===v||void 0===v||null===(n=v.event_setting_attributes)||void 0===n?void 0:n.duration_in_seconds)||3600),k=w===y.SA.overview,N=(0,Gt.N)(P,null===v||void 0===v||null===(r=v.event_setting_attributes)||void 0===r?void 0:r.time_zone),I=N.dayOfMonth,A=N.shortMonthString,E=null===v||void 0===v||null===(o=v.event_setting_attributes)||void 0===o?void 0:o.time_zone_abbreviations,T="".concat(null!==(i=null===I||void 0===I?void 0:I.toString())&&void 0!==i?i:""," ").concat(null!==A&&void 0!==A?A:""," ").concat((0,qt.Dk)(null!==P&&void 0!==P?P:(new Date).toISOString(),null!==(s=null===v||void 0===v||null===(l=v.event_setting_attributes)||void 0===l?void 0:l.time_zone)&&void 0!==s?s:"")," - ").concat((0,qt.Dk)(null!==(c=C.toISOString())&&void 0!==c?c:(new Date).toISOString(),null!==(d=null===v||void 0===v||null===(f=v.event_setting_attributes)||void 0===f?void 0:f.time_zone)&&void 0!==d?d:""),",").concat(null!==E&&void 0!==E?E:"");return k?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"mb-4 mt-5 flex flex-col gap-2 px-5",children:[(0,_.jsxs)("div",{className:"flex w-full items-center justify-between",children:[h&&(0,_.jsx)(Z.g,{label:S}),(0,_.jsx)(Hn,{event:v})]}),(0,_.jsx)(m.Z.TitleSm,{truncate:!0,weight:"semibold",children:b}),(0,_.jsx)(m.Z.LabelSm,{weight:"font-semibold",children:T})]}),(0,_.jsx)("div",{className:"flex flex-col px-5",children:O.map((function(e){return(0,_.jsxs)("button",{type:"button",className:"border-b-primary text-default flex items-center justify-between border-b py-3 text-sm",onClick:function(){return t=e.value,void p(t,j);var t},children:[e.label,(0,_.jsx)(F.JO,{size:16,type:"16-chevron-right",className:"text-default h-4 w-4"})]},e.label)}))})]}):null},qn=n(12114);function Vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vn(Object(n),!0).forEach((function(t){Qn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $n=n(24185),Gn=n(27034);function Jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jn(Object(n),!0).forEach((function(t){Yn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xn(Object(n),!0).forEach((function(t){tr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nr(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function rr(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){nr(i,r,o,a,s,"next",e)}function s(e){nr(i,r,o,a,s,"throw",e)}a(void 0)}))}}var or="force_dirty",ir=function(e){var t=e.onClose,n=e.event,r=e.isDirty,o=e.isEditMode,i=e.setEvent,a=e.shouldClearEventStateOnHide,s=e.onEventChange,l=e.isLiveLocation,c=(0,$n.k6)(),d=(0,Yt.p)(),m=d.success,f=d.error,h=(0,Gn.q)(),b=(0,$n.TH)().pathname,g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,wt.useMutation)((function(t){return e?ln.S1.update({event:e,formData:Kn(Kn({},t),{},{event_type:e.event_type}),forReactQuery:!0}):ln.S1.create({formData:t,forReactQuery:!0})}))}(n),_=!n&&g.isLoading,x=(0,v.useRef)(null),j=(0,v.useRef)(),w=(0,Fe.Y)(),O=w.purchaseRecordingsAddonWhenLimitReached,S=w.purchaseStreamingAddonWhenLimitReached,P=w.shouldUpgradeAddons,C="/events"===b,k=function(){var e=rr(p().mark((function e(t,r){var i,a,s,l,c,u,d,m,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.reset,e.prev=1,c=null===n||void 0===n?void 0:n.event_type,o?delete t[or]:(u=t.recurring_setting_attributes.frequency,c=u?y.E_.RECURRING:y.E_.SINGLE),(o?null===t||void 0===t||null===(a=t.paywall_attributes)||void 0===a?void 0:a.price_amount:(0,y.yl)(t))&&(d=t.paywall_attributes.price_amount,m=(0,Qe.LG)(d),t.paywall_attributes.price_amount=m),!o&&(null===t||void 0===t||null===(s=t.event_setting_attributes)||void 0===s?void 0:s.ticket_type)==y.Mj.PAID&&[y.Bq.LIVE_ROOM,y.Bq.LIVE_STREAM].includes(null===t||void 0===t||null===(l=t.event_setting_attributes)||void 0===l?void 0:l.location_type)&&(t.event_setting_attributes.live_stream_room_setting_attributes.access_type=Ae._d.SECRET),e.next=9,N();case 9:f={onSuccess:function(e){return I(e,i)},onError:M},g.mutate(er(er({},t),{},{event_type:c}),f),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),L(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=rr(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l||!P){e.next=6;break}return e.next=3,O();case 3:return e.next=5,S();case 5:m((0,u.t)("settings.billing.add_ons.changes_succeeded"));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(e,r){var o=n?(0,u.t)("events.saved_successfully"):(0,u.t)("events.created_successfully");m(o),h({shouldInvalidateAllEvents:C}),C&&s(n),A(e)?(t(),i(null),E(e)):T(e,r)},A=function(e){return(null===n||void 0===n?void 0:n.status)===y.Q_.DRAFT&&(null===e||void 0===e?void 0:e.status)===y.Q_.PUBLISHED},E=function(e){c.push(D.xu.show({spaceSlug:e.space_slug,slug:e.slug}))},T=function(e,t){t(er(er({},e),{},{body:e.body_for_editor})),i(e)},M=function(){var e=n?(0,u.t)("events.save_error"):(0,u.t)("events.create_error");f(e)},L=function(e){e instanceof Error&&console.error(e.message)},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.HA.CURRENT;x.current&&j.current&&(x.current("recurring_setting_attributes.edit_mode",e,{shouldDirty:!0}),x.current(or,!0,{shouldDirty:!0}),j.current())};return{handleClose:function(){r&&!confirm((0,u.t)("events.edit_modal.close_warning"))||(t(),a&&i(null))},onSubmit:k,onSave:R,onPublish:function(e){x.current&&x.current("status",y.Q_.PUBLISHED,{shouldDirty:!0}),R(e)},isCreating:_,setValueRef:x,triggerFormSubmitRef:j,mutation:g}};function ar(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return sr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lr=function(e){var t,n=e.onClose,r=e.event,o=e.spaceId,i=e.locationType,a=e.shouldClearEventStateOnHide,s=void 0!==a&&a,l=ar((0,v.useState)(r),2),c=l[0],d=l[1],m=!!r&&(0,we.aA)(null===(t=r.event_setting_attributes)||void 0===t?void 0:t.ends_at),f=(0,qn.vk)({params:{past_events:m}}).onEventChange;(0,v.useEffect)((function(){d(r)}),[r]);var p=!!c,h=p?c.name:(0,u.t)("events.create.title"),b=function(e,t,n){var r=(0,be.wh)(),o=r.currentUser,i=r.currentCommunity,a=(0,ge.m)().spaces.find((function(n){return n.id===(t||(null===e||void 0===e?void 0:e.space_id))}))||null,s=["private","secret"].includes(null===a||void 0===a?void 0:a.visibility),l=(0,we.TP)(new Date),c=(0,we.ZX)(l,3600);return e?Wn(Wn({},e),{},{body:e.body_for_editor,attendee_invite_attributes:{invited_entities_ids:null}}):{user_id:null===o||void 0===o?void 0:o.id,space_id:t,event_type:y.E_.SINGLE,status:y.Q_.DRAFT,event_setting_attributes:{auto_rsvp_invited_attendees:(null===a||void 0===a?void 0:a.event_auto_rsvp_enabled)||!1,location_type:n,starts_at:l.toUTCString(),ends_at:c.toUTCString(),duration_in_seconds:3600,live_stream_room_setting_attributes:{access_type:s?Ae._d.SECRET:Ae._d.OPEN,view_type:Ae.Bk.GRID,recording_enabled:i.live_stream_recording_enabled,auto_post_recording_enabled:i.live_stream_auto_post_recording_enabled,room_type:Ae.H0.STREAM,mute_on_join:!1,hide_participants_list:!1,limit_url_sharing:!1},send_email_confirmation:!0,send_in_app_notification_confirmation:!0,send_email_reminder:!0,send_in_app_notification_reminder:!0,send_publish_email:!0,ticket_type:y.Mj.FREE},recurring_setting_attributes:{range_type:y.pd.ON,occurrences:null,ends_at:c.toUTCString()}}}(c,o,i),_=ar((0,v.useState)(!1),2),x=_[0],j=_[1],w=ar((0,v.useState)(!1),2),O=w[0],S=w[1],P=ar((0,v.useState)(!1),2),C=P[0],k=P[1],N=ar((0,v.useState)(i),2),I=N[0],A=N[1],E=g(),T=E.triggerValidationRef,M=E.validateAndSetCurrentSection,L=I===ee.Bq.LIVE_STREAM||I===ee.Bq.LIVE_ROOM,R=(0,y.f0)(c)&&C,D=ir({onClose:n,event:c,isDirty:x,isEditMode:p,setEvent:d,shouldClearEventStateOnHide:s,onEventChange:f,isLiveLocation:L}),F=D.handleClose,U=D.onSubmit,B=D.onSave,z=D.onPublish,H=D.setValueRef,Z=D.triggerFormSubmitRef,q=D.mutation;return{event:c,isEditMode:p,isCreating:D.isCreating,isDirty:x,isStartsAtDirty:O,locationType:I,setLocationType:A,isLiveLocation:L,handleClose:F,onSubmit:U,onSave:B,onPublish:z,setValueRef:H,triggerFormSubmitRef:Z,triggerValidationRef:T,validateAndSetCurrentSection:M,formDefaultValues:b,title:h,mutation:q,setIsDirty:j,setStartsAtDirty:S,shouldHideAllEventOption:R,setPaywallAttributesDirty:k}},cr=function(e){var t=e.isOpen,n=e.onClose,r=e.event,u=e.spaceId,d=e.locationType,m=e.shouldClearEventStateOnHide,f=void 0!==m&&m,p=e.initialSection,v=void 0===p?y.SA.basicInfo:p,h=lr({spaceId:u,event:r,shouldClearEventStateOnHide:f,locationType:d,onClose:n}),b=h.event,g=h.isEditMode,x=h.isCreating,j=h.isDirty,w=h.isStartsAtDirty,O=h.locationType,S=h.setLocationType,P=h.setValueRef,C=h.triggerFormSubmitRef,k=h.formDefaultValues,N=h.title,I=h.handleClose,A=h.onSubmit,E=h.onSave,T=h.onPublish,M=h.validateAndSetCurrentSection,L=h.triggerValidationRef,R=h.setIsDirty,D=h.setStartsAtDirty,F=h.mutation,U=h.isLiveLocation,z=h.setPaywallAttributesDirty,H=h.shouldHideAllEventOption,Z=(0,i.kK)();return(0,_.jsxs)(_.Fragment,{children:[!Z&&(0,_.jsx)(l.o,{onClick:I,className:"z-[1100]",isVisible:t}),(0,_.jsx)(s.x,{isOpen:t,shouldShowCloseButton:!1,contentPortalId:"events",children:(0,_.jsxs)(a.MW,{formId:"events",sections:Object.values(y.SA),initialSection:Z&&g?y.SA.overview:v,title:N,onExit:I,onSave:A,isSaving:F.isLoading,children:[(0,_.jsx)(s.x.Header,{className:o()("!px-5 !py-3 md:!px-6 md:!py-5",{"!border-0":x}),children:(0,_.jsx)(Y,{isEditMode:g,isCreating:x,event:b,onPublish:T,handleClose:I,validateAndSetCurrentSection:M})}),(0,_.jsxs)(s.x.Body,{children:[Z&&(0,_.jsx)(Zn,{validateAndSetCurrentSection:M,event:r,isEditMode:g,title:N}),(0,_.jsxs)(c.l,{id:"events",onSubmit:A,passThroughProps:{onCancel:I},defaultValues:k,triggerFormSubmitRef:C,submitDirtyOnly:g,children:[!x&&(0,_.jsx)(Fn,{event:b,triggerValidationRef:L,setValueRef:P,setIsDirty:R,setLocationType:S,locationType:O,isLiveLocation:U,setStartsAtDirty:D,setPaywallAttributesDirty:z}),x&&(0,_.jsx)(Bn,{}),Z&&(0,_.jsx)(B,{event:b,isEditMode:g,onPublish:T})]})]}),(0,_.jsx)(s.x.Footer,{className:o()({"!border-0 !p-0":x||!j}),children:(0,_.jsx)(Un,{event:b,isCreating:x,isDirty:j,onSubmit:E,locationType:O,isStartsAtDirty:w,shouldHideAllEventOption:H})})]})})]})}},92385:(e,t,n)=>{n.d(t,{I:()=>d});var r=n(94184),o=n.n(r),i=n(85893),a=["label","value","placeholder","error","disabled","leftAddon","rightAddon"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=function(e){var t=e.label,n=e.value,r=e.placeholder,s=e.error,c=e.disabled,d=e.leftAddon,m=e.rightAddon,f=u(e,a);return(0,i.jsxs)("div",{children:[t&&(0,i.jsx)("div",{className:"text-sm font-semibold",children:t}),(0,i.jsxs)("div",{className:"mt-2 flex w-full",children:[d&&(0,i.jsx)("div",{className:o()({"cursor-not-allowed bg-gray-50":c},"flex h-11 items-center rounded-l-lg border border-gray-300 bg-white px-4 py-3"),children:d}),(0,i.jsx)("input",l({className:o()({"border-red-600 focus:border-red-600":s,"border-primary bg-secondary text-light cursor-not-allowed":c,"text-dark border-gray-400":!c,"rounded-l-none":d,"rounded-r-none":m},"placeholder:text-light h-11 grow rounded-lg border border-solid px-4 py-3 outline-none placeholder:opacity-100 focus:border-2 focus:border-gray-500"),value:n,placeholder:r,disabled:c},f)),m&&(0,i.jsx)("div",{className:o()({"border-primary bg-secondary text-light cursor-not-allowed":c},"bg-primary border-primary text-dark ml-[-1px] flex h-11 items-center rounded-r-lg border px-4 py-3"),children:m})]}),s&&(0,i.jsx)("div",{className:"mt-2 text-sm text-red-600",children:s})]})}},86732:(e,t,n)=>{n.d(t,{x:()=>p});var r=n(86215),o=n(96486),i=n(73935),a=n(41320),s=n(43760),l=n(85893),c=["position","children"];function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=function(e){var t=e.position,n=void 0===t?"header":t,u=e.children,m=f(e,c),p=(0,a.x)(),v=p.shouldShowRailBar,h=void 0===v||v,b=p.toggleShowRailBar,g=void 0===b?o.noop:b,y="#rail-bar-".concat(n),_=document.querySelector(y);return _?(0,l.jsx)(l.Fragment,{children:(0,i.createPortal)((0,l.jsx)(r.J,{children:(0,l.jsx)(r.J.Panel,{as:"div",static:h,children:(0,l.jsx)(s.S0,d(d({toggleShowRailBar:g},m),{},{children:u}))})}),_)}):null}},41793:(e,t,n)=>{n.d(t,{k:()=>v});var r=n(67294),o=n(86013),i=n.n(o),a=n(39068),s=n(58837),l=n(73890),c=n(3852),u=n(20758),d=n(79016),m=n(98338),f=n(39639),p=n(54030),v=function(){var e,t=(0,m.wh)(),n=t.currentCommunity,o=t.currentCommunityMember,v=t.currentCommunitySettings,h=(0,d.E)(),b=h.isCommunityOnTrial,g=h.canChooseCurrency,y=h.defaultCurrency,_=h.currentPlanInterval,x=h.isCommunityOnEnterprise,j=h.isCommunityOnPlus,w=(0,p.BT)(),O=(e=window.location.pathname,(0,r.useMemo)((function(){return/^\/settings\/workflows\/(\d+|new|edit|view)(\/.*)?$/.test(e)&&!/^\/settings\/workflows(\?|$)/.test(e)}),[e])),S=(0,r.useMemo)((function(){return window.location.pathname.startsWith("/communities/new")}),[window.location]),P="pt"===(0,c.cm)()&&b&&(g||"brl"===y),C=(0,r.useMemo)((function(){return/^\/communities\/\d+\/questions\/?$/.test(window.location.pathname)}),[window.location]),k=(0,r.useMemo)((function(){return/^\/communities\/\d+\/templates\/?$/.test(window.location.pathname)}),[window.location]),N=(0,r.useMemo)((function(){return null!==n&&void 0!==n&&n.trial_ends_at?(0,f.ie)(n.trial_ends_at,{day:"2-digit",month:"2-digit"}):""}),[n]),I=(0,r.useMemo)((function(){return null!==n&&void 0!==n&&n.trial_ends_at?(0,l.TF)(n.trial_ends_at):""}),[n]),A=(0,r.useMemo)((function(){var e=(0,s.eC)(new Date,new Date(null===n||void 0===n?void 0:n.trial_ends_at));return e<=1?"1 ".concat(i().t("trial_banner.day")):"".concat(e," ").concat(i().t("trial_banner.days"))}),[n]),E=(0,r.useMemo)((function(){return!b&&(!(null===n||void 0===n||!n.subscription)&&Boolean(n.subscription.cancelled))}),[n,b]),T=(0,r.useMemo)((function(){return!(null===n||void 0===n||!n.promotion_enabled)}),[n]),M=(0,r.useMemo)((function(){return x&&(0,u.pE)(_)}),[x,_]),L=(0,r.useMemo)((function(){var e=(0,a.vb)(o),t=null===v||void 0===v?void 0:v.hide_trial_banner;return Boolean(e&&!M&&!j&&!S&&!C&&!k&&!t&&!w&&!T&&!O)}),[n,o,b,E,w,O,M]),R=document.getElementById("trial-banner"),D=Boolean(R);return{trialEndsInWords:I,trialDaysRemainingInWords:A,trialEndDateFormatted:N,isSubscriptionCancelled:E,shouldSeeBrazilTrialBanner:P,isCommunityOnTrial:b,shouldShowTrialBanner:L,isTrialBannerExists:D}}},22797:(e,t,n)=>{n.d(t,{i:()=>u});var r=n(94184),o=n.n(r),i=n(51024),a=n(38503),s=n(8246),l=n(64422),c=n(85893),u=function(e){var t=e.avatarUrl,n=e.name,r=e.progress,u=void 0===r?0:r,d=e.level,m=e.size,f=void 0===m?"large":m,p=(0,a.TC)().isDarkAppearance?"#42464D":"#F0F3F5",v="large"===f?104:64,h=(v-4)/2,b=2*Math.PI*h,g=b-u/100*b,y=(0,i.O)(d||1);return(0,c.jsxs)("div",{className:"relative flex items-center justify-center rounded-full",style:{height:v,width:v},children:[(0,c.jsxs)("svg",{className:"absolute",width:v,height:v,style:{transform:"rotate(-90deg)"},children:[(0,c.jsx)("circle",{cx:v/2,cy:v/2,r:h,stroke:p,strokeWidth:4,fill:"none"}),(0,c.jsx)("circle",{cx:v/2,cy:v/2,r:h,stroke:y.progress,strokeWidth:4,fill:"none",strokeDasharray:b,strokeDashoffset:g,strokeLinecap:"round"})]}),(0,c.jsx)("div",{className:"bg-secondary absolute z-0 rounded-full",style:{height:v-8,width:v-8},children:(0,c.jsx)(l.s,{isFullRounded:!0,src:t,name:n,size:"large"===f?"24":"14"})}),d&&(0,c.jsx)("div",{className:o()("absolute -bottom-1 -right-1 z-10 flex items-center justify-center rounded-full",{"h-8 w-8":"large"===f,"h-6 w-6":"small"===f},y.bg),children:(0,c.jsx)(s.Z.LabelSm,{weight:"bold",children:(0,c.jsx)("span",{className:y.text,children:d})})})]})}},29043:(e,t,n)=>{n.d(t,{U:()=>c});var r=n(94184),o=n.n(r),i=n(51024),a=n(42991),s=n(8246),l=n(85893),c=function(e){var t=e.level,n=e.levelName,r=(0,i.O)(t);return(0,l.jsxs)("div",{className:o()("mb-2 inline-flex items-center space-x-3 rounded-full px-3 py-1",r.bg,r.text),children:[(0,l.jsxs)(s.Z.LabelSm,{weight:"semibold",color:"text-inherit",children:[(0,l.jsx)("span",{className:"mr-2",children:(0,a.t)("leaderboard.trophy_emoji")}),(0,a.t)("leaderboard.level_number_only",{level:t})]}),(0,l.jsx)("div",{className:o()("h-3 w-px rounded-md",r.divider)}),(0,l.jsx)(s.Z.LabelSm,{weight:"semibold",color:"text-inherit",children:n||(0,a.t)("leaderboard.level_n",{level:t})})]})}},2469:(e,t,n)=>{n.d(t,{k:()=>g});var r=n(86013),o=n(11049),i=n(94184),a=n.n(i),s=n(96486),l=n(51024),c=n(62618),u=n(8246),d=n(85893),m=function(e){var t=e.level,n=e.levelName,o=e.pointsRequired,i=(0,l.O)(t);return(0,d.jsx)("div",{className:"flex flex-col items-center space-y-4 md:flex-row md:space-y-0",children:(0,d.jsxs)("div",{children:[(0,d.jsx)(u.Z.LabelSm,{weight:"semibold",children:(0,d.jsx)("div",{className:a()(i.text),children:n||(0,r.t)("leaderboard.level_n",{level:t})})}),(0,s.isNumber)(o)&&(0,d.jsx)(u.Z.LabelXs,{weight:"regular",children:(0,d.jsx)("div",{className:"text-default",children:(0,r.t)("leaderboard.n_points_required",{count:(0,c.HA)(o)})})})]})})},f=n(75715),p=n(75357),v=n(82177),h=function(){var e,t=(0,o.dd)(),n=(0,f.c8)().data,i=(0,p.S)();return(0,d.jsxs)(v.u_,{title:(0,r.t)("leaderboard.points_info.title"),isOpen:t.visible,onClose:t.hide,children:[(0,d.jsx)(v.u_.Overlay,{}),(0,d.jsxs)(v.u_.Content,{children:[(0,d.jsxs)(v.u_.Header,{children:[(0,d.jsx)(v.u_.Title,{size:"sm",children:(0,d.jsx)(u.Z.LabelLg,{weight:"semibold",children:(0,r.t)("leaderboard.points_info.title")})}),(0,d.jsx)(v.u_.HeaderActions,{children:(0,d.jsx)(v.u_.CloseButton,{onClick:t.hide})})]}),(0,d.jsxs)(v.u_.Body,{className:"pb-6 pt-4",children:[(0,d.jsxs)("div",{className:"mb-[18px] space-y-1",children:[(0,d.jsx)(u.Z.LabelMd,{weight:"semibold",children:(0,d.jsx)("span",{className:"text-darkest",children:(0,r.t)("leaderboard.points_info.like_to_point.title")})}),(0,d.jsx)(u.Z.BodyMd,{children:(0,d.jsx)("div",{className:"text-very-dark",children:(0,r.t)("leaderboard.points_info.like_to_point.description")})})]}),i&&(0,d.jsxs)("div",{className:"mb-[18px] space-y-1",children:[(0,d.jsx)(u.Z.LabelMd,{weight:"semibold",children:(0,d.jsx)("span",{className:"text-darkest",children:(0,r.t)("leaderboard.points_info.rewards.title")})}),(0,d.jsx)(u.Z.BodyMd,{children:(0,d.jsx)("div",{className:"text-very-dark",children:(0,r.t)("leaderboard.points_info.rewards.description")})})]}),(0,d.jsxs)("div",{className:"mb-[27px] space-y-1",children:[(0,d.jsx)(u.Z.LabelMd,{weight:"semibold",children:(0,d.jsx)("span",{className:"text-darkest",children:(0,r.t)("leaderboard.points_info.levels.title")})}),(0,d.jsx)(u.Z.BodyMd,{children:(0,d.jsx)("span",{className:"text-very-dark",children:(0,r.t)("leaderboard.points_info.levels.description")})})]}),(0,d.jsx)("div",{className:"grid grid-flow-col-dense grid-rows-3 gap-5",children:null===n||void 0===n||null===(e=n.levels)||void 0===e?void 0:e.map((function(e){var t=e.level,n=e.name,r=e.points_required;return(0,d.jsx)(m,{level:t,levelName:n,pointsRequired:r},t)}))})]})]})]})};h.displayName="PointsInfoModalComponent";var b=o.gk.create((function(){return(0,d.jsx)(h,{})}));b.displayName="PointsInfoModal";var g=function(){return(0,o.dd)(b)}},51024:(e,t,n)=>{n.d(t,{O:()=>l});var r=n(38503),o={light:{basic:"bg-[#F8EFDD] text-[#D69B29]",mid:"bg-[#EAEDFD] text-[#506CF0]",pro:"bg-[#F5ECFC] text-[#AC61E7]"},dark:{basic:"bg-[#443E32] text-[#E2AB40]",mid:"bg-[#31374E] text-[#7A91FD]",pro:"bg-[#3E354D] text-[#CF93FF]"}},i={light:{basic:"text-[#D69B29]",mid:"text-[#506CF0]",pro:"text-[#AC61E7]"},dark:{basic:"text-[#E2AB40]",mid:"text-[#7A91FD]",pro:"text-[#CF93FF]"}},a={light:{basic:"bg-[#F4E3C1]",mid:"bg-[#D1D8FB]",pro:"bg-[#E9D6F9]"},dark:{basic:"bg-[#6C624E]",mid:"bg-[#4D577B]",pro:"bg-[#5D4278]"}},s={light:{basic:"#D69B29",mid:"#506CF0",pro:"#AC61E7"},dark:{basic:"#E2AB40",mid:"#7A91FD",pro:"#CF93FF"}},l=function(e){var t=(0,r.TC)().isDarkAppearance,n=function(e){return e?e<=3?"basic":e<=6?"mid":"pro":"basic"}(e),l=t?"dark":"light";return{bg:o[l][n],text:i[l][n],divider:a[l][n],progress:s[l][n]}}},79090:(e,t,n)=>{n.d(t,{K:()=>b,Y:()=>g});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(28736),l=n(34713),c=n(98338),u=n(39068),d=n(85893);function m(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){m(i,r,o,a,s,"next",e)}function s(e){m(i,r,o,a,s,"throw",e)}a(void 0)}))}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=(0,i.createContext)({streamingHoursAvailable:!1,recordingHoursReached:!1,totalStreamingHours:0,totalRecordingHours:0,limitsReachedIsOpen:!1,limitsReachedOnClose:a.noop,setRecordingEnabled:a.noop,recordingEnabled:!1,limitsReachedOnOpen:a.noop,shouldUpgradeAddons:!1,purchaseRecordingsAddonWhenLimitReached:function(){return Promise.resolve()},purchaseStreamingAddonWhenLimitReached:function(){return Promise.resolve()}});h.displayName="AddonsContext";var b=function(e){var t=e.children,n=(0,c.wh)().currentCommunityMember,r=(0,u.vb)(n),m=(0,s.tm)({enabled:r}),v=m.streamingHoursAvailable,b=m.recordingHoursAvailable,g=m.streamingTotalPlanHours,y=m.recordingTotalPlanHours,_=m.isLoading,x=(0,l.h)(),j=x.recordingEnabled,w=x.setRecordingEnabled,O=void 0===w?a.noop:w,S=!_&&j&&!b,P=(0,s.$v)(null,{enabled:r}),C=P.purchaseAsync,k=P.currentQuantity,N=P.unitSize,I=(0,s.Yq)(null,{enabled:r}),A=I.purchaseAsync,E=I.currentQuantity,T=I.unitSize,M=Number(g)+Number(k),L=Number(y)+Number(E),R=p((0,i.useState)(!1),2),D=R[0],F=R[1];(0,i.useEffect)((function(){F(!_&&(!v||S))}),[_,v,S]);var U=!v||S,B=function(){var e=f(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}return e.abrupt("return");case 2:if(!b){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,A(T);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=f(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,C(N);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H={streamingHoursAvailable:v,recordingHoursReached:S,totalStreamingHours:M,totalRecordingHours:L,limitsReachedIsOpen:D,limitsReachedOnClose:function(){F(!1)},setRecordingEnabled:O,recordingEnabled:j,limitsReachedOnOpen:function(){F(!0)},shouldUpgradeAddons:U,purchaseRecordingsAddonWhenLimitReached:B,purchaseStreamingAddonWhenLimitReached:z};return(0,d.jsx)(h.Provider,{value:H,children:t})},g=function(){var e=(0,i.useContext)(h);if(void 0===e)throw new Error("useAddonsContext must be used within a AddonsProvider");return e}},58356:(e,t,n)=>{n.d(t,{WP:()=>ye,uT:()=>de,$_:()=>v,xJ:()=>be,h4:()=>s,bW:()=>_e});var r=n(86013),o=n(31611),i=n(8246),a=n(85893),s=function(){return(0,a.jsx)(o.h4.Actions,{children:(0,a.jsx)(i.Z.TitleSm,{weight:"semibold",children:(0,r.t)("live_streams.form.title_v3")})})},l=n(34398),c=n(79181),u=n(38313),d=n(85239),m=n(81786),f=n(79090),p=n(90146),v=function(e){var t=e.roomType,n=e.validateAndContinue,s=function(e){var t=(0,p.qj)(e).sectionTitles,n=(0,o.eW)(),r=n.currentSection,i=n.setCurrentSection,a=n.formId,s=n.isSaving,l=n.onExit,c=n.onSave,u=t.indexOf(r),d=u+1,m=(null===t||void 0===t?void 0:t.length)||0;return{formId:a,isSaving:s,currentStep:d,totalSteps:m,isFirstStep:1===d,isLastStep:d===m,next:function(){u!==m-1&&i(t[u+1])},prev:function(){0!==u&&i(t[u-1])},onSave:c,onExit:l}}(t),v=s.formId,h=s.isSaving,b=s.currentStep,g=s.totalSteps,y=s.isFirstStep,_=s.isLastStep,x=s.next,j=s.prev,w=s.onExit,O=(0,u.Z)(),S=(0,f.Y)(),P=S.streamingHoursAvailable,C=S.recordingHoursReached,k=S.limitsReachedOnOpen,N=function(e){e.preventDefault(),k()};return(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsx)(i.Z.TitleSm,{weight:"semibold",color:"text-gray-800",children:(0,r.t)("live_streams.form.step",{currentStep:b,totalSteps:g})}),(0,a.jsxs)("div",{className:"flex items-center gap-5",children:[b===c.nw&&!P&&C?(0,a.jsxs)("div",{className:"flex justify-start",children:[(0,a.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:N,children:(0,r.t)("live_streams.form.two_upgrades")}),(0,a.jsx)("p",{children:(0,r.t)("live_streams.form.included")})]}):b!==c.nw||P&&!C?null:(0,a.jsxs)("div",{className:"flex justify-start",children:[(0,a.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:N,children:(0,r.t)("live_streams.form.one_upgrade")}),(0,a.jsx)("p",{children:(0,r.t)("live_streams.form.included")})]}),y&&(0,a.jsx)(m.z,{onClick:w,variant:"secondary",children:(0,r.t)("live_streams.form.cancel")}),!y&&(0,a.jsx)(m.z,{onClick:j,type:"button",variant:"secondary",children:(0,r.t)("live_streams.form.prev")}),!_&&(0,a.jsx)(m.z,{onClick:function(){t==d.H0.EVENT?(w(),O.show({locationType:l.Bq.LIVE_STREAM})):n(x)},type:"button",variant:"circle",className:"border-darkest border",children:(0,r.t)("live_streams.form.next")}),_&&(0,a.jsx)(m.z,{form:v,disabled:h,type:"submit",variant:"circle",className:"border-darkest border",children:(0,r.t)("live_streams.form.submit_button_label")})]})]})},h=n(67294),b=n(94184),g=n.n(b),y=n(87536),_=n(67687),x=["appendTranslationRoot","children"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var P=function(e){var t=e.appendTranslationRoot,n=void 0===t?"":t,r=e.children,o=S(e,x);return(0,a.jsx)(_.l.Item,w(w({hideBorder:!0,fullWidth:!0,hideDescription:!0,translationRoot:n?"live_streams.form.".concat(n):"live_streams.form"},o),{},{children:r}))},C=n(28736),k=n(98338),N=n(39068),I=n(18605),A=function(e){var t=e.iconType,n=e.text;return(0,a.jsx)("li",{className:"list-none",children:(0,a.jsxs)("div",{className:"flex items-start gap-2.5 text-left",children:[(0,a.jsx)("span",{className:"mt-0.5 flex w-4",children:(0,a.jsx)(I.JO,{size:16,type:t})}),(0,a.jsx)(i.Z.LabelSm,{children:n})]})})},E=function(e){var t=e.title,n=e.onClick,r=e.isSelected,o=e.disabled,s=e.children;return(0,a.jsxs)("button",{type:"button",className:g()("order-none box-border flex h-full cursor-pointer flex-col items-stretch gap-2 rounded-lg border border-solid p-6 pt-5",{"bg-tertiary border-tertiary":r,"pointer-events-none cursor-not-allowed opacity-70":o}),onClick:function(){o||n()},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(i.Z.LabelLg,{weight:"semibold",children:t}),(0,a.jsx)("div",{className:"text-dark",children:(0,a.jsx)(I.JO,{type:r?"circle-checked":"circle-unchecked",size:16})})]}),s&&(0,a.jsx)("div",{className:"mt-1",children:s})]})},T=function(e){var t=e.onChange,n=e.value,o=e.liveStreamConfig,i=e.shouldDisableEventOption,s=(0,k.wh)().currentCommunityMember,l=(0,N.vb)(s),c=null===o||void 0===o?void 0:o.live_stream_max_host_capacity,u=(null===o||void 0===o?void 0:o.live_stream_max_spectator_capacity)+((0,C.wK)({enabled:l}).currentQuantity||0),m=null===o||void 0===o?void 0:o.live_room_participants_capacity;return(0,a.jsxs)("div",{className:"order-1 grid w-[1024px] grid-cols-3 gap-6 p-0",children:[(0,a.jsx)("div",{className:"h-full","data-testid":"schedule-a-live-event",children:(0,a.jsx)(E,{title:(0,r.t)("live_streams.room_type_picker.live_event.v3.title"),onClick:function(){return t(d.H0.EVENT)},isSelected:n===d.H0.EVENT,disabled:i,children:(0,a.jsxs)("ul",{className:"order-1 flex w-[277.33px] flex-none list-outside flex-col items-start gap-3 self-stretch p-0",children:[(0,a.jsx)(A,{iconType:"16-join-date",text:(0,r.t)("live_streams.room_type_picker.live_event.v3.bullet_1",{spectators:u})}),(0,a.jsx)(A,{iconType:"16-calendar-add",text:(0,r.t)("live_streams.room_type_picker.live_event.v3.bullet_2",{cohosts:c})}),(0,a.jsx)(A,{iconType:"16-live",text:(0,r.t)("live_streams.room_type_picker.live_event.v3.bullet_3")}),(0,a.jsx)(A,{iconType:"20-members",text:(0,r.t)("live_streams.room_type_picker.live_event.v3.bullet_4")})]})})}),(0,a.jsx)("div",{className:"h-full","data-testid":"start-a-live-room",children:(0,a.jsx)(E,{title:(0,r.t)("live_streams.room_type_picker.live_room.title"),onClick:function(){return t(d.H0.CONFERENCE)},isSelected:n===d.H0.CONFERENCE,children:(0,a.jsxs)("ul",{className:"order-1 flex w-[277.33px] flex-none list-outside flex-col items-start gap-3 self-stretch p-0",children:[(0,a.jsx)(A,{iconType:"20-checkmark-circle",text:(0,r.t)("live_streams.room_type_picker.live_room.v3.bullet_1")}),(0,a.jsx)(A,{iconType:"20-members",text:(0,r.t)("live_streams.room_type_picker.live_room.v3.bullet_2",{participants:m})}),(0,a.jsx)(A,{iconType:"16-video",text:(0,r.t)("live_streams.room_type_picker.live_room.v3.bullet_3")}),(0,a.jsx)(A,{iconType:"16-chat",text:(0,r.t)("live_streams.room_type_picker.live_room.v3.bullet_4")})]})})}),(0,a.jsx)("div",{className:"h-full","data-testid":"start-a-live-stream",children:(0,a.jsx)(E,{title:(0,r.t)("live_streams.room_type_picker.live_stream.title"),onClick:function(){return t(d.H0.STREAM)},isSelected:n===d.H0.STREAM,children:(0,a.jsxs)("ul",{className:"order-1 flex w-[277.33px] flex-none list-outside flex-col items-start gap-3 self-stretch p-0",children:[(0,a.jsx)(A,{iconType:"20-checkmark-circle",text:(0,r.t)("live_streams.room_type_picker.live_stream.v3.bullet_1")}),(0,a.jsx)(A,{iconType:"20-members",text:(0,r.t)("live_streams.room_type_picker.live_stream.v3.bullet_2",{spectators:u})}),(0,a.jsx)(A,{iconType:"16-video",text:(0,r.t)("live_streams.room_type_picker.live_stream.v3.bullet_3")}),(0,a.jsx)(A,{iconType:"16-chat",text:(0,r.t)("live_streams.room_type_picker.live_stream.v3.bullet_4")})]})})})]})},M=["name","rules","liveStreamConfig","shouldDisableEventOption"];function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var U=function(e){var t=e.name,n=e.rules,r=e.liveStreamConfig,o=e.shouldDisableEventOption,i=F(e,M),s=(0,y.Gc)().control;return(0,a.jsx)(y.Qr,{control:s,name:t,rules:n,render:function(e){var t=e.field,n=t.onChange,s=t.value;return(0,a.jsx)(T,R(R({},i),{},{onChange:n,value:s,liveStreamConfig:r,shouldDisableEventOption:o}))}})},B=function(){var e=(0,C.oQ)().config,t={canCreateEvent:((0,k.nT)().helpers.spacesWithPostCreationAllowed()||[]).some((function(e){return"event"===e.post_type}))}.canCreateEvent;return(0,a.jsx)("div",{className:"mx-auto w-auto",children:(0,a.jsx)(P,{name:"room_type",rules:{required:(0,r.t)("live_streams.form.room_type_required_error")},hideLabel:!0,children:(0,a.jsx)(U,{liveStreamConfig:e,shouldDisableEventOption:!t})})})},z=n(35639),H=n(71069),Z=function(e){var t=e.roomType,n=(0,y.qo)({name:"recording_enabled"}),o=(0,f.Y)(),s=o.limitsReachedIsOpen,l=o.setRecordingEnabled,c=(0,z.R)().limitUrlSharingEnabled,u=(0,y.Gc)(),m=u.watch,p=u.setValue,v=m("access_type"),b=v===d._d.PUBLIC_STREAM||v===d._d.OPEN,g="limit_url_sharing";return(0,h.useEffect)((function(){b&&p(g,!1,{shouldDirty:!0})}),[v,p]),(0,h.useEffect)((function(){l(n)}),[n]),(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsx)(H.l,{roomType:t}),(0,a.jsx)(i.Z.TitleMd,{weight:"bold",children:(0,r.t)("live_streams.form.details")}),(0,a.jsxs)("div",{className:"mb-8 mt-4",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-1/2 pr-3",children:(0,a.jsx)(be,{name:"name",rules:{required:(0,r.t)("live_streams.form.".concat(t,".name_required_error")),maxLength:{value:255,message:(0,r.t)("live_streams.form.".concat(t,".name_length_error"))}},children:(0,a.jsx)(_.l.Input,{autoFocus:!0})})}),(0,a.jsx)("div",{className:"w-1/2 pl-3",children:(0,a.jsx)(be,{name:"slug",tooltipText:"".concat(window.location.protocol,"//").concat(window.location.hostname,"/live/custom-url-slug"),rules:{maxLength:{value:255,message:(0,r.t)("live_streams.form.slug_length_error")}},children:(0,a.jsx)(_.l.Input,{})})})]}),(0,a.jsx)("div",{className:"mt-3 w-full",children:(0,a.jsx)(be,{name:"description",resizeDisabled:!0,rules:{maxLength:{value:255,message:(0,r.t)("live_streams.form.".concat(t,".description_length_error"))}},children:(0,a.jsx)(_.l.Input,{variant:"textarea",maxLength:255,rows:"6"})})}),(0,a.jsxs)("div",{className:"mt-3 flex flex-col",children:[(0,a.jsx)(be,{name:"recording_enabled",appendTranslationRoot:t,tooltipText:(0,r.t)("live_streams.form.".concat(t,".recording_enabled_tooltip")),inlineReverse:!0,children:(0,a.jsx)(_.l.ToggleSwitch,{name:"recording_enabled",variant:"small"})}),(0,a.jsx)(be,{name:"mute_on_join",appendTranslationRoot:t,inlineReverse:!0,children:(0,a.jsx)(_.l.ToggleSwitch,{name:"mute_on_join",variant:"small"})}),(0,a.jsx)(be,{name:"hide_participants_list",appendTranslationRoot:t,inlineReverse:!0,tooltipText:(0,r.t)("live_streams.form.".concat(t,".hide_participants_list_tooltip")),children:(0,a.jsx)(_.l.ToggleSwitch,{name:"hide_participants_list",variant:"small"})}),c&&!b&&(0,a.jsx)(be,{name:g,appendTranslationRoot:t,tooltipText:(0,r.t)("live_streams.form.".concat(t,".limit_url_sharing_tooltip")),inlineReverse:!0,children:(0,a.jsx)(_.l.ToggleSwitch,{name:g,variant:"small"})})]})]}),(0,a.jsx)(i.Z.TitleMd,{weight:"bold",children:(0,r.t)("live_streams.form.access")}),(0,a.jsx)("div",{className:"my-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-1/2 pr-3",children:(0,a.jsx)(be,{name:"view_type",labelClassName:"mb-3 text-lg",children:(0,a.jsx)(_e,{roomType:t})})}),(0,a.jsx)("div",{className:"w-1/2 pl-3",children:(0,a.jsx)(be,{name:"access_type",labelClassName:"mb-3 text-lg",children:(0,a.jsx)(ye,{roomType:t})})})]})})]})},q=n(62557),V=n(22001),W=n(58533),Q=n(43227),$=n(41982),G=n(64422),J=n(88767),K=n(81089),Y=n(81649),X=function(e,t,n,r){var o,i=(0,J.useInfiniteQuery)("entities-preview-".concat(e,"-").concat(t,"-").concat(n,"-").concat(r),(function(o){var i=o.pageParam;return function(o){return(0,K.UT)(Y.a.entityPreviews.index({params:{page:o,spaces_ids:e,space_groups_ids:t,member_tags_ids:n,members_ids:r}}))}(void 0===i?1:i)}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),a=i.isLoading,s=i.isFetching,l=i.data,c=i.refetch,u=i.fetchNextPage,d=i.fetchPreviousPage,m=null===l||void 0===l||null===(o=l.pages)||void 0===o?void 0:o.reduce((function(e,t){return e.concat(t.records)}),[]),f=(null===l||void 0===l?void 0:l.pages[(null===l||void 0===l?void 0:l.pages.length)-1])||{},p=f.page,v=f.count,h=f.page_count,b=50*(p-1)+1;return{page:p,records:m,totalRecordCount:v,pageRecordCount:h,pageCount:v?Math.ceil(v/50):0,hasNextPage:!!f.has_next_page,startRecordNumber:b,endRecordNumber:b+h-1,isLoading:a,isFetching:s,refetch:c,fetchNextPage:u,fetchPrevPage:d}},ee=function(e){var t=e.spaceIds,n=e.spaceGroupIds,r=e.memberTagIds,o=e.memberIds,s=X(t,n,r,o),l=s.records,u=s.fetchNextPage,d=s.hasNextPage;return(0,a.jsx)(W.Z,{next:u,hasMore:d,scrollableTarget:c.Um,loader:(0,a.jsx)(Q.m,{}),dataLength:(null===l||void 0===l?void 0:l.length)||0,children:(0,a.jsx)("div",{className:"flex w-full flex-col",children:null===l||void 0===l?void 0:l.map((function(e){var t=e.id,n=e.avatar_url,r=e.name,o=e.email;return(0,a.jsxs)("div",{className:"hover:bg-secondary group flex h-12 items-center rounded-md border-none px-2",children:[(0,a.jsx)("div",{className:"mr-3",children:(0,a.jsx)(G.s,{src:n,name:r,size:"8"})}),(0,a.jsx)("div",{className:"w-1/3",children:(0,a.jsx)($.Y,{children:(0,a.jsx)(i.Z.LabelSm,{weight:"semibold",children:r})})}),(0,a.jsx)("div",{className:"flex grow justify-end",children:(0,a.jsx)($.Y,{children:(0,a.jsx)(i.Z.LabelSm,{children:o})})})]},t)}))})})},te=function(){var e=(0,y.qo)({name:"invited_entities_ids"})||{},t=e.spaces_ids,n=e.space_groups_ids,o=e.member_tags_ids,i=e.members_ids,s=Object.values(e).some((function(e){return!(null===e||void 0===e||!e.length)}))?(0,r.t)("manage"):(0,r.t)("invite");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(be,{name:"invited_entities_ids",className:"z-20 mb-6",hideLabel:!0,children:(0,a.jsx)(V.lH,{variant:V.ZC.MODAL,countLabel:(0,r.t)("live_streams.form.members_invited_label"),tooltipText:(0,r.t)("live_streams.form.members_invited_tooltip"),selectionLabel:(0,r.t)("live_streams.form.members_invited_selection_label"),searchPlaceholder:(0,r.t)("live_streams.form.members_invited_placeholder"),buttonLabel:s,includeAllResultTypes:!0})}),(0,a.jsx)(ee,{spaceIds:t,spaceGroupIds:n,memberTagIds:o,memberIds:i})]})},ne=n(93664),re=function(e){var t=e.setIsLimitReached,n=e.initialCohostQuantity,o=void 0===n?1:n,s=e.shouldDisplayDisabledSearchMessage,l=void 0!==s&&s,c=((0,ne.B)().selectionState||{}).memberCount+o||1,u=(0,C.oQ)().config,m=null===u||void 0===u?void 0:u.live_stream_max_host_capacity,f=c>=m;return(0,h.useEffect)((function(){m&&(c<=m-d.ln?t(!1):t(!0))}),[c,m,t]),(0,a.jsxs)("div",{className:"mb-4 text-center",children:[(0,a.jsx)("div",{children:(0,a.jsx)(i.Z.LabelSm,{weight:f?"medium":"normal",children:(0,r.t)("live_streams.room.cohosts_counter_message",{count:Math.min(c,m),hostCapacity:m})})}),l&&(0,a.jsx)("div",{children:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.room.cohosts_disable_search_message")})})]})};function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ae=function(){var e=(0,k.wh)().currentCommunityMember,t=oe((0,h.useState)(!1),2),n=t[0],o=t[1],i=n,s=[null===e||void 0===e?void 0:e.id],l=(0,y.qo)({name:"cohosts"});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(be,{name:"cohosts",className:"z-20 mb-6",hideLabel:!0,children:(0,a.jsx)(V.lH,{variant:V.ZC.MODAL,countLabel:(0,r.t)("live_streams.form.cohosts_added_label"),selectionLabel:(0,r.t)("live_streams.form.cohosts_selection_label"),searchPlaceholder:(0,r.t)("live_streams.form.cohosts_placeholder"),disableSearch:i,excludedMemberIds:s,renderAfterSelection:(0,a.jsx)(re,{setIsLimitReached:o,initialCohostQuantity:d.ln,shouldDisplayDisabledSearchMessage:i})})}),(0,a.jsx)(ee,{memberIds:l})]})};function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ce=function(){var e=(0,p.B0)()===d.H0.STREAM,t=[{label:(0,r.t)("live_streams.form.sections.people_attendees"),key:c.n4.ATTENDEES}];e&&t.push({label:(0,r.t)("live_streams.form.sections.people_cohosts"),key:c.n4.COHOSTS});var n=t.length>1,o=se((0,h.useState)(t[0]),2),i=o[0],s=o[1];return(0,a.jsxs)(a.Fragment,{children:[n&&(0,a.jsx)(q.m,{variant:"underline",className:"sticky",wrapperClassName:"overflow-x-auto overflow-y-hidden",controlled:!0,activeTab:i.label,onClick:function(e){var n=t.find((function(t){return t.label===e}));s(n)},options:t}),i.key===c.n4.ATTENDEES&&(0,a.jsx)(te,{}),i.key===c.n4.COHOSTS&&(0,a.jsx)(ae,{})]})},ue=n(63185),de=function(e){var t=e.setRoomType,n=e.triggerValidationRef,r=(0,o.eW)().currentSection,s=(0,ue.B)(t),l=(0,p.qj)(s).sections,c=(0,y.Gc)().trigger,u=r===l.roomType;return(0,h.useEffect)((function(){n&&c&&(n.current=c)}),[n,c]),(0,a.jsxs)("div",{className:g()("mx-auto py-14",{"max-w-screen-md":!u,"max-w-max":u}),children:[(0,a.jsx)(i.Z.TitleXl,{weight:"bold",children:r}),(0,a.jsxs)("div",{className:"mt-8",children:[r===l.roomType&&(0,a.jsx)(B,{}),r===l.details&&(0,a.jsx)(Z,{roomType:s}),r===l.people&&(0,a.jsx)(ce,{})]})]})},me=["children","name","rules","tooltipText","hidePlaceholder","placeholder","inlineReverse","translationRoot","appendTranslationRoot","hideLabel"];function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var be=function(e){var t=e.children,n=e.name,r=e.rules,o=void 0===r?{}:r,i=e.tooltipText,s=e.hidePlaceholder,l=void 0!==s&&s,c=e.placeholder,u=e.inlineReverse,d=void 0!==u&&u,m=e.translationRoot,f=void 0===m?"live_streams.form":m,p=e.appendTranslationRoot,v=e.hideLabel,h=void 0!==v&&v,b=he(e,me);return(0,a.jsx)(_.l.Item,pe(pe({name:n,hideDescription:!0,translationRoot:p?"".concat(f,".").concat(p):f,rules:o,hideBorder:!0,fullWidth:!0,hidePlaceholder:l,placeholder:c,tooltipText:i,inlineReverse:d,hideLabel:h},b),{},{children:t}))},ge=n(27025),ye=function(e){var t=e.name,n=e.roomType,o=void 0===n?d.H0.STREAM:n,s=(0,C.oQ)().config,l=(0,z.R)().publicLiveStreamsEnabled,c=null===s||void 0===s?void 0:s.live_room_participants_capacity,u=(0,y.Gc)().control,m=[{value:d._d.OPEN,label:(0,r.t)("live_streams.form.access_type_community"),description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".access_type_community_label"),{maxCapacity:c})})},{value:d._d.SECRET,label:(0,r.t)("live_streams.form.access_type_secret"),description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".access_type_secret_label"))})}];l&&o===d.H0.STREAM&&m.push({value:d._d.PUBLIC_STREAM,label:(0,r.t)("live_streams.form.access_type_public"),description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".access_type_public_label"))})});return(0,a.jsx)(y.Qr,{control:u,name:t,render:function(e){var t=e.field,n=t.onChange,r=function(e){return m.find((function(t){return t.value===e}))}(t.value);return(0,a.jsx)(ge.Lt,{direction:"bottom-start",linkType:"button",button:(0,a.jsx)(ge.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"content-start",children:(0,a.jsx)(i.Z.LabelMd,{children:null===r||void 0===r?void 0:r.label})}),(0,a.jsx)("div",{className:"flex content-end",children:(0,a.jsx)(I.JO,{type:"cheveron-down"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:ge.wk.EXTRA_LARGE,onChange:n,options:m,labelWeight:"semibold"})}})},_e=function(e){var t=e.name,n=e.roomType,o=void 0===n?d.H0.STREAM:n,s=(0,y.Gc)().control,l=[{value:d.Bk.GRID,label:(0,r.t)("live_streams.form.view_type_grid"),icon:"gallery-view",description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".view_type_description_grid"))})},{value:d.Bk.SPEAKER,label:(0,r.t)("live_streams.form.view_type_speaker"),icon:"speaker-view",description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".view_type_description_speaker"))})}];return(0,a.jsx)(y.Qr,{control:s,name:t,render:function(e){var t=e.field,n=t.onChange,r=function(e){return l.find((function(t){return t.value===e}))}(t.value);return(0,a.jsx)(ge.Lt,{direction:"bottom-start",linkType:"button",button:(0,a.jsx)(ge.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(I.JO,{type:null===r||void 0===r?void 0:r.icon,className:"ml-1 mr-2 flex"}),(0,a.jsx)(i.Z.LabelMd,{children:null===r||void 0===r?void 0:r.label})]}),(0,a.jsx)("div",{className:"flex content-end",children:(0,a.jsx)(I.JO,{type:"cheveron-down",className:"ml-1 mr-2"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:ge.wk.EXTRA_LARGE,onChange:n,options:l,labelWeight:"semibold"})}})}},71069:(e,t,n)=>{n.d(t,{l:()=>c});var r=n(86013),o=n(79090),i=n(81786),a=n(82177),s=n(8246),l=n(85893),c=function(e){var t=e.roomType,n=(0,o.Y)(),c=n.streamingHoursAvailable,u=n.recordingHoursReached,d=n.totalStreamingHours,m=n.totalRecordingHours,f=n.limitsReachedIsOpen,p=n.limitsReachedOnClose;return(0,l.jsxs)(a.u_,{title:(0,r.t)("live_streams.form.limits_reached"),isOpen:f,onClose:p,className:"z-[2100]",children:[(0,l.jsx)(a.u_.Overlay,{}),(0,l.jsxs)(a.u_.Content,{className:"!overflow-visible",children:[(0,l.jsxs)(a.u_.Header,{children:[(0,l.jsx)(a.u_.Title,{className:"text-center",size:"md",children:(0,r.t)("live_streams.form.limits_reached")}),(0,l.jsx)(a.u_.HeaderActions,{children:(0,l.jsx)(a.u_.CloseButton,{onClick:p})})]}),(0,l.jsx)(a.u_.Body,{className:"!overflow-visible text-justify",children:(0,l.jsxs)("ul",{className:"text-default list-outside pl-4 text-sm font-normal",children:[!c&&(0,l.jsx)("li",{className:"text-dark text-xs font-normal",children:(0,l.jsx)(s.Z.BodyXs,{children:(0,r.t)("live_streams.form.".concat(t,".upgrade_streaming_hours_label_v3"),{hours:d})})}),u&&(0,l.jsx)("li",{className:"text-dark mt-2 text-xs font-normal",children:(0,l.jsx)(s.Z.BodyXs,{children:(0,r.t)("live_streams.form.".concat(t,".upgrade_recording_hours_label_v3"),{hours:m})})})]})}),(0,l.jsx)(a.u_.Footer,{children:(0,l.jsx)(i.z,{type:"submit",variant:"circle",full:!0,large:!0,onClick:p,children:(0,r.t)("live_streams.form.close")})})]})]})}},90146:(e,t,n)=>{n.d(t,{n3:()=>p,a1:()=>s,qj:()=>i,B0:()=>l.B});var r=n(86013),o=n(85239),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.H0.STREAM,t={roomType:(0,r.t)("live_streams.form.sections.room_type"),details:(0,r.t)("live_streams.form.sections.".concat(e,".room_details")),people:(0,r.t)("live_streams.form.sections.people")};return{sections:t,sectionTitles:Object.values(t)}},a=n(98338),s=function(){var e=(0,a.wh)().currentCommunity;return{room_type:o.H0.STREAM,view_type:o.Bk.GRID,access_type:o._d.OPEN,recording_enabled:!(null===e||void 0===e||!e.live_stream_recording_enabled),mute_on_join:!1,hide_participants_list:!1,limit_url_sharing:!1}},l=n(63185),c=n(88767),u=n(24185),d=n(34334),m=n(50732),f=n(69647),p=function(e,t){var n=(0,f.p)(),o=n.success,i=n.error,a=(0,u.k6)();return(0,c.useMutation)((function(e){return d.Qk.create({formData:e,forReactQuery:!0})}),{onSuccess:function(n){t&&t(),o((0,r.t)("live_streams.form.".concat(e,".created_successfully"))),a.push(m.dE.room({roomSlug:n.slug}))},onError:function(){return i((0,r.t)("live_streams.form.create_error"))}})}},63185:(e,t,n)=>{n.d(t,{B:()=>s});var r=n(67294),o=n(96486),i=n(87536),a=n(85239),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(0,i.qo)({name:"room_type",defaultValue:a.H0.STREAM});return(0,r.useEffect)((function(){(0,o.isFunction)(e)&&e(t)}),[t,e]),t}},79181:(e,t,n)=>{n.d(t,{nw:()=>i,n4:()=>r,Um:()=>o});var r={ATTENDEES:"attendees",COHOSTS:"cohosts"},o="live-form-modal-body",i=2},28736:(e,t,n)=>{n.d(t,{wK:()=>h,Wk:()=>r.W,tm:()=>c,oQ:()=>a,IO:()=>j,Yq:()=>b,$v:()=>g,lQ:()=>x});var r=n(50117),o=n(88767),i=n(50732),a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=(0,o.useQuery)(i.av.liveStreams.configurations(),{enabled:e}),n=t.data,r=t.isLoading,a={};return null===n||void 0===n||n.forEach((function(e){a[e.feature_flag]=e.value})),{isLoading:r,config:a}},s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=(0,o.useQuery)(i.av.liveStreams.usage(),{enabled:e}),n=t.data,r=t.isLoading,a={};return null===n||void 0===n||n.forEach((function(e){a[e.type]=e.value})),{isLoading:r,usage:a}},l=3600,c=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=a({enabled:e}),n=t.config,r=t.isLoading,o=s({enabled:e}),i=o.usage,c=o.isLoading,u=b(null,{enabled:e}).currentQuantity,d=g(null,{enabled:e}).currentQuantity,m=r||c,f=(null===i||void 0===i?void 0:i.stream_duration)||0,p=(null===n||void 0===n?void 0:n.live_stream_monthly_stream_hours)||0,v=p*l||0,h=d*l||0,y=(null===i||void 0===i?void 0:i.recordings_duration)||0,_=(null===n||void 0===n?void 0:n.live_stream_recording_hours)||0;return{isLoading:m,streamingHoursAvailable:f<v+h,recordingHoursAvailable:y<(_*l||0)+(u*l||0),streamingTotalPlanHours:p+d,recordingTotalPlanHours:_+u}},u=n(86013),d=n(34334),m=n(81649),f=n(79016);var p=function(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{enabled:!0}).enabled,a=(0,f.E)().isCommunityOnTrial,s=(0,o.useQuery)(m.a.communityPlanAddons.show({addonId:e}),{enabled:r}),l=s.data,c=s.isLoading,p=s.refetch,v=s.isFetching,h=l||{},b=h.id,g=h.max_purchasable_quantity,y=h.name,_=h.quantity,x=h.price,j=h.unit_size,w=null===g||_<g,O=function(e){return null===g||_+e<=g},S=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return a?Promise.resolve().then((function(){return window.location.href=(0,i.xn)()})):O(r)?d.zV.create((n=_+r,(t=b)in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e),{forReactQuery:!0}):Promise.reject((0,u.t)("addons.community_plan_addon_hook.quantity_not_available_message"))},P=(0,o.useMutation)((function(e){return S(e)}),{onSuccess:function(){p(),null===n||void 0===n||n()},onError:function(e){null===t||void 0===t||t(e)}}),C=P.mutate,k=P.mutateAsync,N=P.isLoading;return{id:b,currentQuantity:_,maxPurchasableQuantity:g,name:y,price:x,unitSize:j,canPurchase:w,canPurchaseQuantity:O,purchase:C,purchaseAsync:k,refetch:p,isLoading:c,isFetching:v,isPurchasing:N}},v=n(69647),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0},t=(0,v.p)().error;return p("live_stream_spectators",(function(){return t((0,u.t)("live_streams.room.attendees_addon_quantity_error"))}),null,e)},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},n=(0,v.p)().error;return p("live_stream_recording_hours",(function(){return n((0,u.t)("live_streams.room.recording_hours_addon_error"))}),e,t)},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},n=(0,v.p)().error;return p("live_stream_monthly_stream_hours",(function(){return n((0,u.t)("live_streams.room.stream_hours_addon_error"))}),e,t)},y=(n(34713),["refetch","isLoading"]);function _(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var x=function(){var e,t,n,r,o,i,l,c,u,d,m,f,p=a(),v=p.config,x=p.isLoading,j=s(),w=j.usage,O=j.isLoading,S=(e=b(),t=e.isLoading,n=e.currentQuantity,r=e.refetch,o=g(),i=o.isLoading,l=o.currentQuantity,c=o.refetch,u=h(),d=u.isLoading,m=u.currentQuantity,f=u.refetch,{recordingHoursAddonQuantity:n,streamHoursAddonQuantity:l,attendeeSeatsAddonQuantity:m,isLoading:t||i||d,refetch:function(){r(),c(),f()}}),P=S.refetch,C=S.isLoading,k=_(S,y),N=x||O||C;return{monthlyHourLimit:parseInt(null===v||void 0===v?void 0:v.live_stream_monthly_stream_hours)+parseInt((null===k||void 0===k?void 0:k.streamHoursAddonQuantity)||0),monthlyHourUsage:((null===w||void 0===w?void 0:w.stream_duration)||0)/3600,storageLimit:parseInt(null===v||void 0===v?void 0:v.live_stream_recording_hours)+parseInt((null===k||void 0===k?void 0:k.recordingHoursAddonQuantity)||0),storageUsage:((null===w||void 0===w?void 0:w.recordings_duration)||0)/3600,hostLimit:null===v||void 0===v?void 0:v.live_stream_max_host_capacity,participantLimit:parseInt(null===v||void 0===v?void 0:v.live_stream_max_spectator_capacity)+parseInt((null===k||void 0===k?void 0:k.attendeeSeatsAddonQuantity)||0),isLoading:N,refetchAddons:P}},j=function(){var e=(0,o.useQuery)(i.av.liveStreams.usageLimit()),t=e.data;return{isLoading:e.isLoading,isMonthlyHourLimitReached:null===t||void 0===t?void 0:t.streaming_limit_reached,isStorageLimitReached:null===t||void 0===t?void 0:t.recording_limit_reached}}},50117:(e,t,n)=>{n.d(t,{W:()=>d});var r=n(86013),o=n(88767),i=n(24185),a=n(34334),s=n(98338),l=n(85239),c=n(50732),u=n(69647),d=function(){var e,t=(0,s.wh)().currentUser,n=(0,u.p)(),d=n.error,m=n.success,f=(0,i.k6)(),p=(0,o.useQuery)(c.av.liveStreams.liveNow({params:{per_page:1}})),v=p.data,h=p.remove,b=null===v||void 0===v||null===(e=v.records)||void 0===e?void 0:e[0],g=(0,o.useMutation)((function(){return a.Qk.endStream({id:null===b||void 0===b?void 0:b.id})}),{onSuccess:function(){m((0,r.t)("live_streams.room.".concat((0,l.vX)(b),".end_success"))),h()},onError:function(){return d((0,r.t)("live_streams.room.".concat((0,l.vX)(b),".end_error")))}});return{room:b,canManage:null===b||void 0===b?void 0:b.can_manage,handleNavigateToRoom:function(){if(b){var e=c.dE.room({roomSlug:b.slug});t||((0,l.L6)(b)?e=c.dE.publicRoom({roomSlug:b.slug}):window.location.href=c.dE.room({roomSlug:b.slug})),f.push(e)}},handleEndStream:function(e){e.stopPropagation(),g.mutate()}}}},34713:(e,t,n)=>{n.d(t,{h:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(){var e=o((0,r.useState)(),2),t=e[0];return{setRecordingEnabled:e[1],recordingEnabled:t}}},82964:(e,t,n)=>{n.d(t,{T:()=>_});var r=n(67294),o=n(94184),i=n.n(o),a=n(95172),s=n(11049),l=n(791),c=n(18605),u=n(20107),d=n(8246),m=n(13288),f=n(82177),p=n(85893),v=function(e){var t=e.direction,n=void 0===t?"right":t,r=e.onClick;return(0,p.jsx)("button",{type:"button",className:"bg-primary focus-visible:!outline-secondary flex h-12 w-12 items-center justify-center rounded-full shadow focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:r,children:(0,p.jsx)(c.JO,{size:20,type:"20-arrow-left",className:"right"==n?"rotate-180":""})})};function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=function(e){var t=e.attachments,n=void 0===t?[]:t,o=e.startIndex,b=void 0===o?0:o,g=h((0,r.useState)(b),2),y=g[0],_=g[1],x=h((0,r.useState)(!1),2),j=x[0],w=x[1],O=(0,s.dd)();(0,r.useEffect)((function(){}));var S=y<n.length-1,P=y>0,C=function(){return S&&_(y+1)},k=function(){return P&&_(y-1)},N=n[y],I=N.image_variants||{},A=u.$.isPDF(N.content_type),E=u.$.isImage(N.content_type);return(0,a.y1)("left",k,{enabled:P},[P,y,n]),(0,a.y1)("right",C,{enabled:S},[S,y,n]),(0,r.useEffect)((function(){E&&j&&w(!1)}),[N]),(0,p.jsxs)(f.u_,{isOpen:O.visible,onClose:function(){return O.remove()},title:N.filename,children:[(0,p.jsx)(f.u_.Overlay,{}),(0,p.jsxs)(f.u_.Content,{size:"full",children:[(0,p.jsxs)(f.u_.Header,{children:[(0,p.jsx)(d.Z.LabelMd,{weight:"medium",children:N.filename}),(0,p.jsxs)(f.u_.HeaderActions,{className:"items-center",children:[(0,p.jsx)("a",{className:"ml-2 focus:outline-none",href:N.url,download:!0,target:"_blank",rel:"noreferrer",children:(0,p.jsx)(c.JO,{className:"text-dark fill-current",type:"download"})}),(0,p.jsx)(f.u_.CloseButton,{onClick:O.remove})]})]}),(0,p.jsxs)(f.u_.Body,{className:"flex items-center justify-between",children:[(0,p.jsx)("div",{className:"w-16",children:P&&(0,p.jsx)(v,{direction:"left",onClick:k})}),(0,p.jsxs)("div",{className:"flex max-h-full flex-1 select-none justify-center",children:[A&&(0,p.jsx)(l.X,{src:N.url}),E&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("img",{loading:"eager",alt:"",className:i()("object-contain",{hidden:!j}),src:I.large||N.url,onLoad:function(){return w(!0)},onError:function(){return w(!0)}}),!j&&(0,p.jsx)(m.a,{center:!0})]})]}),(0,p.jsx)("div",{className:"w-16",children:S&&(0,p.jsx)(v,{direction:"right",onClick:C})})]})]})]})},y=s.gk.create((function(e){var t=e.startIndex,n=e.attachments;return(0,p.jsx)(g,{startIndex:t,attachments:n})})),_=function(){return(0,s.dd)(y)}},83410:(e,t,n)=>{n.d(t,{h:()=>j});var r=n(96486),o=n(11049),i=n(86013),a=n(62057),s=n(51705),l=n(81786),c=n(67687),u=n(47839),d=n(8246),m=n(85893),f=function(e){var t=e.post,n=e.spaces,r=e.isOpen,o=e.isLoading,f=e.isSubmitting,p=e.onSubmit,v=e.onClose;return o?null:(0,m.jsx)(u.u,{title:(0,i.t)("duplicate_post"),variant:"default",show:r,onClose:v,overflowVisible:!0,children:(0,m.jsxs)(c.l,{defaultValues:{space_id:t.space_id,send_notifications:!1},onSubmit:function(e){return p(e)},children:[(0,m.jsx)(c.l.Item,{name:"space_id",label:(0,i.t)("space"),description:(0,i.t)("duplicate_post_to_space"),rules:{required:(0,i.t)("events.create.form.space_required_error")},hideBorder:!0,fullWidth:!0,children:(0,m.jsx)(a.M,{name:"space_id",variant:"form-input",containerClassname:"mt-2",spaces:n})}),(0,s.Hz)(t)&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.Z.LabelXs,{color:"text-light",children:(0,i.t)("comments_wont_be_duplicated")}),(0,m.jsx)(c.l.Item,{name:"send_notifications",label:(0,i.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,hideBorder:!0,fullWidth:!0,children:(0,m.jsx)(c.l.ToggleSwitch,{name:"send_notifications",variant:"small"})})]}),(0,m.jsx)("div",{className:"mt-4",children:(0,m.jsx)(l.z,{type:"submit",variant:"primary",disabled:f,children:f?(0,i.t)("duplicating"):(0,i.t)("duplicate")})})]})})},p=n(88767),v=n(86649),h=n(69647),b=n(98338);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(e){var t=e.post,n=e.onSuccess,a=(0,o.dd)(),s=(0,b.nT)(),l=s.isLoading,c=s.helpers,u=function(e){var t=e.post,n=e.onSuccess,o=(0,h.p)(),a=o.success,s=o.error,l=(0,p.useMutation)((function(e){return(0,v.gX)({spaceId:t.space_id,postSlug:t.slug,payload:{post:{space_id:e.space_id,send_notifications:e.send_notifications}}})}),{onSuccess:function(e){a((0,i.t)("duplicated_successfully")),(0,r.isFunction)(n)&&n(e)},onError:function(){s((0,i.t)("duplication_failed"))}});return{duplicate:l.mutate,isDuplicating:l.isLoading}}({post:t,onSuccess:function(e){(0,r.isFunction)(n)&&n(e),a.remove()}}),d=u.duplicate,g=u.isDuplicating;return(0,m.jsx)(f,{post:t,spaces:c.imageSpacesWithPostCreationAllowed(),isOpen:a.visible,isLoading:l,isSubmitting:g,onSubmit:d,onClose:a.remove})},x=o.gk.create((function(e){return(0,m.jsx)(_,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),j=function(){return(0,o.dd)(x)}},38313:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(8761),o=n(11049),i=n(79090),a=n(85893),s=function(e){var t=e.event,n=e.defaultSection,s=e.locationType,l=(0,o.dd)(),c=l.visible,u=l.hide;return(0,a.jsx)(i.K,{children:(0,a.jsx)(r.G,{isOpen:c,onClose:u,event:t,locationType:s,initialSection:n})})},l=o.gk.create((function(e){var t=e.event,n=e.defaultSection,r=e.locationType;return(0,a.jsx)(s,{event:t,defaultSection:n,locationType:r})})),c=function(){return(0,o.dd)(l)}},1744:(e,t,n)=>{n.d(t,{e:()=>_n});var r,o=n(86013),i=n(96486),a=n(67294),s=n(81786),l=n(82177);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u="upload_images",d="adjust_images",m="create_post",f="square",p="landscape",v="portrait",h=(c(r={},f,1),c(r,p,16/9),c(r,v,.8),r),b=n(73445);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(e){return e.selectedFiles.forEach((function(e){return URL.revokeObjectURL(e.preview)})),{selectedFiles:[]}},O=(0,b.Ue)((function(e){return{currentStep:u,isSubmitting:!1,isFormDirty:!1,isImagesDirty:!1,isScheduledBarPortalRendered:!1,galleryAspectRatio:null,selectedFiles:[],uploadedImages:[],setCurrentStep:function(t){return e({currentStep:t})},setIsSubmitting:function(t){return e({isSubmitting:t})},setIsFormDirty:function(t){return e({isFormDirty:t})},setIsImagesDirty:function(t){return e({isImagesDirty:t})},setIsScheduledBarPortalRendered:function(t){return e({isScheduledBarPortalRendered:t})},updateImage:function(t){e((function(e){var n=e.selectedFiles.findIndex((function(e){return e.preview===t.preview}));return e.selectedFiles[n]=t,{selectedFiles:x(e.selectedFiles)}}))},addSelectedFiles:function(t){e((function(e){return{selectedFiles:[].concat(x(e.selectedFiles),x(t))}}))},setSelectedFiles:function(t){e({selectedFiles:t})},addUploadedImages:function(t){e((function(e){return{uploadedImages:[].concat(x(e.uploadedImages),x(t))}}))},setUploadedImages:function(t){e({uploadedImages:t})},setGalleryAspectRatio:function(t){e(t<(h.portrait+h.square)/2?{galleryAspectRatio:h.portrait}:t>(h.landscape+h.square)/2?{galleryAspectRatio:h.landscape}:{galleryAspectRatio:h.square})},resetSelectedFiles:function(){e(w)},reset:function(){e((function(e){return y(y({},w(e)),{},{currentStep:null,uploadedImages:[],galleryAspectRatio:null,isSubmitting:!1,isFormDirty:!1,isImagesDirty:!1,isScheduledBarPortalRendered:!1})}))}}})),S=n(94184),P=n.n(S),C=n(11442),k=n(8246),N=n(94281),I=n(54482),A=n(85893);function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var M=[{format:f,iconType:"16-image-square"},{format:v,iconType:"16-image-portrait"},{format:p,iconType:"16-image-landscape"}],L=function(){var e,t=O(),n=t.galleryAspectRatio,r=t.setGalleryAspectRatio,i=null===(e=Object.entries(h).find((function(e){return E(e,2)[1]===n})))||void 0===e?void 0:e[0],a="image_space.post_modal.steps.adjust_images.cropping_options";return(0,A.jsx)("div",{className:"text-default flex justify-between",children:M.map((function(e){var t=e.format,n=e.iconType;return(0,A.jsx)(N.T,{content:(0,o.t)("".concat(a,".").concat(t)),children:(0,A.jsx)(I.h,{onClick:function(){r(h[t])},className:P()({"bg-tertiary":i===t}),name:n,iconSize:16,buttonSize:28,iconClassName:P()({"!text-dark":i===t}),ariaLabel:(0,o.t)("".concat(a,".").concat(t))})},t)}))})},R=n(33275);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var H=function(e){var t=e.currentImage,n=B((0,a.useState)(null),2),r=n[0],o=n[1],s=O(),l=s.updateImage,c=s.galleryAspectRatio,u=s.setGalleryAspectRatio;return(0,a.useEffect)((function(){var e=new Image;e.src=t.preview,e.onload=function(){o(e)}}),[t.preview]),(0,a.useEffect)((function(){if(!c&&r){var e=r.width,t=r.height;u(e/t)}}),[c,r]),r&&c?(0,A.jsx)("div",{className:"relative flex aspect-video max-w-full grow cursor-pointer",children:(0,A.jsx)(R.Z,{image:t.preview,crop:t.crop,aspect:c,zoom:t.zoom,onCropChange:function(e){e!==t.crop&&l(F(F({},(0,i.cloneDeep)(t)),{},{crop:e}))},onZoomChange:function(e){e!==t.zoom&&l(F(F({},(0,i.cloneDeep)(t)),{},{zoom:e}))},onCropComplete:function(e,n){l(F(F({},(0,i.cloneDeep)(t)),{},{croppedAreaPixels:n}))}})}):null},Z=n(70562),q=n(18605),V=n(99545),W=n(94780),Q=n(25939),$=n(54030),G=function(e){var t=e.onClick,n=e.index,r=e.currentImageIndex,i=(0,V.dw)().activeItem,a=Boolean(i),s=(0,$.en)();return(0,A.jsx)(I.h,{onClick:t,className:P()("bg-tertiary border-secondary outline-tertiary absolute -right-0.5 -top-0.5 z-10 hidden h-4 w-4 rounded-full border !p-0 outline outline-2",{"group-hover:!flex":!a},{"!flex":!s&&!a&&n===r}),buttonSize:16,iconClassName:"!text-dark",name:"16-close",ariaLabel:(0,o.t)("delete_image")})},J=function(e){var t,n=e.direction,r=e.scrollableContainerRef,o="left"===n?-200:200;null===r||void 0===r||null===(t=r.current)||void 0===t||t.scroll({left:(null===r||void 0===r?void 0:r.current.scrollLeft)+o,behavior:"smooth"})},K=function(e){var t=e.direction,n=e.scrollableContainerRef,r="left"===t,o="right"===t;return(0,A.jsxs)("div",{className:P()("absolute z-30 flex h-full items-center",{"-left-px":r,"-right-px":o}),children:[o&&(0,A.jsx)("div",{className:"from-primary h-full w-8 bg-gradient-to-l to-transparent"}),(0,A.jsx)("button",{type:"button",onClick:function(){return J({direction:t,scrollableContainerRef:n})},className:"bg-primary group flex h-full cursor-pointer items-center px-2 py-1",children:(0,A.jsx)(q.JO,{size:16,className:P()({"-rotate-90":o,"rotate-90":r},"text-light group-hover:text-darkest"),type:"caret-down-bold"})}),r&&(0,A.jsx)("div",{className:"from-primary h-full w-8 bg-gradient-to-r to-transparent"})]})},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.noop,t=O().addSelectedFiles;return{handleFileSelection:function(n){n=n.map((function(e){return{file:e,preview:URL.createObjectURL(e),crop:{x:0,y:0},zoom:1}})),t(n),e()}}},X=n(41389),ee=n(69647),te=function(e){var t=e.handleFileSelection,n=e.selectedFiles,r=e.uploadedFilesCount,i=(0,ee.p)(),a="image_space.post_modal.steps.upload_images.errors",s=10-r,l=function(e){e.reduce((function(e,t){var n=t.errors[0].code;return e.includes(n)||e.push(n),e}),[]).forEach((function(e){var t={shouldShowCloseButton:!0,shouldUseProgress:!1};switch(e){case"file-invalid-type":return i.error((0,o.t)("".concat(a,".file_invalid_type")),t);case"file-too-large":return i.error((0,o.t)("".concat(a,".file_too_large")),t);case"too-many-files":return i.error((0,o.t)("".concat(a,".too_many_files"),{max_images:10}),t);default:return i.error((0,o.t)("".concat(a,".something_went_wrong")),t)}}))},c=(0,X.uI)({onDrop:function(e,r){r.length>0?l(r):parseInt(n.length)+parseInt(e.length)>s?l([{errors:[{code:"too-many-files"}]}]):t(e)},noClick:!0,accept:{"image/*":[".jpg",".jpeg",".png"]},maxFiles:s,maxSize:2e7,multiple:!0}),u=c.getRootProps,d=c.getInputProps,m=c.isDragAccept,f=c.isDragReject;return{getRootProps:u,getInputProps:d,isDragActive:m||f,open:c.open}},ne=function(e){var t=e.fileStates,n=e.index;return(0,A.jsx)("div",{className:"shrink-0 p-1",children:(0,A.jsxs)("div",{className:"bg-tertiary flex h-12 w-12 items-center justify-center rounded-md",children:["completed"===t[n].status&&(0,A.jsx)(q.JO,{type:"20-checkmark-circle-fill",size:20,className:"text-default"}),"uploading"===t[n].status&&(0,A.jsx)(C.D,{percentage:t[n].progress,size:18,strokeWidth:1.5}),"error"===t[n].status&&(0,A.jsx)(k.Z.LabelXs,{color:"text-default",children:(0,o.t)("image_space.post_modal.steps.adjust_images.file_error")})]})})},re=function(e){var t=e.image,n=e.index,r=e.setCurrentImageIndex,o=e.currentImageIndex;return(0,A.jsx)("button",{type:"button",onClick:function(){return r(n)},className:P()("shrink-0 cursor-pointer touch-none select-none rounded-lg border-2 border-transparent p-0.5",{"border-secondary":n===o}),children:(0,A.jsx)("img",{loading:"eager",src:t.preview,className:"h-12 w-12 rounded-md object-cover",alt:t.file.name})},t.preview)},oe=function(e){var t=e.isOverlay,n=void 0!==t&&t,r=(0,V.dI)().item;return(0,A.jsx)("div",{className:P()("rounded-lg border-2 border-transparent p-0.5 opacity-50",{"!opacity-100":n}),children:(0,A.jsx)("img",{loading:"eager",src:r.preview,className:"h-12 w-12 rounded-md object-cover",alt:r.file.name})})};function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ue=function(e){var t=e.selectedFiles,n=e.setCurrentImageIndex,r=e.currentImageIndex,o=e.status,i=e.fileStates,s=e.editingImageSignedId,c=e.onDeleteAllImages,u=(0,a.useRef)(null),d=le((0,Z.A)(),2),m=d[0],f=d[1],p=le((0,Z.A)(),2),v=p[0],h=p[1],b=(0,l.UV)().contentPortalElement,g=O(),y=g.uploadedImages,_=g.setSelectedFiles,x=Y((function(){setTimeout((function(){return J({direction:"right",scrollableContainerRef:u})}),200)})).handleFileSelection,j=te({handleFileSelection:x,selectedFiles:t,uploadedFilesCount:y.length}),w=j.getInputProps,S=j.open,P=function(){var e=O(),t=e.setSelectedFiles,n=e.selectedFiles;return{removeImage:function(e){var r=n.filter((function(t){return t!==e}));t(r)}}}(),C=P.removeImage,k=t.map((function(e){return ae(ae({},e),{},{id:e.preview})})),N=k[r],I=!s&&t.length+y.length<10;return(0,A.jsxs)("div",{className:"relative mt-5 flex",children:[!f&&(0,A.jsx)(K,{direction:"left",scrollableContainerRef:u}),(0,A.jsxs)(V.cm,{shouldUseKeyboardSensor:!1,distance:10,items:k,onSort:function(e){var t=e.indexOf(N);t!==r&&n(t),_(e.map((function(e){return ae(ae({},e),{},{id:void 0})})))},restrictToParentElement:!0,children:[(0,A.jsx)(V.Fo,{children:(0,A.jsxs)("div",{className:"scrollbar-hide m-auto !flex items-center overflow-x-scroll px-1 pt-1",ref:u,"data-testid":"thumbnails-list",children:[(0,A.jsx)("div",{className:"h-px w-px",ref:m}),t.map((function(e,a){return"uploading"===o||"completed"===o?(0,A.jsx)(ne,{fileStates:i,index:a},e.preview):(0,A.jsxs)(Q.c,{tabIndex:-1,item:k[a],disabled:1===y.length,placeholder:oe,className:"group relative !w-auto shrink-0",dataTestId:"thumbnail-item",children:[(0,A.jsx)(G,{onClick:function(){C(e),1===t.length&&c()},index:a,currentImageIndex:r}),(0,A.jsx)(re,{image:e,index:a,setCurrentImageIndex:n,currentImageIndex:r})]},e.preview)})),I&&(0,A.jsxs)("button",{type:"button",className:"hover:bg-secondary text-default ml-1 flex h-12 w-12 shrink-0 cursor-pointer items-center justify-center rounded-md border border-dashed",onClick:function(){return"uploading"!==o&&S()},children:[(0,A.jsx)("input",ae(ae({},w()),{},{"data-testid":"upload_more_images"})),(0,A.jsx)(q.JO,{type:"20-add-lg",size:20})]}),(0,A.jsx)("div",{className:"h-px w-px",ref:v})]})}),(0,A.jsx)(W.y,{portalTo:b,children:(0,A.jsx)(oe,{isOverlay:!0})})]}),!h&&(0,A.jsx)(K,{direction:"right",scrollableContainerRef:u})]})},de=n(67842);function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){he(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var be=function(e){var t=e.currentImage,n=O().updateImage;return(0,A.jsxs)("div",{className:"text-light flex items-center justify-between",children:[(0,A.jsx)(I.h,{name:"16-zoom-out",onClick:function(){var e=ve(ve({},(0,i.cloneDeep)(t)),{},{zoom:t.zoom-.1});e.zoom>=1&&n(e)},className:"mr-3",iconSize:16,buttonSize:28,ariaLabel:(0,o.t)("zoom_out")}),(0,A.jsx)("div",{className:"flex h-4 w-32 items-center",children:(0,A.jsxs)(de.i.Root,{value:[Math.round(10*t.zoom)/10],max:5,min:1,step:.1,onValueChange:function(e){var r=me(e,1)[0];r!==t.zoom&&n(ve(ve({},(0,i.cloneDeep)(t)),{},{zoom:r}))},children:[(0,A.jsx)(de.i.Track,{children:(0,A.jsx)(de.i.Range,{className:"!bg-badge"})}),(0,A.jsx)(de.i.Thumb,{className:"before:!bg-badge"})]})}),(0,A.jsx)(I.h,{onClick:function(){var e=ve(ve({},(0,i.cloneDeep)(t)),{},{zoom:t.zoom+.1});e.zoom<=5&&n(e)},className:"ml-3",name:"16-zoom-in",iconSize:16,buttonSize:28,ariaLabel:(0,o.t)("zoom_in")})]})};function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _e=function(e){var t=e.status,n=e.overallProgress,r=e.fileStates,i=e.editingImageSignedId,s=e.onDeleteAllImages,l=ge((0,a.useState)(0),2),c=l[0],u=l[1],d=O(),m=d.selectedFiles,f=d.uploadedImages,p=m[c],v=(0,a.useRef)(m.length),h=v.current,b=m.length;return b>0&&c>b-1?u(m.length-1):b>h&&u(h),v.current=b,p?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:P()("border-primary flex grow flex-col overflow-hidden rounded-md border",{"bg-tertiary":"uploading"===t}),children:["idle"===t&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(H,{currentImage:p}),(0,A.jsxs)("div",{className:P()("border-primary flex border-t px-4 py-3",{"justify-between":0===c,"justify-end":c>0}),children:[0===f.length&&0===c&&(0,A.jsx)(L,{}),(0,A.jsx)(be,{currentImage:p})]})]}),("uploading"===t||"completed"===t)&&(0,A.jsxs)("div",{className:"mb-12 mt-1 flex aspect-video flex-col items-center justify-center gap-4",children:[(0,A.jsx)(C.D,{percentage:n,size:22,strokeWidth:1.75}),(0,A.jsx)(k.Z.LabelMd,{color:"text-default",children:(0,o.t)("image_space.post_modal.steps.adjust_images.uploading")})]}),"error"===t&&(0,A.jsx)("div",{className:"mb-12 mt-1 flex aspect-video flex-col items-center justify-center gap-4",children:(0,A.jsx)(k.Z.LabelMd,{color:"text-default",children:(0,o.t)("image_space.post_modal.steps.adjust_images.files_error")})})]}),(0,A.jsx)(ue,{currentImageIndex:c,selectedFiles:m,setCurrentImageIndex:u,fileStates:r,status:t,editingImageSignedId:i,onDeleteAllImages:s})]}):null},xe=n(79292),je=n(50732);function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){Se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pe(e){return function(e){if(Array.isArray(e))return Ne(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||ke(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){if(e){if("string"===typeof e)return Ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ne(e,t):void 0}}function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){Ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Te=function(e,t){var n,r,o,i;return e.width/e.height>t?(o=Math.round(e.height*t),i=e.height,n=Math.round((e.width-o)/2),r=0):(o=e.width,i=Math.round(e.width/t),n=0,r=Math.round((e.height-i)/2)),{x:n,y:r,width:o,height:i}},Me=function(){var e=O(),t=e.selectedFiles,n=e.setSelectedFiles,r=e.galleryAspectRatio,o=e.setUploadedImages,i=e.addUploadedImages,s=e.uploadedImages,l=e.setIsImagesDirty,c=function(){var e=Ce((0,a.useState)([]),2),t=e[0],n=e[1],r=Ce((0,a.useState)(0),2),o=r[0],i=r[1];return(0,a.useEffect)((function(){var e=t.reduce((function(e,t){return e+t.progress}),0);i(t.length?e/t.length:0)}),[t]),{status:t.some((function(e){return"error"===e.status}))?"error":t.every((function(e){return"idle"===e.status}))?"idle":t.every((function(e){return"completed"===e.status}))?"completed":"uploading",fileStates:t,overallProgress:o,reset:function(){n([]),i(0)},uploadFiles:function(e){var t=e.map((function(){return{progress:0,status:"idle"}}));n(t),e.forEach((function(e,t){new xe.DirectUpload(e,(0,je.hq)(),{directUploadWillStoreFileWithXHR:function(e){e.upload.addEventListener("loadstart",(function(){n((function(e){var n=Pe(e);return n[t]=Oe(Oe({},n[t]),{},{status:"uploading"}),n}))})),e.upload.addEventListener("progress",(function(e){n((function(n){var r=Pe(n);return r[t]=Oe(Oe({},r[t]),{},{progress:e.loaded/e.total*100}),r}))}))}}).create((function(e,r){if(e)throw n((function(e){var n=Pe(e);return n[t]=Oe(Oe({},n[t]),{},{status:"error"}),n})),new Error("Direct upload failed: ".concat(null===e||void 0===e?void 0:e.message));n((function(e){var n=Pe(e);return n[t]=Oe(Oe({},n[t]),{},{status:"completed",progress:100,response:Oe({blob_url:(0,je.Gd)({signed_id:r.signed_id,filename:encodeURIComponent(r.filename)})},r)}),n}))}))}))}}}(),u=c.status,d=c.overallProgress,m=c.reset,f=c.fileStates,p=c.uploadFiles;return{uploadImages:function(){if(!r)throw new Error("Gallery aspect ratio not set");var e=t.map((function(e){return function(e,t){return new Promise((function(n,r){var o=new Image,i=document.createElement("canvas"),a=i.getContext("2d");if(e.croppedAreaPixels){var s=e.croppedAreaPixels,l=s.width,c=s.height;parseFloat((l/c).toFixed(2))!==parseFloat(t.toFixed(2))&&(e.croppedAreaPixels=void 0)}o.src=URL.createObjectURL(e.file),o.onload=function(){var r=e.croppedAreaPixels||Te(o,t);i.width=r.width,i.height=r.height,null===a||void 0===a||a.drawImage(o,r.x,r.y,r.width,r.height,0,0,r.width,r.height),i.toBlob((function(t){if(t){var o=new File([t],e.file.name,{type:"image/jpeg",lastModified:(new Date).getTime()});n({croppedImage:o,croppedArea:r})}}),"image/jpeg")},o.onerror=function(e){r(e)}}))}(e,r)}));Promise.all(e).then((function(e){n(t.map((function(t,n){return Ae(Ae({},t),{},{croppedAreaPixels:e[n].croppedArea})}))),p(e.map((function(e){return e.croppedImage})))})).catch((function(e){throw new Error("Error processing images: ".concat(e))}))},overallProgress:d,resetUploads:m,status:u,fileStates:f,updateStoredImages:function(e){if(e){var n=t[0],r={signed_id:f[0].response.signed_id,url:f[0].response.blob_url,original_url:f[0].response.blob_url,filename:f[0].response.filename,width:n.croppedAreaPixels.width,height:n.croppedAreaPixels.height};o(s.map((function(t){return t.signed_id===e?Ae(Ae({},t),r):t})))}else i(f.map((function(e,n){return{signed_id:e.response.signed_id,url:e.response.blob_url,original_url:e.response.blob_url,filename:e.response.filename,width:t[n].croppedAreaPixels.width,height:t[n].croppedAreaPixels.height}})));l(!0)}}},Le=function(e){var t=e.onClose,n=e.onCompleted,r=void 0===n?i.noop:n,c=e.isOnTop,d=void 0!==c&&c,f=e.editingImageSignedId,p=O(),v=p.setCurrentStep,h=p.resetSelectedFiles,b=Me(),g=b.uploadImages,y=b.overallProgress,_=b.resetUploads,x=b.status,j=b.fileStates,w=b.updateStoredImages,S=function(){h(),d?t():v(u)};return(0,a.useEffect)((function(){"completed"===x?(w(f),_(),h(),v(m),r(),d&&t()):"error"===x&&_()}),[d,x]),(0,A.jsxs)(l.u_,{isOpen:!0,onClose:function(){h(),t()},contentPortalId:"adjust-images-modal-portal",children:[(0,A.jsx)(l.u_.Overlay,{}),(0,A.jsxs)(l.u_.Content,{size:"xl",children:[(0,A.jsxs)(l.u_.Header,{children:[(0,A.jsx)(l.u_.Title,{size:"sm",children:(0,o.t)("image_space.post_modal.steps.adjust_images.title")}),(0,A.jsxs)(l.u_.HeaderActions,{className:"!gap-3",children:[(0,A.jsx)(s.z,{type:"button",variant:"secondary",onClick:S,children:(0,o.t)("cancel")}),(0,A.jsx)(s.z,{type:"submit",variant:"circle",disabled:"uploading"===x,onClick:function(){return g()},children:d?(0,o.t)("save"):(0,o.t)("next")})]})]}),(0,A.jsx)(l.u_.Body,{className:"flex flex-col pb-5 pt-4",children:(0,A.jsx)(_e,{status:x,fileStates:j,overallProgress:y,editingImageSignedId:f,onDeleteAllImages:S})})]})]})},Re=n(64687),De=n.n(Re),Fe=n(88767),Ue=n(24185),Be=n(99658),ze=n(11300),He=n(86649);function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){Ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var We=function(e){return(0,i.pick)(e,["tiptap_body","hide_meta_info","is_comments_disabled","is_comments_closed","is_liking_disabled","is_truncation_disabled","pin_to_top","pinned_at","hide_from_featured_areas","gallery.downloadable_images","slug","user_id","status","published_at","topics"])},Qe=function(e){var t=e.space,n=e.post,r=e.onSuccess,a=(0,ee.p)(),s=O(),l=s.setIsSubmitting,c=s.uploadedImages,u=!!n.slug,d={onSuccess:function(e){l(!1),r(e),a.success((0,o.t)(u?"quick_post.toasts.changes_saved":"quick_post.toasts.".concat(e.status,"_saved")))},onError:function(e){l(!1),a.error(e.errorDetails,{shouldShowCloseButton:!0,shouldUseProgress:!1})}},m=(0,Fe.useMutation)((function(e){return n.slug?(0,He._u)({spaceId:t.id,postSlug:n.slug,payload:e}):(0,He.x6)({spaceId:t.id,payload:e})}),d).mutate;return{onSubmit:function(e){l(!0),m(function(e){var t=e.payload,n=e.space,r=e.uploadedImages;return{post:qe(qe({},(0,i.omit)(t,["gallery"])),{},{space_id:null===n||void 0===n?void 0:n.id,gallery_attributes:qe(qe({},t.gallery),{},{images_attributes:r.map((function(e){return{id:e.id,image:e.signed_id,width:e.width,height:e.height}}))})})}}({payload:e,space:t,uploadedImages:c}))}}},$e=n(51705),Ge=n(97782),Je=n(98338),Ke=n(67687),Ye=n(87536),Xe=n(20036),et=n(96669),tt=n(50045),nt=n(90789),rt=n(93526);function ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return it(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var at=function(e){var t=e.post,n=(0,Je.wh)().currentCommunitySettings,r=null===n||void 0===n?void 0:n.topics_enabled,s=ot((0,a.useState)(!1),2),l=s[0],c=s[1],u=(0,$.j)(),d=(0,Ye.Gc)(),m=d.watch,f=d.setValue,p=O(),v=p.isSubmitting,h=p.uploadedImages,b=p.isScheduledBarPortalRendered,g=(0,Je.L2)().data,y=m(),_=y.published_at,x=y.status,j=y.topics,w=r&&(null===g||void 0===g?void 0:g.require_topic_selection)&&Number(null===j||void 0===j?void 0:j.length)<=0,S=h.length>0&&!v&&!w,P=!(null===t||void 0===t||!t.id),C=(0,$e.Hz)(t),k="quick_post.scheduled_post_ui.".concat(v?"submitting_button":"submit_button"),I=[{icon:"16-download",label:(0,o.t)("".concat(k,".save_draft")),value:"draft"},{icon:"16-calendar",label:(0,o.t)("".concat(k,".schedule_post")),value:"scheduled"},{icon:"16-publish",label:(0,o.t)("".concat(k,".publish")),value:"published"}],E=(0,i.find)(I,{value:x||"published"}),T=function(e){"scheduled"===e.value?c(!0):(f("status",e.value),c(!1),M(null))},M=function(e){f("published_at",e)},L=function(){T(I[0])},R=g&&(0,nt.k8)(g)&&!C;return(0,A.jsxs)(A.Fragment,{children:[b&&(0,A.jsx)(tt.e,{publishedAt:_,revertToDraftState:L,status:x,updatePublishedAt:M,variant:u?"2-lines":"default"}),(0,A.jsx)(Xe.M,{datePickerVisible:l,onCancel:function(e){e&&e.preventDefault(),c(!1),"scheduled"===x&&L()},value:_,onSave:function(e){M(e),f("status","scheduled"),c(!1)},placement:"bottom-end",saveButtonVariant:"circle",children:R?(0,A.jsx)(N.T,{disabled:!w,content:(0,o.t)("quick_post_v2.error_messages.no_topics"),trigger:"mouseenter click focus focusin",placement:"bottom",children:(0,A.jsx)(rt.F,{type:"submit",disabled:!S,selectedAction:E,setSelectedAction:T,options:I,variant:"circle"})}):(0,A.jsx)(N.T,{disabled:!w,content:(0,o.t)("quick_post_v2.error_messages.no_topics"),trigger:"mouseenter click focus focusin",placement:"bottom",children:(0,A.jsx)(et.a,{isEdit:P,isDisabled:!S})})})]})},st=n(77700),lt=n(13288);function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){dt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mt=function(e){var t=e.isDragActive,n=e.getRootProps,r=e.getInputProps,i=e.open,a=e.className,s="image_space.post_modal.steps.upload_images";return(0,A.jsx)("div",ut(ut({},n()),{},{className:"group h-full w-full",children:(0,A.jsxs)("button",{type:"button",className:P()("flex h-full w-full flex-col items-center justify-center px-4 text-center",a),onClick:i,children:[(0,A.jsx)("input",ut(ut({},r()),{},{"data-testid":"upload_multi_image"})),(0,A.jsx)(q.JO,{size:24,type:"24-circle-arrow-up",className:P()("text-default !h-6 !w-6",{"group-hover:text-messaging-info-blue":!t})}),(0,A.jsx)("div",{className:"mb-1 mt-3",children:(0,A.jsxs)(k.Z.LabelMd,{weight:"semibold",color:P()("text-dark",{"group-hover:text-messaging-info-blue":!t}),children:[(0,o.t)("".concat(s,".drag_and_drop_up_to_n_images"),{max_images:10}),t&&" "+(0,o.t)("".concat(s,".here"))]})}),!t&&(0,A.jsx)(k.Z.LabelSm,{color:"text-default group-hover:text-messaging-info-blue",children:(0,o.t)("".concat(s,".recommendation"))})]})}))},ft=["isDragActive"];function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){ht(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function gt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _t=function(){var e=gt((0,a.useState)(!1),2),t=e[0],n=e[1],r=O(),o=r.selectedFiles,i=r.uploadedImages,s=Y((function(){return n(!0)})).handleFileSelection,l=te({handleFileSelection:s,selectedFiles:o,uploadedFilesCount:i.length}),c=l.isDragActive,u=bt(l,ft);return(0,A.jsxs)("div",{className:P()("flex h-full w-full flex-col items-center justify-center rounded-md px-4 text-center",{"!bg-light-blue":c}),children:[(0,A.jsx)(mt,vt(vt({isDragActive:c},u),{},{className:"pb-0"})),t&&(0,A.jsx)(Le,{onClose:function(){return n(!1)},isOnTop:!0})]})},xt=n(27025),jt=n(70532),wt=function(){var e=O(),t=e.setUploadedImages,n=e.uploadedImages,r=e.setIsImagesDirty;return{removeImage:function(e){var o=n.filter((function(t){return t!==e}));t(o),r(!0)}}};function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return St(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pt(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function Ct(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Pt(i,r,o,a,s,"next",e)}function s(e){Pt(i,r,o,a,s,"throw",e)}a(void 0)}))}}var kt=function(){var e=Ct(De().mark((function e(t){var n,r,o,i,a;return De().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.fileName,o=t.contentType,e.next=3,fetch(n);case 3:return i=e.sent,e.next=6,i.blob();case 6:return a=e.sent,e.abrupt("return",new File([a],r,{type:o,lastModified:(new Date).getTime()}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Nt=function(e){var t,n=e.currentImage,r=Ot((0,a.useState)(!1),2),i=r[0],s=r[1],l=wt().removeImage,c=Y((function(){return s(!0)})).handleFileSelection,u="image_space.post_modal.steps.create_post.image_options",d=[{value:(0,o.t)("".concat(u,".crop_image")),label:(0,o.t)("".concat(u,".crop_image")),icon:"16-crop",onClick:(t=Ct(De().mark((function e(){var t;return De().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kt({url:n.original_url,fileName:n.filename,contentType:"image/jpeg"});case 2:t=e.sent,c([t]);case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{value:(0,o.t)("".concat(u,".remove")),label:(0,o.t)("".concat(u,".remove")),icon:"16-trash-bin",onClick:function(){l(n)}}];return(0,A.jsxs)(A.Fragment,{children:[i&&(0,A.jsx)(Le,{onClose:function(){return s(!1)},isOnTop:!0,editingImageSignedId:n.signed_id}),(0,A.jsx)(xt.Lt,{direction:"bottom-end",className:"absolute right-4 top-4",button:(0,A.jsx)(I.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark",className:"bg-primary border-primary rounded-full border",ariaLabel:(0,o.t)("".concat(u,".label"))}),children:(0,A.jsx)(jt.A,{options:d,linkType:"button"})})]})};function It(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return At(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Et=function(e){var t,n=e.currentImageIndex,r=(0,a.useRef)(null),o=(0,a.useRef)(null),i=It((0,a.useState)(!0),2),s=i[0],l=i[1],c=It((0,a.useState)(),2),u=c[0],d=c[1],m=O(),f=m.uploadedImages,p=m.galleryAspectRatio,v=m.setGalleryAspectRatio,h=f[n];return(0,a.useEffect)((function(){if(!p&&h){var e=h.width/h.height;v(e)}}),[p,h,v]),(0,a.useEffect)((function(){if(!s&&o.current){var e=o.current.getBoundingClientRect(),t=e.width,n=e.height;d(t/n)}}),[s,o]),h?(p&&u&&(t=p>u?"w-full my-auto":p<u?"h-full":"h-full w-full"),(0,A.jsxs)("div",{className:"flex justify-center overflow-auto md:grow",ref:o,children:[s&&(0,A.jsx)(lt.a,{}),(0,A.jsxs)("div",{className:P()("relative",t),children:[(0,A.jsx)(Nt,{currentImage:h}),(0,A.jsx)("img",{loading:"eager",ref:r,src:h.url,alt:h.filename,onLoad:function(){return l(!1)},className:P()("rounded-md",{hidden:s},t)})]})]})):(0,A.jsx)(_t,{})};function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Lt=function(e){var t=e.image,n=e.index,r=e.currentImageIndex,o=e.onClick,i=Tt((0,a.useState)(!0),2),s=i[0],l=i[1];return(0,A.jsx)("button",{type:"button",onClick:function(){return o(n)},className:P()("cursor-pointer touch-none select-none rounded-lg border-2 border-transparent p-0.5",{"border-secondary":n===r&&!s,"bg-tertiary mx-1 h-12 w-12 animate-pulse":s}),children:(0,A.jsx)("img",{loading:"eager",src:t.url,className:P()("h-12 w-12 rounded-md object-cover",{hidden:s}),onLoad:function(){return l(!1)},alt:t.filename})})},Rt=function(e){var t=e.isOverlay,n=void 0!==t&&t,r=(0,V.dI)().item;return(0,A.jsx)("div",{className:P()("rounded-lg border-2 border-transparent p-0.5 opacity-50",{"!opacity-100":n}),children:(0,A.jsx)("img",{loading:"eager",src:r.url,className:"h-12 w-12 rounded-md object-cover",alt:r.filename})})};function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(n),!0).forEach((function(t){Ut(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ht=function(e){var t=e.setCurrentImageIndex,n=e.currentImageIndex,r=Bt((0,a.useState)(!1),2),o=r[0],i=r[1],s=(0,a.useRef)(null),c=Bt((0,Z.A)(),2),u=c[0],d=c[1],m=Bt((0,Z.A)(),2),f=m[0],p=m[1],v=(0,l.UV)().contentPortalElement,h=O(),b=h.uploadedImages,g=h.setUploadedImages,y=h.selectedFiles,_=h.resetSelectedFiles,x=h.setIsImagesDirty,j=Y((function(){return i(!0)})).handleFileSelection,w=te({handleFileSelection:j,selectedFiles:y,uploadedFilesCount:b.length}),S=w.getInputProps,P=w.open,C=wt().removeImage,k=b.map((function(e){return Ft(Ft({},e),{},{id:e.signed_id,originalId:e.id})})),N=k[n];return(0,A.jsxs)("div",{className:"relative mt-5 flex",children:[!d&&(0,A.jsx)(K,{direction:"left",scrollableContainerRef:s}),(0,A.jsxs)(V.cm,{shouldUseKeyboardSensor:!1,distance:10,items:k,onSort:function(e){var r=e.indexOf(N);r!==n&&t(r),g(e.map((function(e){return Ft(Ft({},e),{},{id:e.originalId})}))),x(!0)},restrictToParentElement:!0,children:[(0,A.jsx)(V.Fo,{children:(0,A.jsxs)("div",{className:"scrollbar-hide m-auto !flex items-center overflow-x-scroll px-1 pt-1",ref:s,children:[(0,A.jsx)("div",{className:"h-px w-px",ref:u}),b.map((function(e,r){return(0,A.jsxs)(Q.c,{tabIndex:-1,item:k[r],disabled:1===b.length,placeholder:Rt,className:"group relative !w-auto shrink-0",dataTestId:"thumbnail-item",children:[(0,A.jsx)(G,{onClick:function(){return C(e)},index:r,currentImageIndex:n}),(0,A.jsx)(Lt,{image:e,index:r,currentImageIndex:n,onClick:t})]},e.signed_id)})),b.length<10&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("button",{type:"button",className:"hover:bg-secondary text-default ml-1 flex h-12 w-12 shrink-0 cursor-pointer items-center justify-center rounded-md border border-dashed",onClick:function(){_(),P()},children:[(0,A.jsx)("input",Ft({},S())),(0,A.jsx)(q.JO,{type:"20-add-lg",size:20})]}),o&&(0,A.jsx)(Le,{onClose:function(){return i(!1)},onCompleted:function(){return setTimeout((function(){return J({direction:"right",scrollableContainerRef:s})}),200)},isOnTop:!0})]}),(0,A.jsx)("div",{className:"h-px w-px",ref:f})]})}),(0,A.jsx)(W.y,{portalTo:v,children:(0,A.jsx)(Rt,{isOverlay:!0})})]}),!p&&(0,A.jsx)(K,{direction:"right",scrollableContainerRef:s})]})};function Zt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return qt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Vt=function(){var e=Zt((0,a.useState)(0),2),t=e[0],n=e[1],r=!(0,$.j)(),o=O(),i=o.uploadedImages,s=o.setIsScheduledBarPortalRendered,l=(0,a.useRef)(i.length),c=l.current,u=i.length;return u>0&&t>u-1?n(i.length-1):u>c&&n(c),l.current=u,(0,a.useEffect)((function(){r&&s(!0)}),[r,s]),(0,A.jsxs)("div",{className:"flex max-h-full w-full flex-col justify-center overflow-auto lg:h-full lg:w-3/4",children:[r&&(0,A.jsx)("div",{id:st.U}),(0,A.jsxs)("div",{className:"flex max-h-full min-h-[20rem] w-full flex-col overflow-auto p-6",children:[(0,A.jsx)(Et,{currentImageIndex:t}),i.length>0&&(0,A.jsx)(Ht,{currentImageIndex:t,setCurrentImageIndex:n})]})]})},Wt=n(23529),Qt=n(31280),$t=n(76234),Gt=n(87834),Jt=function(e){var t=e.editor,n=e.portalId;return t?(0,A.jsx)($t.Z,{container:function(){return document.getElementById(n)},children:(0,A.jsx)("div",{className:"flex items-center md:pt-2",children:(0,A.jsx)(Gt.c,{popoverPanelClassName:"md:!w-[21rem]",onEmojiSelect:function(e){return t.chain().focus().insertContent(e.emoji).run()},targetWrapperClassName:"!flex",target:(0,A.jsx)(I.h,{iconSize:20,buttonSize:28,iconClassName:"!text-dark !w-6 !h-6",name:"20-emoji",ariaLabel:(0,o.t)("emoji_picker")})})})}):null},Kt=["blockquote","poll","embeds","slash_commands","file","image","horizontal_rule","code_block","headings","cta"],Yt=function(e){var t,n=e.space,r=e.post,i=O().setIsFormDirty,s=(0,Ye.Gc)().formState.isDirty;return(0,a.useEffect)((function(){i(s)}),[s,i]),(0,A.jsxs)("div",{className:"border-b-primary border-y p-6 pb-4 lg:border-t-0",children:[(0,A.jsx)(k.Z.LabelMd,{weight:"semibold",children:(0,o.t)("image_space.post_modal.steps.create_post.caption_label")}),(0,A.jsx)(Qt.$,{placeholder:(0,o.t)("image_space.post_modal.steps.create_post.caption_placeholder"),name:"tiptap_body.body",sgidToObjectMap:(null===r||void 0===r||null===(t=r.tiptap_body)||void 0===t?void 0:t.sgids_to_object_map)||{},spaceId:null===n||void 0===n?void 0:n.id,editorClassName:"min-w-full h-40 overflow-y-scroll mt-3",disabledExtensions:Kt,shouldShowTextModifiersMenu:!1,toolbars:[{portalId:"create-image-post-toolbar",component:Jt}]}),(0,A.jsx)("div",{id:"create-image-post-toolbar"})]})},Xt=function(e){var t=e.space,n=!!t&&(0,nt.k8)(t);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(Ke.l.Item,{variant:"extra-bottom-margin",className:"!pt-3",hideBorder:!0,name:"slug",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,hideDescription:!0,tooltipText:(0,o.t)("post.slug_description"),children:(0,A.jsx)(Ke.l.Input,{name:"slug",autoComplete:"off"})}),n&&(0,A.jsx)(Ke.l.Item,{variant:"extra-bottom-margin",className:"!pt-4",hideBorder:!0,name:"user_id",translationRoot:"post",fullWidth:!0,hideDescription:!0,tooltipText:(0,o.t)("post.user_id_description"),children:(0,A.jsx)(Ke.l.CommunityMemberSelect,{name:"user_id",direction:"up",valueField:"user_id"})})]})},en=function(e){var t=e.space,n=(0,Be.m)().post,r={hide_meta_info:!0,is_comments_disabled:!0,is_comments_closed:!(0,(0,Ye.Gc)().watch)("is_comments_disabled"),is_liking_disabled:!0,is_truncation_disabled:!0,pin_to_top:Boolean(n.id)&&(0,$e.Hz)(n),hide_from_featured_areas:!(null!==t&&void 0!==t&&t.hide_from_featured_areas),"gallery.downloadable_images":!0},i=Object.keys(r).filter((function(e){return r[e]}));return(0,A.jsx)(A.Fragment,{children:i.map((function(e){return(0,A.jsx)(Ke.l.Item,{id:"post_".concat(e),name:e,label:(0,o.t)("post.".concat(e)),labelClassName:"!font-normal !p-0",className:"mb-3 !p-0",hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,A.jsx)(Ke.l.ToggleSwitch,{name:e,variant:"small"})},e)}))})};function tn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rn=function(e){var t=e.space,n=tn((0,a.useState)(!1),2),r=n[0],i=n[1];return(0,A.jsxs)("div",{className:"border-primary border-b",children:[(0,A.jsxs)("button",{type:"button",className:"flex w-full items-center justify-between px-6 py-5",onClick:function(){return i(!r)},"aria-expanded":r,children:[(0,A.jsx)(k.Z.LabelMd,{weight:"semibold",children:(0,o.t)("image_space.post_modal.steps.create_post.more_options_label")}),(0,A.jsx)(q.JO,{type:r?"cheveron-up":"cheveron-down",size:20})]}),r&&(0,A.jsxs)("div",{className:"mb-5 px-6",children:[(0,A.jsx)(en,{space:t}),(0,A.jsx)(Xt,{space:t})]})]})},on=function(e){var t=e.post,n=e.space,r=(0,Je.wh)().currentCommunitySettings,i=null===r||void 0===r?void 0:r.topics_enabled,s=n&&(0,nt.Y_)(n),l=O().setIsScheduledBarPortalRendered,c=(0,$.j)();return(0,a.useEffect)((function(){c&&l(!0)}),[c,l]),(0,A.jsxs)("div",{className:"border-primary w-full lg:h-full lg:w-1/4 lg:overflow-scroll lg:border-l",children:[c&&(0,A.jsx)("div",{id:st.U}),(0,A.jsx)(Yt,{space:n,post:t}),i&&(n.topics_count>0||s)&&(0,A.jsx)("div",{className:"border-primary border-b px-6 pb-2",children:(0,A.jsx)(Ke.l.Item,{name:"topics",hideDescription:!0,hideBorder:!0,label:(0,o.t)("image_space.post_modal.steps.create_post.topics_label"),labelClassName:"!mb-3",children:(0,A.jsx)(Wt.w,{containerClassName:"!p-0 -mx-1",name:"topics",spaceId:n.id,creatable:s})})}),(0,nt.Y_)(n)&&(0,A.jsx)(rn,{space:n})]})};function an(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var sn=function(e){var t=e.onClose,n=e.onPostChange,r=e.shouldSkipRedirectAfterSubmit,i=(0,ze.T)().invalidatePostsApiQueries,a=(0,Be.m)().post,c=(0,Je.L2)().data,u=(0,Ue.k6)(),d=(0,Fe.useQueryClient)(),m=function(){var e,o=(e=De().mark((function e(o){return De().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(a),e.next=3,d.invalidateQueries(Ge.j);case 3:return e.next=5,i();case 5:t(!0),r||u.push((0,$e.RG)({post:o}));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){an(i,r,o,a,s,"next",e)}function s(e){an(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return o.apply(this,arguments)}}(),f=Qe({space:c,post:a,onSuccess:m}).onSubmit;return(0,A.jsx)(l.u_,{isOpen:!0,onClose:t,contentPortalId:"create-post-modal-portal",children:(0,A.jsxs)(Ke.l,{onSubmit:f,defaultValues:We(a),formClassName:"fixed inset-0 z-[1060]",children:[(0,A.jsx)(l.u_.Overlay,{}),(0,A.jsxs)(l.u_.Content,{size:"full",className:"sm:!max-h-[836px] sm:!max-w-[1312px]",children:[(0,A.jsxs)(l.u_.Header,{className:"z-10 md:!py-4",children:[(0,A.jsx)(k.Z.TitleSm,{weight:"font-semibold",children:(0,o.t)("".concat("image_space.post_modal.steps.create_post",".").concat(a.id?"edit":"create","_title"))}),(0,A.jsxs)(l.u_.HeaderActions,{className:"!gap-3",children:[(0,A.jsx)(s.z,{type:"button",variant:"secondary",onClick:function(){return t(!1)},children:(0,o.t)("cancel")}),(0,A.jsx)(at,{post:a})]})]}),(0,A.jsxs)(l.u_.Body,{className:"md:border-primary flex flex-wrap content-start !p-0 md:border-t",children:[(0,A.jsx)(Vt,{}),(0,A.jsx)(on,{post:a,space:c})]})]})]})})},ln=["isDragActive"];function cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cn(Object(n),!0).forEach((function(t){dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var fn=function(e){var t=e.onClose,n=e.onSelection,r=O(),o=r.selectedFiles,i=r.uploadedImages,a=Y(n).handleFileSelection,s=te({handleFileSelection:a,selectedFiles:o,uploadedFilesCount:i.length}),c=s.isDragActive,u=mn(s,ln);return(0,A.jsxs)(l.u_,{isOpen:!0,onClose:t,contentPortalId:"upload-images-modal-portal",children:[(0,A.jsx)(l.u_.Overlay,{}),(0,A.jsxs)(l.u_.Content,{size:"xl",className:P()("aspect-square",{"!bg-light-blue":c}),children:[(0,A.jsxs)(l.u_.Header,{children:[(0,A.jsx)(l.u_.Title,{size:"sm",children:" "}),(0,A.jsx)(l.u_.HeaderActions,{children:(0,A.jsx)(l.u_.CloseButton,{onClick:t,className:P()({"!bg-light-blue":c})})})]}),(0,A.jsx)(l.u_.Body,{className:"flex cursor-pointer flex-col items-center justify-center !p-0",children:(0,A.jsx)(mt,un(un({isDragActive:c},u),{},{className:"pb-14"}))})]})]})},pn=n(11049),vn=n(84710);function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gn=function(e){var t=e.spaceId,n=e.onClose,r=e.currentPost,s=e.onPostChange,l=void 0===s?i.noop:s,c=e.shouldSkipRedirectAfterSubmit,f=void 0!==c&&c,p=(0,pn.dd)(),v=O(),h=v.currentStep,b=v.setCurrentStep,g=v.reset,y=v.isFormDirty,_=v.isImagesDirty,x=function(){(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!y&&!_||confirm((0,o.t)("quick_post_v2.accidental_leave_confirmation")))&&(g(),n())},j=function(e){var t=(0,Ge.t)({spaceId:null===e||void 0===e?void 0:e.space_id,postSlug:null===e||void 0===e?void 0:e.slug,disabled:e&&"gallery"in e}),n=t.post;return t.isLoading?null:n||e||{id:null,gallery:null}}(r);return function(e){var t=O(),n=t.setCurrentStep,r=t.setUploadedImages;(0,a.useEffect)((function(){n(null!==e&&void 0!==e&&e.gallery?m:u),null!==e&&void 0!==e&&e.gallery&&r(e.gallery.images)}),[null===e||void 0===e?void 0:e.gallery,n,r])}(j),p&&p.visible&&j?(0,A.jsx)(Je.mE,{spaceId:t,children:(0,A.jsx)(vn._x,{perPagePostIds:[[j.id]],children:(0,A.jsxs)(Je.DW,{post:j,children:[h===u&&(0,A.jsx)(fn,{onClose:x,onSelection:function(){return b(d)}}),h===d&&(0,A.jsx)(Le,{onClose:x}),h!==u&&h!==d&&(0,A.jsx)(sn,{onClose:x,onPostChange:l,shouldSkipRedirectAfterSubmit:f})]})})}):null},yn=pn.gk.create((function(e){return(0,A.jsx)(gn,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){bn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),_n=function(){return(0,pn.dd)(yn)}},55652:(e,t,n)=>{n.d(t,{C:()=>P});var r=n(64687),o=n.n(r),i=n(86013),a=n(11049),s=n(29614),l=n(44032),c=n(85327),u=n(67294),d=n(88767),m=n(14337);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t=e.event,n=e.onChange,r=b((0,u.useState)(c.HA.ALL),2),i=r[0],a=r[1],s=(0,d.useQueryClient)(),l=(0,m.K)({event:t}).onRecurringUnRsvpSubmit,f=function(){var e,r=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(i);case 2:return n(p(p({},t),{},{rsvped_event:!1})),e.next=5,s.invalidateQueries("posts");case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,s,"next",e)}function s(e){h(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();return{setEditMode:a,onUnRsvpConfirm:f}},_=n(85893);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var O=function(e){var t=e.event,n=e.onChange,r="events.un_rsvp.recurring_modal",u=(0,a.dd)(),d=y({event:t,onChange:n}),m=d.setEditMode,f=d.onUnRsvpConfirm,p=function(){var e,t=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return e.next=4,u.hide();case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){w(i,r,o,a,s,"next",e)}function s(e){w(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,_.jsx)(l.c,{title:(0,i.t)("".concat(r,".not_going")),isOpen:u.visible,confirmText:(0,i.t)("".concat(r,".save")),cancelText:(0,i.t)("".concat(r,".cancel")),onClose:u.hide,onCancel:u.hide,onConfirm:p,size:"sm",children:(0,_.jsx)("div",{className:"mt-6",children:(0,_.jsx)(s.S,{defaultChecked:c.HA.CURRENT,name:"recurring_event_settings.frequency_edit",options:[{label:(0,i.t)("events.edit.recurring_event_modal.this_event"),value:c.HA.CURRENT},{label:(0,i.t)("events.edit.recurring_event_modal.this_and_following"),value:c.HA.REMAINING},{label:(0,i.t)("events.edit.recurring_event_modal.all_events"),value:c.HA.ALL}],size:"sm",onChange:function(e){return m(e)}})})})},S=a.gk.create((function(e){return(0,_.jsx)(O,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),P=function(){return(0,a.dd)(S)}},82609:(e,t,n)=>{n.d(t,{F:()=>E});var r=n(67294),o=n(86013),i=n(10161),a=n(18605),s=n(64813),l=n(8246),c=n(64687),u=n.n(c),d=n(65311),m=n(92027),f=n(82177),p=n(81786),v=n(88767),h=n(55004),b=n(5036),g=n(84710),y=n(69647),_=n(81089),x=n(50732);function j(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var w=function(){var e=function(){var e,t=(e=u().mark((function e(t,n){var r,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="post"===n?{post_id:t}:{comment_id:t},e.next=3,(0,_.UT)(x.av.flaggedContent.index({params:r}));case 3:if(!((o=e.sent)&&Array.isArray(o.records)&&o.records.length>0)){e.next=6;break}return e.abrupt("return",o.records[0]);case 6:return e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){j(i,r,o,a,s,"next",e)}function s(e){j(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e,n){return t.apply(this,arguments)}}();return{list:function(e){var t=e.params,n=void 0===t?{}:t;return(0,_.UT)(x.av.flaggedContent.index({params:n}))},get:e,approve:function(e){return(0,_.gN)(x.av.flaggedContent.approve({id:e}))},reject:function(e){return(0,_.gN)(x.av.flaggedContent.reject({id:e}))}}},O="settings.moderation.review_flagged_content_modal",S=n(85893);function P(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){P(i,r,o,a,s,"next",e)}function s(e){P(i,r,o,a,s,"throw",e)}a(void 0)}))}}var k="settings.moderation.review_flagged_content_modal",N=function(e){var t=e.flaggedContentId,n=e.flaggedContentType,r=e.isOpen,i=e.onClose,a=function(e,t){var n=(0,y.p)(),r=n.success,i=n.error,a=w(),s=a.get,l=a.approve,c=a.reject,u=(0,v.useQueryClient)(),d=(0,v.useQuery)(["flagged-content",e,t],(function(){return s(e,t)}),{enabled:!!e}),m=d.data,f=d.isLoading,p=null===m||void 0===m?void 0:m.id,_=function(){if("post"===t)(0,g.o1)({postId:e,queryClient:u}).forEach((function(e){u.invalidateQueries(e)}));else if("comment"===t){var n,r,o;u.refetchQueries((0,b.kW)({postId:null===m||void 0===m||null===(n=m.flagged_contentable)||void 0===n?void 0:n.post_id,parentCommentId:null===m||void 0===m||null===(r=m.flagged_contentable)||void 0===r?void 0:r.parent_comment_id})),u.refetchQueries((0,h.z)({postId:null===m||void 0===m||null===(o=m.flagged_contentable)||void 0===o?void 0:o.post_id,id:e}))}},x=(0,v.useMutation)({mutationFn:function(){return l(String(p))},onSuccess:function(){_(),r((0,o.t)([O,"success_approving"]))},onError:function(){return i((0,o.t)([O,"error_approving"]))}}),j=x.mutate,S=x.isLoading,P=(0,v.useMutation)({mutationFn:function(){return c(String(p))},onSuccess:function(){_(),r((0,o.t)([O,"success_rejecting"]))},onError:function(){return i((0,o.t)([O,"error_rejecting"]))}});return{approveFlaggedContent:j,isApproving:S,rejectFlaggedContent:P.mutate,isRejecting:P.isLoading,isLoading:f,flaggedContent:m}}(t,n),s=a.approveFlaggedContent,l=a.rejectFlaggedContent,c=a.flaggedContent,_=a.isApproving,x=a.isRejecting,j="post",P="comment",N=null!==c&&void 0!==c?c:{},I=N.flagged_contentable,A=N.reports,E=void 0===A?[]:A,T=N.status,M=(null!==I&&void 0!==I?I:{}).type,L=(void 0===M?"":M).toLowerCase(),R=null===E||void 0===E?void 0:E.length,D=function(){var e=C(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(),e.next=3,i();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=C(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,i();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(L!==j&&L!==P)return null;var U=null===T||"rejected"===T,B=null===T||"approved"===T;return(0,S.jsxs)(f.u_,{isOpen:r,onClose:i,contentPortalId:"review-modal-content",children:[(0,S.jsx)(f.u_.Overlay,{}),(0,S.jsxs)(f.u_.Content,{size:"lg",children:[(0,S.jsxs)(f.u_.Header,{children:[(0,S.jsx)(f.u_.Title,{size:"sm",children:(0,o.t)("flagged_contents.moderation_info.reports_title",{count:R})}),(0,S.jsx)(f.u_.HeaderActions,{className:"absolute right-0 top-0 mr-6 mt-6",children:(0,S.jsx)(f.u_.CloseButton,{onClick:i})})]}),(0,S.jsxs)(f.u_.Body,{className:"flex flex-col !p-0",children:[(0,S.jsx)(m.z,{content:c}),(0,S.jsx)(d.Q,{reports:E})]}),(0,S.jsx)(f.u_.Footer,{className:"flex items-center justify-end gap-4",children:(0,S.jsxs)(S.Fragment,{children:[U&&(0,S.jsx)(p.z,{variant:"secondary",onClick:D,disabled:_,children:_?(0,o.t)([k,"approving"]):(0,o.t)([k,"approve"])}),B&&(0,S.jsx)(p.z,{variant:"danger",onClick:F,disabled:x,children:x?(0,o.t)([k,"rejecting"]):(0,o.t)([k,"reject"])})]})})]})]})};function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t=e.record,n=e.contentType,c=I((0,r.useState)(!1),2),u=c[0],d=c[1],m=t.unresolved_flagged_reports_count;if(!m)return null;var f="post"===n?(0,o.t)("flagged_contents.moderation_info.post"):(0,o.t)("flagged_contents.moderation_info.comment");return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s.a,{className:"mb-4 !py-2",iconEl:(0,S.jsx)(a.JO,{className:"text-v2-warning",type:"20-info",size:20}),children:(0,S.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,S.jsxs)(l.Z.LabelSm,{children:[(0,o.t)("flagged_contents.moderation_info.flagged_report_content",{content:f}),(0,S.jsx)(i.w,{content:(0,o.t)("flagged_contents.moderation_info.flagged_report_count",{count:m}),as:"span"})]}),(0,S.jsx)("button",{type:"button",onClick:function(){return d(!0)},className:"hover:bg-v2-warning-100 dark:hover:bg-primary rounded-full border border-black bg-transparent px-4 py-1 transition dark:border-white",children:(0,S.jsx)(l.Z.LabelSm,{weight:"semibold",children:(0,o.t)("flagged_contents.moderation_info.review_button")})})]})}),u&&(0,S.jsx)(N,{flaggedContentId:t.id,flaggedContentType:n,isOpen:u,onClose:function(){return d(!1)}})]})}},45611:(e,t,n)=>{n.d(t,{F:()=>a});var r=n(24185),o=n(98338),i=n(29402),a=function(){var e=(0,o.wh)().currentCommunitySettings,t=(0,i.T)().isSettingsRoute,n=(0,r.TH)().pathname.startsWith("/two_fa"),a=!(null===e||void 0===e||!e.circle_v3_eligible),s=!(null===e||void 0===e||!e.circle_v3_enabled),l=!(null===e||void 0===e||!e.circle_v3_preview);return a&&!s&&!l&&!t&&!n}},14539:(e,t,n)=>{n.d(t,{q:()=>i});var r=n(24185),o=n(98338),i=function(){var e=(0,o.wh)().currentCommunitySettings,t=(0,r.TH)().pathname.startsWith("/two_fa"),n=!(null===e||void 0===e||!e.circle_v3_eligible),i=!(null===e||void 0===e||!e.circle_v3_enabled),a=!(null===e||void 0===e||!e.circle_v3_preview);return n&&!i&&a&&!t}},10140:(e,t,n)=>{n.d(t,{a:()=>l});var r=n(98338),o=n(39068),i=n(29402),a=n(45611),s=n(14539),l=function(){var e=(0,r.wh)().currentCommunityMember,t=(0,a.F)(),n=(0,s.q)(),l=(0,i.T)().isSettingsRoute;return!(!(0,o.vb)(e)||l)&&(t||n)}},56421:(e,t,n)=>{n.d(t,{EW:()=>l,LG:()=>c,Mz:()=>u,Bj:()=>d,Y9:()=>m});var r=n(86013),o=n(31018);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){return Math.min(Number(e)||1,1e3)},c=function(e){return parseInt(String(e||"0").replace(/[^\d\\-]/g,""))},u=function(e){return parseFloat(String(e||"0").replace(/[^\d\\.\\-]/g,""))},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a(a({},{amountInCents:!0}),t);return function(t){var r;if(r=n.amountInCents?c(t):u(t),!isNaN(r)){var i=e.max_charge_amount;return n.amountInCents||(i=Math.round(i/100)),r=Math.min(r,i),(0,o.I)(e,r,{amountInCents:n.amountInCents,includeCurrencyCode:!1,forceMaxFractionDigits:!0})}}},m=function(e,t,n,i){var a=(0,o.I)(e,i);return t?(a+=" / ",a+=(0,r.t)("settings.paywall_prices.interval_labels.".concat(t),{count:n})):"".concat(a," ").concat((0,r.t)("settings.paywall_prices.onetime_price_text"))}},69585:(e,t,n)=>{n.d(t,{a:()=>L,O:()=>C});var r=n(86013),o=n.n(r),i=n(73935),a=n(67294),s=n(85893);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e){var t=e.trialDays,n=e.hasSubscriptionPrices,i=e.label,c=void 0===i?(0,r.t)("checkbox"):i,u=t>0,d=l((0,a.useState)(u),2),m=d[0],f=d[1];return n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"form-group full-width",children:[(0,s.jsxs)("div",{className:"form-meta",children:[(0,s.jsx)("label",{children:o().t("settings.paywalls.form.free_trial.section_subtitle")}),(0,s.jsx)("div",{className:"field-description",children:o().t("settings.paywalls.form.free_trial.section_description")})]}),(0,s.jsx)("div",{className:"form-input",children:(0,s.jsx)("div",{className:"form-meta-button",children:(0,s.jsxs)("div",{className:"simple-toggle",children:[(0,s.jsx)("input",{type:"checkbox",value:"true",id:"checkbox-enable-trial",name:"enable-trial",defaultChecked:m,onChange:function(e){f(e.target.checked)}}),(0,s.jsx)("label",{htmlFor:"checkbox-enable-trial",children:(0,s.jsx)("span",{className:"sr-only",children:c})})]})})})]}),m&&(0,s.jsxs)("div",{className:"input-container",children:[(0,s.jsx)("label",{children:o().t("settings.paywalls.form.free_trial.input_label")}),(0,s.jsxs)("div",{className:"form-input-group",children:[(0,s.jsx)("input",{type:"number",step:"1",min:"1",name:"paywall[trial_days]",id:"paywall_trial_days",placeholder:o().t("settings.paywalls.form.free_trial.placeholder"),defaultValue:t||1,className:"form-control form-input-group--prefix"}),(0,s.jsx)("div",{className:"form-input-group--suffix",children:o().t("settings.paywalls.form.free_trial.days_label")})]})]})]}):(0,s.jsx)("p",{children:o().t("settings.paywalls.form.free_trial.need_subscription_price")})},d=["monthly","annual","quarter","biannual","biweekly","weekly","daily","onetime"],m=function(e,t){return"subscription"===e?"".concat(t," ").concat((0,r.t)("settings.paywall_prices.subscription_item_text")):t},f=function(e,t,n){var o=function(e){return e/=100,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:e%1==0?0:2}).format(e)+" USD"}(n);return e?(o+=" / ",o+=(0,r.t)("settings.paywall_prices.interval_labels.".concat(e),{count:t})):o},p=function(e){var t=e.priceType,n=e.interval,o=e.intervalCount,i=e.intervalLabel,a=e.amount,l=e.preferred,c=e.allowPreferredAction,u=e.onRemove,d=e.onSetPreferred;return(0,s.jsxs)("div",{className:"price-list__element",children:[(0,s.jsxs)("div",{className:"price-list__element__info",children:[(0,s.jsx)("div",{className:"price-list__element__info--type",children:m(t,i)}),(0,s.jsx)("div",{className:"price-list__element__info--amount",children:f(n,o,a)})]}),(0,s.jsxs)("div",{className:"price-list__element__actions",children:[!l&&c&&(0,s.jsx)("button",{type:"button",className:"price-list__element__actions__action btn-link label-negative focus-visible:!outline-secondary focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:d,children:(0,r.t)("settings.paywall_prices.buttons.make_preferred")}),l&&(0,s.jsx)("button",{type:"button",className:"price-list__element__actions__action label-positive focus-visible:!outline-secondary focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:d,children:(0,r.t)("settings.paywall_prices.form.preferred_label")}),(0,s.jsx)("button",{type:"button",className:"price-list__element__actions__danger btn-link focus-visible:!outline-secondary focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:u,children:(0,r.t)("settings.paywall_prices.buttons.remove")})]})]})},v={daily:{interval:"daily",interval_count:1,interval_label:"daily"},weekly:{interval:"weekly",interval_count:1,interval_label:"weekly"},biweekly:{interval:"weekly",interval_count:2,interval_label:"biweekly"},monthly:{interval:"monthly",interval_count:1,interval_label:"monthly"},quarter:{interval:"monthly",interval_count:3,interval_label:"quarter"},biannual:{interval:"monthly",interval_count:6,interval_label:"biannual"},annual:{interval:"yearly",interval_count:1,interval_label:"annual"},onetime:{interval:void 0,interval_count:void 0,interval_label:"onetime"}},h=function(e,t,n,r){var o=n.find((function(n){return n.amount===Math.round(100*e)&&n.interval===v[t].interval&&n.interval_count===v[t].interval_count}));return e.length<1||n.length>r-1||!!o},b=n(96486);function g(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||w(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){if(e){if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S="monthly",P=function(e,t){var n=j((0,a.useState)(e||[]),2),r=n[0],o=n[1],i=j((0,a.useState)(S),2),s=i[0],l=i[1],c=j((0,a.useState)(""),2),u=c[0],d=c[1],m=j((0,a.useState)([]),2),f=m[0],p=m[1],h=j((0,a.useState)(!1),2),y=h[0],x=h[1];(0,a.useEffect)((function(){!function(){var t=r.filter((function(e){return!!e.tempId})).map((function(e){return(0,b.omit)(e,["tempId","interval_label"])})),n=e.filter((function(e){return!r.some((function(t){return t.id===e.id}))})).map((function(e){return _(_({},e),{},{_destroy:"1"})})),o=e.find((function(e){return e.preferred})),i=r.find((function(e){return e.preferred})),a=[];null!==o&&void 0!==o&&o.id&&(null===o||void 0===o?void 0:o.id)!==(null===i||void 0===i?void 0:i.id)&&r.find((function(e){return e.id===(null===o||void 0===o?void 0:o.id)}))&&a.push({id:o.id,preferred:!1}),"undefined"!==typeof(null===i||void 0===i?void 0:i.id)&&(null===o||void 0===o?void 0:o.id)!==(null===i||void 0===i?void 0:i.id)&&a.push({id:i.id,preferred:!0});var s=[].concat(g(t),g(n),a);p(s.map((function(e){return JSON.stringify(e)}))),x(r.some((function(e){return e.interval})))}()}),[r]);return{currentPaywallPrices:r,intervalOption:s,onIntervalOptionChange:function(e){l(e.target.value)},amount:u,onAmountChange:function(e){var t=e.target.value;t?d(t<1?1:t):d("")},onAdd:function(e){if(e.preventDefault(),s&&u&&!(r.length>t)){var n=v[s],i=n.interval?"subscription":"onetime",a=Math.round(100*u);o([].concat(g(r),[{tempId:"temp-id-".concat(Math.floor(1e6*Math.random())),amount:a,interval:n.interval,interval_count:n.interval_count,interval_label:I18n.t("settings.paywall_prices.form.interval_select_options.".concat(n.interval_label,"_label")),price_type:i,preferred:!1}])),l(S),d("")}},onRemove:function(e){if(!(e<0||e>=r.length)){var t=g(r);t.splice(e,1),o(t)}},onSetPreferred:function(e){if(!(e<0||e>=r.length)){var t=g(r),n=t.findIndex((function(e){return e.preferred}));n!==e&&"undefined"!==typeof n&&(t[n]=_(_({},t[n]),{},{preferred:!1})),t[e]=_(_({},t[e]),{},{preferred:!0}),o(t)}},changes:f,hasSubscriptionPrices:y}},C=function(e){var t=e.name,n=e.paywall_prices,o=e.prices_max_count,a=e.trial_days,l=P(n,o),c=l.currentPaywallPrices,m=l.intervalOption,f=l.onIntervalOptionChange,v=l.amount,b=l.onAmountChange,g=l.onAdd,y=l.onRemove,_=l.onSetPreferred,x=l.changes,j=l.hasSubscriptionPrices,w=document.getElementById("paywall-free-trial-container");return(0,s.jsxs)("div",{className:"paywall-prices-container",children:[(0,s.jsxs)("div",{className:"add-new-price","data-testid":"add-new-price",children:[(0,s.jsx)("select",{className:"add-new-price__element",value:m,onChange:f,children:d.map((function(e){return(0,s.jsx)("option",{value:e,children:(0,r.t)("settings.paywall_prices.form.interval_select_options.".concat(e,"_label"))},e)}))}),(0,s.jsx)("span",{className:"amount-icon",children:"$"}),(0,s.jsx)("input",{type:"number",step:".01",min:"1",placeholder:(0,r.t)("settings.paywall_prices.amount"),className:"form-control add-new-price__element--short rounded-none rounded-r-md",value:v,onChange:b}),(0,s.jsx)("button",{type:"submit",disabled:h(v,m,c,o),className:"add-new-price__element--button btn btn-circle",onClick:g,children:(0,r.t)("settings.paywall_prices.buttons.add")})]}),(0,s.jsx)("div",{className:"price-list",children:c.map((function(e,t){var n=e.id,r=e.tempId,o=e.price_type,i=e.interval,a=e.interval_count,l=e.interval_label,u=e.amount,d=e.preferred;return(0,s.jsx)(p,{priceType:o,interval:i,intervalLabel:l,intervalCount:a,amount:u,preferred:d,allowPreferredAction:c.length>1,onRemove:function(){return y(t)},onSetPreferred:function(){return _(t)}},n||r)}))}),x.map((function(e){return(0,s.jsx)("input",{name:"".concat(t,"[]"),type:"hidden",value:e},e)})),(0,i.createPortal)((0,s.jsx)(u,{trialDays:a,hasSubscriptionPrices:j}),w)]})},k=n(14246),N=n(67687),I=["currency"];function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var L=(0,a.forwardRef)((function(e,t){var n=e.currency,r=M(e,I),o=n.code.toUpperCase(),i=n.direction===k.RV.rtl?(0,s.jsx)("div",{className:"px-4 py-2",children:o}):null,a=n.direction===k.RV.ltr?(0,s.jsx)(s.Fragment,{children:o}):null;return(0,s.jsx)(N.l.Input,E(E({},r),{},{ref:t,inputMode:"numeric",prefixWrapperClassName:"bg-primary! border-primary! rounded-l-lg! relative! -mr-px! inline-flex! items-center! space-x-2! border! sm:text-sm!",prefix:i,suffix:a}))}));L.displayName="PaywallCurrencyAmountFormInput"},41165:(e,t,n)=>{n.d(t,{S:()=>b});var r=n(94184),o=n.n(r),i=n(33986),a=n(43535),s=n(98338),l=n(4404),c=n(86013),u=n(62618),d=n(18605),m=n(28166),f=n(85893),p=function(e){var t=e.post,n=e.comments_count,r=e.className,i=e.showCount,a=void 0===i||i,s=e.onCommentsClick,l=e.iconClassName,p=void 0===l?"!text-default":l;return(0,f.jsx)("div",{className:o()("col-span-1",r),children:(0,f.jsxs)(m.s,{post:t,allComments:!0,ariaLabel:(0,c.t)("cap_comment_aria_label",{title:(null===t||void 0===t?void 0:t.name)||(0,c.t)("this_post")}),className:"action-item action-comment !flex !items-center !justify-center !text-center",onClick:s,children:[(0,f.jsx)("span",{className:"action__icon !inline-flex align-text-top",children:(0,f.jsx)(d.JO,{"aria-hidden":!0,type:"message",className:p,useWithFillCurrentColor:!0})}),a&&(0,f.jsx)("span",{className:"count !text-dark",children:(0,u.HA)(n)})]})})};function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){var t,n=e.name,r=e.onLikeToggle,i=e.is_liked_by_current_user,a=e.user_likes_count,l=e.isOrCanBeCommunityMember,m=e.className,p=e.iconClassName,h=void 0===p?"!text-default":p,b=e.likedSpanClassName,g=e.showCount,y=void 0===g||g,_=(0,s.wh)().isViewOnlyMasquerading;return(0,f.jsx)("div",{className:o()("col-span-1",m),children:(0,f.jsxs)("button",{type:"button",onClick:r,"aria-label":(0,c.t)("like_post_aria_label",{name:null!==n&&void 0!==n?n:""}),className:o()("action-item action-link action-like post__actions--like text-default !flex !items-center !justify-center !text-center",{liked:i,disabled:!l||_}),children:[(0,f.jsx)("span",{className:o()("action__icon !inline-flex align-text-top",i&&b),children:(0,f.jsx)(d.JO,{type:"like",className:o()((t={},v(t,h,!i),v(t,"!text-brand",i),t)),useWithFillCurrentColor:!i,"aria-hidden":!0})}),y&&(0,f.jsx)("span",{className:o()("count",{"!text-dark":!i}),children:(0,u.HA)(a)})]})})},b=function(e){var t=e.type,n=void 0===t?"list":t,r=e.wrapperClassName,c=e.commentButtonClassName,u=e.commentIconClassName,d=e.likeButtonClassName,m=e.likeIconClassName,v=e.likedSpanClassName,b=e.showCommentsCount,g=void 0===b||b,y=e.showLikesCount,_=void 0===y||y,x=e.onCommentsClick,j=(0,i.m)(),w=j.post,O=j.showEngagementActions,S=j.onLikeToggle,P=w.user_likes_count,C=w.is_liking_enabled,k=w.is_comments_enabled,N=w.is_liked_by_current_user,I=w.comments_count,A=w.post_details_loaded,E=w.display_title,T=(0,s.EU)();return O&&(C||k)?A?(0,f.jsxs)("div",{className:o()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),r),children:[(0,f.jsx)(a.T,{children:C&&(0,f.jsx)(h,{name:E,onLikeToggle:function(){null===S||void 0===S||S(void 0)},isOrCanBeCommunityMember:T,user_likes_count:P,is_liked_by_current_user:N,className:d,iconClassName:m,likedSpanClassName:v,showCount:_})}),k&&(0,f.jsx)(p,{comments_count:I,post:w,className:c,iconClassName:u,showCount:g,onCommentsClick:x})]}):(0,f.jsxs)("div",{className:o()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),r),children:[(0,f.jsx)("div",{className:o()("action-item action-link action-like post__actions--like",d),children:(0,f.jsx)("span",{className:"action__icon",children:(0,f.jsx)(l.gi,{variant:"row",lg:!0,short:!0})})}),(0,f.jsx)("div",{className:o()("action-item action-comment",c),children:(0,f.jsx)("span",{className:"action__icon",children:(0,f.jsx)(l.gi,{variant:"row",lg:!0,short:!0})})})]}):null}},73096:(e,t,n)=>{n.d(t,{o:()=>Lt});var r=n(67294),o=n(86013),i=n.n(o),a=n(43227),s=n(96486),l=n(98338),c=n(44032),u=n(94184),d=n.n(u),m=n(87536),f=n(95172),p=n(56200),v=n(31280),h=n(57290),b=n(81625),g=n(81786),y=n(85893);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S=function(e){var t=e.spaceId,n=e.postId,i=e.communityMemberForReply,a=e.autoFocus,c=e.editorRef,u=e.parentCommentId,d=e.isEdit,_=e.initialSgidToObjectMap,O=void 0===_?{}:_,S=(0,l.wh)().currentCommunityMember,P=w((0,r.useState)(O),2),C=P[0],k=P[1],N=w((0,r.useState)(!1),2),I=N[0],A=N[1],E=w((0,r.useState)(0),2),T=E[0],M=E[1],L=(0,m.Gc)(),R=L.watch,D=L.reset,F=L.formState,U=F.isSubmitting,B=F.isSubmitSuccessful,z=R("tiptap_body"),H=!(0,p.NU)(z)||U,Z=I&&!H;(0,f.y1)("cmd+enter, ctrl+enter",(function(){"triggerFormSubmit"in L&&L.triggerFormSubmit()}),{enableOnContentEditable:!0,enabled:Z},[L,Z]),(0,r.useEffect)((function(){B&&(D(),M((function(e){return e+1})))}),[B,D]),(0,r.useEffect)((function(){i&&i.id!==(null===S||void 0===S?void 0:S.id)&&(k(x(x({},C),{},j({},i.rich_text_field_sgid,i))),(0,s.defer)((function(){var e,t;null===c||void 0===c||null===(e=c.current)||void 0===e||null===(t=e.chain)||void 0===t||t.call(e).focus("start").insertContent([(0,h.F_)({sgid:i.rich_text_field_sgid}),(0,h.$U)({text:" "})]).run()})))}),[i,S,c]),(0,r.useEffect)((function(){(0,s.defer)((function(){var e,t,n;a&&(null===c||void 0===c||null===(e=c.current)||void 0===e||null===(t=e.commands)||void 0===t||null===(n=t.focus)||void 0===n||n.call(t,"end"))}))}),[]);var q=["post",n,d?"edit":"create",u,"comment-form-toolbar"].filter(Boolean).join("-");return(0,y.jsxs)("div",{className:"border-primary space-y-3 rounded-lg border px-4 py-3",children:[(0,y.jsx)(v.$,{editorRef:c,placeholder:(0,o.t)("write_a_comment"),name:"tiptap_body.body",onFocusChange:A,toolbars:[{portalId:q,component:b.o}],className:"h-full max-h-[400px] overflow-y-auto",editorClassName:"h-full",spaceId:t,sgidToObjectMap:C,disabledExtensions:["poll","ai_copilot","cta"]}),(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsx)("div",{id:q}),(0,y.jsx)(g.z,{variant:"primary",type:"submit",disabled:H,small:!0,className:"!px-4",children:d?U?(0,o.t)("comments.create.actions.saving"):(0,o.t)("comments.create.actions.save"):U?(0,o.t)("comments.create.actions.submitting"):(0,o.t)("comments.create.actions.submit")})]})]},T)},P=n(64422),C=n(67687),k=n(88767),N=n(81089),I=n(50732),A=n(69647);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){var t=e.spaceId,n=e.postId,r=e.parentCommentId,i=e.communityMemberForReply,a=e.autoFocus,s=void 0!==a&&a,c=e.onCreate,u=e.bodyInputRef,m=(0,l.N3)(),f="full-post-modal"!==(0,l.Zh)().usedIn,p=function(e){var t=e.postId,n=e.parentCommentId,r=e.onCreate,i=(0,A.p)().error;return{createComment:(0,k.useMutation)((function(e){return(0,N.Cu)(I.av.comments.create({postId:t}),{comment:T({parent_comment_id:n},e)})}),{onSuccess:r,onError:function(){return i((0,o.t)("comments.create.alerts.failure"))}}).mutateAsync}}({postId:n,parentCommentId:r,onCreate:c}),v=p.createComment;return(0,y.jsxs)("div",{className:d()("post__reply items-start gap-3",{"reply-to-parent":r,"reply-to-post":!r}),children:[f&&(0,y.jsx)(P.s,{src:m.avatar_url,name:m.name,size:"10"}),(0,y.jsx)(C.l,{className:"relative w-full",onSubmit:function(e){return v(e)},children:(0,y.jsx)(S,{spaceId:t,postId:n,communityMemberForReply:i,autoFocus:s,editorRef:u,isEdit:!1,parentCommentId:r})})]})},R=n(17373),D=n(24185),F=function(){var e=(0,D.TH)().hash.split(R.q)[1];return{commentId:e&&parseInt(e,10)||null}};function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var z=function(e){var t=e.enabled,n=void 0===t||t,o=U((0,r.useState)(!1),2),i=o[0],a=o[1],s=F().commentId;(0,r.useEffect)((function(){if(n&&s&&!i){var e=setTimeout((function(){a(!0);var e=document.querySelector("".concat(R.q).concat(s));e&&e.scrollIntoView()}),500);return function(){return clearTimeout(e)}}}),[n,s,i])},H=n(92041),Z=function(e){var t=e.space,n=e.post,r=e.parentCommentId,o=e.preloaded,s=void 0!==o&&o,c=e.preloadedComments,u=void 0===c?[]:c,d=e.preloadedCommentsTotalCount,m=void 0===d?0:d,f=e.showReplyForm,p=void 0!==f&&f,v=e.autofocusReplyForm,h=void 0!==v&&v,b=e.communityMemberForReply,g=e.onCommentReplyClick,_=e.onCommentCreate,x=e.onCommentDelete,j=e.formRef,w=(0,l.N3)(),O=(0,H.w)({postId:n.id,parentCommentId:r,preloaded:s,preloadedComments:u,preloadedCommentsTotalCount:m,postCommentsClosed:n.is_comments_closed}),S=O.comments,P=O.isLoading,C=O.isFetchingNextPage,k=O.hasNextPage,N=O.fetchNextPage,I=O.addCommentToList,A=O.updateCommentInList,E=O.removeCommentFromList;z({enabled:!P&&!r});var T=function(e){E(e),x(e)},M=P||C,R=w&&t&&p&&(!M||S.length>0);return(0,y.jsxs)(y.Fragment,{children:[S.map((function(e){return(0,y.jsx)(vt,{space:t,post:n,comment:e,autofocusReplyForm:!0,onReplyClick:g,onUpdate:A,onDelete:T,onReplyCreate:_,onReplyDelete:x},e.id)})),M&&(0,y.jsx)(a.m,{}),!M&&k&&(0,y.jsx)("div",{className:"load-more",children:(0,y.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),N()},className:r?"load-more__replies text-link":"btn btn-secondary load-more__comments",children:i().t(r?"comments.list.show_more_replies":"comments.list.show_more_comments")})}),R&&(0,y.jsx)(L,{spaceId:t.id,spaceIsPrivate:t.is_private,postId:n.id,parentCommentId:r,communityMemberForReply:b,autoFocus:h,onCreate:function(e){I(e),_(e)},bodyInputRef:j})]})},q=n(18701),V=n(58974),W=n(54482),Q=n(27025);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K=function(e){var t=e.comment,n=e.canReport,r=e.canReview,i=e.canEdit,a=e.canDestroy,s=e.canBookmark,l=e.isReply,c=e.onReportClick,u=e.onEditClick,m=e.onDeleteClick,f=e.onUpdate,p=(0,q.I)(),v=[];return n&&v.push({key:"report",label:(0,o.t)("comments.action_menu.report.label"),href:"#",onClick:function(){c()}}),r&&v.push(G({key:"review",label:(0,o.t)("comments.action_menu.review.label"),to:I.sC.index()},p?{target:"_blank",rel:"noreferrer"}:{})),i&&v.push({key:"edit",label:(0,o.t)("comments.action_menu.edit.label"),onClick:function(){u()}}),a&&v.push({key:"delete",label:(0,o.t)("comments.action_menu.delete.label"),hasDanger:!0,onClick:function(){m()}}),0!==v.length||s?(0,y.jsx)("div",{className:d()("post__actions--comment",{"post__actions--reply":l}),"data-testid":"post-comment-actions",children:(0,y.jsxs)(Q.Lt,{button:(0,y.jsx)(W.h,{dataTestId:"action-more",name:"16-menu-dots-horizontal"}),children:[(0,y.jsx)(V.e,{variant:"dropdown",bookmarkType:"comment",record:t,onSuccess:function(e){var n=G(G({},t),{},{bookmark_id:e});f(n)}}),v.map((function(e){return(0,y.jsx)(Q.Lt.ItemWithLink,G(G({},e),{},{children:e.label}),e.key)}))]})}):null},Y=n(36464),X=n.n(Y),ee=n(39068),te=n(11355),ne=n(54030),re=n(43574),oe=n(66422),ie=n(7074),ae=function(e){var t=e.tiptapBody;return"post"===(null===t||void 0===t?void 0:t.format)?(0,y.jsx)(ie.R,{readOnly:!0,value:t.body,sgidToObjectMap:t.sgids_to_object_map,inlineAttachments:t.inline_attachments,openInternalLinksInCurrentTab:!0,disabledExtensions:["cta"]}):(0,y.jsx)(oe.T,{type:"comment",editable:!1,rich_text_body:t,openInternalLinksInCurrentTab:!0})},se=n(95287),le=n(34141),ce=n(61844),ue=function(e){var t=e.comment,n=t.body_trix_content,r=t.editor,o=t.tiptap_body,i=t.updated_at,a="tiptap"===r;return(0,y.jsx)("div",{className:"post__body","data-testid":"comment-body",children:(0,y.jsx)("div",{className:d()("post__inside text-dark !line-clamp-none",{"!overflow-auto":(0,se.G6)()}),"data-testid":"comment-body-inside",children:(0,y.jsx)(ce.X,{lines:8,children:a?(0,y.jsx)(ae,{tiptapBody:o}):(0,y.jsx)(le.P,{content:n})})},i)})};function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pe=function(e){var t,n=e.post,i=e.comment,a=i.id,c=i.community_member,u=i.member_tags,m=i.flagged_for_approval_at,f=i.created_at,p=(0,te.O)({public_uid:null!==(t=c.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0}}),v=(0,q.I)(),h=(0,r.useRef)(null),b=(0,l.wh)().currentCommunityMember,g=(0,ee.vb)(b),_=Boolean(c.admin),x=null===u||void 0===u?void 0:u.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.post_bio)})),j=(null===x||void 0===x?void 0:x.length)>0||_,w=(0,ne.kK)()?g:j,O=me({href:(0,I.LM)({spaceSlug:n.space_slug,slug:n.slug,hash:"".concat(R.q).concat(a)})},v?{target:"_blank",rel:"noreferrer"}:{}),S=(0,s.truncate)(c.headline,{length:160});return(0,y.jsxs)("div",{className:d()("post__user !items-start"),ref:h,children:[(0,y.jsx)("div",{className:"post__avatar",children:(0,y.jsx)("a",me(me({className:"user__avatar"},p),{},{children:(0,y.jsx)(P.s,{src:c.avatar_url||"",name:c.name||"",size:"10"})}))}),(0,y.jsxs)("div",{className:"post__bio",children:[(0,y.jsxs)("div",{className:d()("author",{"no-headline":!c.headline}),children:[(0,y.jsx)("div",{className:"author__name",children:(0,y.jsx)("a",me(me({},p),{},{children:c.name}))}),j&&w&&(0,y.jsx)("div",{className:"author__tags member-tags",children:(0,y.jsx)(re.m,{memberTags:x,isAdmin:_})}),(0,y.jsx)("div",{className:"author__time",children:(0,y.jsx)("a",me(me({},O),{},{children:X()(f)}))}),m&&(0,y.jsx)("span",{className:d()("author__in-review",{"!ml-0 !mt-1 md:!ml-2":!j}),children:(0,o.t)("comments.in_review")})]}),S&&(0,y.jsx)("div",{className:"post__meta",children:(0,y.jsx)("div",{className:"author__credentials text-dark",children:S})}),(0,y.jsx)(ue,{comment:i})]})]})},ve=n(28536),he=function(e){var t,n,r=e.comment,i=e.updateComment,a="post"===(null===r||void 0===r||null===(t=r.tiptap_body)||void 0===t?void 0:t.format);return(0,y.jsx)("div",{className:"text-dark mb-1 whitespace-pre-line text-sm font-normal",children:a?(0,y.jsx)(ve.l,{onSubmit:i,defaultValues:{tiptap_body:r.tiptap_body},children:(0,y.jsx)(S,{isEdit:!0,postId:r.post_id,spaceId:r.space_id,autoFocus:!0,initialSgidToObjectMap:null===r||void 0===r||null===(n=r.tiptap_body)||void 0===n?void 0:n.sgids_to_object_map})}):(0,y.jsx)(oe.T,{autofocus:!0,editable:!0,type:"comment",hardBreakOnEnter:!0,submitOnEnter:!1,submitOnModEnter:!0,rich_text_body:r.tiptap_body,onSubmit:function(e){var t=e.body,n=e.attachments;return i({tiptap_body:{body:t,attachments:n}})},isUpdate:!0,placeholder:(0,o.t)("write_a_comment"),menubarProps:{submitButtonLabel:(0,o.t)("comments.create.actions.save"),submittingLabel:(0,o.t)("comments.create.actions.saving")}})})},be=n(11049),ge=n(82177),ye=function(e){var t=e.comment,n=e.updateComment,r=(0,be.dd)();return(0,f.y1)("esc",(function(){return r.remove()}),{enableOnContentEditable:!0},[]),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ge.u_.Overlay,{}),(0,y.jsxs)(ge.u_.Content,{size:"lg",children:[(0,y.jsxs)(ge.u_.Header,{children:[(0,y.jsx)(ge.u_.Title,{size:"sm",children:(0,o.t)("comments.edit.form.title")}),(0,y.jsx)(ge.u_.HeaderActions,{children:(0,y.jsx)(ge.u_.CloseButton,{onClick:r.remove})})]}),(0,y.jsx)(ge.u_.Body,{className:"pb-6",children:(0,y.jsx)(he,{comment:t,updateComment:n})})]})]})},_e=n(64419),xe=n(23127),je=function(e){var t=e.spaceId,n=e.spaceIsPrivate,r=e.onClose,i=(0,m.Gc)(),a=i.watch,s=i.formState,l=s.isDirty,c=s.isSubmitting,u=s.isSubmitSuccessful,d=c||u,f=!!a().body&&!d;(0,_e.M)({enabled:f});var p=function(){l&&!confirm((0,o.t)("prevent_accidental_leave_message"))||r()};return(0,y.jsxs)(ge.u_.Content,{size:"lg",wrapperClassName:"!h-full",className:"!transform-none !overflow-visible",children:[(0,y.jsxs)(ge.u_.Header,{children:[(0,y.jsx)(ge.u_.Title,{children:(0,o.t)("comments.edit.form.title")}),(0,y.jsx)(ge.u_.HeaderActions,{children:(0,y.jsx)(ge.u_.CloseButton,{onClick:p})})]}),(0,y.jsx)(ge.u_.Body,{className:"comment__edit-modal-content-body trix-v2 max-h-[calc(100dvh-82px-65px)] !overflow-visible md:max-h-none",children:(0,y.jsx)(xe.O,{id:"comment-edit-body",name:"body",placeholder:(0,o.t)("comments.form.fields.body_placeholder"),space_id:t,is_private_space:n})}),(0,y.jsxs)(ge.u_.Footer,{className:"bottom-0 flex justify-end space-x-4",children:[(0,y.jsx)(g.z,{type:"button",variant:"secondary",onClick:p,children:(0,o.t)("cancel")}),(0,y.jsx)(g.z,{type:"submit",variant:"primary",disabled:!f,children:d?(0,o.t)("saving_changes"):(0,o.t)("save_changes")})]})]})},we=function(e){var t=e.space,n=e.comment,r=e.onUpdate,i=t.id,a=t.is_private,l=(0,be.dd)(),c="tiptap"===n.editor,u=function(e){var t=e.comment,n=e.onUpdate,r=t.id,i=t.post_id,a=t.body_for_editor,s=(0,A.p)(),l=s.success,c=s.error;return{defaultValues:{body:a},updateComment:(0,k.useMutation)((function(e){return(0,N.gN)(I.av.comments.update({postId:i,id:r}),{comment:e})}),{onSuccess:function(e){n(e),l((0,o.t)("comments.edit.alerts.success"))},onError:function(){return c((0,o.t)("comments.edit.alerts.failure"))}}).mutateAsync}}({comment:n,onUpdate:function(e){r(e),l.hide()}}),d=u.defaultValues,m=u.updateComment;return(0,y.jsx)(ge.u_,{title:(0,o.t)("comments.edit.form.title"),isOpen:l.visible,onClose:s.noop,children:c?(0,y.jsx)(ye,{comment:n,updateComment:m}):(0,y.jsxs)(C.l,{defaultValues:d,onSubmit:m,className:"h-full",formClassName:"h-full",children:[(0,y.jsx)(ge.u_.Overlay,{}),(0,y.jsx)(je,{spaceId:i,spaceIsPrivate:a,onClose:l.hide})]})})},Oe=be.gk.create((function(e){var t=e.space,n=e.comment,r=e.onUpdate;return(0,y.jsx)(we,{space:t,comment:n,onUpdate:r})})),Se=n(38503),Pe=["label","onClick","disabled","isLiked","className"];function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){Ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ie(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ae=function(e){var t=e.label,n=e.onClick,r=e.disabled,o=void 0!==r&&r,i=e.isLiked,a=void 0!==i&&i,s=e.className,l=Ie(e,Pe),c=(0,Se.TC)().isDarkAppearance;return(0,y.jsx)("div",{children:(0,y.jsx)("button",ke(ke({type:"button",className:s,onClick:function(e){e.preventDefault(),o||n()},"aria-disabled":o},l),{},{children:(0,y.jsx)("span",{"aria-checked":a,className:d()("text-sm font-medium",{"font-bold":a,"text-default":!a,"!text-darkest":c&&a}),children:t})}))})},Ee=n(62618),Te=function(e){var t=e.likesCount,n=e.onClick,r=(0,Se.TC)().isDarkAppearance;return(0,y.jsx)("div",{className:"w-full",children:(0,y.jsx)("button",{type:"submit",className:d()("text-default float-right text-sm font-medium",{"text-darkest":r}),"data-testid":"like-count",onClick:n,children:(0,o.t)("comments.likes",{count:t,formatted_count:(0,Ee.HA)(t)})})})},Me=function(e){var t=e.canLike,n=e.canReply,r=e.canSeeLikes,i=e.isLiked,a=e.isLikeDisabled,s=e.likesCount,c=e.onLikeClick,u=e.onLikesCountClick,m=e.onReplyClick,f=(0,l.wh)().currentUser,p=r&&s>0&&(f||t&&n);return(0,y.jsxs)("div",{className:"post__actions post__actions-visible",children:[t&&(0,y.jsx)(Ae,{className:d()("post__actions--like",{liked:i}),label:(0,o.t)("comments.engagement_actions.".concat(i?"liked":"like")),onClick:c,disabled:a,isLiked:i}),n&&(0,y.jsx)(Ae,{className:"post__actions--reply",label:(0,o.t)("comments.engagement_actions.reply"),onClick:m}),p&&(0,y.jsx)(Te,{likesCount:s,onClick:u})]})},Le=n(58533),Re=n(13288),De=n(8246),Fe=["onClick"];function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function He(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ze=function(e){var t,n,r=e.communityMember,o=e.hideModal,i=(0,te.O)({public_uid:null!==(t=r.public_uid)&&void 0!==t?t:""}),a=i.onClick,s=He(i,Fe);return(0,y.jsxs)("button",Be(Be({type:"button",className:"flex w-full items-center gap-3 text-left",onClick:function(e){o(),null===a||void 0===a||a(e)}},s),{},{children:[(0,y.jsx)("div",{className:"mt-0",children:(0,y.jsx)(P.s,{name:null!==(n=r.name)&&void 0!==n?n:"",src:r.avatar_url,size:"10"})}),(0,y.jsx)(De.Z.LabelSm,{weight:"medium",children:r.name})]}))},qe=n(85564),Ve=n.n(qe),We=n(10928),Qe=n.n(We),$e=n(45578),Ge=n.n($e),Je=n(78599),Ke=function(e){var t=e.id,n=e.placeholderLikesCount,r=(0,be.dd)(),i=function(e){var t=e.id,n=e.isQueryEnabled,r=e.placeholderLikesCount,o=(0,Je.m)(I.av.comments.userLikes({id:t,params:{per_page:15}}),{enabled:n}),i=o.data,a=o.isLoading,s=o.hasNextPage,l=o.fetchNextPage,c=o.mapPages;return{likedByMembers:Ge()(Ve()(c((function(e){return e.records}))),"id"),totalLikesCount:i?Qe()(i.pages).count:r,isLoading:a,hasNextPage:s,fetchNextPage:l}}({id:t,isQueryEnabled:r.visible,placeholderLikesCount:n}),s=i.likedByMembers,l=i.totalLikesCount,c=i.isLoading,u=i.hasNextPage,d=i.fetchNextPage;return(0,y.jsxs)(ge.u_,{title:(0,o.t)("comments.likes"),isOpen:r.visible,onClose:r.hide,children:[(0,y.jsx)(ge.u_.Overlay,{}),(0,y.jsxs)(ge.u_.Content,{children:[(0,y.jsxs)(ge.u_.Header,{children:[(0,y.jsx)(ge.u_.Title,{size:"sm",children:(0,y.jsx)(De.Z.LabelLg,{weight:"semibold",children:(0,o.t)("comments.likes",{count:l,formatted_count:(0,Ee.HA)(l)})})}),(0,y.jsx)(ge.u_.HeaderActions,{children:(0,y.jsx)(ge.u_.CloseButton,{onClick:r.hide})})]}),(0,y.jsx)(ge.u_.Body,{className:"py-4",children:c?(0,y.jsx)(a.m,{}):(0,y.jsx)("div",{id:"comment-likes-modal-".concat(t),className:"max-h-[calc(100dvh-62px-40px)] overflow-auto sm:max-h-80",children:(0,y.jsx)(Le.Z,{scrollThreshold:.75,next:d,hasMore:u||!1,loader:(0,y.jsx)(Re.a,{}),scrollableTarget:"comment-likes-modal-".concat(t),dataLength:s.length,className:"flex flex-col space-y-4",children:s.map((function(e){return(0,y.jsx)(Ze,{communityMember:e,hideModal:r.hide},e.id)}))})})})]})]})},Ye=be.gk.create((function(e){var t=e.id,n=e.placeholderLikesCount;return(0,y.jsx)(Ke,{id:t,placeholderLikesCount:n})})),Xe=n(47839),et=["harassment","spam","incorrect_location","against_guidelines","other"],tt=function(e){var t=e.show,n=e.onClose,r=e.onReportSubmit,i=(0,l.Zh)().usedIn,a=et.map((function(e){return{value:e,label:(0,o.t)("flagged_contents.report_reasons.".concat(e))}}));return(0,y.jsx)(Xe.u,{show:t,onClose:n,title:(0,o.t)("comments.report.form.title"),containerClassName:"full-post-modal"===i&&"!z-[1061]",children:(0,y.jsxs)(C.l,{onSubmit:r,children:[(0,y.jsx)(C.l.Item,{name:"reported_reason_type",label:(0,o.t)("flagged_contents.form.reported_reason_type"),description:(0,o.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,y.jsx)(C.l.SelectNative,{options:a})}),(0,y.jsx)(C.l.Item,{name:"reported_reason_body",label:(0,o.t)("flagged_contents.form.reported_reason_body"),description:(0,o.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,y.jsx)(C.l.TextArea,{})}),(0,y.jsx)(g.z,{type:"submit",variant:"primary",formButton:!0,children:(0,o.t)("report")})]})})};function nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ot=n(34334);function it(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var st="Comment";function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ct(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vt=function(e){var t=e.space,n=e.post,i=e.comment,a=e.showReplyForm,u=void 0!==a&&a,d=e.autofocusReplyForm,m=void 0!==d&&d,f=e.onReplyClick,p=e.onUpdate,v=e.onDelete,h=e.onReplyCreate,b=e.onReplyDelete,g=(0,l.wh)().isViewOnlyMasquerading,_=i.id,x=i.parent_comment_id,j=i.community_member,w=i.replies,O=i.replies_count,S=i.flagged_for_approval_at,P=i.policies,C=!!S,E=!!x,T=P.can_report&&!C,M=P.can_manage&&C,L=P.can_edit,R=P.can_destroy,D=P.can_bookmark,F=(0,r.useRef)(),U=function(e){var t=e.comment,n=e.showReplyForm,i=e.replyFormRef,a=t.is_replying_enabled,s=(0,l.xJ)(),c=(0,l.EU)(),u=(0,q.I)(),d=lt((0,r.useState)(n),2),m=d[0],f=d[1],p=lt((0,r.useState)(null),2),v=p[0],h=p[1];return{openReplyForm:function(e){var t=e.communityMember;if(s){var n,r;h(t),f(!0),i.current&&(null===(n=i.current.commands)||void 0===n||null===(r=n.focus)||void 0===r||r.call(n,"end"))}else{var a=(0,I.j)({params:{notice:(0,o.t)("comments.log_in_to_add_a_comment"),post_login_redirect:window.location.href}});u?window.open(a,"_blank","noreferrer"):window.location.href=a}},shouldShowReplyForm:m,communityMemberForReply:v,canReply:a&&c}}({comment:i,showReplyForm:u,replyFormRef:F}),B=U.openReplyForm,z=U.shouldShowReplyForm,H=U.communityMemberForReply,V=U.canReply,W=function(e){var t=e.comment,n=t.id,i=t.is_liking_enabled,a=t.is_liked,s=t.likes_count,c=(0,l.xJ)(),u=(0,l.EU)(),d=(0,q.I)(),m=it((0,r.useState)(a),2),f=m[0],p=m[1],v=it((0,r.useState)(s),2),h=v[0],b=v[1],g=(0,k.useMutation)((function(){return ot.Qd.create({userLikeableId:n,userLikableType:st,forReactQuery:!0})})),y=g.mutate,_=g.isLoading,x=(0,k.useMutation)((function(){return ot.Qd.destroy({userLikeableId:n,userLikableType:st,forReactQuery:!0})})),j=x.mutate,w=x.isLoading;return{toggleLike:function(){if(c)_||w||(f?(p(!1),b((function(e){return e-1})),j()):(p(!0),b((function(e){return e+1})),y()));else{var e=(0,I.j)({params:{notice:(0,o.t)("comments.log_in_to_like_comments"),post_login_redirect:window.location.href}});d?window.open(e,"_blank","noreferrer"):window.location.href=e}},isLiked:f,likesCount:h,canLike:i&&u,canSeeLikes:i,isLoading:_||w}}({comment:i}),Q=W.toggleLike,$=W.isLiked,G=W.likesCount,J=W.canLike,Y=W.canSeeLikes,X=W.isLoading,ee=(0,be.dd)(Ye),te=(0,be.dd)(Oe),ne=function(e){var t=e.comment.id,n=(0,A.p)(),i=n.success,a=n.error,s=ft((0,r.useState)(!1),2),l=s[0],c=s[1],u=function(){return c(!1)},d=(0,k.useMutation)((function(e){return(0,N.Cu)(I.av.flaggedContent.create(),{flagged_content:dt(dt({},e),{},{flagged_contentable_id:t,flagged_contentable_type:"Comment"})})}),{onSuccess:function(){i((0,o.t)("comments.report.alerts.success"),{duration:"short",shouldUseProgress:!1}),u()},onError:function(){a((0,o.t)("comments.report.alerts.failure"))}}).mutate;return{isReportModalOpen:l,openReportModal:function(){return c(!0)},closeReportModal:u,submitReport:d}}({comment:i}),re=ne.isReportModalOpen,oe=ne.openReportModal,ie=ne.closeReportModal,ae=ne.submitReport,se=function(e){var t=e.comment,n=e.onDelete,i=t.id,a=t.post_id,s=(0,A.p)(),l=s.success,c=s.error,u=nt((0,r.useState)(!1),2),d=u[0],m=u[1],f=function(){return m(!1)},p=(0,k.useMutation)((function(){return(0,N.pC)(I.av.comments.destroy({postId:a,id:i}))}),{onSuccess:function(){l((0,o.t)("comments.delete.alerts.success"),{duration:"short",shouldUseProgress:!1}),f(),n({id:i})},onError:function(){c((0,o.t)("comments.delete.alerts.failure")),f()}}),v=p.mutate,h=p.isLoading;return{isDeleteConfirmModalOpen:d,openDeleteConfirmModal:function(){return m(!0)},closeDeleteConfirmModal:f,deleteComment:v,isDeletingComment:h}}({comment:i,onDelete:v}),le=se.isDeleteConfirmModalOpen,ce=se.openDeleteConfirmModal,ue=se.closeDeleteConfirmModal,de=se.deleteComment,me=se.isDeletingComment,fe=f||B;return(0,y.jsxs)("div",{className:"post--comment",id:"comment_wrapper_".concat(_),children:[(0,y.jsx)("div",{className:"text-dark",children:(0,y.jsxs)("div",{className:"post__content",children:[(0,y.jsx)(pe,{post:n,comment:i}),(0,y.jsx)(Me,{canReply:V,canLike:J,canSeeLikes:Y,isLiked:$,likesCount:G,isLikeDisabled:X,onReplyClick:g?s.noop:function(){return fe({communityMember:j})},onLikeClick:g?s.noop:Q,onLikesCountClick:g?s.noop:function(){return ee.show({id:_,placeholderLikesCount:G})}}),(0,y.jsx)(K,{comment:i,canReport:T,canReview:M,canEdit:L,canDestroy:R,canBookmark:D,isReply:E,onReportClick:g?s.noop:oe,onEditClick:g?s.noop:function(){return te.show({space:t,comment:i,onUpdate:p})},onDeleteClick:g?s.noop:ce,onUpdate:p}),T&&(0,y.jsx)(tt,{show:re,onClose:ie,onReportSubmit:ae}),R&&(0,y.jsx)(c.c,{isOpen:le,onClose:ue,onConfirm:de,confirmText:me?(0,o.t)("deleting"):(0,o.t)("delete"),confirmVariant:"danger",title:(0,o.t)("comments.delete.confirm.title"),disabled:me,children:(0,o.t)("comments.delete.confirm.description")})]})}),!E&&(0,y.jsx)("div",{className:"post__replies",children:(0,y.jsx)(Z,{space:t,post:n,parentCommentId:_,preloaded:!0,preloadedComments:w,preloadedCommentsTotalCount:O,showReplyForm:z,autofocusReplyForm:m,communityMemberForReply:H,onCommentReplyClick:B,onCommentCreate:h,onCommentDelete:b,formRef:F})})]})},ht=n(74131);const bt=function(e){var t=e.space,n=e.post,o=e.id,s=e.showReplyForm,l=void 0!==s&&s,c=e.autofocusReplyForm,u=void 0!==c&&c,d=e.onCommentDelete,m=e.onReplyCreate,f=e.onReplyDelete,p=(0,ht.E)({postId:n.id,id:o,postCommentsClosed:n.is_comments_closed}),v=p.comment,h=p.isLoading,b=p.updateQueryData;return(0,r.useEffect)((function(){h||window.initialiseTippy()}),[h]),z({enabled:!h}),h?(0,y.jsx)(a.m,{}):v?(0,y.jsx)(vt,{space:t,post:n,comment:v,showReplyForm:l,autofocusReplyForm:u,onUpdate:b,onDelete:d,onReplyCreate:m,onReplyDelete:f}):(0,y.jsx)("div",{className:"post__comment-not-found alert alert-warning !ml-0",children:i().t("comments.hierarchy.not_found")})},gt=Z;var yt=n(33986),_t=n(51705),xt=n(18605),jt=function(e){var t=e.className;return(0,y.jsx)("div",{className:t,children:(0,y.jsxs)("div",{className:"bg-tertiary flex items-center justify-center gap-2 rounded-md p-3 text-center",children:[(0,y.jsx)(xt.JO,{size:16,type:"lock-v2",className:"text-dark"}),(0,y.jsx)(De.Z.LabelSm,{children:(0,o.t)("post.comments_section.comments_closed")})]})})},wt=n(68997),Ot=n(90789);function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){Ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kt=function(e){var t=e.isIframeEmbed,n=e.containerClassNames,r=e.currentCommunity,i=t?{target:"_blank",rel:"noreferrer"}:{},a=(0,wt.fs)(r);return(0,y.jsxs)("div",{className:n,children:[(0,y.jsx)("div",{className:"mb-3",children:(0,y.jsx)(De.Z.LabelLg,{weight:"semibold",children:(0,o.t)("login_to_comment")})}),(0,y.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,y.jsx)("a",Pt(Pt({className:"btn btn-secondary",href:(0,I.j)({params:{post_login_redirect:window.location.href}})},i),{},{children:(0,o.t)("log_in")})),a&&(0,y.jsx)("a",Pt(Pt({className:"btn btn-primary signup-link",href:(0,wt.pn)(r)},i),{},{children:(0,o.t)("sign_up")}))]})]})},Nt=n(66007),It=function(e){var t=e.lockedPostCtaContent,n=e.containerClassNames;return(0,y.jsxs)("div",{className:n,children:[(0,y.jsx)("div",{children:(0,y.jsx)(De.Z.TitleSm,{weight:"semibold",children:t.heading})}),(0,y.jsx)("div",{className:"mt-4",children:t.body&&(0,y.jsx)(De.Z.BodyMd,{children:(0,y.jsx)(Nt.Z,{html:t.body})})}),(0,y.jsx)("div",{className:"mt-6",children:(0,y.jsx)(g.z,{onClick:function(){return window.location.href=t.buttonLink},children:t.buttonLabel})}),(0,y.jsxs)("div",{className:"already-member mt-4",children:[(0,y.jsx)(De.Z.LabelSm,{children:(0,o.t)("already_a_member")}),(0,y.jsx)("a",{className:"signup-link text-link ml-1 text-sm font-medium",href:(0,I.j)({params:{post_login_redirect:window.location.href}}),children:(0,o.t)("log_in")})]})]})},At=function(e){var t=e.post,n=e.space,r=(0,l.wh)(),i=r.currentCommunity,a=r.currentUser,s=(0,yt.m)(),c=s.isSharedPostWithTeaserLayout,u=s.showGatedCommentSectionAtBottom,m=s.showGatedCommentSectionAtTop,f=(0,q.I)(),p={heading:i.locked_post_cta_heading||(0,o.t)("login_to_comment"),body:i.locked_post_cta_body,buttonLabel:i.locked_post_cta_button_text||(0,o.t)("log_in"),buttonLink:i.locked_post_cta_button_url||(0,I.j)({params:{post_login_redirect:window.location.href}})},v=!!!a&&c,h=(0,wt.v)(i),b=d()("gated-post gated-post--custom-cta",{post__logged_out_comments:!h,post__bottom_border:m,post__top_border:u,"gated-post--standard-layout":!t.minimal_layout,"gated-post--no-gradient":!v,"gated-post--gradient":v});return(h||(0,Ot.WB)(n))&&i.custom_cta_for_share_links?(0,y.jsx)(It,{containerClassNames:b,lockedPostCtaContent:p}):t.is_comments_enabled?(0,y.jsx)(kt,{containerClassNames:b,isIframeEmbed:f,currentCommunity:i}):void 0},Et=function(e){var t=e.post||{},n=t.slug,r=t.space_slug;return(0,y.jsx)("div",{className:"border-primary flex items-center justify-center gap-4 border-t p-12",children:(0,y.jsx)("a",{className:"btn btn-secondary",href:(0,I.LM)({spaceSlug:r,slug:n}),children:(0,o.t)("leave_a_comment")})})};function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Lt=function(e){var t=e.autofocusReplyForm,n=e.commentsFormRef,i=(0,yt.m)(),a=i.post,s=i.showGatedCommentSectionAtBottom,c=i.showGatedCommentSectionAtTop,u=i.shouldShowLeaveCommentButton,d=i.shouldHideCommentsListForSpace,m=i.refetchPostDetails,f=i.updatePostDetailsQueryCache,p=F().commentId,v=Tt((0,r.useState)(p),2),h=v[0],b=v[1],g=Tt((0,r.useState)(p&&a.comments_count>10),2),_=g[0],x=g[1],j=(0,l.L2)().data,w=(0,l.wh)().currentCommunityMember,O=a.is_comments_closed,S=function(){m&&m()},P=function(){f&&f({comments_count:a.comments_count+1})},C=function(){x(!1),b(null),window.location.hash="#all_comments"},k=d({space:j});(0,r.useEffect)((function(){b(p)}),[p]);var N=!(u||(0,_t.HZ)(a));return(0,y.jsxs)("div",{className:"post__comments trix-v2","data-controller":"comments",id:"all_comments","data-post-id":a.id,children:[O&&(0,y.jsx)(jt,{className:"m-4"}),u&&(0,y.jsx)(Et,{post:a}),N&&c&&(0,y.jsx)(At,{post:a,space:j}),!k&&_&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"show-all-comments__wrapper mx-[26px] mb-4 mt-[26px] !p-0",children:(0,y.jsxs)("a",{className:"show-all-comments__link btn btn-secondary",href:"#all_comments",onClick:function(e){e.preventDefault(),C()},children:[(0,y.jsx)(xt.JO,{type:"arrow-solid-top-left"}),(0,o.t)("post.comments_section.show_all_count_comments",{count:a.comments_count,formatted_count:(0,Ee.HA)(a.comments_count)})]})}),(0,y.jsx)(bt,{communityMember:w,space:j,post:a,id:h,showReplyForm:!O,autofocusReplyForm:t,onCommentDelete:function(){S(),C()},onReplyCreate:P,onReplyDelete:S})]}),!k&&!_&&(0,y.jsx)(gt,{communityMember:w,space:j,post:a,showReplyForm:!O,autofocusReplyForm:t,formRef:n,onCommentCreate:P,onCommentDelete:S}),N&&s&&(0,y.jsx)(At,{post:a,space:j})]})}},11552:(e,t,n)=>{n.d(t,{N:()=>s});var r=n(11355),o=n(64422),i=n(8246),a=n(85893),s=function(e){var t=e.member,n=e.hideModal,s=t.name,l=t.avatar_url,c=t.public_uid,u=(0,r.O)({public_uid:c}),d=u.onClick,m=u["aria-label"],f=u.href,p=u.rel,v=u.target;return(0,a.jsxs)("a",{className:"flex items-center gap-3",onClick:function(e){n(),d&&d(e)},"aria-label":m,href:f,rel:p,target:v,children:[(0,a.jsx)("div",{className:"mt-0",children:(0,a.jsx)(o.s,{name:s,src:l,size:"10"})}),(0,a.jsx)(i.Z.LabelSm,{weight:"medium",children:s})]})}},77508:(e,t,n)=>{n.d(t,{Z:()=>b});var r=n(86013),o=n(88767),i=n(24185),a=n(62057),s=n(98338),l=n(81089),c=n(51705),u=n(50732),d=n(81786),m=n(67687),f=n(47839),p=n(69647),v=n(8246),h=n(85893),b=function(e){var t=e.spaceId,n=e.postId,b=e.postSlug,g=e.postTitle,y=e.hasNoteAboutExceptions,_=void 0===y||y,x=e.isOpen,j=void 0!==x&&x,w=e.onClose,O=e.onDuplicateSuccess,S=(0,i.k6)(),P=(0,p.p)(),C=P.success,k=P.error,N=(0,s.nT)(),I=N.isLoading,A=(0,N.helpers.basicSpacesWithPostCreationAllowed)(),E=(0,o.useMutation)((function(e){return(0,l.aU)(u.av.posts.duplicate({spaceId:t,postSlug:b}),{post:{post_id:n,space_id:e.space_id,send_notifications:e.send_notifications}})}),{onSuccess:function(e){C((0,r.t)("duplicated_successfully")),w(),S.push((0,c.RG)({post:e,editMode:!0})),O&&O(e)},onError:function(){k((0,r.t)("duplication_failed"))}}),T=E.mutate,M=E.isLoading;return I?null:(0,h.jsx)(f.u,{overflowVisible:!0,title:(0,r.t)("duplicate_post_title",{post_title:g||(0,r.t)("duplicate_post_title_untitled")}),show:j,onClose:w,children:(0,h.jsxs)(m.l,{onSubmit:T,defaultValues:{space_id:t,send_notifications:!1},children:[(0,h.jsx)(m.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,label:(0,r.t)("space"),description:(0,r.t)("duplicate_post_to_space"),rules:{required:(0,r.t)("events.create.form.space_required_error")},children:(0,h.jsx)(a.M,{spaces:A,name:"space_id",variant:"form-input",defaultValue:t,containerClassname:"mt-2"})}),_&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(v.Z.LabelXs,{color:"text-light",children:(0,r.t)("comments_wont_be_duplicated")}),(0,h.jsx)(m.l.Item,{name:"send_notifications",hideBorder:!0,fullWidth:!0,label:(0,r.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,children:(0,h.jsx)(m.l.ToggleSwitch,{variant:"small",name:"send_notifications"})})]}),(0,h.jsx)("div",{className:"mt-4",children:(0,h.jsx)(d.z,{type:"submit",variant:"primary",disabled:M,children:M?(0,r.t)("duplicating"):(0,r.t)("duplicate")})})]})})}},70097:(e,t,n)=>{n.d(t,{u:()=>l});var r=n(97782),o=n(65631),i=n(98338),a=n(13288),s=n(85893),l=function(e){var t=e.show,n=e.closeModal,l=e.post,c=e.shouldSkipRedirectAfterSubmit,u=void 0!==c&&c,d=e.onChange,m=e.onSubmitSuccess;if(!t)return null;var f=(0,r.t)({spaceId:l.space_id,postSlug:l.slug,context:"edit-post-modal"}),p=f.isLoading,v=f.post,h=f.remove;if(p)return(0,s.jsx)(a.a,{variant:"fullscreen"});return(0,s.jsx)(i.DW,{post:v,onPostChange:d,children:(0,s.jsx)(o.Y,{show:t,closeModal:function(){n&&n(),h()},shouldSkipRedirectAfterSubmit:u,onSubmitSuccess:m})})}},43643:(e,t,n)=>{n.d(t,{p:()=>me});var r=n(33986),o=n(98338),i=n(86013),a=n(88767),s=n(34334),l=n(67907),c=n(13972),u=n(18274),d=n(58350),m=n(34398),f=n(97659),p=n(38313),v=n(54030),h=n(1881),b=n(58974),g=n(18605),y=n(44032),_=n(27025),x=n(69647),j=n(85893);function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S=function(e){var t=e.onChange,n=e.onPostDestroy,O=(0,r.m)(),S=O.post,P=O.canUpdatePost,C=O.canDuplicatePost,k=O.canDestroyPost,N=O.canManagePost,I=O.refetchPostDetails,A=(0,p.Z)(),E=(0,x.p)(),T=E.success,M=E.error,L=(0,o.L2)().refetch,R=w((0,h.k)(),2),D=R[0],F=R[1],U=w((0,h.k)(!1),2),B=U[0],z=U[1],H=w((0,h.k)(),2),Z=H[0],q=H[1],V=(0,o.wh)().isViewOnlyMasquerading,W=(0,v.kK)(),Q=(0,a.useMutation)((function(e){return s.S1.destroy({event:S,params:{delete_mode:e}})}),{onSuccess:function(){n(S.id),T((0,m.Km)(S)),null===L||void 0===L||L()},onError:function(){return M(I18n.t("event_dropdown_actions.delete_failed"))}});return P||C||k?V?(0,j.jsx)(g.JO,{type:"menu-dots","aria-label":I18n.t("events.event_actions"),className:"cursor-not-allowed"}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(_.Lt,{direction:"bottom-end",button:(0,j.jsx)(_.Lt.MenuButton,{children:(0,j.jsx)("div",{"data-testid":"action-more",children:(0,j.jsx)(g.JO,{type:"menu-dots","aria-label":I18n.t("events.event_actions")})})}),transitionWrapperClassName:"z-50",size:"large",appendTo:document.body,children:[W&&(0,j.jsx)(d.i,{onChange:t,className:"w-full",buttonClassName:"w-full",button:(0,j.jsx)(_.Lt.ItemLink,{children:(0,i.t)("events.event_actions_dropdown.share_event")})}),(0,j.jsx)(b.e,{variant:"dropdown",bookmarkType:"event",record:S,onSuccess:I}),P&&(0,j.jsx)(_.Lt.ItemLink,{onClick:function(){return A.show({event:S})},forceClose:!0,children:(0,i.t)("edit_event")}),C&&(0,j.jsx)(_.Lt.ItemLink,{onClick:z,children:(0,i.t)("duplicate_event")}),k&&(0,j.jsx)(_.Lt.ItemLink,{onClick:function(){(0,f.H3)(S)?q(!0):F(!0)},forceClose:!0,children:(0,j.jsx)("span",{className:"text-v2-danger",children:(0,i.t)("delete_event")})}),N&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(_.Lt.Separator,{}),(0,j.jsx)(u.E,{event:S,canEdit:P})]})]}),(0,j.jsx)(y.c,{isOpen:D,title:(0,i.t)("delete_event_confirmation"),onClose:F,onCancel:F,onConfirm:Q.mutate,confirmVariant:"danger",disabled:Q.isLoading,confirmText:Q.isLoading?(0,i.t)("deleting"):(0,i.t)("confirm"),children:(0,i.t)("delete_event_descriptor")}),(0,j.jsx)(c.D,{event:S,show:B,onClose:z}),!(0,m.yl)(S)&&(0,j.jsx)(l.t,{show:Z,onConfirm:Q.mutate,onCloseModal:function(){return q(!1)}})]}):null},P=n(96486),C=n(24185),k=n(1744),N=n(51705),I=n(90789),A=n(83410),E=n(66866),T=n(68997),M=n(39068),L=n(50732),R=n(54482),D=n(82177),F=n(3669),U=n(81089),B=n(52995),z=function(e){var t=e.post,n=e.handleClose,o=void 0===n?P.noop:n,s=(0,x.p)(),l=s.success,c=s.error,u=!!t.post_follower_id,d=(0,r.m)().onPostFollow,m=(0,a.useMutation)(u?function(){return(0,U.pC)(L.av.postFollowers.destroy({postId:t.id,postFollowerId:t.post_follower_id}))}:function(){return(0,U.Cu)(L.av.postFollowers.create({postId:t.id}))},{onSuccess:function(e){var t;d({post_follower_id:u?null:null===e||void 0===e||null===(t=e.post_follower)||void 0===t?void 0:t.id}),o(),l(I18n.t(u?"post_unfollow.success":"post_follow.success"))},onError:function(){return c(I18n.t(u?"post_unfollow.error":"post_follow.error"))}});return(0,j.jsx)(_.Lt.ItemLink,{onClick:function(){m.mutate()},children:(0,j.jsx)(B.sI,{label:(0,i.t)("follow_post"),field:"follow_post",value:u,variant:"small"})})},H=n(64687),Z=n.n(H);function q(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var V=function(e){var t,n,r=e.post,o=e.onChange,l=e.refetchPosts,c=e.handleClose,u=void 0===c?P.noop:c,d=(0,x.p)(),m=d.success,f=d.error,p=r.pinned_at_top_of_space,v=(0,a.useMutation)((function(){return s.Fv.pin({post:r,formData:{is_pinned:!p,pin_to_top:!0}})}),{onSuccess:(t=Z().mark((function e(t){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o(t,{refetch:!1}),!(0,P.isFunction)(l)){e.next=4;break}return e.next=4,l();case 4:m(I18n.t(p?"post_unpinned":"post_pinned"));case 5:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){q(i,r,o,a,s,"next",e)}function s(e){q(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){f(I18n.t(p?"post_unpinned_error":"post_pinned_error"))},onSettled:u});return(0,j.jsx)(_.Lt.ItemLink,{onClick:v.mutate,children:(0,j.jsx)(B.sI,{label:(0,i.t)("pin_to_top"),field:"pin_to_top",value:p,variant:"small"})})},W=n(98661);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J=function(e){var t=e.post,n=void 0===t?{}:t,r=e.handleClose,o=e.onChange,l=!!n.pinned_at,c=(0,a.useQueryClient)(),u=(0,x.p)(),d=u.success,m=u.error,f=(0,W.P)().refetch,p=(0,a.useMutation)((function(){return s.Fv.pin({post:n,formData:$($({},n),{},{is_pinned:!l,pin_to_top:!1})})}),{onSuccess:function(e){o(e,{refetch:!1}),f(),c.invalidateQueries("posts"),d(I18n.t(l?"post_unpinned_from_sidebar":"post_pinned_to_sidebar"))},onError:function(){m(I18n.t(l?"post_unpinned_error":"post_pinned_error"))},onSettled:r});return(0,j.jsx)(_.Lt.ItemLink,{onClick:p.mutate,children:(0,j.jsx)(B.sI,{label:(0,i.t)("pin_post"),field:"pin_post",value:l,variant:"small"})})},K=function(e){var t=e.post,n=e.handleClose,r=e.onChange,o=t.is_comments_disabled,s=o?"post.enable_comments":"post.disable_comments",l=(0,x.p)(),c=l.success,u=l.error,d=(0,a.useMutation)((function(){return(0,U.gN)(L.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_comments_disabled:!o}})}),{onSuccess:function(e){r(e,{refetch:!1}),c((0,i.t)("".concat(s,".alerts.success")))},onError:function(){u((0,i.t)("".concat(s,".alerts.failure")))},onSettled:n}).mutate;return(0,j.jsx)(_.Lt.ItemLink,{onClick:d,children:(0,j.jsx)(B.sI,{label:(0,i.t)("post.action_menu.disable_comments"),field:"disable_comments",value:o,variant:"small"})})},Y=function(e){var t=e.post,n=e.handleClose,r=e.onChange,o=t.is_comments_closed,s=o?"post.open_comments":"post.close_comments",l=(0,x.p)(),c=l.success,u=l.error,d=(0,a.useMutation)((function(){return(0,U.gN)(L.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_comments_closed:!o}})}),{onSuccess:function(e){r(e,{refetch:!1}),c((0,i.t)("".concat(s,".alerts.success")))},onError:function(){u((0,i.t)("".concat(s,".alerts.failure")))},onSettled:n}).mutate;return(0,j.jsx)(_.Lt.ItemLink,{onClick:d,children:(0,j.jsx)(B.sI,{label:(0,i.t)("post.action_menu.close_comments"),field:"close_comments",value:o,variant:"small"})})};function X(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var ee=function(e){var t,n,r=e.post,o=e.handleClose,l=void 0===o?P.noop:o,c=e.onChange,u=e.refetchPosts,d=r.hide_from_featured_areas,m=(0,x.p)(),f=m.success,p=m.error,v=(0,a.useMutation)((function(){return d?s.Fv.showInFeaturedAreas({post:r}):s.Fv.hideFromFeaturedAreas({post:r})}),{onSuccess:(t=Z().mark((function e(t){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c(t,{refetch:!1}),!(0,P.isFunction)(u)){e.next=4;break}return e.next=4,u();case 4:f(I18n.t(d?"post.marked_unhidden":"post.marked_hidden"));case 5:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){X(i,r,o,a,s,"next",e)}function s(e){X(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){p(I18n.t("something_went_wrong"))}});return(0,j.jsx)(_.Lt.ItemLink,{onClick:function(){l(),v.mutate()},children:(0,j.jsx)(B.sI,{label:(0,i.t)("post.hide_from_featured_areas"),field:"hide_from_featured_areas",value:d,variant:"small"})})},te=n(77508),ne=n(70097),re=n(81786),oe=n(67687),ie=n(47839),ae=["harassment","spam","incorrect_location","against_guidelines","other"],se=function(e){var t=e.onClose,n=e.show,r=e.post,s=(0,o.Zh)().usedIn,l=(0,x.p)(),c=(0,a.useMutation)((function(e){return(0,U.t5)(L.av.flaggedContent.create(),{method:"POST",forReactQuery:!0,body:JSON.stringify({flagged_content:e})})}),{onSuccess:function(){l.success((0,i.t)("report_post_success")),t()},onError:function(){l.error((0,i.t)("something_went_wrong"))}}),u=ae.map((function(e){return{value:e,label:(0,i.t)("flagged_contents.report_reasons.".concat(e))}}));return(0,j.jsx)(ie.u,{show:n,onClose:t,title:(0,i.t)("flagged_contents.form.report_post"),containerClassName:"full-post-modal"===s&&"!z-[1061]",children:(0,j.jsxs)(oe.l,{defaultValues:{flagged_contentable_id:r.id,flagged_contentable_type:"Post"},onSubmit:c.mutate,children:[(0,j.jsx)(oe.l.Item,{name:"reported_reason_type",label:(0,i.t)("flagged_contents.form.reported_reason_type"),description:(0,i.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,j.jsx)(oe.l.SelectNative,{options:u})}),(0,j.jsx)(oe.l.Item,{name:"reported_reason_body",label:(0,i.t)("flagged_contents.form.reported_reason_body"),description:(0,i.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,j.jsx)(oe.l.TextArea,{})}),(0,j.jsx)(re.z,{type:"submit",variant:"primary","data-testid":"report_post_submit",formButton:!0,children:I18n.t("report")})]})})};function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ue=function(e){var t=e.refetchPosts,n=e.currentCommunity,l=e.onPostDestroy,c=e.onChange,u=(0,C.k6)(),d=(0,r.m)(),m=d.post,f=d.showModerationInActionsDropdown,p=d.canManagePost,g=d.canUpdatePost,w=d.canDestroyPost,O=d.canDuplicatePost,S=d.canReportPost,U=d.refetchPostDetails,B=d.showShareOnWebOptions,H=(0,o.Zh)().usedIn,Z=le((0,h.k)(!1),2),q=Z[0],W=Z[1],Q=le((0,h.k)(!1),2),$=Q[0],G=Q[1],X=le((0,h.k)(!1),2),re=X[0],oe=X[1],ie=le((0,h.k)(!1),2),ae=ie[0],ce=ie[1],ue=(0,o.wh)(),de=ue.currentCommunitySettings,me=ue.isViewOnlyMasquerading,fe=ue.currentCommunityMember,pe=null===de||void 0===de?void 0:de.quick_post_v2_enabled,ve=(0,E.L)().show,he=(0,k.e)(),be=(0,A.h)(),ge=(0,v.kK)(),ye=(0,N.Fr)(m),_e=(0,N.hm)(m),xe=(0,D.UV)(),je=xe.contentPortalElement,we=xe.onClose,Oe=(0,x.p)(),Se=Oe.success,Pe=Oe.error,Ce=(0,o.L2)(),ke=Ce.data,Ne=Ce.refetch,Ie=_e&&Boolean(!(null!==ke&&void 0!==ke&&ke.hide_right_sidebar))&&!(0,I.AU)(ke),Ae=(null===de||void 0===de?void 0:de.kb_post_action_enabled)&&(0,M.vb)(fe),Ee=(0,a.useMutation)((function(){return s.Fv.destroy({post:m})}),{onSuccess:function(){l(m.id),Se((0,i.t)("post_dropdown_actions.delete_successful")),Ne()},onError:function(){return Pe((0,i.t)("post_dropdown_actions.delete_failed"))}}),Te=(0,a.useMutation)((function(){return s.Fv.updateKnowledgeBasePost({post:m})}),{onSuccess:function(){Se((0,i.t)("post_dropdown_actions.update_knowledge_base_post_successful"))},onError:function(){return Pe((0,i.t)("post_dropdown_actions.update_knowledge_base_post_failed"))}}),Me=function(e){return u.push((0,N.RG)({post:e}))};return me?(0,j.jsx)(R.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark cursor-not-allowed","aria-label":(0,i.t)("post_actions"),dataTestId:"action-more",disabled:!0}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(_.Lt,{direction:"bottom-end",button:(0,j.jsx)(R.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark","aria-label":(0,i.t)("post_actions"),dataTestId:"action-more"}),className:"z-10 ml-0 md:ml-1",transitionWrapperClassName:"z-50",size:"large",buttonLabel:(0,i.t)("post_actions"),appendTo:null!==je&&void 0!==je?je:document.body,children:[(0,j.jsx)(b.e,{variant:"dropdown",bookmarkType:"post",record:m,onSuccess:U}),g&&_e&&(0,j.jsx)(_.Lt.ItemLink,{onClick:function(){me?(0,P.noop)():pe?ve({post:m,onPostChange:c}):W()},children:(0,i.t)("edit_post")}),g&&ye&&(0,j.jsx)(_.Lt.ItemLink,{onClick:function(){he.show({spaceId:ke.id,onClose:function(){return he.remove()},onPostChange:c,currentPost:m,shouldSkipRedirectAfterSubmit:"full-post-modal"===H})},children:(0,i.t)("edit_post")}),B&&(ge||"full-post-modal"===H)&&(0,j.jsx)(F.P,{onChange:c,className:"w-full",buttonClassName:"w-full",button:(0,j.jsx)(_.Lt.ItemLink,{children:(0,i.t)("post.share.title")}),shouldRenderCustomMenuButton:ge||"full-post-modal"===H}),_e&&O&&(0,j.jsx)(_.Lt.ItemLink,{onClick:G,children:(0,i.t)("duplicate_post")}),ye&&O&&(0,j.jsx)(_.Lt.ItemLink,{onClick:function(){"full-post-modal"===H&&we(),be.show({post:m,onSuccess:Me})},children:(0,i.t)("duplicate_post")}),S&&(0,j.jsx)(_.Lt.ItemLink,{onClick:me?P.noop:oe,children:(0,i.t)("report_post")}),f&&(0,j.jsx)(_.Lt.ItemWithLink,{to:L.sC.index(),children:(0,i.t)("flagged_contents.review")}),w&&(0,j.jsx)(_.Lt.ItemLink,{onClick:me?P.noop:ce,children:(0,j.jsx)("span",{className:"text-v2-danger",children:(0,i.t)("delete_post")})}),Ae&&(0,j.jsx)(_.Lt.ItemLink,{onClick:function(){Te.mutate()},children:(0,i.t)("post_dropdown_actions.update_knowledge_base_post_dropdown_label")}),(g||O||S||f||w)&&(0,j.jsx)(_.Lt.Separator,{}),(0,j.jsx)(z,{post:m,onChange:c}),p&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(V,{post:m,onChange:c,refetchPosts:t}),Ie&&(0,j.jsx)(J,{post:m,onChange:c,refetchPosts:t}),(0,j.jsx)(K,{post:m,onChange:c}),m.is_comments_enabled&&(0,j.jsx)(Y,{post:m,onChange:c}),(0,T.Nf)(n)&&(0,j.jsx)(ee,{post:m,community:n,onChange:c,refetchPosts:t})]})]}),(0,j.jsx)(ne.u,{show:q,closeModal:W,post:m,onChange:c}),(0,j.jsx)(te.Z,{spaceId:m.space_id,postId:m.id,postSlug:m.slug,postTitle:m.name,isOpen:$,onClose:G}),(0,j.jsx)(se,{post:m,show:re,onClose:oe}),(0,j.jsx)(y.c,{isOpen:ae,title:(0,i.t)("delete_post_confirmation"),onClose:ce,onCancel:ce,onConfirm:Ee.mutate,confirmVariant:"danger",disabled:Ee.isLoading,confirmText:Ee.isLoading?(0,i.t)("deleting"):(0,i.t)("confirm"),children:(0,i.t)("delete_post_descriptor")})]})},de=function(e){var t=e.onChange,n=e.onPostDestroy,o=e.refetchPosts,i=e.currentCommunity,a=(0,r.m)(),s=a.isBasicPost,l=a.isEventPost,c=a.isImagePost;return(0,j.jsxs)(j.Fragment,{children:[(s||c)&&(0,j.jsx)(ue,{onChange:t,onPostDestroy:n,refetchPosts:o,currentCommunity:i}),l&&(0,j.jsx)(S,{onChange:t,onPostDestroy:n})]})},me=function(e){var t=e.onChange,n=e.onPostDestroy,i=e.refetchPosts,a=(0,r.m)(),s=a.showPostActions,l=a.canUpdatePost,c=a.canDestroyPost,u=a.isEventPost,d=(0,o.wh)().currentCommunity;return s&&(!u||l||c)?(0,j.jsx)(de,{onChange:t,onPostDestroy:n,refetchPosts:i,currentCommunity:d}):null}},3502:(e,t,n)=>{n.d(t,{H:()=>m});var r=n(17479),o=n(98338),i=n(28166),a=n(85893),s=["post"];function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var m=function(e){var t,n=e.post,l=d(e,s),u=(0,o.wh)().currentCommunitySettings,m=u.optimize_active_storage_images_enabled,f=u.progressive_image_loading_enabled,p=m?null===(t=n.cover_image_variants)||void 0===t?void 0:t.large:n.cover_image_url;return p?(0,a.jsx)("div",{className:"px-5 pt-5 md:p-0",children:(0,a.jsx)(i.s,c(c({post:n,className:"post__cover"},l),{},{children:f&&m?(0,a.jsx)(r.Q,{src:n.cover_image_url,srcVariants:n.cover_image_variants,alt:I18n.t("post.cover_image_alt")},n.cover_image_url):(0,a.jsx)("img",{loading:"lazy",src:p,alt:I18n.t("post.cover_image_alt")},p)}))}):null}},3669:(e,t,n)=>{n.d(t,{P:()=>P});var r=n(94184),o=n.n(r),i=n(86013),a=n(92385),s=n(98338),l=n(18605),c=n(81786),u=n(27025),d=n(52995),m=n(8246),f=n(67294),p=n(20640),v=n.n(p),h=n(50732),b=n(69647);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=n(85893),O=function(e){var t=e.getSharePostLink,n=e.post,r=e.sharePostData,p=function(e){var t=e.post,n=e.getSharePostLink,r=e.sharePostData,o=(0,b.p)().success,a=(0,s.wh)().currentCommunity,l=(0,s.L2)().data,c=x((0,f.useState)({post:{show_post_teaser:!(null===t||void 0===t||!t.show_post_teaser),share_to_web:!(null===t||void 0===t||!t.share_post_enabled),share_post_enabled:!(null===t||void 0===t||!t.share_post_enabled),minimal_layout:!(null===t||void 0===t||!t.minimal_layout)}}),2),u=c[0],d=c[1],m=(0,h.LM)({spaceSlug:null===t||void 0===t?void 0:t.space_slug,slug:null===t||void 0===t?void 0:t.slug});return(0,f.useEffect)((function(){t.share_post_enabled&&!r&&n({postId:null===t||void 0===t?void 0:t.id,body:u})}),[null===t||void 0===t?void 0:t.share_post_enabled,r,u,n,null===t||void 0===t?void 0:t.id]),{onClickCopyLink:function(e){v()(e||window.location.origin+m),o((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){d((function(r){var o={post:y(y({},r.post),e)};return n({postId:null===t||void 0===t?void 0:t.id,body:o}),o}))},formData:u,currentCommunity:a,currentSpace:l}}({post:n,getSharePostLink:t,sharePostData:r}),g=p.onClickCopyLink,_=p.onChange,j=p.formData,O=p.currentCommunity,S=p.currentSpace,P=(0,s.wh)().isViewOnlyMasquerading;return O.is_private||null!==S&&void 0!==S&&S.is_private?(0,w.jsxs)("div",{children:[(0,w.jsx)(u.Lt.ItemLink,{disabled:P,onClick:function(){_({share_to_web:!j.post.share_to_web})},children:(0,w.jsx)(d.sI,{label:(0,i.t)("post.share.share_to_web"),tooltipText:(0,i.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:j.post.share_to_web,variant:"small",disabled:P,className:o()({"cursor-not-allowed":P})})}),j.post.share_to_web&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"flex flex-row items-center",children:(0,w.jsx)("div",{className:"mb-4 mt-1 flex-1 px-5",children:(0,w.jsx)(a.I,{disabled:!0,value:null===r||void 0===r?void 0:r.share_post_link,rightAddon:(0,w.jsx)("button",{type:"submit",onClick:function(){return g(null===r||void 0===r?void 0:r.share_post_link)},children:(0,w.jsx)(l.JO,{type:"20-copy"})})})})}),(0,w.jsx)(u.Lt.ItemLink,{onClick:function(){_({show_post_teaser:!j.post.show_post_teaser})},children:(0,w.jsx)(d.sI,{label:(0,i.t)("post.share.show_teaser"),tooltipText:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("p",{children:(0,i.t)("post.share.show_teaser_description_title")}),(0,w.jsx)("a",{href:"/settings#field-custom_cta_for_share_links",children:(0,i.t)("post.share.show_teaser_description_link")})]}),field:"show_post_teaser",value:j.post.show_post_teaser,variant:"small"})}),!(null!==O&&void 0!==O&&O.is_private)&&(0,w.jsx)(u.Lt.ItemLink,{onClick:function(){return _({minimal_layout:!j.post.minimal_layout})},children:(0,w.jsx)(d.sI,{label:(0,i.t)("post.share.minimal_layout"),tooltipText:(0,i.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:j.post.minimal_layout,variant:"small"})})]})]}):(0,w.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,w.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,w.jsx)(m.Z.LabelMd,{weight:"bold",children:(0,i.t)("post.share.share_to_web")}),(0,w.jsx)(m.Z.LabelSm,{children:(0,i.t)("post.share.post_is_public")})]}),(0,w.jsx)("div",{children:(0,w.jsx)(c.z,{variant:"secondary",onClick:function(){return g()},children:(0,i.t)("copy_link")})})]})},S=n(33986),P=function(e){var t=e.onChange,n=e.button,r=e.shouldRenderCustomMenuButton,a=(0,S.m)({onChangeSharePost:t}),c=a.showShareOnWebOptions,d=a.post,f=a.getSharePostLink,p=a.sharePostData,v=(0,s.L2)().data,h=n||(0,w.jsx)(l.JO,{type:"16-share",size:20});return c(v)?(0,w.jsx)(u.Lt,{size:"extra-large",direction:"bottom-end",className:o()("z-10 w-full md:w-auto",{"ml-1":!r}),buttonClassName:o()("w-full md:w-auto",{"md:!w-full":r}),button:r?h:(0,w.jsx)(u.Lt.MenuButton,{className:"!pt-0",children:(0,w.jsx)(m.Z.LabelSm,{weight:"medium",color:"text-dark hover:text-default",children:(0,i.t)("post.share.title")})}),children:(0,w.jsx)(O,{post:d,getSharePostLink:f,sharePostData:p})}):null}},28166:(e,t,n)=>{n.d(t,{s:()=>h});var r=n(24185),o=n(40160),i=n(17373),a=n(51705),s=n(50732),l=n(18701),c=n(82177),u=n(85893),d=["post","ariaLabel","allComments","forwardedRef","onClick","children"];function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var h=function(e){var t=e.post,n=e.ariaLabel,m=e.allComments,p=void 0!==m&&m,h=e.forwardedRef,b=e.onClick,g=e.children,y=v(e,d),_=(0,r.UO)().postSlug,x=(0,l.I)(),j=(0,c.UV)(),w=j.isInsideModal,O=j.onClose,S=(0,s.LM)({spaceSlug:t.space_slug,slug:t.slug,hash:p?i.Q:""});return x?(0,u.jsx)("a",f(f(f({href:S,target:"_blank",rel:"noreferrer","aria-label":n},y),h&&{ref:h}),{},{children:g})):(0,a.Sb)(t,{postSlugInUrl:_})?(0,u.jsx)("a",f(f(f({href:S,"aria-label":n},y),h&&{ref:h}),{},{children:g})):(0,u.jsx)(o.rU,f(f(f({to:S,"aria-label":n},y),h&&{ref:h}),{},{onClick:w?O:b,children:g}))}},55470:(e,t,n)=>{n.d(t,{D:()=>Re});var r=n(67294),o=n(94184),i=n.n(o),a=n(24185),s=n(32808),l=n(34267),c=n(73096),u=n(33986),d=n(43535),m=n(86013),f=n(98338),p=n(18605),v=n(62618),h=n(4404),b=n(85893),g=function(e){var t=e.count,n=e.toggleComment;return e.hasPostDetailsLoaded?(0,b.jsx)("button",{type:"button",className:"hover:!text-dark focus-visible:!text-dark transition-colors duration-150 ease-in-out",onClick:n,children:(0,m.t)("post.comments",{count:t,formatted_count:(0,v.HA)(t)})}):(0,b.jsx)(h.gi,{variant:"row",lg:!0,long:!0})},y=function(e){var t,n=e.shouldOpenCommentPage,r=e.showCommentAndFocusCommentForm,o=e.toggleComment,a=(0,f.EU)(),s=(0,u.m)().post,l=s.is_comments_closed,c=s.is_comments_enabled,d=s.comments_count,v=void 0===d?0:d,h=s.post_details_loaded;return c&&!n?(0,b.jsxs)(b.Fragment,{children:[!l&&a&&(0,b.jsxs)("button",{type:"button",onClick:r,"aria-label":(0,m.t)("cap_comment_aria_label",{title:null!==(t=null===s||void 0===s?void 0:s.name)&&void 0!==t?t:(0,m.t)("this_post")}),className:i()("action-comment text-default hover:!text-dark focus-visible:!text-dark transition-colors duration-150 ease-in-out"),children:[(0,b.jsx)("span",{className:"action__icon",children:(0,b.jsx)(p.JO,{useWithFillCurrentColor:!0,type:"message"})}),(0,b.jsx)("span",{className:i()("action__label"),children:(0,m.t)("cap_comment")})]}),(0,b.jsx)("div",{className:"engagement__comments",children:(0,b.jsx)(g,{count:v,toggleComment:o,hasPostDetailsLoaded:h})})]}):null},_=n(28166),x=function(e){var t=e.shouldOpenCommentPage,n=e.toggleComment,r=(0,u.m)().post,o=r.is_comments_enabled,i=r.comments_count,a=void 0===i?0:i,s=r.post_details_loaded;return o&&t?(0,b.jsxs)(_.s,{post:r,allComments:!0,className:"flex w-full !items-center !justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("span",{className:"action__icon",children:(0,b.jsx)(p.JO,{type:"message",className:"!text-dark",useWithFillCurrentColor:!0})}),(0,b.jsx)("span",{className:"count !text-dark",children:(0,m.t)("cap_comment")})]}),(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsx)(g,{count:a,toggleComment:n,hasPostDetailsLoaded:s})})]}):null},j=n(96486),w=["post"];function O(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var S=function(){var e,t=(0,f.EU)(),n=(0,u.m)(),r=n.post,o=O(n,w),a=r.is_liking_enabled,s=r.is_liked_by_current_user,l=r.post_details_loaded;return a&&t?(0,b.jsxs)("button",{type:"button","aria-label":(0,m.t)("like_post_aria_label",{name:null!==(e=null===r||void 0===r?void 0:r.name)&&void 0!==e?e:""}),onClick:function(e){(0,j.isFunction)(null===o||void 0===o?void 0:o.onLikeToggle)&&o.onLikeToggle(e)},className:i()("action-link post__actions--like hover:!text-dark focus-visible:!text-dark transition-colors duration-150 ease-in-out",{liked:s,"cursor-not-allowed":!l,"text-default":!s}),children:[(0,b.jsx)("span",{className:"action__icon",children:(0,b.jsx)(p.JO,{useWithFillCurrentColor:!0,type:"like"})}),(0,b.jsx)("span",{"aria-checked":s,className:i()("action__label"),children:(0,m.t)(s?"liked":"like")})]}):null},P=n(67142),C=n(51705),k=n(36589),N=function(e){var t=e.firstCommunityMemberToLike,n=e.secondCommunityMemberToLike,r=e.likesCount;if(e.isLoading)return(0,b.jsx)(h.gi,{variant:"row",lg:!0,extraLong:!0});if(!t)return null;var o=(null===t||void 0===t?void 0:t.first_name)||"",i=(null===n||void 0===n?void 0:n.first_name)||"",a="";return 1===r?a=(0,m.t)("liked_by_one",{name:o}):2===r?a=(0,m.t)("liked_by_two",{first:o,second:i}):r>2&&(a=(0,m.t)("liked_by_three_or_more",{name:o,amount:(0,v.HA)(r-1)})),(0,b.jsx)("span",{children:a})},I=n(58533),A=n(11049),E=n(43227),T=n(50732),M=n(78599),L=n(82177),R=n(11552),D=function(e){var t,n=e.post,o=(0,A.dd)(),i=(0,M.m)(T.av.posts.userLikesList({postId:String(n.id),params:{per_page:15}}),{enabled:!(null===n||void 0===n||!n.id)},["post-likes-modal",null===n||void 0===n?void 0:n.id]),a=i.data,s=i.isLoading,l=i.fetchNextPage,c=i.hasNextPage,u=i.mapPages,d=(0,r.useMemo)((function(){return(0,j.flatten)(u((function(e){return e.records})))}),[u]),f=null===a||void 0===a||null===(t=a.pages[0])||void 0===t?void 0:t.count;return(0,b.jsxs)(L.u_,{title:(0,m.t)("like_modal_title"),isOpen:o.visible,onClose:o.hide,children:[(0,b.jsx)(L.u_.Overlay,{}),(0,b.jsxs)(L.u_.Content,{children:[(0,b.jsxs)(L.u_.Header,{children:[(0,b.jsx)(L.u_.Title,{size:"sm",children:f?(0,b.jsxs)(b.Fragment,{children:[(0,v.HA)(f)," ",1===f?(0,m.t)("like"):(0,m.t)("likes")]}):(0,m.t)("likes")}),(0,b.jsx)(L.u_.HeaderActions,{children:(0,b.jsx)(L.u_.CloseButton,{onClick:o.hide})})]}),(0,b.jsx)(L.u_.Body,{className:"py-4",children:s?(0,b.jsx)(E.m,{}):(0,b.jsx)("div",{id:"post-likes-modal-".concat(n.id),className:"max-h-[calc(100dvh-62px-40px)] overflow-auto sm:max-h-80",children:(0,b.jsx)(I.Z,{scrollThreshold:.75,next:l,hasMore:c||!1,loader:(0,b.jsx)(E.m,{}),scrollableTarget:"post-likes-modal-".concat(n.id),dataLength:d.length,className:"flex flex-col space-y-4",children:d.map((function(e){return(0,b.jsx)(R.N,{member:e,hideModal:o.hide},e.id)}))})})})]})]})},F=A.gk.create((function(e){var t=e.post;return(0,b.jsx)(D,{post:t})})),U=function(){var e=(0,u.m)(),t=e.post,n=e.isPostBodyEmpty,r=(0,k.I)().isV3Enabled,o=t.user_likes_count,a=t.is_liking_enabled,s=t.sample_user_likes_community_members,l=void 0===s?[]:s,c=t.post_details_loaded,d=(0,A.dd)(F);if(!c)return(0,b.jsx)("div",{className:i()("post__engagement",{"!pt-5":(0,C.Fr)(t)&&n}),children:(0,b.jsx)(h.gi,{variant:"members-avatar-row"})});if(!a||!o||!l.length)return null;return(0,b.jsx)("button",{type:"button",onClick:function(){return d.show({post:t})},className:i()("post__engagement",{"!pt-5":(0,C.Fr)(t)&&n}),children:(0,b.jsxs)("div",{className:"engagement__likes",children:[(0,b.jsx)("div",{className:"engagement__members border-tertiary",children:(0,b.jsx)(P.pB,{users:l.slice(0,3).map((function(e){return{src:e.avatar_url,name:e.name}})),isFullRounded:r})}),(0,b.jsx)("div",{className:"engagement__members--descriptor","data-testid":"post-engagement",children:(0,b.jsx)(N,{firstCommunityMemberToLike:l[0],secondCommunityMemberToLike:l[1],likesCount:o,isLoading:!c})})]})})},B=function(e){var t=e.toggleComment,n=e.showCommentAndFocusCommentForm,r=e.shouldOpenCommentPage,o=void 0!==r&&r;return(0,u.m)().showEngagementActions?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(U,{}),(0,b.jsxs)("div",{className:"post__actions post__actions-visible !border-primary !border-t",children:[(0,b.jsx)(d.T,{children:(0,b.jsx)(S,{})}),(0,b.jsx)(y,{shouldOpenCommentPage:o,showCommentAndFocusCommentForm:n,toggleComment:t}),(0,b.jsx)(x,{shouldOpenCommentPage:o,toggleComment:t})]})]}):null},z=n(54030),H=n(77852),Z=n(3888),q=n(58974),V=n(8246),W=function(e){var t=e.post,n=(0,z.kK)();return t.pinned_at_top_of_space?n&&(0,C.hm)(t)?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.JO,{size:20,type:"20-pinned-post",className:"text-dark"}),(0,b.jsx)(V.Z.LabelXxs,{weight:"font-semibold",children:(0,m.t)("post.pinned_post")})]}):(0,b.jsx)("div",{className:"post__pin post__pin--pinned",children:(0,b.jsx)(p.JO,{type:"pin"})}):null},Q=n(43643),$=n(3669),G=function(e){var t=e.post,n=e.onChange,r=e.onPostDestroy,o=e.refetchPosts,a=e.hideShareLink,s=e.hidePinnedToTopIcon,l=e.hideBookmarkButton,c=(0,u.m)().refetchPostDetails,d=(0,z.kK)(),m=(0,C.Fr)(t),f=(0,C.hm)(t),p=m||f;return d&&p?(0,b.jsx)("div",{className:i()("post-actions",{"flex flex-col gap-2":t.pinned_at_top_of_space,"float-right":!t.pinned_at_top_of_space}),children:(0,b.jsxs)("div",{className:i()("px-5 pt-5",{"flex w-full flex-row justify-between":t.pinned_at_top_of_space}),children:[!s&&(0,b.jsx)(W,{post:t}),(0,b.jsx)("div",{className:"flex flex-row gap-1",children:(0,b.jsx)(Q.p,{onChange:n,onPostDestroy:r,refetchPosts:o})})]})}):(0,b.jsxs)("div",{className:"post__actions-container text-dark items-center justify-center","data-testid":"post-header-actions",children:[!s&&(0,b.jsx)(W,{post:t}),(0,b.jsx)(Q.p,{onChange:n,onPostDestroy:r,refetchPosts:o}),!a&&(0,b.jsx)($.P,{onChange:n}),!l&&(0,b.jsx)("span",{className:i()({"z-10 mb-0.5":p,"mt-0.5":!p}),children:(0,b.jsx)(q.e,{bookmarkType:p?"post":"event",record:t,onSuccess:c})})]})},J=n(66007),K=n(95287),Y=n(34141),X=n(61844),ee=n(7074),te=n(88767),ne=n(5476),re=n(94426),oe=n(27887),ie=n(64248);function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var le=function(e){var t=e.post,n=ae((0,r.useState)(null),2),o=n[0],i=n[1],a=ae((0,r.useState)(!1),2),s=a[0],l=a[1],c=(0,te.useMutation)((function(e){var t=e.postId,n=e.value;return ne.R.createPostFeedback({postId:t,helpful:n})})).mutate;return(0,b.jsxs)("div",{className:"mx-auto w-full pt-4",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(oe.Di,{weight:"semibold",children:(0,m.t)("support_widget.was_this_article_helpful")})}),(0,b.jsx)("div",{className:"mb-6 flex justify-center gap-4",children:(0,b.jsx)(ie.O,{value:o,handleFeedback:function(e){s||(i(e),c({postId:t.id,value:e}),l(!0))},isFeedbackGiven:s})}),(0,b.jsx)("div",{children:(o||!1===o)&&(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsx)(re.p,{children:(0,m.t)("support_widget.thank_you_for_article_feedback")})})})]})},ce=function(e){var t=e.enableTruncation,n=void 0!==t&&t,o=e.noPadding,a=void 0!==o&&o,s=e.className,l=void 0===s?"":s,c=(0,u.m)(),d=c.post,m=c.isSharedPostWithTeaserLayout,f=c.isSharedPostViewWithMinimalLayout,p=c.isTiptapPost,v=c.isTrixPost,h=c.isBasicPost,g=c.isPostBodyEmpty,y=["help","help-en"].includes(d.community_slug)&&h,_=!n,x=f&&m,w=m,O=d.body_trix_content,S=d.tiptap_body,P=d.internal_custom_html,k=d.pinned_at_top_of_space,N=d.updated_at;if((0,r.useEffect)((function(){var e;P&&(0,j.isFunction)(null===(e=window)||void 0===e?void 0:e.loadOembed)&&window.loadOembed()}),[P]),g)return null;var I=8;return k?I=2:x&&(I=4),(0,b.jsx)("div",{className:i()("post__body",{"!p-0":a,"!pt-5":f&&(0,C.Fr)(d)},l),"data-testid":"post-body",children:(0,b.jsx)("div",{className:i()("post__inside trix-v2 !line-clamp-none w-full",{"!overflow-auto":(0,K.G6)()}),"data-testid":"post-body-inside",children:(0,b.jsxs)(X.X,{lines:I,disabled:_,hideToggle:w,children:[v&&O&&(0,b.jsx)(Y.P,{content:O,contentParentPath:T.xu.show({slug:d.slug,spaceSlug:d.space_slug})}),p&&S&&(0,b.jsx)(ee.R,{readOnly:!0,value:S.body,sgidToObjectMap:S.sgids_to_object_map,inlineAttachments:S.inline_attachments}),P&&(0,b.jsx)(J.Z,{html:P},"internal_custom_html"),y&&(0,b.jsx)(le,{post:d})]})})},N)},ue=n(3502),de=n(36464),me=n.n(de),fe=n(11355),pe=n(43574),ve=(0,r.forwardRef)((function(e,t){var n=e.headline,r=e.post,o=r.community_member,a=r.name,s=r.flagged_for_approval_at,l=r.created_at;return(0,z.kK)()?(0,b.jsxs)("div",{className:"post__meta",children:[!a&&s?(0,b.jsx)("span",{className:"post__headline-tag !ml-0",children:(0,m.t)("in_review")}):o&&n&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:i()("author__credentials !text-dark",{"is-admin":!!o.is_admin}),children:n}),(0,b.jsx)("span",{className:"bg-badge mx-2 inline-block h-[0.15rem] w-[0.15rem] rounded-full align-middle"})]}),(0,b.jsx)("div",{className:"author__time inline-block",children:(0,b.jsx)(_.s,{post:r,className:"ago !text-dark",forwardedRef:t,children:me()(l)})})]}):(0,b.jsx)("div",{className:"post__meta",children:!a&&s?(0,b.jsx)("span",{className:"post__headline-tag !ml-0",children:(0,m.t)("in_review")}):o&&(0,b.jsx)("span",{className:i()("author__credentials !text-dark",{"is-admin":!!o.is_admin}),children:n})})}));ve.displayName="AuthorHeadline";var he=n(64422);function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _e=function(e){var t,n,r=e.post.community_member,o=(0,fe.O)({public_uid:null!==(t=r.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0},name:r.name});return(0,b.jsx)("div",{className:"post__avatar",children:(0,b.jsx)("a",ge(ge({},o),{},{children:(0,b.jsx)("div",{className:"mr-[14px]","data-testid":"post-avatar",children:(0,b.jsx)(he.s,{src:r.avatar_url,name:null!==(n=r.name)&&void 0!==n?n:"",size:"10"})})}))})},xe=(0,r.forwardRef)((function(e,t){var n=e.doesPostHaveCoverImage,r=void 0!==n&&n,o=e.className,a=e.children,s=(0,z.kK)();return(0,b.jsx)("div",{className:i()("post__user !items-start",{"!mb-0 !px-5 !pt-5 md:!mb-2 md:!mt-1":s&&r,"!mt-0 !px-5 !pt-5":s&&!r},o),ref:t,children:a})}));function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}xe.displayName="PostViewListItemWrapper";var Se=function(e){var t=e.isRenderedOutsideTheSpace,n=e.space,o=e.doesPostHaveCoverImage,a=void 0!==o&&o,s=e.tagsLimit,l=e.tagsShowMoreLabelVariant,c=e.wrapperClassName,d=e.hideAuthorHeadline,f=(0,u.m)(),p=f.post,v=f.isSharedPostView,h=p.community_member,g=p.hide_meta_info,y=p.member_tags,x=(0,fe.O)({public_uid:h.public_uid,params:{show_back_link:!0}}),w=null===y||void 0===y?void 0:y.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.post_bio)})),O=(0,r.useMemo)((function(){return h.id&&(null===w||void 0===w?void 0:w.length)>0}),[h.id,w]),S=(0,z.kK)(),P=(0,r.useRef)(null),C=(0,r.useRef)(null);if(g||!n)return null;var k=(0,j.truncate)(h.headline,{length:160}),N=t?"".concat((0,m.t)("post.posted_in")," ").concat(n.name):k,I=Boolean(h.admin);return S?(0,b.jsxs)(xe,{doesPostHaveCoverImage:a,ref:P,children:[(0,b.jsx)(_e,{post:p}),(0,b.jsxs)("button",{type:"button",className:"post__bio text-left",onClick:function(e){e.target instanceof HTMLAnchorElement||C.current&&C.current.click()},children:[(0,b.jsxs)("div",{className:i()("author",{"no-headline":!h.headline&&p.name,"has-tags":O}),children:[(0,b.jsx)("div",{className:"author__name",children:(0,b.jsx)("a",we(we({},x),{},{className:"!text-dark",children:h.name}))}),!v&&(O||I)&&(0,b.jsx)("div",{className:"author__tags member-tags !m-0",children:(0,b.jsx)(pe.m,{memberTags:w,isAdmin:I,limit:s,showMoreLabelVariant:l})})]}),!d&&(0,b.jsx)(ve,{headline:N,post:p,ref:C})]})]}):(0,b.jsxs)(xe,{doesPostHaveCoverImage:a,ref:P,className:c,children:[(0,b.jsx)(_e,{post:p}),(0,b.jsxs)("button",{type:"button",className:"post__bio text-left",onClick:function(e){e.target instanceof HTMLAnchorElement||C.current&&C.current.click()},children:[(0,b.jsxs)("div",{className:i()("author",{"no-headline":!h.headline&&p.name,"has-tags":O}),children:[(0,b.jsx)("div",{className:"author__name",children:(0,b.jsx)("a",we(we({},x),{},{className:"!text-dark",children:h.name}))}),!v&&(O||I)&&(0,b.jsx)("div",{className:"author__tags member-tags",children:(0,b.jsx)(pe.m,{memberTags:w,isAdmin:I,limit:s,showMoreLabelVariant:l})}),(0,b.jsx)("div",{className:"author__time",children:(0,b.jsx)(_.s,{post:p,className:"ago !text-dark",forwardedRef:C,children:me()(p.created_at)})})]}),!d&&(0,b.jsx)(ve,{headline:N,post:p})]})]})},Pe=n(81360),Ce=function(){var e=(0,u.m)(),t=e.post,n=e.canManagePost;if(!t.name)return null;var r=(t||{}).event_setting_attributes||{},o=r.starts_at,a=r.ends_at,s=i()("post__header",{"post-meta--hidden":t.hide_meta_info});return(0,b.jsxs)("div",{className:s,children:[o&&a&&(0,b.jsx)(Pe.A,{startsAt:o,endsAt:a,status:null===t||void 0===t?void 0:t.status}),(0,b.jsx)("h1",{className:i()("post__title text-2xl",{"with-admin-actions":n}),children:(0,b.jsxs)(_.s,{post:t,children:[t.name,t.flagged_for_approval_at&&(0,b.jsx)("span",{className:"post__headline-tag",children:I18n.t("in_review")})]})})]})};function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te=function(e){var t,n,o=e.autofocusReplyForm,d=void 0!==o&&o,m=e.className,p=e.defaultShowComment,v=void 0!==p&&p,h=e.hideAuthorHeadline,g=void 0!==h&&h,y=e.hideBookmarkButton,_=void 0!==y&&y,x=e.hidePinnedToTopIcon,j=void 0!==x&&x,w=e.hideShareLink,O=void 0!==w&&w,S=e.isRenderedOutsideTheSpace,P=void 0!==S&&S,k=e.metaInfoWrapperClassName,N=e.onPostChange,I=e.onPostDestroy,A=e.pageSupportsContentTruncation,E=void 0===A||A,T=e.refetchPosts,M=e.shouldOpenCommentPage,L=void 0!==M&&M,R=e.tagsLimit,D=e.tagsShowMoreLabelVariant,F=(0,r.useRef)(null),U=(0,f.Zh)(),q=U.record,V=U.usedIn,W=(0,u.m)(),Q=W.isPostBodyEmpty,$=W.isPostMetaHidden,J=(0,f.L2)().data,K=Ae((0,r.useState)(v),2),Y=K[0],X=K[1],ee=Ae((0,r.useState)(d),2),te=ee[0],ne=ee[1],re=(0,z.kK)(),oe=null===(t=(0,a.$B)("/home"))||void 0===t?void 0:t.isExact,ie=null===(n=(0,a.$B)("/feed"))||void 0===n?void 0:n.isExact,ae=q.name,se=q.is_truncation_disabled,le=q.is_comments_enabled,de=q.flagged_for_approval_at,me=q.hide_meta_info,fe=q.pinned_at_top_of_space,pe=q.post_details_loaded,ve=q.event_setting_attributes,he=null===ve||void 0===ve?void 0:ve.live_stream_room_setting_attributes,be=null===he||void 0===he?void 0:he.recording_url,ge=null===he||void 0===he?void 0:he.recording_transcript_id,ye=null===he||void 0===he?void 0:he.recording_thumbnail,_e=null===he||void 0===he?void 0:he.auto_post_recording_enabled,xe=null===q||void 0===q?void 0:q.cover_image_url,je=!se,we=(0,f.wh)(),Oe=we.currentUser,Pe=we.currentCommunitySettings,ke=null===Pe||void 0===Pe?void 0:Pe.reactified_comments_enabled,Ie=(0,u.m)(),Ee=Ie.isSharedPostView,Te=Ie.isSharedPostWithTeaserLayout,Me=E&&je||Te,Le=Q&&!oe&&!ie&&!$&&!(0,C.Fr)(q);if(!q||!q.id)return null;var Re=function(){setTimeout((function(){var e=document.querySelector('[input="comment-body-'.concat(q.id,'"]'));e&&e instanceof HTMLElement&&(e.focus(),e.scrollIntoView({behavior:"smooth",block:"center"}))}),500)},De=(0,r.useCallback)((function(){return(0,H.p)(F.current)&&F.current.focus()}),[F]);(0,r.useEffect)((function(){te&&De()}),[De]);var Fe=i()("post post--parent !bg-primary !border-primary",{"post--shared":Ee,"post--shared__truncated":Te&&!Oe,"is-truncation-disabled":!Me,"flagged-for-approval":de,"post-name--empty":!ae,"post-meta--hidden":me,"is-pinned":fe,"!shadow-none !rounded-none !border-0 !border-b":"full-post-modal"===V},m),Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};N(Ne(Ne({},q),e),t)},Be=(0,r.useCallback)((function(){var e,t;(X(!0),ke)?(ne(!0),F.current&&((0,H.p)(F.current)?(0,H.p)(F.current)&&F.current.focus():null===(e=F.current.commands)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e,"end"))):Re()}),[ke,Re]),ze=(0,C.HZ)(q);return(0,b.jsxs)("div",{className:Fe,children:[(0,b.jsx)(ue.H,{post:q}),(0,b.jsxs)("div",{className:i()("post__post",{"!border-x-0":Ee,"!border-b":!Oe&&Ee&&ze,"!border-primary !rounded-t-lg":Ee&&!(null!==q&&void 0!==q&&q.cover_image_url)}),children:[(0,b.jsx)(G,{post:q,onChange:Ue,refetchPosts:T,onPostDestroy:I,hideShareLink:O,hidePinnedToTopIcon:j,hideBookmarkButton:_}),(0,b.jsxs)("div",{className:i()("post__content text-dark",{"pb-5":Le}),children:[P||re?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Se,{isRenderedOutsideTheSpace:P,space:J,doesPostHaveCoverImage:xe}),(0,b.jsx)(Ce,{})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ce,{}),(0,b.jsx)(Se,{isRenderedOutsideTheSpace:P,doesPostHaveCoverImage:xe,space:J,tagsLimit:R,tagsShowMoreLabelVariant:D,wrapperClassName:k,hideAuthorHeadline:g})]}),ze&&(0,b.jsx)(l.Y,{onChange:Ue,insidePost:!0}),be&&_e&&(0,b.jsx)("div",{className:"px-6 py-4",children:(0,b.jsx)(Z.T,{src:be,type:"video/mp4",mediaTranscriptId:ge,poster:ye})}),(0,C.Fr)(q)&&"full-post-modal"!==V&&(0,b.jsx)(s.l,{onPostChange:N,onPostDestroy:I}),(0,b.jsx)(ce,{enableTruncation:Me})]})]}),(0,b.jsx)("div",{className:"mt-auto",children:(0,b.jsx)(B,{toggleComment:function(){ne(!1),X((function(e){return!e}))},showCommentAndFocusCommentForm:Be,shouldOpenCommentPage:L})}),pe&&le&&Y&&(0,b.jsx)(c.o,{commentsFormRef:F,autofocusReplyForm:te})]})};function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Re=function(e){return(0,b.jsx)(Te,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){Le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}},33986:(e,t,n)=>{n.d(t,{m:()=>b});var r=n(88767),o=n(24185),i=n(81089),a=n(98338),s=n(68997),l=n(39068),c=n(51705),u=n(90789),d=n(18701),m=["record"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onChangeSharePost,t=(0,o.UO)().postSlug,n=(0,d.I)(),f=(0,a.Zh)(),v=f.record,b=h(f,m),g=(0,a.wh)(),y=g.currentUser,_=g.currentCommunity,x=g.currentCommunityMember,j=c.Sb(v,{postSlugInUrl:t}),w=j&&v.minimal_layout,O=j&&v.show_post_teaser,S=!n&&c.GT(v,{currentUser:y,postSlugInUrl:t}),P=c.ou(v),C=c.sN(v),k=c.Vr(v),N=c.$2(v),I=c.KX(v),A=w,E=!y&&v.is_comments_enabled&&!v.is_comments_closed||O,T=E&&v.comments_count>5,M=E&&v.comments_count<=5,L=v.flagged_for_approval_at&&P,R=c.hm(v),D=c.HZ(v),F=c.Fr(v),U=c.s8(v),B=c.Iz(v),z=c.Vt(v),H=c.A8(v),Z=!w&&(v.is_liking_enabled||v.is_comments_enabled),q=w&&x,V=(0,r.useMutation)((function(e){var t=e.postId,n=e.body;return(0,i.aU)("/posts/".concat(t,"/share"),n)}),{onSuccess:function(t){e&&e(p(p({},v),t),{refetch:!1})}}),W=V.mutate,Q=V.data,$=V.isLoading;return p(p({post:v},b),{},{canManagePost:P,canDuplicatePost:k,canDestroyPost:N,canUpdatePost:C,canReportPost:I,isSharedPostView:j,showPostActions:S,showEngagementActions:Z,showGatedCommentSection:E,showGatedCommentSectionAtTop:T,showGatedCommentSectionAtBottom:M,showModerationInActionsDropdown:L,isBasicPost:R,isEventPost:D,isImagePost:F,showSpaceName:A,isSharedPostViewWithMinimalLayout:w,isSharedPostWithTeaserLayout:O,isTiptapPost:U,isTrixPost:B,getSharePostLink:W,sharePostData:Q,isLoadingSharePostData:$,showShareOnWebOptions:function(e){return!j&&!n&&(0,c.Pu)(v,_,e)},shouldHideCommentsListForSpace:function(e){var t=e.space,n=(0,s.aF)(_)||x,r=(0,u.fL)(t)||(0,u.J$)(t)||(0,l.vb)(x);return!(n&&r)||w||O},isPostBodyEmpty:z,isPostMetaHidden:H,shouldShowLeaveCommentButton:q})}},5958:(e,t,n)=>{n.d(t,{e:()=>f});var r=n(67294),o=n(86013),i=n(88767),a=n(5476),s=n(94426),l=n(27887),c=n(64248),u=n(85893);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e){var t=e.post,n=d((0,r.useState)(null),2),m=n[0],f=n[1],p=d((0,r.useState)(!1),2),v=p[0],h=p[1],b=(0,i.useMutation)((function(e){var t=e.postId,n=e.value;return a.R.createPostFeedback({postId:t,helpful:n})})).mutate;return(0,u.jsxs)("div",{className:"mx-auto w-full pt-4",children:[(0,u.jsx)("div",{className:"mb-4",children:(0,u.jsx)(l.Di,{weight:"semibold",children:(0,o.t)("support_widget.was_this_article_helpful")})}),(0,u.jsx)("div",{className:"mb-6 flex justify-center gap-4",children:(0,u.jsx)(c.O,{value:m,handleFeedback:function(e){v||(f(e),b({postId:t.id,value:e}),h(!0))},isFeedbackGiven:v})}),(0,u.jsx)("div",{children:(m||!1===m)&&(0,u.jsx)("div",{className:"mb-2",children:(0,u.jsx)(s.p,{children:(0,o.t)("support_widget.thank_you_for_article_feedback")})})})]})}},8340:(e,t,n)=>{n.d(t,{S:()=>_});var r=n(94184),o=n.n(r),i=n(96486),a=n(99658),s=n(43535),l=n(98338),c=n(4404),u=n(86013),d=n(62618),m=n(51705),f=n(36589),p=n(18605),v=n(94281),h=n(74374),b=n(85893),g=function(e){var t=e.post,n=e.comments_count,r=e.className,i=e.showCount,a=void 0===i||i,s=e.onCommentsClick,l=e.iconClassName,c=void 0===l?"text-default":l,g=(0,f.I)().isV3Enabled;return(0,b.jsx)("div",{className:o()("col-span-1",r),children:(0,b.jsx)(v.T,{placement:"bottom",content:(0,u.t)("post.comment_description"),interactive:!1,children:(0,b.jsxs)(h.s,{post:t,allComments:!0,ariaLabel:(0,u.t)("post.comment_description"),shouldOpenPostModal:!0,className:o()("action-item action-comment text-default focus-visible:outline-secondary group flex items-center justify-center rounded-md text-center transition-colors focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"hover:text-dark p-1":!(0,m.Fr)(t)}),onClick:s,children:[(0,b.jsx)("span",{className:"action__icon inline-flex align-text-top",children:(0,b.jsx)(p.JO,{"aria-hidden":!0,type:g?"24-comment":"message",className:o()("group-hover:text-dark mr-1",c),useWithFillCurrentColor:!0})}),a&&(0,b.jsx)("span",{className:"count text-default group-hover:text-dark text-base font-medium tracking-tight",children:(0,d.dm)(n)})]})})})},y=function(e){var t,n,r=e.name,i=e.onLikeToggle,a=e.is_liked_by_current_user,s=e.user_likes_count,c=e.isOrCanBeCommunityMember,h=e.className,g=e.iconClassName,y=void 0===g?"":g,_=e.likedSpanClassName,x=e.showCount,j=void 0===x||x,w=(0,l.wh)().isViewOnlyMasquerading,O=(0,l.Zh)().record,S=(0,f.I)().isV3Enabled;return(0,b.jsx)("div",{className:o()("col-span-1",h),children:(0,b.jsx)(v.T,{placement:"bottom",content:(t=a,n=t?"post.unlike_description":"post.like_description",(0,u.t)(n,{name:null!==r&&void 0!==r?r:""})),interactive:!1,children:(0,b.jsxs)("button",{type:"button",onClick:i,"aria-label":(0,u.t)("like_post_aria_label",{name:null!==r&&void 0!==r?r:""}),className:o()("action-item action-link action-like post__actions--like text-default focus-visible:outline-secondary group flex items-center justify-center rounded-md text-center transition-colors focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{liked:a,disabled:!c||w,"hover:text-dark":!a,"hover:text-dark min-w-[2.5rem] p-1":!(0,m.Fr)(O)}),children:[(0,b.jsx)("span",{className:o()("action__icon inline-flex align-text-top",a&&_),children:S?(0,b.jsx)(p.JO,{className:o()("mr-1",y),type:a?"24-heart-red-fill":"24-heart-outline"}):(0,b.jsx)(p.JO,{type:"like",className:o()("mr-1",{"!text-brand":a},y),useWithFillCurrentColor:!0})}),j&&(0,b.jsx)("span",{className:o()("count text-base font-medium tracking-tight",{"!text-v2-danger":a}),children:(0,d.dm)(s)})]})})})},_=function(e){var t=e.type,n=void 0===t?"list":t,r=e.wrapperClassName,u=e.commentButtonClassName,d=e.commentIconClassName,m=e.likeButtonClassName,f=e.likeIconClassName,p=e.likedSpanClassName,v=e.showCommentsCount,h=void 0===v||v,_=e.showLikesCount,x=void 0===_||_,j=e.onCommentsClick,w=void 0===j?i.noop:j,O=(0,a.m)(),S=O.post,P=O.showEngagementActions,C=O.onLikeToggle,k=S.user_likes_count,N=S.is_liking_enabled,I=S.is_comments_enabled,A=S.is_liked_by_current_user,E=S.comments_count,T=S.post_details_loaded,M=S.display_title,L=(0,l.EU)();return P&&(N||I)?T?(0,b.jsxs)("div",{className:o()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),{"grid grid-cols-2 items-center text-sm md:w-40":"list"===n},{"absolute bottom-4 left-4 flex items-center gap-2":"card"===n},{"flex items-center gap-2 text-sm":"image-card"===n},r),children:[(0,b.jsx)(s.T,{children:N&&(0,b.jsx)(y,{name:M,onLikeToggle:function(e){null===C||void 0===C||C(e)},isOrCanBeCommunityMember:L,user_likes_count:k,is_liked_by_current_user:A,className:m,iconClassName:f,likedSpanClassName:p,showCount:x})}),I&&(0,b.jsx)(g,{comments_count:E,post:S,className:u,iconClassName:d,showCount:h,onCommentsClick:w})]}):(0,b.jsxs)("div",{className:o()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),{"flex items-center":"list"===n},{"absolute bottom-4 left-4 flex items-center gap-2":"card"===n},r),children:[(0,b.jsx)("div",{className:o()("action-item action-link action-like post__actions--like p-1",m),children:(0,b.jsx)("span",{className:"action__icon",children:(0,b.jsx)(c.gi,{variant:"row",lg:!0,short:!0})})}),(0,b.jsx)("div",{className:o()("action-item action-comment p-1",u),children:(0,b.jsx)("span",{className:"action__icon",children:(0,b.jsx)(c.gi,{variant:"row",lg:!0,short:!0})})})]}):null}},40641:(e,t,n)=>{n.d(t,{d:()=>l});var r=n(67294),o=n(96486),i=n(24185),a=n(77131),s=n(54030),l=function(){var e=(0,i.k6)(),t=(0,s.kK)();if(!e)throw new Error("useNavigateToPost must be used within a Router component");return{navigateToPost:(0,r.useCallback)((function(n){var r=n.newPost,i=n.prevLocation,s=n.params,l=n.hasNextPage,c=n.shouldFocusOnCommentsSection,u=void 0!==c&&c,d=n.isWithinProfileContext,m=n.profileContextMember,f=(0,o.pickBy)({prevLocation:i,params:s,hasNextPage:l,shouldFocusOnCommentsSection:u,isWithinProfileContext:d,profileContextMember:m},(function(e){return void 0!==e}));t?e.push(a.x.show({slug:r.slug,spaceSlug:r.space_slug})):e.push({pathname:a.x.show({slug:r.slug,spaceSlug:r.space_slug}),state:f})}),[e,t])}}},96070:(e,t,n)=>{n.d(t,{Y:()=>we});var r=n(67294),o=n(86254),i=n(94184),a=n.n(i),s=n(4395),l=n(98338),c=n(85893),u=function(){var e=(0,l.Zh)().record,t=(0,r.useRef)(null),n=(0,r.useRef)(null),i=(0,l.wh)().currentCommunityMember;return(0,r.useEffect)((function(){if(t.current&&null!==e&&void 0!==e&&e.is_comments_enabled){var n=new o.do((function(){var e=document.documentElement.scrollHeight;window.parent.postMessage(["setHeight",e],"*")}));return n.observe(t.current),function(){return n.disconnect()}}}),[null===e||void 0===e?void 0:e.is_comments_enabled]),null!==e&&void 0!==e&&e.is_comments_enabled?(0,c.jsx)("div",{ref:t,className:a()("post bg-primary border-primary border md:mb-6 md:rounded-lg",{"pb-1 pt-2.5":!!i}),children:(0,c.jsx)(s.o,{commentsFormRef:n,autofocusReplyForm:!1})}):null},d=n(32808),m=n(51705),f=n(99658),p=n(34141),v=n(61844),h=n(7074),b=function(){var e=(0,l.Zh)(),t=e.record,n=e.helpers,r=t.body_trix_content,o=t.tiptap_body,i=n,a=i.isTiptapPost,s=i.isTrixPost,u=(0,f.m)().isPostBodyEmpty;return(0,c.jsxs)(c.Fragment,{children:[!u&&(0,c.jsx)(v.X,{seeMoreClassName:"text-default hover:text-dark",children:(0,c.jsxs)("div",{className:"profile-posts__post__body",children:[s&&r&&(0,c.jsx)(p.P,{content:r}),a&&o&&(0,c.jsx)(h.R,{readOnly:!0,value:o.body,sgidToObjectMap:o.sgids_to_object_map,inlineAttachments:o.inline_attachments})]})}),(0,m.Fr)(t)&&(0,c.jsx)(d.l,{className:"!py-2"})]})},g=n(86013),y=n(96486),_=n(64660),x=n(74374),j=n(18605),w=n(62618),O=n(94281),S=n(4404),P=function(e){var t=e.shouldOpenInNewTab,n=(0,l.wh)().isViewOnlyMasquerading,r=(0,_.r)().hide,o=(0,l.Zh)(),i=o.record,s=o.onLikeToggle,u=i.comments_count,d=i.is_comments_enabled,m=i.is_liked_by_current_user,f=i.is_liking_enabled,p=i.user_likes_count,v=i.post_details_loaded,h=(0,l.EU)();return d||f?(0,c.jsxs)("div",{className:a()("profile-posts__post__actions flex items-center",{"justify-between":f,"justify-end":!f}),children:[f&&(0,c.jsx)(O.T,{interactive:!1,content:m?(0,g.t)("profile_tabs.post.unlike_description"):(0,g.t)("profile_tabs.post.like_description"),placement:"bottom",disabled:!h||!v,children:(0,c.jsx)("button",{type:"button",onClick:n?y.noop:s,className:a()("profile-posts__post__like focus-visible:outline-secondary hover:bg-tertiary active:text-default flex space-x-1 rounded-md p-1 text-sm focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"text-default focus:text-default":!m,"liked text-brand focus:text-brand":m,disabled:!h||!v}),children:v?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(j.JO,{type:"like"}),(0,c.jsx)("span",{className:"profile-posts__post__like-count",children:(0,w.HA)(p)})]}):(0,c.jsx)(S.gi,{variant:"row",lg:!0,short:!0})})}),d&&(0,c.jsx)(O.T,{interactive:!1,content:(0,g.t)("profile_tabs.post.comment_description"),placement:"bottom",disabled:!v,children:(0,c.jsxs)(x.s,{post:i,allComments:!0,className:"profile-posts__post__comments-count text-default focus-visible:outline-secondary focus-visible:text-dark hover:text-dark inline-block rounded-md p-1 text-sm focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:r,target:t&&"_blank",children:[v&&(0,g.t)("post.comments",{count:u,formatted_count:(0,w.HA)(u)}),!v&&(0,c.jsx)(S.gi,{variant:"row",lg:!0,long:!0})]})})]}):null},C=n(50732),k=n(31247),N=n(95287),I=n(73890),A=function(e){var t=e.shouldOpenInNewTab,n=void 0!==t&&t,r=(0,_.r)().hide,o=(0,l.Zh)().record,i=function(e){return!(0,N.n2)(e)&&r()},a=o.name,s=o.created_at,u=o.space_name,d=o.space_slug;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(k.H,{onClick:i,post:o,className:"!rounded-lg",wrapperClassName:"!p-0"}),(0,c.jsxs)("div",{className:"profile-posts__post__meta w-full space-x-2",children:[(0,c.jsxs)("span",{className:"profile-posts__post__author text-default text-sm",children:[(0,g.t)("profile_tabs.post.posted_in")," ",(0,c.jsx)("a",{className:"focus-visible:outline-secondary focus-visible:text-dark text-dark hover:text-darkest font-medium focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:C.RZ.show({spaceSlug:d}),children:u})]}),(0,c.jsx)("span",{className:"bg-badge inline-block h-1 w-1 rounded-full align-middle"}),(0,c.jsx)(O.T,{interactive:!1,content:(0,m.s4)(s),children:(0,c.jsx)(x.s,{onClick:i,post:o,target:n?"_blank":"_self",className:"text-dark focus-visible:outline-secondary focus-visible:text-dark group inline-flex focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,c.jsx)("span",{className:"profile-posts__post__time text-default group-hover:text-dark text-sm",children:(0,I.TF)(s,{format:I.lc.short})})})})]}),!!a&&(0,c.jsx)(x.s,{onClick:i,post:o,target:n?"_blank":"_self",className:"text-dark focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,c.jsx)("div",{className:"profile-posts__post__title text-darkest break-all text-xl font-semibold leading-7",children:a})})]})};function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){var t=e.onPostChange,n=e.shouldOpenInNewTab,r=(0,l.Zh)().record;if(!r||!r.id)return null;var o=r.updated_at;return(0,c.jsxs)("div",{className:"profile-posts__post bg-primary flex flex-col space-y-3 p-5 md:px-6",children:[(0,c.jsx)(A,{}),(0,c.jsx)(b,{}),(0,c.jsx)(P,{onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(T(T({},r),e))},shouldOpenInNewTab:n})]},o)},R=["post"];function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function B(e){var t=e.post,n=U(e,R);return(0,c.jsx)(L,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({post:t},n))}var z=n(14068),H=n(19752),Z=n(90789),q=n(82507),V=n(51215),W=n(11355),Q=n(36589),$=n(38503),G=n(94353),J=n(13288),K=n(64422),Y=function(e){var t=e.post,n=t.last_replied_or_posted,r=t.post_details_loaded,o="replied"===(null===n||void 0===n?void 0:n.type);if(!r)return(0,c.jsx)(S.gi,{variant:"row",lg:!0,almostFull:!0});if(!n)return null;var i=(0,g.t)(n.type);return(0,c.jsxs)(x.s,{post:t,className:"!text-default focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:[o&&(0,c.jsx)(j.JO,{type:"arrow-solid-bottom-right",useWithFillCurrentColor:!0,className:"mr-1 !w-3.5",size:14}),(0,c.jsxs)(O.T,{interactive:!1,content:(0,m.s4)(n.created_at),className:"inline-flex items-center gap-1",children:[(0,c.jsx)("span",{className:"meta-person-action text-sm",children:"".concat(n.user_name," ").concat(i," ")}),(0,c.jsx)("span",{className:"ago post--card__timestamp text-sm",children:(0,I.TF)(n.created_at)})]})]})},X=n(8340),ee=function(){return(0,c.jsx)(X.S,{type:"card"})};function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oe=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.refetchPosts,o=(0,l.Zh)(),i=o.record,s=o.isUpdatingCardViewThumbnail,u=(0,$.TC)().isDarkAppearance,d=(0,Q.I)().isV3Enabled;if(!i)return null;var m=i.flagged_for_approval_at,f=i.cardview_thumbnail_url,p=i.community_member,v=i.hide_meta_info,h=i.display_title,b=i.is_liking_enabled,_=i.is_comments_enabled,j=i.cover_image_url,w=b||_,O=a()("post--card post--parent border-primary bg-primary border relative overflow-hidden",{"flagged-for-approval":m,"has-engagement pb-10":w,"rounded-lg":!d,"rounded-2xl":d}),S=f||j,P=(0,W.O)({public_uid:p.public_uid,params:{show_back_link:!0}});return(0,c.jsxs)("div",{className:O,children:[(0,c.jsxs)("div",{className:"post--card__post text-dark",children:[(0,c.jsx)(x.s,{post:i,className:"post--card__cover text-dark bg-primary focus-visible:outline-secondary focus-visible:text-dark relative block aspect-[2] rounded-t-lg bg-cover bg-center bg-no-repeat focus-visible:rounded-t-lg focus-visible:outline focus-visible:outline-2",style:function(){if(S)return{backgroundImage:"url(".concat(S,")")};var e=u?(0,V.aP)("dark-mode-cover-thumbnail-2x.png"):(0,V.aP)("light-mode-cover-thumbnail-2x.png");return{backgroundImage:"url(".concat(e,")")}}(),shouldOpenPostModal:!0,children:s&&(0,c.jsx)("div",{className:"bg-primary absolute inset-0 flex items-center justify-center rounded-t-lg",children:(0,c.jsx)(J.a,{})})}),!v&&(0,c.jsx)("div",{className:"post--card__user has-cover -mt-5 px-5",children:(0,c.jsx)("div",{className:"post__avatar",children:(0,c.jsx)("a",ne(ne({className:"user__avatar focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},P),{},{children:(0,c.jsx)(K.s,{src:p.avatar_url,name:p.name,size:"10"})}))})}),(0,c.jsx)("div",{className:a()("post--card__body p-5",{"post-meta--hidden":v}),children:(0,c.jsxs)("div",{className:"post--card__content",children:[(0,c.jsx)("div",{className:"post--card__header",children:(0,c.jsxs)("h2",{className:"space-x-2 break-words text-base font-semibold",children:[(0,c.jsx)(x.s,{post:i,className:"!text-darkest focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:(0,y.truncate)(h,{length:60})}),!!m&&(0,c.jsx)(G.g,{className:"post--card__headline-tag !bg-author-in-review border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]})}),!v&&(0,c.jsx)("div",{className:"post--card__meta",children:(0,c.jsx)(Y,{post:i})})]})})]}),(0,c.jsx)(ee,{}),(0,c.jsx)("div",{className:"post--card__actions-wrapper absolute right-4 top-4",children:(0,c.jsx)(q.p,{onPostDestroy:n,refetchPosts:r,onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(ne(ne({},i),e),n)}})})]})};function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var se=function(e){return(0,c.jsx)(oe,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))},le=n(54030),ce=function(e){var t=e.post,n=t.last_replied_or_posted;return t.post_details_loaded?n?(0,c.jsxs)(x.s,{post:t,className:"!text-default focus-visible:outline-secondary inline-flex items-center gap-1 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:["replied"===n.type&&(0,c.jsx)(j.JO,{useWithFillCurrentColor:!0,type:"arrow-solid-bottom-right",className:"text-default !w-3.5",size:14}),(0,c.jsxs)(O.T,{interactive:!1,content:(0,m.s4)(n.created_at),className:"inline-flex items-center gap-1",children:[(0,c.jsx)("span",{className:"meta-person-action text-xs",children:"".concat(n.user_name," ").concat(n.type," ")}),(0,c.jsx)("span",{className:"ago post--list__timestamp text-xs",children:(0,I.TF)(n.created_at)})]})]}):null:(0,c.jsx)(S.gi,{variant:"row",lg:!0,half:!0})};function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){me(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fe=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.refetchPosts,o=e.hideTitle,i=void 0!==o&&o,s=(0,l.Zh)().record,u=(0,le.kK)(),d=(0,Q.I)().isV3Enabled,m=s.flagged_for_approval_at,f=s.community_member,p=s.hide_meta_info,v=s.display_title,h=a()("post--list post--parent border-t border-primary px-5 py-3 md:py-4 bg-primary border-b-none last:border-b md:border-x",{"flagged-for-approval":m,"first:md:rounded-t-lg last:md:rounded-b-lg":!d,"first:md:rounded-t-2xl last:md:rounded-b-2xl":d}),b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(de(de({},s),e),n)},_=(0,W.O)({public_uid:f.public_uid,params:{show_back_link:!0}});return u?(0,c.jsx)("div",{className:h,children:(0,c.jsx)("div",{className:"post--list__post text-dark flex gap-3",children:(0,c.jsxs)("div",{className:"post--list__body flex w-full flex-col gap-2",children:[(0,c.jsx)("div",{className:"post--list__content w-full gap-2 !pr-0 md:gap-0",children:!i&&(0,c.jsxs)("div",{className:a()("post--list__header flex w-full items-start justify-between",{"post-meta--hidden":p}),children:[(0,c.jsxs)("h2",{className:"mr-4 space-x-2 break-words text-base font-medium leading-5",children:[(0,c.jsx)(x.s,{post:s,className:"!text-dark focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:(0,y.truncate)(v,{length:110})}),!!m&&(0,c.jsx)(G.g,{className:"post--list__headline-tag !bg-author-in-review w-full max-w-fit border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]}),(0,c.jsx)(q.p,{onPostDestroy:n,refetchPosts:r,onChange:b})]})}),!p&&(0,c.jsxs)("div",{className:"flex items-start justify-start space-x-2",children:[(0,c.jsx)("div",{className:"post--list__user",children:(0,c.jsx)("a",de(de({},_),{},{className:"focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,c.jsx)(K.s,{src:f.avatar_url,name:f.name,size:"6"})}))}),(0,c.jsxs)("div",{className:"post--list__meta flex w-full items-center justify-between",children:[(0,c.jsx)(ce,{post:s}),(0,c.jsx)("div",{className:"post--list__actions-wrapper gap-2 self-start md:gap-0",children:(0,c.jsx)(X.S,{})})]})]})]})})}):(0,c.jsx)("div",{className:h,children:(0,c.jsxs)("div",{className:"post--list__post text-dark flex gap-3",children:[!p&&(0,c.jsx)("div",{className:"post--list__user",children:(0,c.jsx)("a",de(de({},_),{},{className:"focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,c.jsx)(K.s,{src:f.avatar_url,name:f.name,size:"10"})}))}),(0,c.jsxs)("div",{className:"post--list__body flex w-full items-center justify-between",children:[(0,c.jsxs)("div",{className:a()("post--list__content flex flex-col",{"justify-center":p,"justify-start gap-1":!p}),children:[!i&&(0,c.jsx)("div",{className:a()("post--list__header",{"post-meta--hidden":p}),children:(0,c.jsxs)("h2",{className:"mr-4 flex space-x-2 break-words text-base font-medium leading-5",children:[(0,c.jsx)(x.s,{post:s,className:"!text-dark focus-visible:outline-secondary focus-visible:text-dark line-clamp-1 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:v}),!!m&&(0,c.jsx)(G.g,{className:"post--list__headline-tag !bg-author-in-review w-full max-w-fit shrink-0 border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]})}),!p&&(0,c.jsx)("div",{className:"post--list__meta inline-flex",children:(0,c.jsx)(ce,{post:s})})]}),(0,c.jsxs)("div",{className:"post--list__actions-wrapper flex items-baseline gap-1",children:[(0,c.jsx)(X.S,{likeButtonClassName:"!inline-flex",commentButtonClassName:"!inline-flex"}),(0,c.jsx)(q.p,{onPostDestroy:n,refetchPosts:r,onChange:b})]})]})]})})};function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var he=function(e){return(0,c.jsx)(fe,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))},be=n(21904),ge=["space","post","isFirst","forcePostView","forceSimplifiedView","forceIframeView","usedIn"];function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var we=function(e){var t=e.space,n=void 0===t?{}:t,r=e.post,o=e.isFirst,i=void 0!==o&&o,a=e.forcePostView,s=void 0!==a&&a,d=e.forceSimplifiedView,m=void 0!==d&&d,f=e.forceIframeView,p=void 0!==f&&f,v=e.usedIn,h=je(e,ge),b=Boolean(r.pinned_at_top_of_space),g=(0,Z.AU)(n),y=(0,Z.G6)(n),_=be.D;return(0,Z.fq)(n)?_=be.D:(0,Z.wk)(n)?_=H.p:(0,Z.HO)(n)?_=z.d:m?_=B:p?_=u:s||b&&i?_=be.D:g?_=se:y&&(_=he),(0,c.jsx)(l.DW,{post:r,usedIn:v,children:(0,c.jsx)(_,_e({post:r},h))})}},71179:(e,t,n)=>{n.d(t,{Fk:()=>a,_t:()=>s});var r=n(67294),o=n(85893),i=(0,r.createContext)({params:{},hasNextPage:!1});i.displayName="PostNavigationContext";var a=function(e){var t=e.children,n=e.params,r=void 0===n?{}:n,a=e.hasNextPage,s=void 0!==a&&a;return(0,o.jsx)(i.Provider,{value:{params:r,hasNextPage:s},children:t})},s=function(){var e=(0,r.useContext)(i);if(!e)throw new Error("usePostNavigationContext must be used within a PostNavigationProvider");return e}},4395:(e,t,n)=>{n.d(t,{o:()=>Jt});var r=n(67294),o=n(94184),i=n.n(o),a=n(86013),s=n(98338),l=n(43227),c=n(96486),u=n(90789),d=n(82609),m=n(44032),f=n(24185),p=n(31280),v=n(81625),h=n(81786),b=n(95172),g=n(57290);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=n(87536),w=n(56200);function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=function(e){var t=e.editorRef,n=e.autoFocus,o=e.parentCommentId,i=e.communityMemberForReply,a=e.currentCommunityMember,s=e.initialSgidToObjectMap,l=e.usedIn,u=e.toolbarPortalId,d="minimal-post-modal"===l,m=Boolean(o),f=d&&!m,p=function(e,t){var n=O((0,r.useState)(!1),2),o=n[0],i=n[1],a=O((0,r.useState)(0),2),s=a[0],l=a[1],u=O((0,r.useState)(e),2),d=u[0],m=u[1],f=(0,r.useRef)(null),p=(0,r.useRef)(null),v=(0,j.Gc)(),h=v.watch,b=v.reset,g=v.formState,y=g.isSubmitting,_=g.isSubmitSuccessful,x=h("tiptap_body"),S=!(0,w.NU)(x),P=S||y,C=(0,r.useCallback)((function(e){t&&i(!(!e&&S))}),[t,S]),k=(0,r.useCallback)((function(){t&&i(!0)}),[t]);return(0,r.useEffect)((function(){!S&&t&&i(!0)}),[S,t]),(0,r.useEffect)((function(){_&&(t&&i(!1),(0,c.defer)((function(){b(),l((function(e){return e+1}))})))}),[_,b,t]),{isEditorExpanded:o,setIsEditorExpanded:i,editorKey:s,sgidToObjectMap:d,setSgidToObjectMap:m,commentBoxRef:f,toolbarRef:p,formContext:v,isSubmitting:y,isEditorEmpty:S,isSubmitDisabled:P,handleFocusChange:C,handleEditorFocus:k}}(s,d),v=p.isEditorExpanded,h=p.editorKey,y=p.sgidToObjectMap,S=p.setSgidToObjectMap,P=p.commentBoxRef,C=p.toolbarRef,k=p.formContext,N=p.isSubmitting,I=p.isSubmitDisabled,A=p.handleFocusChange,E=p.handleEditorFocus,T=f?v&&!I:!I;return function(e,t,n){(0,r.useEffect)((function(){(0,c.defer)((function(){var r,o,i;t&&!e&&(null===n||void 0===n||null===(r=n.current)||void 0===r||null===(o=r.commands)||void 0===o||null===(i=o.focus)||void 0===i||i.call(o,"end"))}))}),[t,e,n])}(f,n,t),(0,r.useEffect)((function(){C.current=document.getElementById(u)}),[u,C]),function(e,t,n){(0,r.useEffect)((function(){if(e){var r=function(){setTimeout((function(){var e,r=document.activeElement,o=null===(e=t.current)||void 0===e?void 0:e.contains(r),i=document.querySelector(".post__reply:not(.reply-to-parent)"),a=null===i||void 0===i?void 0:i.contains(r);n(!(!o&&!a))}),0)};return document.addEventListener("focusin",r),document.addEventListener("focusout",r),function(){document.removeEventListener("focusin",r),document.removeEventListener("focusout",r)}}}),[e,t,n])}(d,C,A),function(e,t,n,o){(0,r.useEffect)((function(){e&&e.id!==(null===t||void 0===t?void 0:t.id)&&(o((function(t){return _(_({},t),{},x({},e.rich_text_field_sgid,e))})),(0,c.defer)((function(){var t,r;null===n||void 0===n||null===(t=n.current)||void 0===t||null===(r=t.chain)||void 0===r||r.call(t).focus("start").insertContent([(0,g.F_)({sgid:e.rich_text_field_sgid}),(0,g.$U)({text:" "})]).run()})))}),[e,t,n,o])}(i,a,t,S),(0,b.y1)("cmd+enter, ctrl+enter",(function(){"triggerFormSubmit"in k&&k.triggerFormSubmit()}),{enableOnContentEditable:!0,enabled:T},[k,T]),{isEditorExpanded:v,commentBoxRef:P,handleEditorFocus:E,editorKey:h,sgidToObjectMap:y,isSubmitDisabled:I,isSubmitting:N,isUsedInMinimalPostModal:d,isPostCommentFormInMinimalPostModal:f}},C=n(85893),k=function(e){var t=e.autoFocus,n=void 0!==t&&t,r=e.className,o=e.communityMemberForReply,l=e.editorRef,c=e.initialSgidToObjectMap,u=void 0===c?{}:c,d=e.isEdit,m=void 0!==d&&d,f=e.parentCommentId,b=e.placeholder,g=void 0===b?(0,a.t)("comments.form.fields.body_placeholder"):b,y=e.postId,_=e.spaceId,x=e.usedIn,j=(0,s.wh)().currentCommunityMember,w=["post",y,m?"edit":"create",f,"comment-form-toolbar",x].filter(Boolean).join("-"),O=P({editorRef:l,autoFocus:n,usedIn:x,parentCommentId:f,communityMemberForReply:o,currentCommunityMember:j,initialSgidToObjectMap:u,toolbarPortalId:w}),S=O.isEditorExpanded,k=O.commentBoxRef,N=O.handleEditorFocus,I=O.editorKey,A=O.sgidToObjectMap,E=O.isSubmitDisabled,T=O.isSubmitting,M=O.isUsedInMinimalPostModal,L=O.isPostCommentFormInMinimalPostModal;return(0,C.jsxs)("div",{ref:k,className:i()("border-primary focus-within:border-light active:border-light rounded-lg border transition-all duration-300 ease-in-out",{"pointer-events-none opacity-50":T,"px-4 py-3":!L,"max-h-[40px] px-4 py-1.5":L&&!S,"max-h-[440px] px-4 py-3":L&&S}),children:[(0,C.jsx)("div",{className:i()("transition-all duration-300 ease-in-out",{"max-h-[40px] overflow-hidden":M&&!S,"max-h-[400px]":M&&S}),children:(0,C.jsx)(p.$,{editorRef:l,placeholder:g,name:"tiptap_body.body",toolbars:[{portalId:w,component:v.o}],className:i()("max-h-[400px] overflow-y-auto",r),editorClassName:"min-h-[30px]",spaceId:_,sgidToObjectMap:A,disabledExtensions:["poll","ai_copilot","cta"],onFocusChange:function(e){e&&N()}})}),(0,C.jsxs)("div",{className:i()("flex items-end justify-between transition-all duration-300 ease-in-out",{"invisible max-h-0 overflow-hidden opacity-0":L&&!S,"visible max-h-[32px] opacity-100":L&&S,"h-0":L&&!S,"h-[32px]":L&&S}),children:[(0,C.jsx)("div",{id:w,className:"transition-opacity duration-300 ease-in-out"}),(0,C.jsx)(h.z,{variant:"primary",type:"submit",disabled:E,className:"!px-4 transition-opacity duration-300 ease-in-out",children:m?T?(0,a.t)("comments.create.actions.saving"):(0,a.t)("comments.create.actions.save"):T?(0,a.t)("comments.create.actions.submitting"):(0,a.t)("comments.create.actions.submit")})]})]},I)},N=n(22050),I=n(64422),A=n(67687),E=n(88767),T=n(81089),M=n(50732),L=n(69647);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U=function(e){var t=e.spaceId,n=e.postId,r=e.parentCommentId,o=e.communityMemberForReply,l=e.autoFocus,c=void 0!==l&&l,u=e.onCreate,d=e.bodyInputRef,m=e.className,f=(0,N.g)(!!r),p=(0,s.N3)(),v=(0,s.Zh)(),h=v.usedIn,b=v.isUsedInMinimalTipTapViewModal,g="full-post-modal"!==h,y=o?(0,a.t)("comments.form.fields.body_reply_placeholder",{name:o.name}):(0,a.t)("comments.form.fields.body_placeholder"),_=function(e){var t=e.postId,n=e.parentCommentId,r=e.onCreate,o=(0,L.p)().error;return{createComment:(0,E.useMutation)((function(e){return(0,T.Cu)(M.av.comments.create({postId:t}),{comment:D({parent_comment_id:n},e)})}),{onSuccess:r,onError:function(){return o((0,a.t)("comments.create.alerts.failure"))}}).mutateAsync}}({postId:n,parentCommentId:r,onCreate:u}),x=_.createComment;return(0,C.jsxs)("div",{className:i()("post__reply flex items-start gap-3 py-2.5 md:py-5",{"bg-primary absolute bottom-0 left-0 z-10 w-full !px-5 !py-4 md:!px-8":b&&!r,"md:px-6":"minimal-post-modal"!==h,"reply-to-parent -ml-8 py-2.5 md:ml-0":r&&"full-post-modal"!==h,"reply-to-parent -ml-8 md:ml-[-3.125rem]":r&&"full-post-modal"===h,"reply-to-post px-5":!r}),ref:f,children:[g&&(0,C.jsx)(I.s,{src:p.avatar_url,name:p.name,size:"10"}),(0,C.jsx)(A.l,{className:"relative w-full",onSubmit:function(e){return x(e)},children:(0,C.jsx)(k,{autoFocus:c,className:m,communityMemberForReply:o,editorRef:d,isEdit:!1,parentCommentId:r,placeholder:y,postId:n,spaceId:t,usedIn:h})})]})},B=n(97910),z=function(){var e=(0,f.TH)().hash.split(B.q)[1];return{commentId:e&&parseInt(e,10)||null}};function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q=function(e){var t=e.enabled,n=void 0===t||t,o=H((0,r.useState)(!1),2),i=o[0],a=o[1],s=z().commentId;(0,r.useEffect)((function(){if(n&&s&&!i){var e=setTimeout((function(){a(!0);var e=document.querySelector("".concat(B.q).concat(s));e&&e.scrollIntoView()}),500);return function(){return clearTimeout(e)}}}),[n,s,i])},V=n(5036),W=function(e){var t=e.space,n=e.post,o=e.parentCommentId,c=e.preloaded,u=void 0!==c&&c,d=e.preloadedComments,m=void 0===d?[]:d,p=e.preloadedCommentsTotalCount,v=void 0===p?0:p,h=e.showReplyForm,b=void 0!==h&&h,g=e.autofocusReplyForm,y=void 0!==g&&g,_=e.communityMemberForReply,x=e.onCommentReplyClick,j=e.onCommentCreate,w=e.onCommentDelete,O=e.formRef,S=(0,s.N3)(),P=(0,s.Zh)(),k=P.usedIn,N=P.isUsedInMinimalTipTapViewModal,I=(0,f.TH)(),A=I.state,E=null===A||void 0===A?void 0:A.shouldFocusOnCommentsSection,T=(0,V.wS)({postId:n.id,parentCommentId:o,preloaded:u,preloadedComments:m,preloadedCommentsTotalCount:v,postCommentsClosed:n.is_comments_closed,postLikingDisabled:n.is_liking_disabled,usedIn:k}),M=T.comments,L=T.isLoading,R=T.isFetchingNextPage,D=T.hasNextPage,F=T.fetchNextPage,B=T.addCommentToList,z=T.updateCommentInList,H=T.removeCommentFromList;q({enabled:!L&&!o});var Z=function(e){H(e),null===w||void 0===w||w(e)},W=L||R;(0,r.useEffect)((function(){if(!W&&E){var e=document.getElementById("all_comments");null===e||void 0===e||e.scrollIntoView({behavior:"smooth"}),I.state.shouldFocusOnCommentsSection=!1}}),[W,E,I.state]);var Q=S&&t&&b&&(!W||M.length>0);return(0,C.jsxs)("div",{className:i()({"my-3":!Q&&!o}),children:[M.map((function(e){return(0,C.jsx)(Ct,{space:t,post:n,comment:e,autofocusReplyForm:!0,onReplyClick:x,onUpdate:z,onDelete:Z,onReplyCreate:j,onReplyDelete:w},e.id)})),W&&(0,C.jsx)(l.m,{}),!W&&D&&(0,C.jsx)("div",{className:i()("load-more",{"py-5 text-center":!o,"mb-4 mt-2 pl-5 text-left text-sm font-medium md:pl-6":o}),children:(0,C.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),F()},className:i()("focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"load-more__replies text-link":o,"load-more__comments border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest inline-block rounded-md border px-6 py-2 text-sm font-semibold leading-normal transition-colors duration-150":!o}),children:(0,a.t)(o?"comments.list.show_more_replies":"comments.list.show_more_comments")})}),W&&N&&(0,C.jsx)("div",{className:"bg-primary absolute bottom-0 left-0 w-full !px-5 !py-4 md:!px-8",children:(0,C.jsxs)("div",{className:"flex gap-4",children:[(0,C.jsx)("div",{className:"bg-tertiary h-10 w-10 animate-pulse rounded-full"}),(0,C.jsx)("div",{className:"border-primary h-10 w-full rounded-lg border p-px"})]})}),Q&&(0,C.jsx)(U,{spaceId:t.id,postId:n.id,parentCommentId:o,communityMemberForReply:_,autoFocus:y,className:i()(N&&"!max-h-[360px]"),onCreate:function(e){B(e),null===j||void 0===j||j(e);var t=document.getElementById("comment_wrapper_".concat(e.id));N&&t&&t.scrollIntoView({behavior:"smooth",block:"center"})},bodyInputRef:O})]})},Q=n(20640),$=n.n(Q),G=n(18701),J=n(58974),K=n(54482),Y=n(27025);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ne=function(e){var t=e.comment,n=e.canReport,r=e.canReview,o=e.canEdit,s=e.canDestroy,l=e.canBookmark,c=e.isReply,u=e.onReportClick,d=e.onEditClick,m=e.onDeleteClick,f=e.onUpdate,p=(0,G.I)(),v=[],h=(0,L.p)().success;return n&&v.push({key:"report",label:(0,a.t)("comments.action_menu.report.label"),href:"#",onClick:function(){u()}}),r&&v.push(ee({key:"review",label:(0,a.t)("comments.action_menu.review.label"),to:M.sC.index()},p?{target:"_blank",rel:"noreferrer"}:{})),o&&v.push({key:"edit",label:(0,a.t)("comments.action_menu.edit.label"),onClick:function(){d()}}),t.show_url&&v.push({key:"Copy link",label:(0,a.t)("comments.action_menu.copy_url.label"),href:"#",onClick:function(){$()(t.show_url),h((0,a.t)("comments.action_menu.copy_url.url_copied"))}}),s&&v.push({key:"delete",label:(0,a.t)("comments.action_menu.delete.label"),hasDanger:!0,onClick:function(){m()}}),0!==v.length||l?(0,C.jsx)("div",{className:i()("post__actions--comment ml-2 md:ml-4",{"post__actions--reply":c}),"data-testid":"post-comment-actions",children:(0,C.jsxs)(Y.Lt,{menuButtonEl:"div",button:(0,C.jsx)(K.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,dataTestId:"action-more",ariaLabel:(0,a.t)("comments.actions")}),children:[(0,C.jsx)(J.e,{variant:"dropdown",bookmarkType:"comment",record:t,onSuccess:function(e){var n=ee(ee({},t),{},{bookmark_id:e});f(n)}}),v.map((function(e){return(0,C.jsx)(Y.Lt.ItemWithLink,ee(ee({},e),{},{children:e.label}),e.key)}))]})}):null},re=n(32209),oe=n(34141),ie=n(61844),ae=function(e){var t=e.comment,n=t.body_trix_content,r=t.editor,o=t.tiptap_body,i=t.updated_at,a="tiptap"===r;return(0,C.jsx)("div",{className:"post__body text-base","data-testid":"comment-body",children:(0,C.jsx)("div",{className:"post__inside text-dark","data-testid":"comment-body-inside",children:(0,C.jsx)(ie.X,{lines:8,children:a?(0,C.jsx)(re.G,{tiptapBody:o}):(0,C.jsx)(oe.P,{content:n})})},i)})},se=n(28536),le=n(66422),ce=function(e){var t,n,r=e.comment,o=e.updateComment,i="post"===(null===r||void 0===r||null===(t=r.tiptap_body)||void 0===t?void 0:t.format);return(0,C.jsx)("div",{className:"text-dark mb-1 whitespace-pre-line text-sm font-normal",children:i?(0,C.jsx)(se.l,{onSubmit:o,defaultValues:{tiptap_body:r.tiptap_body},children:(0,C.jsx)(k,{isEdit:!0,postId:r.post_id,spaceId:r.space_id,autoFocus:!0,initialSgidToObjectMap:null===r||void 0===r||null===(n=r.tiptap_body)||void 0===n?void 0:n.sgids_to_object_map})}):(0,C.jsx)(le.T,{autofocus:!0,editable:!0,type:"comment",hardBreakOnEnter:!0,submitOnEnter:!1,submitOnModEnter:!0,rich_text_body:r.tiptap_body,onSubmit:function(e){var t=e.body,n=e.attachments;return o({tiptap_body:{body:t,attachments:n}})},isUpdate:!0,placeholder:(0,a.t)("write_a_comment"),menubarProps:{submitButtonLabel:(0,a.t)("comments.create.actions.save"),submittingLabel:(0,a.t)("comments.create.actions.saving")}})})},ue=n(11049),de=n(82177),me=function(e){var t=e.comment,n=e.updateComment,r=(0,ue.dd)();return(0,b.y1)("esc",(function(){return r.remove()}),{enableOnContentEditable:!0},[]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(de.u_.Overlay,{}),(0,C.jsxs)(de.u_.Content,{size:"lg",className:"!overflow-visible",children:[(0,C.jsxs)(de.u_.Header,{children:[(0,C.jsx)(de.u_.Title,{size:"sm",children:(0,a.t)("comments.edit.form.title")}),(0,C.jsx)(de.u_.HeaderActions,{children:(0,C.jsx)(de.u_.CloseButton,{onClick:r.remove})})]}),(0,C.jsx)(de.u_.Body,{className:"!overflow-y-visible pb-6",children:(0,C.jsx)(ce,{comment:t,updateComment:n})})]})]})},fe=n(64419),pe=n(23127),ve=function(e){var t=e.spaceId,n=e.spaceIsPrivate,r=e.onClose,o=(0,j.Gc)(),i=o.watch,s=o.formState,l=s.isDirty,c=s.isSubmitting,u=s.isSubmitSuccessful,d=c||u,m=!!i().body&&!d;(0,fe.M)({enabled:m});var f=function(){l&&!confirm((0,a.t)("prevent_accidental_leave_message"))||r()};return(0,C.jsxs)(de.u_.Content,{size:"lg",wrapperClassName:"!h-full",className:"!transform-none !overflow-visible",children:[(0,C.jsxs)(de.u_.Header,{children:[(0,C.jsx)(de.u_.Title,{children:(0,a.t)("comments.edit.form.title")}),(0,C.jsx)(de.u_.HeaderActions,{children:(0,C.jsx)(de.u_.CloseButton,{onClick:f})})]}),(0,C.jsx)(de.u_.Body,{className:"comment__edit-modal-content-body trix-v2 max-h-[calc(100dvh-82px-65px)] !overflow-visible md:max-h-none",children:(0,C.jsx)(pe.O,{id:"comment-edit-body",name:"body",placeholder:(0,a.t)("comments.form.fields.body_placeholder"),className:"h-full",editorContainerClassName:"flex flex-col h-full",textboxClassName:"overflow-auto rounded-md py-4 sm:max-h-[40vh]",space_id:t,is_private_space:n})}),(0,C.jsxs)(de.u_.Footer,{className:"bottom-0 flex justify-end space-x-4",children:[(0,C.jsx)(h.z,{type:"button",variant:"secondary",onClick:f,children:(0,a.t)("cancel")}),(0,C.jsx)(h.z,{type:"submit",variant:"primary",disabled:!m,children:d?(0,a.t)("saving_changes"):(0,a.t)("save_changes")})]})]})},he=function(e){var t=e.space,n=e.comment,r=e.onUpdate,o=t.id,i=t.is_private,s=(0,ue.dd)(),l="tiptap"===n.editor,u=function(e){var t=e.comment,n=e.onUpdate,r=t.id,o=t.post_id,i=t.body_for_editor,s=(0,L.p)(),l=s.success,c=s.error;return{defaultValues:{body:i},updateComment:(0,E.useMutation)((function(e){return(0,T.gN)(M.av.comments.update({postId:o,id:r}),{comment:e})}),{onSuccess:function(e){n(e),l((0,a.t)("comments.edit.alerts.success"))},onError:function(){return c((0,a.t)("comments.edit.alerts.failure"))}}).mutateAsync}}({comment:n,onUpdate:function(e){r(e),s.hide()}}),d=u.defaultValues,m=u.updateComment;return(0,C.jsx)(de.u_,{title:(0,a.t)("comments.edit.form.title"),isOpen:s.visible,onClose:c.noop,children:l?(0,C.jsx)(me,{comment:n,updateComment:m}):(0,C.jsxs)(A.l,{defaultValues:d,onSubmit:m,className:"h-full",formClassName:"h-full",children:[(0,C.jsx)(de.u_.Overlay,{}),(0,C.jsx)(ve,{spaceId:o,spaceIsPrivate:i,onClose:s.hide})]})})},be=ue.gk.create((function(e){var t=e.space,n=e.comment,r=e.onUpdate;return(0,C.jsx)(he,{space:t,comment:n,onUpdate:r})})),ge=["label","onClick","disabled","isLiked","className"];function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var we=function(e){var t=e.label,n=e.onClick,r=e.disabled,o=void 0!==r&&r,a=e.isLiked,s=void 0!==a&&a,l=e.className,c=je(e,ge);return(0,C.jsx)("button",_e(_e({type:"button",className:i()("focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",l),onClick:function(e){e.preventDefault(),o||n()},"aria-disabled":o},c),{},{children:(0,C.jsx)("span",{"aria-checked":s,className:i()("hover:text-dark text-sm",{"text-brand font-semibold":s,"text-default font-medium":!s}),children:t})}))},Oe=n(62618),Se=function(e){var t=e.likesCount,n=e.onClick;return(0,C.jsx)("button",{type:"submit",className:"text-default hover:text-dark group ml-auto mr-0 text-sm font-medium","data-testid":"like-count",onClick:n,children:(0,C.jsx)("span",{className:"group-focus-visible:outline-secondary group-focus-visible:rounded-sm group-focus-visible:outline group-focus-visible:outline-2 group-focus-visible:outline-offset-2",children:(0,a.t)("comments.likes",{count:t,formatted_count:(0,Oe.HA)(t)})})})},Pe=function(e){var t=e.canLike,n=e.canReply,r=e.canSeeLikes,o=e.isLiked,l=e.isLikeDisabled,c=e.likesCount,u=e.onLikeClick,d=e.onLikesCountClick,m=e.onReplyClick,f=(0,s.wh)().currentUser,p=r&&c>0&&(f||t&&n);return(0,C.jsxs)("div",{className:"post__actions post__actions-visible mt-1 flex pl-[3.25rem]",children:[t&&(0,C.jsx)(we,{className:i()("post__actions--like mr-2",{liked:o}),label:(0,a.t)("comments.engagement_actions.".concat(o?"liked":"like")),onClick:u,disabled:l,isLiked:o}),n&&(0,C.jsx)(we,{className:"post__actions--reply",label:(0,a.t)("comments.engagement_actions.reply"),onClick:m}),p&&(0,C.jsx)(Se,{likesCount:c,onClick:d})]})},Ce=n(58533),ke=n(13288),Ne=n(8246),Ie=n(11355),Ae=["onClick"];function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){Me(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Le(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Re=function(e){var t,n,r=e.communityMember,o=e.hideModal,i=(0,Ie.O)({public_uid:null!==(t=r.public_uid)&&void 0!==t?t:""}),a=i.onClick,s=Le(i,Ae);return(0,C.jsxs)("button",Te(Te({type:"button",className:"flex w-full items-center gap-3 text-left",onClick:function(e){o(),null===a||void 0===a||a(e)}},s),{},{children:[(0,C.jsx)("div",{className:"mt-0",children:(0,C.jsx)(I.s,{name:null!==(n=r.name)&&void 0!==n?n:"",src:r.avatar_url,size:"10"})}),(0,C.jsx)(Ne.Z.LabelSm,{weight:"medium",children:r.name})]}))},De=n(85564),Fe=n.n(De),Ue=n(10928),Be=n.n(Ue),ze=n(45578),He=n.n(ze),Ze=n(78599),qe=function(e){var t=e.id,n=e.placeholderLikesCount,r=(0,ue.dd)(),o=function(e){var t=e.id,n=e.isQueryEnabled,r=e.placeholderLikesCount,o=(0,Ze.m)(M.av.comments.userLikes({id:t,params:{per_page:15}}),{enabled:n}),i=o.data,a=o.isLoading,s=o.hasNextPage,l=o.fetchNextPage,c=o.mapPages;return{likedByMembers:He()(Fe()(c((function(e){return e.records}))),"id"),totalLikesCount:i?Be()(i.pages).count:r,isLoading:a,hasNextPage:s,fetchNextPage:l}}({id:t,isQueryEnabled:r.visible,placeholderLikesCount:n}),i=o.likedByMembers,s=o.totalLikesCount,c=o.isLoading,u=o.hasNextPage,d=o.fetchNextPage;return(0,C.jsxs)(de.u_,{title:(0,a.t)("comments.likes",{count:s}),isOpen:r.visible,onClose:r.hide,children:[(0,C.jsx)(de.u_.Overlay,{}),(0,C.jsxs)(de.u_.Content,{children:[(0,C.jsxs)(de.u_.Header,{children:[(0,C.jsx)(de.u_.Title,{size:"sm",children:(0,C.jsx)(Ne.Z.LabelLg,{weight:"semibold",children:(0,a.t)("comments.likes",{count:s,formatted_count:(0,Oe.HA)(s)})})}),(0,C.jsx)(de.u_.HeaderActions,{children:(0,C.jsx)(de.u_.CloseButton,{onClick:r.hide})})]}),(0,C.jsx)(de.u_.Body,{className:"pb-6 pt-4",children:c?(0,C.jsx)(l.m,{}):(0,C.jsx)("div",{id:"comment-likes-modal-".concat(t),className:"max-h-[calc(100dvh-62px-44px-24px)] overflow-auto sm:max-h-80",children:(0,C.jsx)(Ce.Z,{scrollThreshold:.75,next:d,hasMore:u||!1,loader:(0,C.jsx)(ke.a,{}),scrollableTarget:"comment-likes-modal-".concat(t),dataLength:i.length,className:"flex flex-col space-y-4",children:i.map((function(e){return(0,C.jsx)(Re,{communityMember:e,hideModal:r.hide},e.id)}))})})})]})]})};qe.displayName="LikesModalComponent";var Ve=ue.gk.create((function(e){var t=e.id,n=e.placeholderLikesCount;return(0,C.jsx)(qe,{id:t,placeholderLikesCount:n})}));Ve.displayName="LikesModal";var We=n(388);function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){Ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Je=function(e){var t,n,r,o=e.comment.community_member,i=(0,Ie.O)({public_uid:null!==(t=o.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0}});return(0,C.jsx)("div",{className:"post__user flex items-start",children:(0,C.jsx)("div",{className:"post__avatar mr-3",children:(0,C.jsx)("a",$e($e({className:"user__avatar focus-visible:outline-secondary focus-visible:text-dark block h-10 w-10 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},i),{},{children:(0,C.jsx)(We.C,{communityMemberId:o.id,name:o.name,publicUid:o.public_uid,headline:o.headline,avatarURL:o.avatar_url,children:(0,C.jsx)(I.s,{src:null!==(n=o.avatar_url)&&void 0!==n?n:"",name:null!==(r=o.name)&&void 0!==r?r:"",size:"10"})})}))})})},Ke=n(39068),Ye=n(73890),Xe=n(51705),et=n(54030),tt=n(94281),nt=n(94353),rt=n(43574);function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){at(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function at(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var st=function(e){var t=e.comment,n=e.commentLinkProps,r=t.community_member,o=t.created_at,l=(0,et.kK)(),u="full-post-modal"===(0,s.Zh)().usedIn,d=l||u?(0,c.truncate)(r.headline,{length:60}):r.headline;return d||l||u?(0,C.jsx)("div",{className:"post__meta inline-flex",children:(0,C.jsx)(tt.T,{content:r.headline,shouldUseSpanWrapper:!1,interactive:!1,disabled:!d,children:(0,C.jsx)("button",{type:"button",className:"author__credentials text-default focus-visible:outline-secondary focus-visible:text-dark mt-1 w-full text-left text-xs leading-4 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,C.jsxs)("span",{children:[d&&(0,C.jsx)("span",{className:i()("overflow-anywhere mr-2",{"md:line-clamp-1":!u}),children:d}),(l||u)&&!!d&&(0,C.jsx)("span",{className:"bg-badge mr-2 inline-block h-[0.15rem] w-[0.15rem] rounded-full align-middle"}),(l||u)&&(0,C.jsx)("a",it(it({className:i()("text-default hover:text-dark text-xs leading-5","focus-visible:outline-secondary focus-visible:text-dark mr-2 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2")},n),{},{children:(0,C.jsx)(tt.T,{content:(0,Xe.s4)(o),className:"inline-flex",interactive:!1,children:(0,Ye.TF)(o,{format:Ye.lc.short})})})),(l||u)&&t.flagged_for_approval_at&&(0,C.jsx)(nt.g,{className:"authour__in-review !bg-author-in-review border-0 uppercase text-white",label:(0,a.t)("comments.in_review")})]})})})}):null};function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){ut(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dt=function(e){var t,n=e.post,r=e.comment,o=r.id,l=r.community_member,c=r.member_tags,u=r.flagged_for_approval_at,d=r.created_at,m=r.parent_comment_id,f=(0,s.wh)().currentCommunityMember,p="full-post-modal"===(0,s.Zh)().usedIn,v=Boolean(l.admin),h=null===c||void 0===c?void 0:c.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.post_bio)})),b=(0,G.I)(),g=(0,Ke.vb)(f),y=(null===h||void 0===h?void 0:h.length)>0||v,_=(0,et.kK)(),x=_?g:y,j=(0,Ie.O)({public_uid:null!==(t=l.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0}}),w=ct({href:(0,M.LM)({spaceSlug:n.space_slug,slug:n.slug,hash:"".concat(B.q).concat(o)})},b?{target:"_blank",rel:"noreferrer"}:{}),O=_||p||!!m;return(0,C.jsxs)("div",{className:"post__bio mb-1.5 w-full",children:[(0,C.jsxs)("div",{className:i()("author text-darkest flex flex-wrap items-center gap-x-2",{"no-headline":!l.headline}),children:[(0,C.jsx)("div",{className:"author__name flex",children:(0,C.jsx)("a",ct(ct({className:"text-dark hover:text-darkest focus-visible:outline-secondary focus-visible:text-dark overflow-anywhere text-sm font-semibold focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},j),{},{children:l.name}))}),y&&x&&(0,C.jsx)("div",{className:"author__tags member-tags",children:(0,C.jsx)(rt.m,{memberTags:h,isAdmin:v,limit:O?1:2,showMoreLabelVariant:"numbers"})}),!_&&!p&&(0,C.jsx)("div",{className:"author__time flex",children:(0,C.jsx)("a",ct(ct({className:i()("text-default hover:text-dark text-xs","focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2")},w),{},{children:(0,C.jsx)(tt.T,{content:(0,Xe.s4)(d),className:"inline-flex",interactive:!1,children:(0,Ye.TF)(d,{format:Ye.lc.short})})}))}),!_&&!p&&u&&(0,C.jsx)(nt.g,{className:"authour__in-review !bg-author-in-review border-0 uppercase text-white",label:(0,a.t)("comments.in_review")})]}),(0,C.jsx)(st,{comment:r,commentLinkProps:w})]})},mt=["harassment","spam","incorrect_location","against_guidelines","other"],ft=function(e){var t=e.show,n=e.onClose,r=e.onReportSubmit,o=mt.map((function(e){return{value:e,label:(0,a.t)("flagged_contents.report_reasons.".concat(e))}}));return(0,C.jsxs)(de.u_,{isOpen:t,onClose:n,title:(0,a.t)("comments.report.form.title"),children:[(0,C.jsx)(de.u_.Overlay,{}),(0,C.jsxs)(de.u_.Content,{children:[(0,C.jsxs)(de.u_.Header,{children:[(0,C.jsx)(de.u_.Title,{size:"sm",children:(0,a.t)("comments.report.form.title")}),(0,C.jsx)(de.u_.HeaderActions,{children:(0,C.jsx)(de.u_.CloseButton,{onClick:n})})]}),(0,C.jsx)(de.u_.Body,{children:(0,C.jsxs)(A.l,{onSubmit:r,children:[(0,C.jsx)(A.l.Item,{name:"reported_reason_type",label:(0,a.t)("flagged_contents.form.reported_reason_type"),description:(0,a.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,C.jsx)(A.l.SelectNative,{options:o})}),(0,C.jsx)(A.l.Item,{name:"reported_reason_body",label:(0,a.t)("flagged_contents.form.reported_reason_body"),description:(0,a.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,C.jsx)(A.l.TextArea,{})}),(0,C.jsx)("div",{className:"py-4",children:(0,C.jsx)(h.z,{type:"submit",variant:"primary",children:(0,a.t)("report")})})]})})]})]})};function pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ht=n(34334);function bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yt="Comment";function _t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function St(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ct=function(e){var t=e.space,n=e.post,o=e.comment,l=e.showReplyForm,f=void 0!==l&&l,p=e.autofocusReplyForm,v=void 0!==p&&p,h=e.onReplyClick,b=e.onUpdate,g=e.onDelete,y=e.onReplyCreate,_=e.onReplyDelete,x=(0,s.wh)().isViewOnlyMasquerading,j=(0,s.Zh)().isUsedInMinimalTipTapViewModal,w=o.id,O=o.parent_comment_id,S=o.community_member,P=o.replies,k=o.replies_count,N=o.flagged_for_approval_at,I=o.policies,A=!!N,R=!!O,D=I.can_report&&!A,F=I.can_manage&&A,U=I.can_edit,B=I.can_destroy,z=I.can_bookmark,H=(0,r.useRef)(),Z=function(e){var t=e.comment,n=e.showReplyForm,o=e.replyFormRef,i=t.is_replying_enabled,l=(0,s.xJ)(),c=(0,s.EU)(),u=(0,G.I)(),d=_t((0,r.useState)(n),2),m=d[0],f=d[1],p=_t((0,r.useState)(null),2),v=p[0],h=p[1];return{openReplyForm:function(e){var t=e.communityMember;if(l){var n,r;h(t),f(!0),o.current&&(null===(n=o.current.commands)||void 0===n||null===(r=n.focus)||void 0===r||r.call(n,"end"))}else{var i=(0,M.j)({params:{notice:(0,a.t)("comments.log_in_to_add_a_comment"),post_login_redirect:window.location.href}});u?window.open(i,"_blank","noreferrer"):window.location.href=i}},shouldShowReplyForm:m,communityMemberForReply:v,canReply:i&&c}}({comment:o,showReplyForm:f,replyFormRef:H}),q=Z.openReplyForm,V=Z.shouldShowReplyForm,Q=Z.communityMemberForReply,$=Z.canReply,J=function(e){var t=e.comment,n=t.id,o=t.is_liking_enabled,i=t.is_liked,l=t.likes_count,c=(0,s.xJ)(),u=(0,s.EU)(),d=(0,G.I)(),m=bt((0,r.useState)(i),2),f=m[0],p=m[1],v=bt((0,r.useState)(l),2),h=v[0],b=v[1],g=(0,E.useMutation)((function(){return ht.Qd.create({userLikeableId:n,userLikableType:yt,forReactQuery:!0})})),y=g.mutate,_=g.isLoading,x=(0,E.useMutation)((function(){return ht.Qd.destroy({userLikeableId:n,userLikableType:yt,forReactQuery:!0})})),j=x.mutate,w=x.isLoading;return{toggleLike:function(){if(c)_||w||(f?(p(!1),b((function(e){return e-1})),j()):(p(!0),b((function(e){return e+1})),y()));else{var e=(0,M.j)({params:{notice:(0,a.t)("comments.log_in_to_like_comments"),post_login_redirect:window.location.href}});d?window.open(e,"_blank","noreferrer"):window.location.href=e}},isLiked:f,likesCount:h,canLike:o&&u,canSeeLikes:o,isLoading:_||w}}({comment:o}),K=J.toggleLike,Y=J.isLiked,X=J.likesCount,ee=J.canLike,te=J.canSeeLikes,re=J.isLoading,oe=(0,ue.dd)(Ve),ie=(0,ue.dd)(be),se=function(e){var t=e.comment.id,n=(0,L.p)(),o=n.success,i=n.error,s=St((0,r.useState)(!1),2),l=s[0],c=s[1],u=function(){return c(!1)},d=(0,E.useMutation)((function(e){return(0,T.Cu)(M.av.flaggedContent.create(),{flagged_content:wt(wt({},e),{},{flagged_contentable_id:t,flagged_contentable_type:"Comment"})})}),{onSuccess:function(){o((0,a.t)("comments.report.alerts.success"),{duration:"short",shouldUseProgress:!1}),u()},onError:function(){i((0,a.t)("comments.report.alerts.failure"))}}).mutate;return{isReportModalOpen:l,openReportModal:function(){return c(!0)},closeReportModal:u,submitReport:d}}({comment:o}),le=se.isReportModalOpen,ce=se.openReportModal,de=se.closeReportModal,me=se.submitReport,fe=function(e){var t=e.comment,n=e.onDelete,o=t.id,i=t.post_id,s=(0,L.p)(),l=s.success,c=s.error,u=pt((0,r.useState)(!1),2),d=u[0],m=u[1],f=function(){return m(!1)},p=(0,E.useMutation)((function(){return(0,T.pC)(M.av.comments.destroy({postId:i,id:o}))}),{onSuccess:function(){l((0,a.t)("comments.delete.alerts.success"),{duration:"short",shouldUseProgress:!1}),f(),n({id:o})},onError:function(){c((0,a.t)("comments.delete.alerts.failure")),f()}}),v=p.mutate,h=p.isLoading;return{isDeleteConfirmModalOpen:d,openDeleteConfirmModal:function(){return m(!0)},closeDeleteConfirmModal:f,deleteComment:v,isDeletingComment:h}}({comment:o,onDelete:g}),pe=fe.isDeleteConfirmModalOpen,ve=fe.openDeleteConfirmModal,he=fe.closeDeleteConfirmModal,ge=fe.deleteComment,ye=fe.isDeletingComment,_e=h||q,xe=(0,u.Y_)(t)&&(null===o||void 0===o?void 0:o.unresolved_flagged_reports_count)>0;return(0,C.jsxs)("div",{className:i()("post--comment text-dark md:px-0",{"px-5":!R&&!j,"pl-5":R&&!j}),id:"comment_wrapper_".concat(w),children:[(0,C.jsxs)("div",{className:i()("post__content py-2.5",{"md:px-6":!j}),children:[(0,C.jsxs)("div",{className:"flex w-full justify-between",children:[(0,C.jsxs)("div",{className:"flex w-full pt-1",children:[(0,C.jsx)(Je,{comment:o}),(0,C.jsxs)("div",{className:"flex w-full flex-col",children:[(0,C.jsx)(dt,{post:n,comment:o}),(0,C.jsx)(ae,{comment:o})]})]}),(0,C.jsx)(ne,{comment:o,canReport:D,canReview:F,canEdit:U,canDestroy:B,canBookmark:z,isReply:R,onReportClick:x?c.noop:ce,onEditClick:x?c.noop:function(){return ie.show({space:t,comment:o,onUpdate:b})},onDeleteClick:x?c.noop:ve,onUpdate:b})]}),xe&&(0,C.jsx)("div",{className:"mt-2 pl-[3.25rem]",children:(0,C.jsx)(d.F,{record:o,contentType:"comment"})}),(0,C.jsx)(Pe,{canReply:$,canLike:ee,canSeeLikes:te,isLiked:Y,likesCount:X,isLikeDisabled:re,onReplyClick:x?c.noop:function(){return _e({communityMember:S})},onLikeClick:x?c.noop:K,onLikesCountClick:x?c.noop:function(){return oe.show({id:w,placeholderLikesCount:X})}}),D&&(0,C.jsx)(ft,{show:le,onClose:de,onReportSubmit:me}),B&&(0,C.jsx)(m.c,{isOpen:pe,onClose:he,onConfirm:ge,confirmText:ye?(0,a.t)("deleting"):(0,a.t)("delete"),confirmVariant:"danger",title:(0,a.t)("comments.delete.confirm.title"),disabled:ye,children:(0,a.t)("comments.delete.confirm.description")})]}),!R&&(0,C.jsx)("div",{className:i()("post__replies md:ml-[3.125rem]",{"ml-8":!j,"ml-12":j}),children:(0,C.jsx)(W,{space:t,post:n,parentCommentId:w,preloaded:!0,preloadedComments:P,preloadedCommentsTotalCount:k,showReplyForm:V,autofocusReplyForm:v,communityMemberForReply:Q,onCommentReplyClick:q,onCommentCreate:y,onCommentDelete:_,formRef:H})})]})},kt=n(55004);const Nt=function(e){var t=e.space,n=e.post,o=e.id,i=e.showReplyForm,c=void 0!==i&&i,u=e.autofocusReplyForm,d=void 0!==u&&u,m=e.onCommentDelete,f=e.onReplyCreate,p=e.onReplyDelete,v=(0,s.Zh)().usedIn,h=(0,kt.E)({postId:n.id,id:o,postCommentsClosed:n.is_comments_closed,postLikingDisabled:n.is_liking_disabled,usedIn:v}),b=h.comment,g=h.isLoading,y=h.updateQueryData;return(0,r.useEffect)((function(){g||window.initialiseTippy()}),[g]),q({enabled:!g}),g?(0,C.jsx)(l.m,{}):b?(0,C.jsx)(Ct,{space:t,post:n,comment:b,showReplyForm:c,autofocusReplyForm:d,onUpdate:y,onDelete:m,onReplyCreate:f,onReplyDelete:p}):(0,C.jsx)("div",{className:"post__comment-not-found border-primary text-dark dark:text-lightest bg-v2-warning-100 rounded-b-lg border-t p-2.5 py-4 text-base md:p-5",children:(0,a.t)("comments.hierarchy.not_found")})},It=W;var At=n(99658),Et=n(18605),Tt=function(e){var t=e.className;return(0,C.jsx)("div",{className:t,children:(0,C.jsxs)("div",{className:"bg-tertiary flex items-center justify-center gap-2 rounded-md p-3 text-center",children:[(0,C.jsx)(Et.JO,{size:16,type:"lock-v2",className:"text-dark"}),(0,C.jsx)(Ne.Z.LabelSm,{children:(0,a.t)("post.comments_section.comments_closed")})]})})},Mt=n(68997);function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(n),!0).forEach((function(t){Dt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ft=function(e){var t=e.isIframeEmbed,n=e.containerClassNames,r=e.currentCommunity,o=t?{target:"_blank",rel:"noreferrer"}:{},i=Boolean(null===r||void 0===r?void 0:r.private_sign_up_url),s=(0,Mt.fs)(r)||i,l=i?r.private_sign_up_url:(0,Mt.pn)(r);return(0,C.jsxs)("div",{className:n,children:[(0,C.jsx)("div",{className:"mb-3 text-center",children:(0,C.jsx)(Ne.Z.LabelLg,{weight:"semibold",children:(0,a.t)("login_to_comment")})}),(0,C.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,C.jsx)("a",Rt(Rt({className:"focus-visible:outline-secondary border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest rounded-md border px-[18px] py-[6px] text-sm font-semibold transition-colors duration-150 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:(0,M.j)({params:{post_login_redirect:window.location.href}})},o),{},{children:(0,a.t)("log_in")})),s&&(0,C.jsx)("a",Rt(Rt({className:"signup-link btn btn-primary focus-visible:!outline-secondary !bg-brand !text-brand-button !h-auto !rounded-md !px-[18px] !py-[6px] !text-sm !font-bold !leading-5 !transition-colors !duration-150 hover:!opacity-90 focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",href:l},o),{},{children:i?r.private_sign_up_label:(0,a.t)("sign_up")}))]})]})},Ut=n(66007),Bt=function(e){var t=e.lockedPostCtaContent,n=e.containerClassNames;return(0,C.jsxs)("div",{className:n,children:[(0,C.jsx)("div",{children:(0,C.jsx)(Ne.Z.TitleSm,{weight:"semibold",children:t.heading})}),(0,C.jsx)("div",{className:"mt-4",children:t.body&&(0,C.jsx)(Ne.Z.BodyMd,{children:(0,C.jsx)(Ut.Z,{html:t.body})})}),(0,C.jsx)("div",{className:"mt-6",children:(0,C.jsx)(h.z,{onClick:function(){return window.location.href=t.buttonLink},children:t.buttonLabel})}),(0,C.jsxs)("div",{className:"already-member mt-4",children:[(0,C.jsx)(Ne.Z.LabelSm,{children:(0,a.t)("already_a_member")}),(0,C.jsx)("a",{className:"signup-link text-link ml-1 text-sm font-medium",href:(0,M.j)({params:{post_login_redirect:window.location.href}}),children:(0,a.t)("log_in")})]})]})},zt=function(e){var t=e.post,n=e.space,r=(0,s.wh)(),o=r.currentCommunity,l=r.currentUser,c=(0,At.m)(),d=c.isSharedPostWithTeaserLayout,m=c.showGatedCommentSectionAtBottom,f=c.showGatedCommentSectionAtTop,p=c.isSharedPostViewWithMinimalLayout,v=(0,G.I)(),h={heading:o.locked_post_cta_heading||(0,a.t)("login_to_comment"),body:o.locked_post_cta_body,buttonLabel:o.locked_post_cta_button_text||(0,a.t)("log_in"),buttonLink:o.locked_post_cta_button_url||(0,M.j)({params:{post_login_redirect:window.location.href}})},b=!!l,g=!b&&d,y=(0,Mt.v)(o),_=i()("gated-post gated-post--custom-cta py-10 px-7 text-center",{"border-t border-primary":p,post__logged_out_comments:!y,"post__bottom_border border-b border-primary":f&&!p,"post__top_border border-t border-primary":m&&!p,"gated-post--standard-layout":!t.minimal_layout,"gated-post--no-gradient":!g,"gated-post--gradient":g});return(y||(0,u.WB)(n))&&o.custom_cta_for_share_links?(0,C.jsx)(Bt,{containerClassNames:_,lockedPostCtaContent:h}):t.is_comments_enabled&&!b?(0,C.jsx)(Ft,{containerClassNames:_,isIframeEmbed:v,currentCommunity:o}):null},Ht=function(e){var t=e.post||{},n=t.slug,r=t.space_slug;return(0,C.jsx)("div",{className:"border-primary flex items-center justify-center gap-4 border-t p-12",children:(0,C.jsx)("a",{className:"btn btn-secondary",href:(0,M.LM)({spaceSlug:r,slug:n}),children:(0,a.t)("leave_a_comment")})})};function Zt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||qt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qt(e,t){if(e){if("string"===typeof e)return Vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vt(e,t):void 0}}function Vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wt=function(e,t){(0,r.useEffect)((function(){var n=e.current,r=new ResizeObserver((function(e){var n,r=function(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=qt(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;t(o.contentRect.height)}}catch(i){r.e(i)}finally{r.f()}})),o=function(){var e=null===n||void 0===n?void 0:n.querySelector(".post__reply.reply-to-post");e&&r.observe(e)};o();var i=new MutationObserver(o);return n&&i.observe(n,{childList:!0,subtree:!0}),function(){r.disconnect(),i.disconnect()}}),[e,t])},Qt=function(){var e,t,n,o=Zt((0,r.useState)(!1),2),i=o[0],a=o[1],s=Zt((0,r.useState)(0),2),l=s[0],c=s[1],u=(0,r.useRef)(null);return Wt(u,c),e=u,t=a,n=(0,r.useCallback)((function(){var n,r=null===(n=e.current)||void 0===n?void 0:n.querySelector(".post__reply.reply-to-post");if(r){var o=r.querySelector(".ProseMirror");if(o){var i=o.innerHTML,a=document.activeElement===o||!!i;t(a)}}}),[e,t]),(0,r.useEffect)((function(){var t=e.current,r=new MutationObserver((function(){n()}));t&&r.observe(t,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),n();var o=function(){return n()},i=function(){return n()};return null===t||void 0===t||t.addEventListener("focusin",o),null===t||void 0===t||t.addEventListener("focusout",i),function(){r.disconnect(),null===t||void 0===t||t.removeEventListener("focusin",o),null===t||void 0===t||t.removeEventListener("focusout",i)}}),[e,t,n]),{commentsSectionRef:u,dynamicMarginBottom:i?l+32+20:l+32}};function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Jt=function(e){var t=e.autofocusReplyForm,n=e.commentsFormRef,o=e.className,l=void 0===o?"":o,c=(0,At.m)(),u=c.post,d=c.showGatedCommentSectionAtBottom,m=c.showGatedCommentSectionAtTop,f=c.shouldShowLeaveCommentButton,p=c.shouldHideCommentsListForSpace,v=c.refetchPostDetails,h=c.updatePostDetailsQueryCache,b=z().commentId,g=$t((0,r.useState)(b),2),y=g[0],_=g[1],x=$t((0,r.useState)(b&&u.comments_count>10),2),j=x[0],w=x[1],O=(0,s.L2)().data,S=(0,s.wh)().currentCommunityMember,P=(0,s.Zh)().isUsedInMinimalTipTapViewModal,k=u.is_comments_closed,N=function(){v&&v()},I=function(){h&&h({comments_count:u.comments_count+1})},A=function(){w(!1),_(null),window.location.hash="#all_comments"},E=p({space:O});(0,r.useEffect)((function(){_(b)}),[b]);var T=Qt(),M=T.commentsSectionRef,L=T.dynamicMarginBottom,R=!(f||(0,Xe.HZ)(u));return(0,C.jsxs)("div",{ref:M,className:i()("post__comments trix-v2",{"transition-[margin] duration-150 ease-in-out":P&&!k},l),style:{marginBottom:P&&!k?"".concat(L,"px"):void 0},"data-controller":"comments",id:"all_comments","data-post-id":u.id,children:[k&&(0,C.jsx)(Tt,{className:"m-4"}),f&&(0,C.jsx)(Ht,{post:u}),R&&m&&(0,C.jsx)(zt,{post:u,space:O}),!E&&j&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"show-all-comments__wrapper px-2.5 py-4 md:p-6",children:(0,C.jsxs)("a",{className:"show-all-comments__link focus-visible:outline-secondary border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-semibold leading-normal transition-colors duration-150 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:"#all_comments",onClick:function(e){e.preventDefault(),A()},children:[(0,C.jsx)(Et.JO,{type:"arrow-solid-top-left"}),(0,a.t)("post.comments_section.show_all_count_comments",{count:u.comments_count,formatted_count:(0,Oe.HA)(u.comments_count)})]})}),(0,C.jsx)(Nt,{communityMember:S,space:O,post:u,id:y,showReplyForm:!k,autofocusReplyForm:t,onCommentDelete:function(){N(),A()},onReplyCreate:I,onReplyDelete:N})]}),!E&&!j&&(0,C.jsx)(It,{communityMember:S,space:O,post:u,showReplyForm:!k,autofocusReplyForm:t,formRef:n,onCommentCreate:I,onCommentDelete:N}),R&&d&&(0,C.jsx)(zt,{post:u,space:O})]})}},78113:(e,t,n)=>{n.d(t,{S:()=>$});var r=n(94184),o=n.n(r),i=n(99658),a=n(43535),s=n(86013),l=n(24185),c=n(98338),u=n(36589),d=n(18605),m=n(40641),f=n(71179),p=n(62618),v=n(4404),h=n(85893),b=function(e){var t=e.count,n=e.toggleComment,r=e.hasPostDetailsLoaded,a=e.shouldForceSamePageInteractions,c=void 0!==a&&a,d=(0,i.m)().post,b=(0,u.I)(),g=b.isV3Enabled,y=b.shouldShowPostModal,_=(0,l.TH)(),x=(0,m.d)().navigateToPost,j=(0,f._t)(),w=j.params,O=j.hasNextPage;return r?(0,h.jsx)("button",{type:"button",className:o()("hover:!text-dark focus-visible:outline-secondary text-default text-sm font-medium transition-colors duration-150 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"px-2 py-1.5":!g,"p-0":g}),"data-testid":"post-comment-count",onClick:function(){y&&!c?x({newPost:d,prevLocation:_,params:w,hasNextPage:O,shouldFocusOnCommentsSection:!0}):n()},children:(0,s.t)("post.comments",{count:t,formatted_count:(0,p.HA)(t)})}):(0,h.jsx)(v.gi,{variant:"row",lg:!0,long:!0})},g=n(67142),y=n(51705),_=function(e){var t=e.likesCount;return e.isLoading?(0,h.jsx)(v.gi,{variant:"row",lg:!0,extraLong:!0}):0===t?null:(0,h.jsx)("span",{className:"overflow-anywhere text-default group-hover:text-dark text-sm font-medium",children:(0,s.t)("likes_count",{localeCount:(0,p.HA)(t),count:t})})},x=n(67294),j=n(96486),w=n(58533),O=n(11049),S=n(43227),P=n(50732),C=n(78599),k=n(82177),N=n(388),I=n(11355),A=n(64422),E=n(8246),T=function(e){var t=e.member,n=e.hideModal,r=t.name,o=t.avatar_url,i=t.public_uid,a=t.headline,s=(0,I.O)({public_uid:i}),l=s.onClick,c=s["aria-label"],u=s.href,d=s.rel,m=s.target;return(0,h.jsxs)("a",{className:"flex items-center gap-3",onClick:function(e){n(),l&&l(e)},"aria-label":c,href:u,rel:d,target:m,children:[(0,h.jsx)("div",{className:"mt-0",children:(0,h.jsx)(N.C,{communityMemberId:t.id,name:r,publicUid:i,headline:a,avatarURL:o,children:(0,h.jsx)(A.s,{name:r,src:o,size:"10"})})}),(0,h.jsx)(E.Z.LabelSm,{weight:"medium",children:r})]})},M=function(e){var t,n=e.post,r=(0,O.dd)(),o=(0,C.m)(P.av.posts.userLikesList({postId:String(n.id),params:{per_page:15}}),{enabled:!(null===n||void 0===n||!n.id)},["post-likes-modal",null===n||void 0===n?void 0:n.id]),i=o.data,a=o.isLoading,l=o.fetchNextPage,c=o.hasNextPage,u=o.mapPages,d=(0,x.useMemo)((function(){return(0,j.flatten)(u((function(e){return e.records})))}),[u]),m=null===i||void 0===i||null===(t=i.pages[0])||void 0===t?void 0:t.count;return(0,h.jsxs)(k.u_,{title:(0,s.t)("like_modal_title"),isOpen:r.visible,onClose:r.hide,children:[(0,h.jsx)(k.u_.Overlay,{}),(0,h.jsxs)(k.u_.Content,{children:[(0,h.jsxs)(k.u_.Header,{children:[(0,h.jsx)(k.u_.Title,{size:"sm",children:m?(0,h.jsxs)(h.Fragment,{children:[(0,p.HA)(m)," ",1===m?(0,s.t)("like"):(0,s.t)("likes")]}):(0,s.t)("likes")}),(0,h.jsx)(k.u_.HeaderActions,{children:(0,h.jsx)(k.u_.CloseButton,{onClick:r.hide})})]}),(0,h.jsx)(k.u_.Body,{className:"pb-6 pt-4",children:a?(0,h.jsx)(S.m,{}):(0,h.jsx)("div",{id:"post-likes-modal-".concat(n.id),className:"max-h-[calc(100dvh-62px-44px-24px)] overflow-auto sm:max-h-80",children:(0,h.jsx)(w.Z,{scrollThreshold:.75,next:l,hasMore:c||!1,loader:(0,h.jsx)(S.m,{}),scrollableTarget:"post-likes-modal-".concat(n.id),dataLength:d.length,className:"flex flex-col space-y-4",children:d.map((function(e){return(0,h.jsx)(T,{member:e,hideModal:r.hide},e.id)}))})})})]})]})},L=O.gk.create((function(e){var t=e.post;return(0,h.jsx)(M,{post:t})})),R=function(){return(0,O.dd)(L)},D=function(e){var t=e.shouldDisplayVerticalDivider,n=void 0===t||t,r=(0,i.m)(),a=r.post,s=r.isPostBodyEmpty,l=(0,c.Zh)().usedIn,d=(0,u.I)().isV3Enabled,m=a.user_likes_count,f=a.is_liking_enabled,p=a.sample_user_likes_community_members,b=void 0===p?[]:p,x=a.post_details_loaded,j=R();if(!d)return null;if(!x)return(0,h.jsx)("div",{className:o()("post__engagement",{"!pt-5":(0,y.Fr)(a)&&s,"mx-2":"minimal-post-modal"!==l}),children:(0,h.jsx)(v.gi,{variant:"members-avatar-row-v3"})});if(!f||!m||!b.length)return null;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("button",{type:"button",onClick:function(){return j.show({post:a})},className:"post__engagement focus-visible:outline-secondary group focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2","data-testid":"post-liked-by",children:(0,h.jsx)("div",{className:"engagement__likes flex items-center",children:(0,h.jsxs)("div",{className:"engagement__members border-tertiary flex items-center space-x-2",children:[(0,h.jsx)(g.pB,{users:b.slice(0,3).map((function(e){return{src:e.avatar_url,name:e.name}})),isFullRounded:d,size:"5"}),(0,h.jsx)(_,{likesCount:m,isLoading:!x})]})})}),n&&(0,h.jsx)("div",{className:"bg-badge h-0.5 w-0.5 rounded-full"})]})},F=function(e){var t,n=e.shouldOpenCommentPage,r=e.showCommentAndFocusCommentForm,a=e.toggleComment,p=e.shouldForceSamePageInteractions,v=void 0!==p&&p,g=(0,c.EU)(),y=(0,u.I)(),_=y.shouldShowPostModal,x=y.isV3Enabled,j=(0,l.TH)(),w=(0,m.d)().navigateToPost,O=(0,f._t)(),S=O.params,P=O.hasNextPage,C=(0,i.m)().post,k=C.is_comments_closed,N=C.is_comments_enabled,I=C.comments_count,A=void 0===I?0:I,E=C.post_details_loaded;return N&&!n?(0,h.jsxs)(h.Fragment,{children:[!k&&g&&(0,h.jsx)("button",{type:"button",onClick:function(){_?w({newPost:C,prevLocation:j,params:S,hasNextPage:P}):r()},"aria-label":(0,s.t)("cap_comment_aria_label",{title:null!==(t=null===C||void 0===C?void 0:C.name)&&void 0!==t?t:(0,s.t)("this_post")}),className:o()("action-comment text-default hover:!text-dark focus-visible:outline-secondary flex items-center text-sm font-medium transition-colors duration-150 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",x?"px-1 py-0.5":"px-2 py-1.5"),children:x?(0,h.jsx)("span",{className:"action__icon",children:(0,h.jsx)(d.JO,{type:"24-comment",size:24})}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{className:"action__icon mr-1.5 inline-flex",children:(0,h.jsx)(d.JO,{useWithFillCurrentColor:!0,type:"message"})}),(0,h.jsx)("span",{className:o()("action__label"),children:(0,s.t)("cap_comment")})]})}),(0,h.jsxs)("div",{className:"engagement__comments ml-auto mr-0 flex items-center gap-2","data-testid":"engagement-comments",children:[(0,h.jsx)(D,{}),(0,h.jsx)(b,{count:A,toggleComment:a,hasPostDetailsLoaded:E,shouldForceSamePageInteractions:v})]})]}):(0,h.jsx)("div",{className:"engagement__comments ml-auto mr-0 flex items-center gap-2",children:(0,h.jsx)(D,{shouldDisplayVerticalDivider:!1})})},U=n(74374),B=function(e){var t=e.shouldOpenCommentPage,n=e.toggleComment,r=e.shouldForceSamePageInteractions,o=void 0!==r&&r,a=(0,i.m)().post,l=a.is_comments_enabled,c=a.comments_count,u=void 0===c?0:c,m=a.post_details_loaded;return l&&t?(0,h.jsxs)(U.s,{post:a,allComments:!0,className:"flex w-full !items-center !justify-between",shouldOpenPostModal:!1,children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("span",{className:"action__icon",children:(0,h.jsx)(d.JO,{type:"message",className:"!text-dark",useWithFillCurrentColor:!0})}),(0,h.jsx)("span",{className:"count !text-dark",children:(0,s.t)("cap_comment")})]}),(0,h.jsx)("div",{className:"flex items-center",children:(0,h.jsx)(b,{count:u,toggleComment:n,hasPostDetailsLoaded:m,shouldForceSamePageInteractions:o})})]}):null},z=["post"];function H(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var V=function(){var e,t=Z((0,x.useState)(!1),2),n=t[0],r=t[1],a=(0,u.I)().isV3Enabled,l=(0,c.EU)(),m=(0,i.m)(),f=m.post,p=H(m,z),v=f.is_liking_enabled,b=f.is_liked_by_current_user,g=f.post_details_loaded;return v&&l?(0,h.jsx)("button",{type:"button","aria-label":(0,s.t)("like_post_aria_label",{name:null!==(e=null===f||void 0===f?void 0:f.name)&&void 0!==e?e:""}),onClick:function(e){var t;r(!0),setTimeout((function(){r(!1)}),200),null===(t=p.onLikeToggle)||void 0===t||t.call(p,e)},className:o()("action-link post__actions--like hover:!text-dark focus-visible:outline-secondary flex items-center text-sm transition-all duration-200 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"liked text-brand font-semibold":b,"text-default font-medium":!b,"cursor-not-allowed":!g},n?"scale-110":"scale-100",a?"px-1 py-0.5":"px-2 py-1.5"),children:a?(0,h.jsx)(d.JO,{type:b?"24-heart-red-fill":"24-heart-outline",size:24}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{className:"action__icon mr-1.5 inline-flex",children:(0,h.jsx)(d.JO,{type:"like"})}),(0,h.jsx)("span",{"aria-checked":b,className:o()("action__label"),children:(0,s.t)(b?"liked":"like")})]})}):null},W=function(e){var t=e.firstCommunityMemberToLike,n=e.secondCommunityMemberToLike,r=e.likesCount;if(e.isLoading)return(0,h.jsx)(v.gi,{variant:"row",lg:!0,extraLong:!0});if(!t)return null;var o=(null===t||void 0===t?void 0:t.first_name)||"",i=(null===n||void 0===n?void 0:n.first_name)||"",a="";return 1===r?a=(0,s.t)("liked_by_one",{name:o}):2===r?a=(0,s.t)("liked_by_two",{first:o,second:i}):r>2&&(a=(0,s.t)("liked_by_three_or_more",{name:o,amount:(0,p.HA)(r-1)})),(0,h.jsx)("span",{className:"overflow-anywhere",children:a})},Q=function(){var e=(0,i.m)(),t=e.post,n=e.isPostBodyEmpty,r=(0,c.Zh)().usedIn,a=(0,u.I)().isV3Enabled,s=t.user_likes_count,l=t.is_liking_enabled,d=t.sample_user_likes_community_members,m=void 0===d?[]:d,f=t.post_details_loaded,p=R();if(a)return null;if(!f)return(0,h.jsx)("div",{className:o()("post__engagement mb-5",{"!pt-5":(0,y.Fr)(t)&&n,"mx-5 md:mx-6":"minimal-post-modal"!==r}),children:(0,h.jsx)(v.gi,{variant:"members-avatar-row"})});if(!l||!s||!m.length)return null;return(0,h.jsx)("button",{type:"button",onClick:function(){return p.show({post:t})},className:o()("post__engagement focus-visible:outline-secondary mb-5 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"pt-5":(0,y.Fr)(t)&&"full-post-modal"!==r&&n,"mx-5 md:mx-6":"minimal-post-modal"!==r}),children:(0,h.jsxs)("div",{className:"engagement__likes flex items-center",children:[(0,h.jsx)("div",{className:"engagement__members border-tertiary mr-3",children:(0,h.jsx)(g.pB,{users:m.slice(0,3).map((function(e){return{src:e.avatar_url,name:e.name}})),isFullRounded:a})}),(0,h.jsx)("div",{className:"engagement__members--descriptor text-dark text-left text-sm","data-testid":"post-engagement",children:(0,h.jsx)(W,{firstCommunityMemberToLike:m[0],secondCommunityMemberToLike:m[1],likesCount:s,isLoading:!f})})]})})},$=function(e){var t=e.toggleComment,n=e.showCommentAndFocusCommentForm,r=e.shouldOpenCommentPage,s=void 0!==r&&r,l=e.shouldForceSamePageInteractions,c=void 0!==l&&l,u=e.className,d=void 0===u?"":u;return(0,i.m)().showEngagementActions?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Q,{}),(0,h.jsxs)("div",{className:o()("post__actions post__actions-visible border-primary flex items-center gap-1 border-t px-3 py-2.5 md:px-4",d),"data-testid":"post-engagement-actions",children:[(0,h.jsx)(a.T,{children:(0,h.jsx)(V,{})}),(0,h.jsx)(F,{shouldOpenCommentPage:s,showCommentAndFocusCommentForm:n,toggleComment:t,shouldForceSamePageInteractions:c}),(0,h.jsx)(B,{shouldOpenCommentPage:s,toggleComment:t})]})]}):null}},87228:(e,t,n)=>{n.d(t,{c:()=>u});var r=n(94184),o=n.n(r),i=n(86013),a=n(54030),s=n(18605),l=n(8246),c=n(85893),u=function(e){var t=e.post,n=e.mobileWrapperClassName,r=void 0===n?"":n,u=(0,a.kK)();return t.pinned_at_top_of_space?u?(0,c.jsxs)("div",{className:o()("mx-5 mt-5 flex items-center gap-2",r),children:[(0,c.jsx)(s.JO,{size:20,type:"20-pinned-post",className:"text-dark"}),(0,c.jsx)(l.Z.LabelXxs,{weight:"font-semibold",children:(0,i.t)("post.pinned_post")})]}):(0,c.jsx)("div",{className:"post__pin post__pin--pinned inline-flex p-1",children:(0,c.jsx)(s.JO,{type:"20-pin-post",className:"text-default !h-5 !w-5",size:20,useWithStrokeCurrentColor:!0})}):null}},76527:(e,t,n)=>{n.d(t,{u:()=>l});var r=n(97782),o=n(65631),i=n(98338),a=n(13288),s=n(85893),l=function(e){var t=e.show,n=e.closeModal,l=e.post,c=e.shouldSkipRedirectAfterSubmit,u=void 0!==c&&c,d=e.onChange,m=e.onSubmitSuccess;if(!t)return null;var f=(0,r.t)({spaceId:l.space_id,postSlug:l.slug,context:"edit-post-modal"}),p=f.isLoading,v=f.post,h=f.remove;if(p)return(0,s.jsx)(a.a,{variant:"fullscreen"});return(0,s.jsx)(i.DW,{post:v,onPostChange:d,children:(0,s.jsx)(o.Y,{show:t,closeModal:function(){n&&n(),h()},shouldSkipRedirectAfterSubmit:u,onSubmitSuccess:m})})}},15992:(e,t,n)=>{n.d(t,{m:()=>C});var r=n(86013),o=n(88767),i=n(34334),a=n(67907),s=n(13972),l=n(18274),c=n(58350),u=n(34398),d=n(97659),m=n(38313),f=n(99658),p=n(98338),v=n(54030),h=n(1881),b=n(58974),g=n(18605),y=n(44032),_=n(54482),x=n(82177),j=n(27025),w=n(69647),O=n(85893);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){var t=e.onChange,n=e.onPostDestroy,P=(0,f.m)(),C=P.post,k=P.canUpdatePost,N=P.canDuplicatePost,I=P.canDestroyPost,A=P.canManagePost,E=P.refetchPostDetails,T=(0,m.Z)(),M=(0,w.p)(),L=M.success,R=M.error,D=(0,p.L2)().refetch,F=(0,v.kK)(),U=S((0,h.k)(),2),B=U[0],z=U[1],H=S((0,h.k)(!1),2),Z=H[0],q=H[1],V=S((0,h.k)(),2),W=V[0],Q=V[1],$=(0,p.wh)().isViewOnlyMasquerading,G=(0,x.UV)().contentPortalElement,J=(0,o.useMutation)((function(e){return i.S1.destroy({event:C,params:{delete_mode:e}})}),{onSuccess:function(){n(C.id),L((0,u.Km)(C),{duration:"short",shouldUseProgress:!1}),null===D||void 0===D||D()},onError:function(){return R((0,r.t)("event_dropdown_actions.delete_failed"))}});return k||N||I?$?(0,O.jsx)(g.JO,{type:"menu-dots","aria-label":(0,r.t)("events.event_actions"),className:"cursor-not-allowed"}):(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)(j.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,O.jsx)(_.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,"aria-label":(0,r.t)("events.event_actions"),dataTestId:"action-more"}),className:"z-10",transitionWrapperClassName:"z-50",size:"large",appendTo:null!==G&&void 0!==G?G:document.body,children:[(0,O.jsx)(b.e,{variant:"dropdown",bookmarkType:"event",record:C,onSuccess:E}),F&&(0,O.jsx)(c.i,{onChange:t,className:"w-full",buttonClassName:"w-full",button:(0,O.jsx)(j.Lt.ItemLink,{children:(0,r.t)("events.event_actions_dropdown.share_event")})}),k&&(0,O.jsx)(j.Lt.ItemLink,{onClick:function(){return T.show({event:C})},forceClose:!0,children:(0,r.t)("edit_event")}),N&&(0,O.jsx)(j.Lt.ItemLink,{onClick:q,children:(0,r.t)("duplicate_event")}),I&&(0,O.jsx)(j.Lt.ItemLink,{onClick:function(){(0,d.H3)(C)?Q(!0):z(!0)},forceClose:!0,children:(0,O.jsx)("span",{className:"text-v2-danger",children:(0,r.t)("delete_event")})}),A&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(j.Lt.Separator,{}),(0,O.jsx)(l.E,{event:C,canEdit:k})]})]}),(0,O.jsx)(y.c,{isOpen:B,title:(0,r.t)("delete_event_confirmation"),onClose:z,onCancel:z,onConfirm:J.mutate,confirmVariant:"danger",disabled:J.isLoading,confirmText:J.isLoading?(0,r.t)("deleting"):(0,r.t)("confirm"),children:(0,r.t)("delete_event_descriptor")}),(0,O.jsx)(s.D,{event:C,show:Z,onClose:q}),!(0,u.yl)(C)&&(0,O.jsx)(a.t,{show:W,onConfirm:J.mutate,onCloseModal:function(){return Q(!1)}})]}):null}},82507:(e,t,n)=>{n.d(t,{p:()=>pe});var r=n(99658),o=n(98338),i=n(15992),a=n(86013),s=n(96486),l=n(88767),c=n(1744),u=n(51705),d=n(34334),m=n(83410),f=n(66866),p=n(68997),v=n(39068),h=n(50732),b=n(58974),g=n(44032),y=n(54482),_=n(69647),x=n(27025),j=n(82177),w=n(87229),O=n(81089),S=n(52995),P=n(85893),C=function(e){var t=e.post,n=e.handleClose,o=void 0===n?s.noop:n,i=(0,_.p)(),c=i.success,u=i.error,d=!!t.post_follower_id,m=(0,r.m)().onPostFollow,f=(0,l.useMutation)(d?function(){return(0,O.pC)(h.av.postFollowers.destroy({postId:t.id,postFollowerId:t.post_follower_id}))}:function(){return(0,O.Cu)(h.av.postFollowers.create({postId:t.id}))},{onSuccess:function(e){var t;m({post_follower_id:d?null:null===e||void 0===e||null===(t=e.post_follower)||void 0===t?void 0:t.id}),o(),c(I18n.t(d?"post_unfollow.success":"post_follow.success"))},onError:function(){return u(I18n.t(d?"post_unfollow.error":"post_follow.error"))}});return(0,P.jsx)(x.Lt.ItemLink,{onClick:function(){f.mutate()},children:(0,P.jsx)(S.sI,{label:(0,a.t)("follow_post"),field:"follow_post",value:d,variant:"small"})})},k=n(64687),N=n.n(k);function I(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var A=function(e){var t,n,r=e.post,o=e.onChange,i=e.refetchPosts,c=e.handleClose,u=void 0===c?s.noop:c,m=(0,_.p)(),f=m.success,p=m.error,v=r.pinned_at_top_of_space,h=(0,l.useMutation)((function(){return d.Fv.pin({post:r,formData:{is_pinned:!v,pin_to_top:!0}})}),{onSuccess:(t=N().mark((function e(t){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o(t,{refetch:!1}),!(0,s.isFunction)(i)){e.next=4;break}return e.next=4,i();case 4:f(I18n.t(v?"post_unpinned":"post_pinned"));case 5:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){I(i,r,o,a,s,"next",e)}function s(e){I(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){p(I18n.t(v?"post_unpinned_error":"post_pinned_error"))},onSettled:u});return(0,P.jsx)(x.Lt.ItemLink,{onClick:h.mutate,children:(0,P.jsx)(S.sI,{label:(0,a.t)("pin_to_top"),field:"pin_to_top",value:v,variant:"small"})})},E=n(98661);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){var t=e.post,n=void 0===t?{}:t,r=e.handleClose,o=e.onChange,i=!!n.pinned_at,s=(0,l.useQueryClient)(),c=(0,_.p)(),u=c.success,m=c.error,f=(0,E.P)().refetch,p=(0,l.useMutation)((function(){return d.Fv.pin({post:n,formData:M(M({},n),{},{is_pinned:!i,pin_to_top:!1})})}),{onSuccess:function(e){o(e,{refetch:!1}),f(),s.invalidateQueries("posts"),u(I18n.t(i?"post_unpinned_from_sidebar":"post_pinned_to_sidebar"))},onError:function(){m(I18n.t(i?"post_unpinned_error":"post_pinned_error"))},onSettled:r});return(0,P.jsx)(x.Lt.ItemLink,{onClick:p.mutate,children:(0,P.jsx)(S.sI,{label:(0,a.t)("pin_post"),field:"pin_post",value:i,variant:"small"})})},D=function(e){var t=e.post,n=e.handleClose,r=e.onChange,o=t.is_comments_disabled,i=o?"post.enable_comments":"post.disable_comments",s=(0,_.p)(),c=s.success,u=s.error,d=(0,l.useMutation)((function(){return(0,O.gN)(h.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_comments_disabled:!o}})}),{onSuccess:function(e){r(e,{refetch:!1}),c((0,a.t)("".concat(i,".alerts.success")))},onError:function(){u((0,a.t)("".concat(i,".alerts.failure")))},onSettled:n}).mutate;return(0,P.jsx)(x.Lt.ItemLink,{onClick:d,children:(0,P.jsx)(S.sI,{label:(0,a.t)("post.action_menu.disable_comments"),field:"disable_comments",value:o,variant:"small"})})},F=function(e){var t=e.post,n=e.handleClose,r=e.onChange,o=t.is_comments_closed,i=o?"post.open_comments":"post.close_comments",s=(0,_.p)(),c=s.success,u=s.error,d=(0,l.useMutation)((function(){return(0,O.gN)(h.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_comments_closed:!o}})}),{onSuccess:function(e){r(e,{refetch:!1}),c((0,a.t)("".concat(i,".alerts.success")))},onError:function(){u((0,a.t)("".concat(i,".alerts.failure")))},onSettled:n}).mutate;return(0,P.jsx)(x.Lt.ItemLink,{onClick:d,children:(0,P.jsx)(S.sI,{label:(0,a.t)("post.action_menu.close_comments"),field:"close_comments",value:o,variant:"small"})})};function U(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var B=function(e){var t,n,r=e.post,o=e.handleClose,i=void 0===o?s.noop:o,c=e.onChange,u=e.refetchPosts,m=r.hide_from_featured_areas,f=(0,_.p)(),p=f.success,v=f.error,h=(0,l.useMutation)((function(){return m?d.Fv.showInFeaturedAreas({post:r}):d.Fv.hideFromFeaturedAreas({post:r})}),{onSuccess:(t=N().mark((function e(t){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c(t,{refetch:!1}),!(0,s.isFunction)(u)){e.next=4;break}return e.next=4,u();case 4:p(I18n.t(m?"post.marked_unhidden":"post.marked_hidden"));case 5:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){U(i,r,o,a,s,"next",e)}function s(e){U(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){v(I18n.t("something_went_wrong"))}});return(0,P.jsx)(x.Lt.ItemLink,{onClick:function(){i(),h.mutate()},children:(0,P.jsx)(S.sI,{label:(0,a.t)("post.hide_from_featured_areas"),field:"hide_from_featured_areas",value:m,variant:"small"})})},z=function(e){var t=e.post,n=e.onChange,r=t.is_liking_disabled,o=r?"post.enable_liking":"post.disable_liking",i=(0,_.p)(),s=i.success,c=i.error,u=(0,l.useMutation)((function(){return(0,O.gN)(h.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_liking_disabled:!r}})}),{onSuccess:function(e){n(e,{refetch:!1}),s((0,a.t)("".concat(o,".alerts.success")))},onError:function(){c((0,a.t)("".concat(o,".alerts.failure")))}}).mutate;return(0,P.jsx)(x.Lt.ItemLink,{onClick:function(){return u()},children:(0,P.jsx)(S.sI,{label:(0,a.t)("post.action_menu.disable_liking"),field:"disable_liking",value:r,variant:"small"})})},H=n(24185),Z=n(62057),q=n(81786),V=n(67687),W=n(8246),Q=function(e){var t=e.spaceId,n=e.postId,r=e.postSlug,i=e.postTitle,s=e.hasNoteAboutExceptions,c=void 0===s||s,d=e.isOpen,m=void 0!==d&&d,f=e.onClose,p=e.onDuplicateSuccess,v=(0,H.k6)(),b=(0,_.p)(),g=b.success,y=b.error,x=(0,o.nT)(),w=x.isLoading,S=(0,x.helpers.basicSpacesWithPostCreationAllowed)(),C=(0,l.useMutation)((function(e){return(0,O.aU)(h.av.posts.duplicate({spaceId:t,postSlug:r}),{post:{post_id:n,space_id:e.space_id,send_notifications:e.send_notifications}})}),{onSuccess:function(e){g((0,a.t)("duplicated_successfully")),f(),v.push((0,u.RG)({post:e,editMode:!0})),p&&p(e)},onError:function(){y((0,a.t)("duplication_failed"))}}),k=C.mutate,N=C.isLoading;return w?null:(0,P.jsxs)(j.u_,{isOpen:m,onClose:f,children:[(0,P.jsx)(j.u_.Overlay,{}),(0,P.jsxs)(j.u_.Content,{children:[(0,P.jsxs)(j.u_.Header,{children:[(0,P.jsx)(j.u_.Title,{children:(0,a.t)("duplicate_post_title",{post_title:i||(0,a.t)("duplicate_post_title_untitled")})}),(0,P.jsx)(j.u_.CloseButton,{onClick:f})]}),(0,P.jsx)(j.u_.Body,{children:(0,P.jsxs)(V.l,{onSubmit:k,defaultValues:{space_id:t,send_notifications:!1},id:"duplicate-post-form",children:[(0,P.jsx)(V.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,label:(0,a.t)("space"),description:(0,a.t)("duplicate_post_to_space"),rules:{required:(0,a.t)("events.create.form.space_required_error")},children:(0,P.jsx)(Z.M,{spaces:S,name:"space_id",variant:"form-input",defaultValue:t,containerClassname:"mt-2"})}),c&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(W.Z.LabelXs,{color:"text-light",children:(0,a.t)("comments_wont_be_duplicated")}),(0,P.jsx)(V.l.Item,{name:"send_notifications",hideBorder:!0,fullWidth:!0,label:(0,a.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,children:(0,P.jsx)(V.l.ToggleSwitch,{variant:"small",name:"send_notifications"})})]})]})}),(0,P.jsx)(j.u_.Footer,{children:(0,P.jsx)(q.z,{type:"submit",variant:"primary",disabled:N,form:"duplicate-post-form",children:N?(0,a.t)("duplicating"):(0,a.t)("duplicate")})})]})]})},$=n(76527),G=["harassment","spam","incorrect_location","against_guidelines","other"],J=function(e){var t=e.onClose,n=e.show,r=e.post,o=(0,_.p)(),i=(0,l.useMutation)((function(e){return(0,O.t5)(h.av.flaggedContent.create(),{method:"POST",forReactQuery:!0,body:JSON.stringify({flagged_content:e})})}),{onSuccess:function(){o.success((0,a.t)("report_post_success")),t()},onError:function(){o.error((0,a.t)("something_went_wrong"))}}),s=G.map((function(e){return{value:e,label:(0,a.t)("flagged_contents.report_reasons.".concat(e))}}));return(0,P.jsxs)(j.u_,{isOpen:n,onClose:t,title:(0,a.t)("flagged_contents.form.report_post"),children:[(0,P.jsx)(j.u_.Overlay,{}),(0,P.jsx)(j.u_.Content,{children:(0,P.jsxs)(V.l,{defaultValues:{flagged_contentable_id:r.id,flagged_contentable_type:"Post"},onSubmit:function(e){return i.mutate(e)},children:[(0,P.jsxs)(j.u_.Header,{children:[(0,P.jsx)(j.u_.Title,{size:"sm",children:(0,a.t)("comments.report.form.title")}),(0,P.jsx)(j.u_.HeaderActions,{children:(0,P.jsx)(j.u_.CloseButton,{onClick:t})})]}),(0,P.jsxs)(j.u_.Body,{children:[(0,P.jsx)(V.l.Item,{name:"reported_reason_type",label:(0,a.t)("flagged_contents.form.reported_reason_type"),description:(0,a.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,P.jsx)(V.l.SelectNative,{name:"reported_reason_type",options:s})}),(0,P.jsx)(V.l.Item,{name:"reported_reason_body",label:(0,a.t)("flagged_contents.form.reported_reason_body"),description:(0,a.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,P.jsx)(V.l.TextArea,{name:"reported_reason_body"})})]}),(0,P.jsxs)(j.u_.Footer,{className:"flex justify-end",children:[(0,P.jsx)(q.z,{type:"button",variant:"secondary",onClick:t,className:"mr-2",disabled:i.isLoading,children:(0,a.t)("cancel")}),(0,P.jsx)(q.z,{type:"submit",variant:"circle",disabled:i.isLoading,"data-testid":"report_post_submit",children:(0,a.t)("report")})]})]})})]})},K=n(87536),Y=n(28536),X=n(48088);function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ae=function(e){var t=e.post,n=e.isOpen,r=e.onClose,i=e.onChange,c=(0,o.Zh)().setIsUpdatingCardViewThumbnail,u=function(e){var t=e.post,n=e.onSuccess,r=e.onError,o=(0,_.p)(),i=o.success,c=o.error;return(0,l.useMutation)({mutationFn:function(e){return(0,O.gN)(h.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:te({space_id:t.space_id},e)})},onSuccess:function(e){(0,s.isFunction)(n)&&n(e),i((0,a.t)("changes_saved"))},onError:function(){(0,s.isFunction)(r)&&r(),c((0,a.t)("failed_to_save_changes"))}})}({post:t,onSuccess:function(e){i(e,{refetch:!1}),null===c||void 0===c||c(!1)},onError:function(){null===c||void 0===c||c(!1)}}),d=(0,K.cI)({defaultValues:{cardview_thumbnail:t.cardview_thumbnail}});return(0,P.jsx)(Y.l,oe(oe({},d),{},{onSubmit:function(e){u.mutate(e)},className:"hidden",children:function(e){var t=e.triggerFormSubmit;return(0,P.jsx)(X.a,{isOpen:n,name:"cardview_thumbnail",onClose:function(){r()},aspectRatio:2,title:(0,a.t)("upload_a_cardview_thumbnail"),renderer:function(){return(0,P.jsx)(P.Fragment,{})},onImageAttachSuccess:t,onProcessing:function(e){return e&&(null===c||void 0===c?void 0:c(e))}})}}))},se=n(90789),le=n(54030),ce=n(1881);function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=function(e){var t=e.refetchPosts,n=e.currentCommunity,i=e.onPostDestroy,O=e.onChange,S=(0,r.m)(),k=S.post,N=S.showModerationInActionsDropdown,I=S.canManagePost,E=S.canUpdatePost,T=S.canDestroyPost,M=S.canDuplicatePost,L=S.canReportPost,U=S.refetchPostDetails,Z=(0,o.Zh)(),q=Z.usedIn,V=Z.isUsedInMinimalTipTapViewModal,W=(0,o.wh)(),G=W.currentCommunitySettings,K=W.isViewOnlyMasquerading,Y=W.currentCommunityMember,X=null===G||void 0===G?void 0:G.quick_post_v2_enabled,ee=(0,f.L)().show,te=(0,c.e)(),ne=(0,m.h)(),re=(0,u.Fr)(k),oe=(0,u.hm)(k),ie=(0,j.UV)(),de=ie.contentPortalElement,me=ie.onClose,fe=(0,o.L2)().data,pe=(null===G||void 0===G?void 0:G.kb_post_action_enabled)&&(0,v.vb)(Y),ve=(0,_.p)(),he=ve.success,be=ve.error,ge=(0,l.useMutation)((function(){return d.Fv.updateKnowledgeBasePost({post:k})}),{onSuccess:function(){he((0,a.t)("post_dropdown_actions.update_knowledge_base_post_successful"))},onError:function(){return be((0,a.t)("post_dropdown_actions.update_knowledge_base_post_failed"))}}),ye=function(e){var t=e.onPostDestroy,n=(0,o.L2)(),i=n.data,s=n.refetch,c=(0,r.m)(),m=c.post,f=c.showShareOnWebOptions,p=(0,o.Zh)().usedIn,v=(0,H.k6)(),h=ue((0,ce.k)(!1),2),b=h[0],g=h[1],y=ue((0,ce.k)(!1),2),x=y[0],j=y[1],w=ue((0,ce.k)(!1),2),O=w[0],S=w[1],P=ue((0,ce.k)(!1),2),C=P[0],k=P[1],N=ue((0,ce.k)(!1),2),I=N[0],A=N[1],E=(0,u.hm)(m),T=(0,le.kK)(),M=(0,_.p)(),L=M.success,R=M.error,D=E&&Boolean(!(null!==i&&void 0!==i&&i.hide_right_sidebar))&&!(0,se.AU)(i),F=(0,se.AU)(i)||(0,se.G6)(i),U=Boolean((0,H.$B)("/c/:spaceSlug/:postSlug")),B=m.pinned_at_top_of_space,z=!U&&!B&&F,Z=T||"full-post-modal"===p;return{shouldShowPinToSidebar:D,isPostCardOrListView:F,isPostDetailsPage:U,isCurrentPostPinnedAtTopOfSpace:B,isEligibleForSharing:z,isRenderedOnSmallScreensOrFullPostModal:Z,shouldShowShareOnWebOptions:(Z||z)&&f(i),shouldShowSetThumbnailOptionForPosts:(0,se.AU)(i)&&!B&&(0,se.Y_)(i),shouldShowEditPostModal:b,toggleEditPostModal:g,shouldShowDuplicatePostModal:x,toggleDuplicatePostModal:j,shouldShowReportPostModal:O,toggleReportPostModal:S,shouldShowConfirmationModal:C,toggleConfirmationModal:k,deleteMutation:(0,l.useMutation)((function(){return d.Fv.destroy({post:m})}),{onSuccess:function(){t(m.id),L((0,a.t)("post_dropdown_actions.delete_successful")),s()},onError:function(){return R((0,a.t)("post_dropdown_actions.delete_failed"))}}),redirectToPost:function(e){return v.push((0,u.RG)({post:e}))},shouldShowSetThumbnailModal:I,toggleSetThumbnailModal:A}}({onPostDestroy:i}),_e=ye.shouldShowPinToSidebar,xe=ye.shouldShowShareOnWebOptions,je=ye.shouldShowSetThumbnailOptionForPosts,we=ye.shouldShowEditPostModal,Oe=ye.toggleEditPostModal,Se=ye.shouldShowDuplicatePostModal,Pe=ye.toggleDuplicatePostModal,Ce=ye.shouldShowReportPostModal,ke=ye.toggleReportPostModal,Ne=ye.shouldShowConfirmationModal,Ie=ye.toggleConfirmationModal,Ae=ye.deleteMutation,Ee=ye.redirectToPost,Te=ye.shouldShowSetThumbnailModal,Me=ye.toggleSetThumbnailModal;return K?(0,P.jsx)(y.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark cursor-not-allowed","aria-label":(0,a.t)("post_actions"),dataTestId:"action-more",disabled:!0}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(x.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,P.jsx)(y.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,"aria-label":(0,a.t)("post_actions"),dataTestId:"action-more"}),className:"z-10",transitionWrapperClassName:"z-50",size:"large",buttonLabel:(0,a.t)("post_actions"),appendTo:null!==de&&void 0!==de?de:document.body,children:[(0,P.jsx)(b.e,{variant:"dropdown",bookmarkType:"post",record:k,onSuccess:U}),xe&&(0,P.jsx)(w.P,{onChange:O,className:"w-full",buttonClassName:"w-full",button:(0,P.jsx)(x.Lt.ItemLink,{children:(0,a.t)("post.share.share_post_actions_label")}),shouldRenderCustomMenuButton:!0}),E&&oe&&(0,P.jsx)(x.Lt.ItemLink,{onClick:function(){K?(0,s.noop)():X?ee({post:k,onPostChange:O,shouldSkipRedirectAfterSubmit:V}):Oe()},children:(0,a.t)("edit_post")}),E&&re&&(0,P.jsx)(x.Lt.ItemLink,{onClick:function(){te.show({spaceId:fe.id,onClose:function(){return te.remove()},onPostChange:O,currentPost:k,shouldSkipRedirectAfterSubmit:"full-post-modal"===q})},children:(0,a.t)("edit_post")}),oe&&M&&(0,P.jsx)(x.Lt.ItemLink,{onClick:Pe,children:(0,a.t)("duplicate_post")}),re&&M&&(0,P.jsx)(x.Lt.ItemLink,{onClick:function(){"full-post-modal"===q&&me(),ne.show({post:k,onSuccess:Ee})},children:(0,a.t)("duplicate_post")}),je&&(0,P.jsx)(x.Lt.ItemLink,{onClick:function(){Me()},children:(0,a.t)("set_thumbnail")}),L&&(0,P.jsx)(x.Lt.ItemLink,{onClick:K?s.noop:ke,children:(0,a.t)("report_post")}),N&&(0,P.jsx)(x.Lt.ItemWithLink,{to:h.sC.index(),children:(0,a.t)("flagged_contents.review")}),T&&(0,P.jsx)(x.Lt.ItemLink,{onClick:K?s.noop:Ie,children:(0,P.jsx)("span",{className:"text-v2-danger",children:(0,a.t)("delete_post")})}),pe&&(0,P.jsx)(x.Lt.ItemLink,{onClick:function(){ge.mutate()},children:(0,a.t)("post_dropdown_actions.update_knowledge_base_post_dropdown_label")}),(E||M||L||N||T)&&(0,P.jsx)(x.Lt.Separator,{}),(0,P.jsx)(C,{post:k,onChange:O}),I&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(A,{post:k,onChange:O,refetchPosts:t}),_e&&(0,P.jsx)(R,{post:k,onChange:O,refetchPosts:t}),(0,P.jsx)(z,{post:k,onChange:O}),(0,P.jsx)(D,{post:k,onChange:O}),k.is_comments_enabled&&(0,P.jsx)(F,{post:k,onChange:O}),(0,p.Nf)(n)&&(0,P.jsx)(B,{post:k,community:n,onChange:O,refetchPosts:t})]})]}),(0,P.jsx)(ae,{post:k,onChange:O,onClose:Me,isOpen:Te}),(0,P.jsx)($.u,{show:we,closeModal:Oe,post:k,onChange:O}),(0,P.jsx)(Q,{spaceId:k.space_id,postId:k.id,postSlug:k.slug,postTitle:k.name,isOpen:Se,onClose:Pe}),(0,P.jsx)(J,{post:k,show:Ce,onClose:ke}),(0,P.jsx)(g.c,{isOpen:Ne,title:(0,a.t)("delete_post_confirmation"),onClose:Ie,onCancel:Ie,onConfirm:Ae.mutate,confirmVariant:"danger",disabled:Ae.isLoading,confirmText:Ae.isLoading?(0,a.t)("deleting"):(0,a.t)("confirm"),children:(0,a.t)("delete_post_descriptor")})]})},fe=function(e){var t=e.onChange,n=e.onPostDestroy,o=e.refetchPosts,a=e.currentCommunity,s=(0,r.m)(),l=s.isBasicPost,c=s.isEventPost,u=s.isImagePost;return(0,P.jsxs)(P.Fragment,{children:[(l||u)&&(0,P.jsx)(me,{onChange:t,onPostDestroy:n,refetchPosts:o,currentCommunity:a}),c&&(0,P.jsx)(i.m,{onChange:t,onPostDestroy:n})]})},pe=function(e){var t=e.onChange,n=e.onPostDestroy,i=e.refetchPosts,a=(0,r.m)(),s=a.showPostActions,l=a.canUpdatePost,c=a.canDestroyPost,u=a.isEventPost,d=(0,o.wh)().currentCommunity;return s&&(!u||l||c)?(0,P.jsx)(fe,{onChange:t,onPostDestroy:n,refetchPosts:i,currentCommunity:d}):null}},94216:(e,t,n)=>{n.d(t,{y:()=>w});var r=n(67294),o=n(94184),i=n.n(o),a=n(66007),s=n(86013),l=n(96486),c=n(24185),u=n(51705),d=n(50732),m=n(99658),f=n(98338),p=n(36589),v=n(38503),h=n(34141),b=n(61844),g=n(7074),y=n(5958),_=n(40641),x=n(71179),j=n(85893),w=function(e){var t=e.enableTruncation,n=void 0!==t&&t,o=e.noPadding,w=void 0!==o&&o,O=(0,m.m)(),S=O.post,P=O.isSharedPostWithTeaserLayout,C=O.isSharedPostViewWithMinimalLayout,k=O.isTiptapPost,N=O.isTrixPost,I=O.isBasicPost,A=O.isPostBodyEmpty,E=(0,c.TH)(),T=(0,_.d)().navigateToPost,M=(0,x._t)(),L=M.params,R=M.hasNextPage,D=(0,v.wC)().minimal_layout,F=(0,f.Zh)(),U=F.usedIn,B=F.isUsedInMinimalTipTapViewModal,z=["help","help-en"].includes(S.community_slug)&&I,H=!n,Z=C&&P,q=P,V=(0,p.I)().isV3Enabled&&!B&&(0,u.HZ)(S)&&!H,W=S.body_trix_content,Q=S.tiptap_body,$=S.internal_custom_html,G=S.pinned_at_top_of_space,J=S.updated_at;if((0,r.useEffect)((function(){var e;$&&(0,l.isFunction)(null===(e=window)||void 0===e?void 0:e.loadOembed)&&window.loadOembed()}),[$]),A)return null;var K=8;return G?K=2:Z&&(K=4),(0,j.jsx)("div",{className:i()("post__body",{"!p-0":w,"px-5 pb-5 md:px-6":(0,u.Fr)(S)&&!B,"mt-5":"minimal-post-modal"===U}),"data-testid":"post-body",children:(0,j.jsxs)("div",{className:"post__inside trix-v2 w-full","data-testid":"post-body-inside",children:[(0,j.jsxs)(b.X,{lines:K,disabled:H,hideToggle:q||V,children:[N&&W&&(0,j.jsx)(h.P,{content:W,contentParentPath:d.xu.show({slug:S.slug,spaceSlug:S.space_slug})}),k&&Q&&(0,j.jsx)(g.R,{readOnly:!0,disableMentionClicks:D,value:Q.body,sgidToObjectMap:Q.sgids_to_object_map,inlineAttachments:Q.inline_attachments}),$&&(0,j.jsx)(a.Z,{html:$},"internal_custom_html"),z&&(0,j.jsx)(y.e,{post:S})]}),V&&(0,j.jsx)("button",{type:"button",className:"text-default hover:text-dark mt-2 text-base",onClick:function(){T({newPost:S,params:L,hasNextPage:R,prevLocation:E})},children:(0,s.t)("see_more")})]})},J)}},31247:(e,t,n)=>{n.d(t,{H:()=>h});var r=n(94184),o=n.n(r),i=n(86013),a=n(17479),s=n(51705),l=n(36589),c=n(74374),u=n(85893),d=["post","className","wrapperClassName"];function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var h=function(e){var t,n,r,m,p=e.post,h=e.className,b=void 0===h?"":h,g=e.wrapperClassName,y=void 0===g?"":g,_=v(e,d),x=(0,l.I)().isV3Enabled,j=(0,s.HZ)(p);return(null!==(t=null===(n=p.cover_image_variants)||void 0===n?void 0:n.large)&&void 0!==t?t:p.cover_image_url)?(0,u.jsx)("div",{className:o()("px-5 pt-5 md:p-0",y),children:(0,u.jsx)(c.s,f(f({shouldOpenPostModal:!0,post:p,className:"post__cover focus-visible:outline-secondary focus-visible:text-dark block focus-visible:rounded-lg focus-visible:outline focus-visible:outline-2 focus-visible:md:rounded-b-none"},_),{},{children:p.cover_image_variants&&(0,u.jsx)(a.Q,{src:null!==(m=p.cover_image_url)&&void 0!==m?m:"",srcVariants:p.cover_image_variants,alt:(0,i.t)("post.cover_image_alt"),className:o()("w-full object-cover",b,{"md:rounded-b-none":!j,"rounded-lg":!x||j,"rounded-2xl":x&&!j})},null!==(r=p.cover_image_url)&&void 0!==r?r:"")}))}):null}},9144:(e,t,n)=>{n.d(t,{m:()=>j});var r=n(94184),o=n.n(r),i=n(86013),a=n(24185),s=n(90789),l=n(82609),c=n(98338),u=n(51705),d=n(54030),m=n(94353),f=n(99658),p=n(58974),v=n(87228),h=n(82507),b=n(87229),g=n(85893),y=function(e){var t=e.post,n=e.onChange,r=e.onPostDestroy,i=e.refetchPosts,a=e.hideShareLink,s=e.hidePinnedToTopIcon,l=e.hideBookmarkButton,m=(0,f.m)(),y=m.refetchPostDetails,_=m.isSharedPostView,x=(0,d.kK)(),j=(0,u.Fr)(t),w=(0,u.hm)(t),O=j||w,S=!l&&!_&&!x,P=!a&&!x,C=!s&&!_&&!x,k=!(0,c.Zh)().isUsedInMinimalTipTapViewModal;return S||k||P||C?(0,g.jsxs)("div",{className:"post__actions-container text-dark flex items-center gap-0.5","data-testid":"post-header-actions",children:[S&&(0,g.jsx)(p.e,{bookmarkType:O?"post":"event",record:t,onSuccess:y,className:o()("!text-default",{"group-hover:!text-dark":!t.bookmark_id})}),P&&(0,g.jsx)(b.P,{onChange:n}),k&&(0,g.jsx)(h.p,{onChange:n,onPostDestroy:r,refetchPosts:i}),C&&(0,g.jsx)(v.c,{post:t})]}):null},_=n(72299),x=n(34678),j=function(e){var t,n,r=e.hideAuthorHeadline,f=void 0!==r&&r,p=e.hideBookmarkButton,v=void 0!==p&&p,h=e.hidePinnedToTopIcon,b=void 0!==h&&h,j=e.hideShareLink,w=void 0!==j&&j,O=e.isRenderedOutsideTheSpace,S=void 0!==O&&O,P=e.metaInfoWrapperClassName,C=e.onChange,k=e.onPostDestroy,N=e.post,I=e.refetchPosts,A=e.tagsLimit,E=e.tagsShowMoreLabelVariant,T=(0,c.L2)().data,M=(0,c.Zh)(),L=M.usedIn,R=M.isUsedInMinimalTipTapViewModal,D=null===N||void 0===N?void 0:N.cover_image_url,F=(0,d.kK)(),U=null===(t=(0,a.$B)("/home"))||void 0===t?void 0:t.isExact,B=null===(n=(0,a.$B)("/feed"))||void 0===n?void 0:n.isExact,z=(0,s.Y_)(T)&&(null===N||void 0===N?void 0:N.unresolved_flagged_reports_count)>0,H=S||U||B||F||"minimal-post-modal"===L;return(0,g.jsxs)(g.Fragment,{children:[z&&(0,g.jsx)(l.F,{record:N,contentType:"post"}),(0,g.jsxs)("div",{className:o()("flex items-start justify-between gap-3",{"mb-5":R&&(0,u.Fr)(N)}),children:[(0,g.jsxs)("div",{className:"flex grow flex-col items-start justify-between space-y-5",children:[(null===N||void 0===N?void 0:N.flagged_for_approval_at)&&(0,g.jsx)(m.g,{className:"!bg-author-in-review post__headline-tag align mt-1 border-0 align-middle uppercase text-white",label:(0,i.t)("in_review")}),H?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(_.c,{isRenderedOutsideTheSpace:S,doesPostHaveCoverImage:D,space:T,tagsLimit:A,tagsShowMoreLabelVariant:E,wrapperClassName:o()("mt-1",P),hideAuthorHeadline:f}),(0,g.jsx)(x.p,{})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(x.p,{}),(0,g.jsx)(_.c,{isRenderedOutsideTheSpace:S,doesPostHaveCoverImage:D,space:T,tagsLimit:A,tagsShowMoreLabelVariant:E,wrapperClassName:o()("mt-1",P),hideAuthorHeadline:f})]})]}),(0,g.jsx)(y,{post:N,onChange:C,refetchPosts:I,onPostDestroy:k,hideShareLink:w,hidePinnedToTopIcon:b,hideBookmarkButton:v})]})]})}},72299:(e,t,n)=>{n.d(t,{c:()=>D});var r=n(67294),o=n(86013),i=n(99658),a=n(98338),s=n(54030),l=n(94184),c=n.n(l),u=n(74374),d=n(95287),m=n(73890),f=n(51705),p=n(94281),v=n(43574),h=n(96486),b=n(85893),g=(0,r.forwardRef)((function(e,t){var n=e.headline,r=e.post,o=r.community_member,i=r.created_at,l=(0,s.kK)(),d=(0,a.Zh)().usedIn,f=l||"full-post-modal"===d,v=f?(0,h.truncate)(n,{length:60}):n;return n||f?(0,b.jsx)("div",{className:"post__meta inline-flex flex-wrap items-center gap-x-2",children:(0,b.jsx)(p.T,{content:n,shouldUseSpanWrapper:!1,interactive:!1,disabled:!n,children:(0,b.jsx)("button",{type:"button",className:c()("author__credentials text-default focus-visible:outline-secondary focus-visible:text-dark text-left text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"is-admin":!!o.is_admin}),children:(0,b.jsxs)("span",{className:"space-x-2",children:[n&&(0,b.jsx)("span",{className:c()("overflow-anywhere",{"md:line-clamp-1":"full-post-modal"!==d}),children:v}),f&&!!n&&(0,b.jsx)("span",{className:"bg-badge inline-block h-[0.15rem] w-[0.15rem] rounded-full align-middle"}),f&&(0,b.jsx)("span",{className:"author__time",children:(0,b.jsx)(u.s,{post:r,className:"ago text-default hover:text-dark focus-visible:outline-secondary focus-visible:text-dark text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",forwardedRef:t,children:(0,m.TF)(i,{format:m.lc.short})})})]})})})}):null}));g.displayName="AuthorHeadline";var y=n(11355),_=n(38503);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){var t,n=e.children,r=e.post,o=e.className,i=void 0===o?"":o,a=r.community_member,s=(0,_.wC)().minimal_layout,l=(0,y.O)({public_uid:null!==(t=a.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0},name:a.name});return s?(0,b.jsx)("div",{className:i,children:n}):(0,b.jsx)("a",j(j({},l),{},{className:c()("focus-visible:outline-secondary hover:text-dark inline-block focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",i),"data-testid":"post-avatar",children:n}))},S=n(388),P=n(10950),C=n(64422),k=function(e){var t,n,r=e.post,o=r.community_member,i=!!(0,P.E)().member;return(0,b.jsx)("div",{className:"post__avatar",children:(0,b.jsx)(S.C,{communityMemberId:o.id,publicUid:o.public_uid,avatarURL:o.avatar_url,name:null!==(t=o.name)&&void 0!==t?t:"",headline:o.headline,disabled:i,children:(0,b.jsx)(O,{post:r,className:"mr-3",children:(0,b.jsx)(C.s,{src:o.avatar_url,name:null!==(n=o.name)&&void 0!==n?n:"",size:"10"})})})})},N=["doesPostHaveCoverImage","className","children"];function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var M=(0,r.forwardRef)((function(e,t){var n=e.doesPostHaveCoverImage,r=void 0!==n&&n,o=e.className,i=e.children,a=T(e,N),l=(0,s.kK)();return(0,b.jsx)("div",A(A({className:c()("post__user flex items-stretch",{"md:!mb-2 md:!mt-1":l&&r},o),ref:t},a),{},{children:i}))}));M.displayName="PostViewListItemWrapper";var L=function(e){var t=e.communityMember,n=e.containerRef,r=e.doesPostHaveCoverImage,i=void 0!==r&&r,a=e.hasTags,s=void 0!==a&&a,l=e.headline,h=e.hideAuthorHeadline,y=void 0!==h&&h,_=e.isAdmin,x=void 0!==_&&_,j=e.isSmScreen,w=void 0!==j&&j,S=e.pageLinkRef,P=e.post,C=e.posterJoinedDate,N=e.shouldDisplayMemberTags,I=void 0!==N&&N,A=e.tagsShowMoreLabelVariant,E=e.visibleMemberTags,T=e.wrapperClassName,L=Boolean(l),R=Boolean(C),D=!(L&&!y)&&R;return(0,b.jsxs)(M,{doesPostHaveCoverImage:i,ref:n,className:T,"data-testid":"post-meta-info-regular",children:[(0,b.jsx)(k,{post:P}),(0,b.jsxs)("button",{type:"button",className:"post__bio focus-visible:outline-secondary flex flex-col justify-between self-center text-left focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:function(e){if(!(e.target instanceof HTMLAnchorElement)&&S.current)if((0,d.n2)(e)){var t=S.current.href;window.open(t,"_blank","noreferrer"),e.preventDefault()}else S.current.click()},children:[(0,b.jsxs)("div",{className:c()("author flex flex-wrap items-baseline gap-x-2 gap-y-px",{"no-headline":!(null!==t&&void 0!==t&&t.headline)&&P.name,"has-tags":s}),children:[(0,b.jsx)("div",{className:"author__name inline-flex",children:(0,b.jsx)(O,{post:P,className:"!text-dark overflow-anywhere text-sm font-semibold leading-5",children:null===t||void 0===t?void 0:t.name})}),I&&(0,b.jsx)("div",{className:"author__tags member-tags",children:(0,b.jsx)(v.m,{memberTags:E,isAdmin:x,limit:w||(0,f.Fr)(P)?1:2,showMoreLabelVariant:A})}),(0,b.jsx)("div",{className:"author__time inline-flex",children:(0,b.jsx)(u.s,{post:P,className:"ago text-default hover:text-dark focus-visible:outline-secondary focus-visible:text-dark flex items-baseline text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",forwardedRef:S,children:(0,b.jsx)(p.T,{interactive:!1,content:(0,f.s4)(P.created_at),children:(0,m.TF)(P.created_at,{format:m.lc.short})})})})]}),!y&&(0,b.jsx)(g,{headline:l,post:P}),D&&(0,b.jsx)("div",{className:"text-light flex text-xs",children:(0,o.t)("post.member_since",{date:C})})]})]})},R=function(e){var t=e.communityMember,n=e.containerRef,r=e.doesPostHaveCoverImage,o=void 0!==r&&r,i=e.hasTags,a=void 0!==i&&i,s=e.headline,l=e.hideAuthorHeadline,u=void 0!==l&&l,d=e.isAdmin,m=void 0!==d&&d,f=e.pageLinkRef,p=e.post,h=e.shouldDisplayMemberTags,y=void 0!==h&&h,_=e.tagsLimit,x=e.tagsShowMoreLabelVariant,j=e.visibleMemberTags,w=e.wrapperClassName;return(0,b.jsxs)(M,{doesPostHaveCoverImage:o,ref:n,className:w,"data-testid":"post-meta-info-small",children:[(0,b.jsx)(k,{post:p}),(0,b.jsxs)("button",{type:"button",className:"post__bio focus-visible:outline-secondary flex flex-col justify-between gap-1 self-center text-left focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:function(e){e.target instanceof HTMLAnchorElement||f.current&&f.current.click()},children:[(0,b.jsxs)("div",{className:c()("author flex flex-wrap items-center gap-x-2 gap-y-1",{"no-headline":!(null!==t&&void 0!==t&&t.headline)&&p.name,"has-tags":a}),children:[(0,b.jsx)("div",{className:"author__name inline-flex",children:(0,b.jsx)(O,{post:p,className:"!text-dark text-sm font-semibold leading-5",children:null===t||void 0===t?void 0:t.name})}),y&&(0,b.jsx)("div",{className:"author__tags member-tags !m-0",children:(0,b.jsx)(v.m,{memberTags:j,isAdmin:m,limit:_,showMoreLabelVariant:x})})]}),!u&&(0,b.jsx)(g,{headline:s,post:p,ref:f})]})]})},D=function(e){var t=e.doesPostHaveCoverImage,n=void 0!==t&&t,l=e.hideAuthorHeadline,c=void 0!==l&&l,u=e.isRenderedOutsideTheSpace,d=void 0!==u&&u,m=e.space,f=e.tagsLimit,p=e.tagsShowMoreLabelVariant,v=void 0===p?"numbers":p,h=e.wrapperClassName,g=(0,i.m)(),y=g.post,_=g.isSharedPostView,x=g.posterJoinedDate,j=(0,a.Zh)().usedIn,w=Boolean(null===y||void 0===y?void 0:y.hide_meta_info),O=null===y||void 0===y?void 0:y.community_member,S=(null===y||void 0===y?void 0:y.member_tags)||[],P=null===O||void 0===O?void 0:O.id,C=null===S||void 0===S?void 0:S.filter((function(e){var t;return Boolean((null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.post_bio))})),k=(0,r.useMemo)((function(){return Boolean(P&&(null===C||void 0===C?void 0:C.length)>0)}),[P,C]),N=(0,s.kK)(),I=(0,r.useRef)(null),A=(0,r.useRef)(null);if(w||!m)return null;var E=d?"".concat((0,o.t)("post.posted_in")," ").concat(m.name):null===O||void 0===O?void 0:O.headline,T=Boolean(null===O||void 0===O?void 0:O.admin),M=!_&&(k||T);return N||"full-post-modal"===j?(0,b.jsx)(R,{communityMember:O,containerRef:I,doesPostHaveCoverImage:n,hasTags:k,headline:E,hideAuthorHeadline:c,isAdmin:T,pageLinkRef:A,post:y,shouldDisplayMemberTags:M,tagsLimit:f,tagsShowMoreLabelVariant:v,visibleMemberTags:C,wrapperClassName:h}):(0,b.jsx)(L,{communityMember:O,containerRef:I,doesPostHaveCoverImage:n,hasTags:k,headline:E,hideAuthorHeadline:c,isAdmin:T,isSmScreen:N,pageLinkRef:A,post:y,posterJoinedDate:x,shouldDisplayMemberTags:M,tagsShowMoreLabelVariant:v,visibleMemberTags:C,wrapperClassName:h})}},34678:(e,t,n)=>{n.d(t,{p:()=>u});var r=n(94184),o=n.n(r),i=n(81360),a=n(74374),s=n(99658),l=n(98338),c=n(85893),u=function(){var e=(0,s.m)(),t=e.post,n=e.canManagePost,r=(0,l.Zh)().usedIn;if(!t.name||"minimal-post-modal"===r)return null;var u=(t||{}).event_setting_attributes||{},d=u.starts_at,m=u.ends_at,f=o()("post__header",{"post-meta--hidden":t.hide_meta_info});return(0,c.jsxs)("div",{className:f,children:[d&&m&&(0,c.jsx)(i.A,{startsAt:d,endsAt:m,status:null===t||void 0===t?void 0:t.status}),(0,c.jsx)("h1",{className:o()("post__title break-words text-2xl font-bold leading-7",{"with-admin-actions":n}),children:(0,c.jsx)(a.s,{post:t,className:"!text-darkest focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:t.name})})]})}},87229:(e,t,n)=>{n.d(t,{P:()=>P});var r=n(94184),o=n.n(r),i=n(86013),a=n(92385),s=n(98338),l=n(18605),c=n(81786),u=n(52995),d=n(8246),m=n(27025),f=n(67294),p=n(20640),v=n.n(p),h=n(50732),b=n(69647);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=n(85893),O=function(e){var t=e.getSharePostLink,n=e.post,r=e.sharePostData,p=function(e){var t=e.post,n=e.getSharePostLink,r=e.sharePostData,o=(0,b.p)().success,a=(0,s.wh)().currentCommunity,l=(0,s.L2)().data,c=x((0,f.useState)({post:{show_post_teaser:!(null===t||void 0===t||!t.show_post_teaser),share_to_web:!(null===t||void 0===t||!t.share_post_enabled),share_post_enabled:!(null===t||void 0===t||!t.share_post_enabled),minimal_layout:!(null===t||void 0===t||!t.minimal_layout)}}),2),u=c[0],d=c[1],m=(0,h.LM)({spaceSlug:null===t||void 0===t?void 0:t.space_slug,slug:null===t||void 0===t?void 0:t.slug});return(0,f.useEffect)((function(){t.share_post_enabled&&!r&&n({postId:null===t||void 0===t?void 0:t.id,body:u})}),[null===t||void 0===t?void 0:t.share_post_enabled,r,u,n,null===t||void 0===t?void 0:t.id]),{onClickCopyLink:function(e){v()(e||window.location.origin+m),o((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){d((function(r){var o={post:y(y({},r.post),e)};return n({postId:null===t||void 0===t?void 0:t.id,body:o}),o}))},formData:u,currentCommunity:a,currentSpace:l}}({post:n,getSharePostLink:t,sharePostData:r}),g=p.onClickCopyLink,_=p.onChange,j=p.formData,O=p.currentCommunity,S=p.currentSpace,P=(0,s.wh)().isViewOnlyMasquerading;return O.is_private||null!==S&&void 0!==S&&S.is_private?(0,w.jsxs)("div",{children:[(0,w.jsx)(m.Lt.ItemLink,{disabled:P,onClick:function(){_({share_to_web:!j.post.share_to_web})},children:(0,w.jsx)(u.sI,{label:(0,i.t)("post.share.share_to_web"),tooltipText:(0,i.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:j.post.share_to_web,variant:"small",disabled:P,className:o()({"cursor-not-allowed":P})})}),j.post.share_to_web&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"flex flex-row items-center",children:(0,w.jsx)("div",{className:"mb-4 mt-1 flex-1 px-5",children:(0,w.jsx)(a.I,{disabled:!0,value:null===r||void 0===r?void 0:r.share_post_link,rightAddon:(0,w.jsx)("button",{type:"submit",onClick:function(){return g(null===r||void 0===r?void 0:r.share_post_link)},children:(0,w.jsx)(l.JO,{type:"20-copy"})})})})}),(0,w.jsx)(m.Lt.ItemLink,{onClick:function(){_({show_post_teaser:!j.post.show_post_teaser})},children:(0,w.jsx)(u.sI,{label:(0,i.t)("post.share.show_teaser"),tooltipText:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("p",{children:(0,i.t)("post.share.show_teaser_description_title")}),(0,w.jsx)("a",{href:"/settings#field-custom_cta_for_share_links",children:(0,i.t)("post.share.show_teaser_description_link")})]}),field:"show_post_teaser",value:j.post.show_post_teaser,variant:"small"})}),!(null!==O&&void 0!==O&&O.is_private)&&(0,w.jsx)(m.Lt.ItemLink,{onClick:function(){return _({minimal_layout:!j.post.minimal_layout})},children:(0,w.jsx)(u.sI,{label:(0,i.t)("post.share.minimal_layout"),tooltipText:(0,i.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:j.post.minimal_layout,variant:"small"})})]})]}):(0,w.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,w.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,w.jsx)(d.Z.LabelMd,{weight:"bold",children:(0,i.t)("post.share.share_to_web")}),(0,w.jsx)(d.Z.LabelSm,{children:(0,i.t)("post.share.post_is_public")})]}),(0,w.jsx)("div",{children:(0,w.jsx)(c.z,{variant:"secondary",onClick:function(){return g()},children:(0,i.t)("copy_link")})})]})},S=n(99658),P=function(e){var t=e.onChange,n=e.button,r=e.shouldRenderCustomMenuButton,a=e.menuButtonEl,c=void 0===a?"button":a,u=e.appendTo,f=(0,S.m)({onChangeSharePost:t}),p=f.showShareOnWebOptions,v=f.post,h=f.getSharePostLink,b=f.sharePostData,g=(0,s.L2)().data,y=null!==n&&void 0!==n?n:(0,w.jsx)(l.JO,{type:"16-share",size:20});return p(g)?(0,w.jsx)(m.Lt,{size:"extra-large",direction:"bottom-end",menuButtonEl:c,className:"w-full",appendTo:u,buttonClassName:o()("w-full focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-1",{"p-1 hover:bg-tertiary rounded group flex items-center":!r}),button:r?y:(0,w.jsx)(d.Z.LabelSm,{weight:"medium",color:"text-default group-hover:text-dark",children:(0,i.t)("post.share.title")}),children:(0,w.jsx)(O,{post:v,getSharePostLink:h,sharePostData:b})}):null}},74374:(e,t,n)=>{n.d(t,{s:()=>_});var r=n(24185),o=n(40160),i=n(97910),a=n(10950),s=n(51705),l=n(50732),c=n(18701),u=n(36589),d=n(54030),m=n(82177),f=n(71179),p=n(85893),v=["post","ariaLabel","allComments","forwardedRef","onClick","children","shouldOpenPostModal"];function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var _=function(e){var t=e.post,n=e.ariaLabel,h=e.allComments,g=void 0!==h&&h,_=e.forwardedRef,x=e.onClick,j=e.children,w=e.shouldOpenPostModal,O=void 0!==w&&w,S=y(e,v),P=(0,a.E)().member,C=!!P,k=(0,d.kK)(),N=(0,r.UO)().postSlug,I=(0,c.I)(),A=(0,m.UV)(),E=A.isInsideModal,T=A.onClose,M=(0,u.I)(),L=M.isV3Enabled,R=M.shouldShowPostModal,D=(0,r.TH)(),F=(0,f._t)(),U=F.params,B=F.hasNextPage,z=(0,l.LM)({spaceSlug:t.space_slug,slug:t.slug,hash:g?i.Q:""});return I?(0,p.jsx)("a",b(b(b({href:z,target:"_blank",rel:"noreferrer","aria-label":n},S),_&&{ref:_}),{},{children:j})):(0,s.Sb)(t,{postSlugInUrl:N})?(0,p.jsx)("a",b(b(b({href:z,"aria-label":n},S),_&&{ref:_}),{},{children:j})):L&&O&&R&&!k?(0,p.jsx)(o.rU,b(b(b({to:{pathname:l.xu.show({slug:t.slug,spaceSlug:t.space_slug}),state:{prevLocation:D,params:U,hasNextPage:B,isWithinProfileContext:C,profileContextMember:P}},"aria-label":n},S),_&&{ref:_}),{},{children:j})):(0,p.jsx)(o.rU,b(b(b({to:z,"aria-label":n},S),_&&{ref:_}),{},{onClick:E?T:x,children:j}))}},21904:(e,t,n)=>{n.d(t,{D:()=>ve});var r=n(67294),o=n(94184),i=n.n(o),a=n(24185),s=n(32808),l=n(34267),c=n(4395),u=n(78113),d=n(87228),m=n(99658),f=n(98338),p=n(51705),v=n(36589),h=n(54030),b=n(77852),g=n(3888),y=n(66007),_=n(86013),x=n(96486),j=n(38503),w=n(7074),O=n(71179),S=n(40641),P=["image","file","embed","poll","video"],C=250;function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e){return!("paragraph"!==e.type||e.content&&0!==e.content.length)||!(void 0===e.text||""!==e.text.trim()||" "===e.text)},E=function e(t){return t.filter((function(e){return!A(e)})).map((function(t){return t.content?N(N({},t),{},{content:e(t.content)}):t}))},T=function(e){return!(e&&e.content&&Array.isArray(e.content))||0===e.content.length},M=function(e){return"string"===typeof e.type&&P.includes(e.type)};function L(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B=function(e,t){M(e)?q(e,t):e.content&&Array.isArray(e.content)?z(e,t):V(e,t)},z=function(e,t){var n=F(F({},e),{},{content:[]});t.truncatedContent.push(n);var r,o=L(e.content);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(t.hasCharacterLimitReached)break;var a=Q(i,t),s=C-t.charCount;a<=s?(B(i,F(F({},t),{},{truncatedContent:n.content})),t.charCount+=a):(W(i,s,F(F({},t),{},{truncatedContent:n.content})),t.hasCharacterLimitReached=!0),H(t)}}catch(l){o.e(l)}finally{o.f()}},H=function(e){e.charCount>=C&&(e.hasCharacterLimitReached=!0)},Z=function e(t,n){return(0,x.some)(t,(function(t){var r;if(A(t))return!1;var o=n.hasCharacterLimitReached&&M(t),i=n.hasCharacterLimitReached&&Array.isArray(t.content);return!(!o||!function(e,t){return!t.mediaContent&&(t.mediaContent=e,!0)}(t,n))||(n.hasCharacterLimitReached||(B(t,n),H(n)),i&&e(null!==(r=t.content)&&void 0!==r?r:[],n))}))},q=function(e,t){t.charCount<=C&&(t.hasMediaAttachmentsBeforeTruncation=!0),t.charCount+80<=C?(t.charCount+=80,t.truncatedContent.push(F({},e))):t.hasCharacterLimitReached=!0},V=function(e,t){var n=Q(e,t),r=C-t.charCount;n<=r?(t.charCount+=n,t.truncatedContent.push(F({},e))):(W(e,r,t),t.hasCharacterLimitReached=!0)},W=function(e,t,n){var r=F({},e);"string"===typeof e.text?(r.text=e.text.slice(0,t).trim(),r.text&&(t<e.text.length&&(r.text+="..."),n.truncatedContent.push(r),n.charCount+=r.text.length)):e.content&&Array.isArray(e.content)&&(r.content=[],n.truncatedContent.push(r),Z(e.content,F(F({},n),{},{truncatedContent:r.content})))},Q=function e(t,n){var r;if(n.textLengthCache.has(t))return null!==(r=n.textLengthCache.get(t))&&void 0!==r?r:0;var o=0;return"string"===typeof t.text?o=t.text.length:t.content&&Array.isArray(t.content)&&(o=t.content.reduce((function(t,r){return t+e(r,n)}),0)),n.textLengthCache.set(t,o),o},$=function(e){var t,n,o=e.params,i=void 0===o?{}:o,s=e.hasNextPage,l=void 0!==s&&s,c=(0,m.m)().post,u=(0,S.d)().navigateToPost,d=(0,a.TH)(),f=(0,r.useMemo)((function(){var e,t;return function(e){if(!e)return{truncatedContent:[],mediaContent:null,hasCharacterLimitReached:!1,hasMediaAttachmentsBeforeTruncation:!1};var t={charCount:0,truncatedContent:[],mediaContent:null,hasCharacterLimitReached:!1,textLengthCache:new Map,hasMediaAttachmentsBeforeTruncation:!1};return Z(e,t),{truncatedContent:E(t.truncatedContent),mediaContent:t.mediaContent,hasCharacterLimitReached:t.hasCharacterLimitReached,hasMediaAttachmentsBeforeTruncation:t.hasMediaAttachmentsBeforeTruncation}}(null===c||void 0===c||null===(e=c.tiptap_body)||void 0===e||null===(t=e.body)||void 0===t?void 0:t.content)}),[null===c||void 0===c||null===(t=c.tiptap_body)||void 0===t||null===(n=t.body)||void 0===n?void 0:n.content]),p=f.truncatedContent,v=f.mediaContent,h=f.hasCharacterLimitReached,b=f.hasMediaAttachmentsBeforeTruncation,g=(0,r.useMemo)((function(){return{type:"doc",content:p}}),[p]),y=(0,r.useMemo)((function(){return v?{type:"doc",content:[v]}:null}),[v]),_=(0,r.useMemo)((function(){return T(y)}),[y]),x=(0,r.useMemo)((function(){return T(g)}),[g]),j=h&&p&&!x,w=p&&!x,O=!b&&!!v&&!_,P=(0,r.useCallback)((function(){u({newPost:c,prevLocation:d,params:i,hasNextPage:l})}),[c,d,i,l,u]);return{truncatedContent:g,mediaContent:y,redirectToPostModal:P,tiptapBody:null===c||void 0===c?void 0:c.tiptap_body,shouldShowSeeMoreButton:j,shouldRenderTruncatedContent:w,shouldRenderMediaContent:O}},G=n(85893),J=function(){var e=(0,j.wC)().minimal_layout,t=(0,m.m)().post,n=(0,O._t)(),o=n.params,i=n.hasNextPage,a=t.internal_custom_html,s=$({params:o,hasNextPage:i}),l=s.mediaContent,c=s.truncatedContent,u=s.shouldRenderTruncatedContent,d=s.shouldRenderMediaContent,f=s.tiptapBody,p=s.redirectToPostModal,v=s.shouldShowSeeMoreButton;return(0,r.useEffect)((function(){var e;a&&(0,x.isFunction)(null===(e=window)||void 0===e?void 0:e.loadOembed)&&window.loadOembed()}),[a]),(0,G.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[u&&(0,G.jsx)(w.R,{readOnly:!0,disableMentionClicks:e,value:c,shouldRefetch:!0,sgidToObjectMap:f.sgids_to_object_map,inlineAttachments:f.inline_attachments}),a&&(0,G.jsx)(y.Z,{html:a},"internal_custom_html"),v&&(0,G.jsx)("button",{type:"button",className:"text-light hover:text-dark focus-visible:text-dark inline-flex text-base","data-testid":"see-more-post",onClick:p,children:(0,_.t)("see_more")}),d&&(0,G.jsx)(w.R,{readOnly:!0,disableMentionClicks:e,sgidToObjectMap:f.sgids_to_object_map,inlineAttachments:f.inline_attachments,value:l,shouldRefetch:!0,className:"w-full"})]})},K=n(50732),Y=n(61844),X=n(34141),ee=n(5958),te=function(){var e=(0,m.m)(),t=e.post,n=e.isTrixPost,o=t.body_trix_content,i=t.internal_custom_html,s=t.pinned_at_top_of_space,l=(0,S.d)().navigateToPost,c=(0,a.TH)(),u=(0,O._t)(),d=u.params,f=u.hasNextPage;(0,r.useEffect)((function(){var e;i&&(0,x.isFunction)(null===(e=window)||void 0===e?void 0:e.loadOembed)&&window.loadOembed()}),[i]);var v=4;s&&(v=2);var h=["help","help-en"].includes(t.community_slug)&&(0,p.hm)(t);return(0,G.jsxs)("div",{className:"flex w-full flex-col items-start justify-start gap-2",children:[(0,G.jsxs)(Y.X,{lines:v,hideToggle:!0,children:[n&&o&&(0,G.jsx)(X.P,{content:o,contentParentPath:K.xu.show({slug:t.slug,spaceSlug:t.space_slug})}),i&&(0,G.jsx)(y.Z,{html:i},"internal_custom_html"),h&&(0,G.jsx)(ee.e,{post:t})]}),(0,G.jsx)("button",{type:"button",className:"text-default hover:text-dark text-base",onClick:function(){l({newPost:t,params:d,hasNextPage:f,prevLocation:c})},children:(0,_.t)("see_more")})]})},ne=function(e){var t=e.noPadding,n=void 0!==t&&t,r=(0,m.m)(),o=r.post,a=r.isTiptapPost,s=r.isPostBodyEmpty,l=o.updated_at;return s?null:(0,G.jsx)("div",{className:i()("post__body",{"!p-0":n,"px-5 pb-5 md:px-6":(0,p.Fr)(o)}),"data-testid":"post-body",children:(0,G.jsx)("div",{className:"post__inside trix-v2 w-full","data-testid":"post-body-inside",children:a?(0,G.jsx)(J,{}):(0,G.jsx)(te,{})})},l)},re=n(94216),oe=function(e){var t,n,r=e.children,o=(0,m.m)(),s=o.isImagePost,l=o.isPostBodyEmpty,c=o.isPostMetaHidden,u=o.isSharedPostWithTeaserLayout,d=(0,f.Zh)().usedIn,p=null===(t=(0,a.$B)("/home"))||void 0===t?void 0:t.isExact,v=null===(n=(0,a.$B)("/feed"))||void 0===n?void 0:n.isExact,h="full-post-modal"===d,b=l&&!p&&!v&&!c&&!s;return(0,G.jsx)("div",{className:i()("post__content text-dark",{"p-5 md:px-6":!s&&c,"px-5 pb-5 pt-4 md:px-6 md:py-5":!s&&!c,"pt-5":s&&!h&&c,"pt-4 md:pt-5":s&&!h&&!c,"py-5":s&&h,"!pb-0":s&&h&&!l,"pb-5":b,relative:u}),children:r})},ie=n(31247),ae=n(9144);function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=function(e){var t,n=e.autofocusReplyForm,o=void 0!==n&&n,y=e.className,_=e.defaultShowComment,x=void 0!==_&&_,j=e.hideAuthorHeadline,w=void 0!==j&&j,O=e.hideBookmarkButton,S=void 0!==O&&O,P=e.hidePinnedToTopIcon,C=void 0!==P&&P,k=e.hideShareLink,N=void 0!==k&&k,I=e.isRenderedOutsideTheSpace,A=void 0!==I&&I,E=e.metaInfoWrapperClassName,T=e.onPostChange,M=e.onPostDestroy,L=e.pageSupportsContentTruncation,R=void 0===L||L,D=e.refetchPosts,F=e.shouldOpenCommentPage,U=void 0!==F&&F,B=e.tagsLimit,z=void 0===B?3:B,H=e.tagsShowMoreLabelVariant,Z=void 0===H?"numbers":H,q=e.shouldForceSamePageInteractions,V=void 0!==q&&q,W=(0,r.useRef)(null),Q=(0,f.Zh)(),$=Q.record,J=Q.usedIn,K=(0,m.m)(),Y=K.isPostBodyEmpty,X=K.showPostActions,ee=ue((0,r.useState)(x),2),te=ee[0],se=ee[1],ce=ue((0,r.useState)(o),2),de=ce[0],me=ce[1],fe=(0,h.kK)(),pe=$.name,ve=$.is_truncation_disabled,he=$.is_comments_enabled,be=$.flagged_for_approval_at,ge=$.hide_meta_info,ye=$.pinned_at_top_of_space,_e=$.post_details_loaded,xe=$.event_setting_attributes,je=null===xe||void 0===xe?void 0:xe.live_stream_room_setting_attributes,we=null===je||void 0===je?void 0:je.recording_url,Oe=null===je||void 0===je?void 0:je.recording_transcript_id,Se=null===je||void 0===je?void 0:je.recording_thumbnail,Pe=null===je||void 0===je?void 0:je.auto_post_recording_enabled,Ce=(0,v.I)().isV3Enabled,ke=null===(t=(0,a.$B)("/c/:spaceSlug/:postSlug"))||void 0===t?void 0:t.isExact,Ne=(0,p.hm)($)&&Ce&&!ke&&!ve&&!V,Ie=!ve,Ae=(0,f.wh)(),Ee=Ae.currentUser,Te=Ae.currentCommunitySettings,Me=null===Te||void 0===Te?void 0:Te.reactified_comments_enabled,Le=(0,m.m)(),Re=Le.isSharedPostView,De=Le.isSharedPostWithTeaserLayout,Fe=R&&Ie||De,Ue=(0,p.Fr)($)||(0,p.hm)($),Be="full-post-modal"===J,ze=!X&&"full-post-modal"===J&&ge;if(!$||!$.id)return null;var He=function(){setTimeout((function(){var e=document.querySelector('[input="comment-body-'.concat($.id,'"]'));e&&e instanceof HTMLElement&&(e.focus(),e.scrollIntoView({behavior:"smooth",block:"center"}))}),500)},Ze=(0,r.useCallback)((function(){return(0,b.p)(W.current)&&W.current.focus()}),[W]);(0,r.useEffect)((function(){de&&Ze()}),[Ze]);var qe=i()("post post--parent bg-primary border-primary mb-5 md:mb-6 rounded-none border first:mt-5 first:md:mt-0",{"md:rounded-lg":!Ce,"md:rounded-2xl":Ce,"post--shared":Re,"post--shared__truncated":De&&!Ee,"is-truncation-disabled":!Fe,"flagged-for-approval":be,"post-name--empty":!pe,"post-meta--hidden":ge,"is-pinned":ye,"!shadow-none !rounded-none !border-0 !border-b":Be},y),Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};T(le(le({},$),e),t)},We=(0,r.useCallback)((function(){var e,t;(se(!0),Me)?(me(!0),W.current&&((0,b.p)(W.current)?(0,b.p)(W.current)&&W.current.focus():null===(e=W.current.commands)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e,"end"))):He()}),[Me,He]),Qe=(0,p.HZ)($);return(0,G.jsxs)("div",{className:qe,children:[!C&&fe&&Ue&&(0,G.jsx)(d.c,{post:$}),(0,G.jsx)(ie.H,{post:$}),(0,G.jsx)("div",{className:i()("post__post",{"!border-b":!Ee&&Re&&Qe}),children:(0,G.jsxs)(oe,{children:[(0,G.jsx)("div",{className:i()({"mb-5":!Y,"px-5 md:px-6":(0,p.Fr)($),hidden:ze}),children:(0,G.jsx)(ae.m,{post:$,isRenderedOutsideTheSpace:A,onChange:Ve,refetchPosts:D,onPostDestroy:M,hideShareLink:N,hidePinnedToTopIcon:C,hideBookmarkButton:S,tagsLimit:fe?1:z,tagsShowMoreLabelVariant:Z,metaInfoWrapperClassName:E,hideAuthorHeadline:w})}),Qe&&(0,G.jsx)(l.Y,{onChange:Ve,insidePost:!0}),we&&Pe&&(0,G.jsx)("div",{className:"px-6 py-4",children:(0,G.jsx)(g.T,{src:we,type:"video/mp4",mediaTranscriptId:Oe,poster:Se})}),(0,p.Fr)($)&&"full-post-modal"!==J&&(0,G.jsx)(s.l,{onPostChange:T,onPostDestroy:M}),Ne?(0,G.jsx)(ne,{}):(0,G.jsx)(re.y,{enableTruncation:Fe}),De&&(0,G.jsx)("div",{className:"to-primary absolute bottom-0 left-0 z-10 h-1/2 w-full bg-gradient-to-b from-transparent"})]})}),(0,G.jsx)("div",{className:"mt-auto",children:(0,G.jsx)(u.S,{toggleComment:function(){me(!1),se((function(e){return!e}))},showCommentAndFocusCommentForm:We,shouldOpenCommentPage:U,shouldForceSamePageInteractions:V})}),_e&&he&&te&&(0,G.jsx)(c.o,{commentsFormRef:W,autofocusReplyForm:de})]})};function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ve=function(e){return(0,G.jsx)(me,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}},99658:(e,t,n)=>{n.d(t,{m:()=>g});var r=n(88767),o=n(24185),i=n(81089),a=n(98338),s=n(68997),l=n(39068),c=n(39639),u=n(51705),d=n(90789),m=n(18701),f=["record"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var g=function(){var e,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onChangeSharePost,n=(0,o.UO)().postSlug,p=(0,m.I)(),h=(0,a.Zh)(),g=h.record,y=b(h,f),_=(0,c.ie)(null===g||void 0===g||null===(e=g.community_member)||void 0===e?void 0:e.created_at,{month:"long",year:"numeric",day:"numeric"}),x=(0,a.wh)(),j=x.currentUser,w=x.currentCommunity,O=x.currentCommunityMember,S=u.Sb(g,{postSlugInUrl:n}),P=Boolean(S&&g.minimal_layout),C=Boolean(S&&g.show_post_teaser),k=!p&&u.GT(g,{currentUser:j,postSlugInUrl:n}),N=u.ou(g),I=u.sN(g),A=u.Vr(g),E=u.$2(g),T=u.KX(g),M=P,L=Boolean(!j&&g.is_comments_enabled&&!g.is_comments_closed||C),R=L&&g.comments_count>5,D=L&&g.comments_count<=5,F=Boolean(g.flagged_for_approval_at&&N),U=u.hm(g),B=u.HZ(g),z=u.Fr(g),H=u.s8(g),Z=u.Iz(g),q=u.Vt(g),V=u.A8(g),W=Boolean(!P&&(g.is_liking_enabled||g.is_comments_enabled)),Q=Boolean(P&&O),$=(0,r.useMutation)((function(e){var t=e.postId,n=e.body;return(0,i.aU)("/posts/".concat(t,"/share"),n)}),{onSuccess:function(e){t&&t(v(v({},g),e),{refetch:!1})}}),G=$.mutate,J=$.data,K=$.isLoading;return v(v({post:g},y),{},{canDestroyPost:E,canDuplicatePost:A,canManagePost:N,canReportPost:T,canUpdatePost:I,getSharePostLink:G,isBasicPost:U,isEventPost:B,isImagePost:z,isLoadingSharePostData:K,isPostBodyEmpty:q,isPostMetaHidden:V,isSharedPostView:S,isSharedPostViewWithMinimalLayout:P,isSharedPostWithTeaserLayout:C,isTiptapPost:H,isTrixPost:Z,posterJoinedDate:_,sharePostData:J,shouldHideCommentsListForSpace:function(e){var t=e.space,n=(0,s.aF)(w)||O,r=(0,d.fL)(t)||(0,d.J$)(t)||(0,l.vb)(O);return!(n&&r)||P||C},shouldShowLeaveCommentButton:Q,showEngagementActions:W,showGatedCommentSection:L,showGatedCommentSectionAtBottom:D,showGatedCommentSectionAtTop:R,showModerationInActionsDropdown:F,showPostActions:k,showShareOnWebOptions:function(e){return!S&&!p&&u.Pu(g,w,e)},showSpaceName:M})}},97082:(e,t,n)=>{n.d(t,{s:()=>a});var r=n(51418),o=n(112),i=n(85893),a=function(e){var t=e.profileFields,n=t.visible,a=t.not_visible;return(0,i.jsxs)(o.$,{dataTestId:"profile-fields-section",children:[(0,i.jsx)(r.so,{fields:n}),(0,i.jsx)(r.so,{fields:a,isHidden:!0})]})}},68936:(e,t,n)=>{n.d(t,{C:()=>u});var r=n(94184),o=n.n(r),i=n(18605),a=n(85893);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){var t=e.iconType,n=e.iconProps,r=void 0===n?{}:n,s=e.info,c=e.dataTestId,u=e.className,d=void 0===u?"":u,m=e.iconClassName,f=void 0===m?"":m;return s?(0,a.jsxs)("div",{className:o()("profile-drawer__about__block whitespace-pre-line [word-break:break-word]",d),"data-testid":c,children:[t?(0,a.jsx)(i.JO,l({useWithFillCurrentColor:!0,className:o()("text-dark",f),type:t},r)):null," ",(0,a.jsx)("p",{children:s})]}):null}},88437:(e,t,n)=>{n.d(t,{o:()=>a});var r=n(23647),o=n(68936),i=n(85893),a=function(e){var t=e.link,n=e.iconType;return t?(0,i.jsx)(o.C,{iconType:n,info:(0,i.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:(0,r.B)(t)})}):null}},112:(e,t,n)=>{n.d(t,{$:()=>o});var r=n(85893),o=function(e){var t=e.title,n=e.children,o=e.dataTestId;return(0,r.jsxs)("div",{className:"profile-drawer__about__section","data-testid":o,children:[t&&(0,r.jsx)("div",{className:"profile-drawer__about__heading",children:t}),n]})}},36611:(e,t,n)=>{n.d(t,{B:()=>m});var r=n(20640),o=n.n(r),i=n(86013),a=n(50732),s=n(94281),l=n(81786),c=n(69647),u=n(18605),d=n(85893),m=function(e){var t=e.member.public_uid,n=(0,c.p)().success,r=(0,a.zd)({public_uid:t});return(0,d.jsx)(s.T,{placement:"bottom",content:(0,i.t)("post.share.copy_link_to_profile"),interactive:!1,children:(0,d.jsx)("div",{children:(0,d.jsx)(l.z,{type:"button",variant:"secondary","aria-label":(0,i.t)("post.share.copy_link_to_profile"),onClick:function(){o()(window.location.origin+r),n((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},"data-testid":"copy-link-profile",children:(0,d.jsx)(u.JO,{type:"link",size:16,useWithFillCurrentColor:!0})})})})}},30087:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(85893);function o(e){var t=e.title,n=e.subtitle;return(0,r.jsxs)("div",{className:"profile-drawer__empty",children:[(0,r.jsx)("div",{className:"profile-drawer__empty__title",children:t}),(0,r.jsx)("div",{className:"profile-drawer__empty__subtitle",children:n})]})}},388:(e,t,n)=>{n.d(t,{C:()=>I});var r=n(67294),o=n(97762),i=n(98338),a=n(36589),s=n(94184),l=n.n(s),c=n(64660),u=n(22797),d=n(29043),m=n(86013),f=n(96486),p=n(88767),v=n(24185),h=n(74666),b=n(50732),g=n(59887),y=n(18605),_=n(81786),x=n(85893),j=function(e){var t=e.communityMemberId,n=e.closeCard,r=(0,v.k6)(),o=(0,i.wh)().isViewOnlyMasquerading,a=(0,g.pB)().findOrCreateChatRoom,s=(0,p.useMutation)((function(){return a({kind:h.g8,community_member_ids:[t]})}),{onSuccess:function(e){r.push((0,b.co)({url:(0,b.so)({uuid:e})}))}}),l=s.mutate,c=s.isLoading;return(0,x.jsxs)(_.z,{onClick:function(){o?(0,f.noop)():l(),n()},className:"!border-primary flex items-center space-x-2 !px-3 !py-1.5 !font-medium",variant:"secondary",children:[(0,x.jsx)(y.JO,{type:c?"loader":"16-chat",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0}),(0,x.jsx)("span",{children:(0,m.t)("message")})]})},w=n(44073),O=n(75715),S=n(42991),P=n(8246),C=function(e){var t=e.communityMemberId,n=e.publicUid,r=e.messagingEnabled,s=e.avatarURL,m=e.name,f=void 0===m?"":m,p=e.headline,v=void 0===p?"":p,h=e.closeCard,b=(0,c.r)(),g=(0,O.c8)().data,C=(0,i.wh)(),k=C.currentCommunityMember,N=C.currentCommunitySettings,I=(0,a.I)().isV3Enabled,A=Boolean(null===N||void 0===N?void 0:N.gamification_enabled),E=!((null===k||void 0===k?void 0:k.id)===t)&&(null===k||void 0===k?void 0:k.messaging_enabled)&&r,T=(0,w.Y)({member_ids:[t],enabled:A&&I}),M=T.isLoading,L=T.data,R=null===L||void 0===L?void 0:L.find((function(e){return Number(e.community_member_id)===Number(t)})),D=(null===g||void 0===g?void 0:g.enabled)&&I&&A;return(0,x.jsxs)(o.VY,{className:"border-primary bg-primary z-[1059] w-full max-w-[320px] rounded-xl border p-6 shadow-xl",sideOffset:5,side:"right",children:[(0,x.jsxs)("div",{className:l()("flex justify-between",v?"items-start":"items-center"),children:[(0,x.jsxs)("div",{className:"text-dark mr-4 truncate",children:[(0,x.jsx)(P.Z.LabelLg,{weight:"semibold",children:(0,x.jsx)("span",{className:"text-dark",children:f})}),(0,x.jsx)("br",{}),v&&(0,x.jsx)("div",{className:"text-light truncate",children:(0,x.jsx)(P.Z.LabelSm,{weight:"regular",children:(0,x.jsx)("span",{className:"text-light",children:v})})}),D&&(0,x.jsx)("div",{className:"mt-2",children:M?(0,x.jsx)("div",{className:"bg-tertiary mb-2 h-7 w-32 animate-pulse rounded-full text-center text-transparent md:text-left"}):(null===R||void 0===R?void 0:R.current_level)&&(0,x.jsx)(d.U,{level:null===R||void 0===R?void 0:R.current_level,levelName:null===R||void 0===R?void 0:R.current_level_name})})]}),(0,x.jsx)("div",{className:"flex-1",children:(0,x.jsx)(u.i,{avatarUrl:s,name:f,size:"small",progress:null===R||void 0===R?void 0:R.level_progress,level:null===R||void 0===R?void 0:R.current_level})})]}),(0,x.jsx)("div",{className:"mt-4 space-y-2"}),(0,x.jsxs)("div",{className:"mt-4 flex w-full space-x-2",children:[n&&(0,x.jsxs)(_.z,{className:"!border-primary flex items-center justify-center space-x-2 !px-3 !py-1.5 !font-medium",full:!E,variant:"secondary",onClick:function(){b.show({memberPublicId:n}),h()},children:[(0,x.jsx)(y.JO,{type:"16-user",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0}),(0,x.jsx)("span",{children:(0,S.t)("view_profile")})]}),E&&(0,x.jsx)(j,{closeCard:h,communityMemberId:t})]})]})};function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=function(e){var t=e.children,n=e.communityMemberId,s=e.publicUid,l=e.messagingEnabled,c=e.avatarURL,u=e.name,d=void 0===u?"":u,m=e.headline,f=void 0===m?"":m,p=e.disabled,v=void 0!==p&&p,h=k((0,r.useState)(!1),2),b=h[0],g=h[1],y=(0,i.wh)().currentCommunitySettings,_=(0,a.I)().isV3Enabled,j=Boolean(null===y||void 0===y?void 0:y.gamification_enabled);return(0,x.jsxs)(o.fC,{openDelay:300,closeDelay:100,open:b,onOpenChange:g,children:[(0,x.jsx)(o.xz,{asChild:!0,children:(0,x.jsx)("div",{children:t})}),(0,x.jsx)(o.h_,{children:j&&_&&!v&&(0,x.jsx)(C,{communityMemberId:n,publicUid:s,avatarURL:c,name:d,headline:f,messagingEnabled:l,closeCard:function(){return g(!1)}})})]})}},44073:(e,t,n)=>{n.d(t,{Y:()=>a});var r=n(88767),o=n(81089),i=n(50732),a=function(e){var t=e.member_ids,n=e.enabled,a=void 0===n||n;return(0,r.useQuery)(["gamificationMember",t],(function(){return(0,o.UT)(i.av.gamification.members({params:{member_ids:t}}))}),{cacheTime:6e4,enabled:a})}},336:(e,t,n)=>{n.d(t,{N:()=>Pe});var r=n(94184),o=n.n(r),i=n(86013),a=n.n(i),s=n(96486),l=n(80432),c=n(6952),u=n(78417),d=n(57954),m=n(39639),f=n(73890),p=n(42599),v=n(27973),h=n(25830),b=n(54030),g=n(47619),y=n(51418),_=n(43574),x=n(8246),j=n(97082),w=n(68936),O=n(88437),S=n(112),P=n(85893),C=function(e){var t,n=e.member,r=Object.prototype.hasOwnProperty.call(n,"email"),o=(0,y.aL)(),a=(0,y.R1)(),s=(0,h.rV)(),l=(0,v.V)(),c=(0,b.kK)(),u=null===(t=n.member_tags)||void 0===t?void 0:t.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.profile_page)})),C=(null===u||void 0===u?void 0:u.length)>0;return(0,P.jsxs)("div",{className:"profile-drawer__about",children:[!o&&n.bio&&(0,P.jsx)(S.$,{dataTestId:"biography-section",title:(0,i.t)("profile_drawer.biography"),children:(0,P.jsx)(w.C,{info:n.bio,dataTestId:"profile-member-bio"})}),(0,P.jsxs)(S.$,{dataTestId:"profile-info-section",children:[!l&&r&&(0,P.jsx)(w.C,{iconType:"at-symbol",info:n.email,dataTestId:"profile-member-email"}),!o&&(0,P.jsx)(w.C,{iconType:"map-pin",iconProps:{viewBox:"0 0 14 18"},info:n.location,dataTestId:"profile-member-location"}),(0,P.jsx)(w.C,{iconType:"calendar",info:(0,i.t)("profile_drawer.member_since",{member_since:(0,m.ie)(n.created_at,{month:"long",year:"numeric",day:"numeric"})}),dataTestId:"profile-member-since"}),Boolean(n.last_seen_at)&&(0,P.jsx)(w.C,{iconType:"16-clock",info:(0,i.t)("profile_drawer.last_seen",{last_seen:(0,f.TF)(n.last_seen_at)}),iconProps:{viewBox:"0 0 18 18",className:"text-dark ml-0.5 mt-0.5"}})]}),s&&(0,P.jsx)(S.$,{dataTestId:"activity-score-section",children:(0,P.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,P.jsx)(x.Z.LabelSm,{weight:"semibold",children:(0,i.t)("activity_score.activity_score_title")}),(0,P.jsx)(g.XR,{ids:[n.id],children:(0,P.jsx)(d.z4,{memberId:n.id})})]})}),C&&!c&&(0,P.jsx)(S.$,{title:(0,i.t)("profile_drawer.tags"),children:(0,P.jsx)("div",{className:"profile-drawer__about__tags",children:(0,P.jsx)(_.m,{limit:1/0,memberTags:u})})}),a&&(0,P.jsx)(S.$,{title:(0,i.t)("profile_fields.upgrade_flow.title"),children:(0,P.jsx)(y.IA,{})}),o&&(0,P.jsx)(j.s,{profileFields:n.profile_fields}),!o&&(0,p.sR)(n)&&(0,P.jsxs)(S.$,{title:(0,i.t)("profile_drawer.social"),children:[(0,P.jsx)(O.o,{iconType:"globe",link:n.website_url}),(0,P.jsx)(O.o,{iconType:"facebook",link:n.facebook_url}),(0,P.jsx)(O.o,{iconType:"twitter",link:n.twitter_url}),(0,P.jsx)(O.o,{iconType:"linkedin",link:n.linkedin_url}),(0,P.jsx)(O.o,{iconType:"instagram",link:n.instagram_url})]})]})},k=function(){return(0,P.jsx)("div",{className:"p-6",children:(0,P.jsx)(x.Z.LabelSm,{children:(0,i.t)("something_went_wrong")})})};function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(e){return(0,P.jsx)(u.S,{renderFunc:k,children:(0,P.jsx)(C,I({},e))})},T=n(58533),M=n(43227),L=n(8475),R=n(30087),D=n(40160),F=n(32209),U=n(95287),B=n(51705),z=n(50732),H=n(94281),Z=n(34141);function q(e){var t=e.comment,n=e.onClose,r=e.shouldOpenInNewTab,o="tiptap"===t.editor;return(0,P.jsx)(D.rU,{to:(0,z.LM)({slug:t.post_slug,spaceSlug:t.space_slug})+"#comment_wrapper_".concat(t.id),onClick:function(e){return!(0,U.n2)(e)&&n()},className:"profile-comments__item bg-primary focus-visible:outline-secondary hover:outline-secondary flex items-start p-5 transition-colors duration-150 md:px-6",target:r&&"_blank",children:(0,P.jsxs)("div",{className:"profile-comments__content text-darkest flex w-full flex-col space-y-3 text-base",children:[(0,P.jsx)("div",{className:"profile-comments__meta text-default flex flex-row space-x-3 text-sm font-normal",children:(0,P.jsxs)("div",{className:"space-x-2",children:[(0,P.jsxs)("span",{className:"profile-comments__post-name text-default break-all",children:[(0,i.t)("profile_drawer.comments.commented_on")," ",(0,P.jsx)("span",{className:"text-dark font-medium",children:t.post_name||t.post_truncated_content})]}),(0,P.jsx)("span",{className:"bg-badge inline-block h-1 w-1 rounded-full align-middle"}),(0,P.jsx)(H.T,{interactive:!1,content:(0,B.s4)(t.created_at),className:"inline-flex",children:(0,P.jsx)("span",{children:(0,f.TF)(t.created_at,{format:f.lc.short})})})]})}),o?(0,P.jsx)(F.G,{tiptapBody:t.tiptap_body},t.updated_at):(0,P.jsx)(Z.P,{content:t.body_trix_content})]})})}var V=function(e){var t=e.memberPublicId,n=e.member,r=e.onClose,o=e.shouldOpenInNewTab,i=e.scrollableTarget,s=void 0===i?"panel":i,l=(0,L.F)({memberPublicId:t}),c=l.fetchNextPage,u=l.comments,d=l.hasNextPage;return l.isLoading?(0,P.jsx)(M.m,{}):u.length<1?(0,P.jsx)(R.Z,{title:a().t("profile_drawer.comments.empty_state.title"),subtitle:a().t("profile_drawer.comments.empty_state.subtitle")}):(0,P.jsx)("div",{className:"profile-comments bg-tertiary h-full overflow-auto",id:"profile-comments-scrollable-target",children:(0,P.jsx)(T.Z,{scrollThreshold:.5,next:c,hasMore:!!d,loader:(0,P.jsx)(M.m,{}),dataLength:u.length,scrollableTarget:s||"profile-comments-scrollable-target",className:"flex flex-col space-y-2",children:u.map((function(e){return(0,P.jsx)(q,{onClose:r,comment:e,member:n,shouldOpenInNewTab:o},e.id)}))})})},W=n(96070),Q=n(98338),$=n(84710),G=n(67675),J=function(e){var t=e.memberPublicId,n=e.shouldOpenInNewTab,r=e.scrollableTarget,o=void 0===r?"panel":r,a=(0,G.t)({memberPublicId:t}),s=a.fetchNextPage,l=a.posts,c=a.data,u=a.hasNextPage,d=a.isLoading,m=a.onPostChange;if(d)return(0,P.jsx)(M.m,{});if(l.length<1)return(0,P.jsx)(R.Z,{title:(0,i.t)("profile_drawer.posts.empty_state.title"),subtitle:(0,i.t)("profile_drawer.posts.empty_state.subtitle")});var f=null===c||void 0===c?void 0:c.pages.map((function(e){return e.records.map((function(e){return e.id}))}));return(0,P.jsx)($._x,{perPagePostIds:f,children:(0,P.jsx)("div",{className:"profile-posts bg-tertiary h-full overflow-auto",id:"profile-posts-scrollable-target",children:(0,P.jsx)(T.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:s,hasMore:!!u,loader:(0,P.jsx)(M.m,{}),dataLength:l.length,scrollableTarget:o||"profile-posts-scrollable-target",className:"space-y-2",children:l.map((function(e){return(0,P.jsx)(Q.mE,{spaceId:e.space_id,children:(0,P.jsx)(W.Y,{forceSimplifiedView:!0,onPostChange:m,post:e,shouldOpenInNewTab:n},e.id)},e.id)}))})})})},K=n(67142),Y=n(36589),X=n(47774),ee=n(43535),te=function(e){var t=e.member,n=function(e){return e.is_deleted?(0,i.t)("deactivated"):e.admin?(0,i.t)("admin"):e.moderator?(0,i.t)("moderator"):null}(t);return n?(0,P.jsx)("div",{className:o()("text-badge m-0 inline-block select-none overflow-hidden rounded-2xl bg-clip-padding px-2 py-[2px] text-[9px] font-bold uppercase",{"bg-[#ef4444] text-white":t.is_deleted,"bg-brand text-brand-button":!t.is_deleted}),children:n}):null},ne=n(36611),re=n(81786),oe=n(18605),ie=function(e){var t=e.toggleDrawer,n=e.isFullPageProfile,r=e.memberId;return(0,P.jsx)(H.T,{placement:"bottom",content:(0,i.t)("post.share.edit_profile"),interactive:!1,children:(0,P.jsx)(re.z,{variant:"secondary",onClick:function(){n?window.location.href=z.bf.edit({memberId:r}):t()},"aria-label":(0,i.t)("post.share.edit_profile"),children:(0,P.jsx)(oe.JO,{type:"pencil",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0})})})},ae=n(64687),se=n.n(ae),le=n(24185),ce=n(74666),ue=n(59887),de=n(64422),me=n(3764);function fe(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var pe=function(e){var t=e.member,n=e.onSendMessageClick,r=e.isFullPageProfile,a=void 0!==r&&r,s=e.shouldHideMessageButton,l=void 0!==s&&s,c=e.shouldAutoNavigate,u=void 0===c||c,d=(0,ue.pB)().findOrCreateChatRoom,m=(0,le.k6)(),f=(0,me.w)({memberPublicId:t.public_id,member:t,isFullPageProfile:a,shouldHideMessageButton:l}),v=f.shouldShowEditProfileButton,h=f.onClickOpenEditProfileDrawer,b=f.handleCopyProfileLink,g=f.shouldShowMemberChatIcon,y=function(){var e,t=(e=se().mark((function e(t){var r;return se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({kind:ce.g8,community_member_ids:[t]});case 2:r=e.sent,u&&m.push((0,z.co)({url:(0,z.so)({uuid:r})})),n(r);case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){fe(i,r,o,a,s,"next",e)}function s(e){fe(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,P.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",children:[(0,P.jsx)(de.s,{name:null===t||void 0===t?void 0:t.name,size:"16",src:null===t||void 0===t?void 0:t.avatar_url}),(0,P.jsxs)("div",{children:[(0,P.jsx)(x.Z.TitleSm,{weight:"font-bold",textAlign:"text-center",children:null===t||void 0===t?void 0:t.name}),(0,P.jsx)(x.Z.BodySm,{textAlign:"text-center",children:null===t||void 0===t?void 0:t.headline})]}),(0,p.cT)(t)&&(0,P.jsx)(_.m,{limit:1/0,memberTags:t.member_tags}),g&&(0,P.jsx)(re.z,{full:!0,variant:"circle",onClick:function(){return y(t.id)},children:(0,i.t)("message")}),a&&(0,P.jsxs)("div",{className:o()("grid gap-2",{"grid-cols-2":v}),children:[(0,P.jsx)(re.z,{full:!0,variant:"secondary-light",onClick:b,children:(0,i.t)("profile_drawer.dropdown.copy_profile_link")}),v&&(0,P.jsx)(re.z,{full:!0,variant:"secondary-light",onClick:h,children:(0,i.t)("profile_drawer.dropdown.edit_member_profile")})]})]})},ve=n(36970),he=function(e){var t=e.member,n=e.onSendMessageClick,r=e.isFullPageProfile,o=e.shouldHideMessageButton,i=e.shouldOpenInNewTab,a=(0,b.kK)(),s=(0,Y.I)().isV3Enabled,l=(0,me.w)({memberPublicId:t.public_id,member:t,isFullPageProfile:r,shouldHideMessageButton:o}),c=l.shouldShowEditProfileButton,u=l.onClickOpenEditProfileDrawer,d=l.shouldShowMemberChatIcon,m=l.canEditProfile,f=l.canViewOnlyMasquerade;return a?(0,P.jsx)(pe,{member:t,shouldAutoNavigate:!i,onSendMessageClick:n,shouldHideMessageButton:o,isFullPageProfile:r}):(0,P.jsxs)("div",{className:"profile-drawer__header",children:[(0,P.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,P.jsx)(K.sJ,{size:"24",src:t.avatar_url,name:t.name,isFullRounded:s}),(0,P.jsx)("div",{className:"absolute -bottom-2 flex items-center gap-1",children:(0,P.jsx)(te,{member:t})})]}),(0,P.jsxs)("div",{className:"profile-drawer__header__info",children:[(0,P.jsxs)("div",{children:[(0,P.jsx)("h3",{className:"profile-drawer__header__name",children:t.name}),(0,P.jsx)("div",{className:"profile-drawer__header__headline",children:t.headline})]}),(0,P.jsx)(ee.T,{children:(0,P.jsxs)("div",{className:"profile-drawer__header__actions",children:[d&&(0,P.jsx)(X.k,{communityMemberId:t.id,onClick:n,shouldAutoNavigate:!i,variant:f?"icon":"button"}),r?m&&(0,P.jsx)(ie,{toggleDrawer:u,memberId:t.public_id}):(0,P.jsx)(ne.B,{member:t}),f&&(0,P.jsx)(ve.O,{member:t}),c&&(0,P.jsx)(ie,{toggleDrawer:u,memberId:t.public_id})]})})]})]})},be=n(3002),ge=n(38503),ye=n(75149),_e=n(39068),xe=n(9951),je=function(e){var t=e.onClose,n=e.space,r=n.emoji,o=n.custom_emoji_url,a=n.custom_emoji_dark_url,s=n.hide_members_count,l=n.name,c=n.slug,u=n.member_count,d=n.is_private,m=n.show_lock_icon_for_non_members,f=n.is_space_member,p=e.shouldOpenInNewTab,v=(0,ge.TC)().currentAppearance,h=(0,Q.wh)().currentCommunityMember,b=(0,_e.vb)(h),g=(0,ye.$)({shouldShowLockIconForNonMembers:m&&!f,isPrivate:d,isAdmin:b});return(0,P.jsxs)(D.rU,{to:(0,z._v)({spaceSlug:c}),onClick:function(e){return!(0,U.n2)(e)&&t()},className:"profile-spaces__item",target:p&&"_blank",children:[(0,P.jsx)(xe.S,{wrapperClassName:"profile-spaces__emoji self-start",className:"gated-or-not with-emoji",emoji:r,customEmojiUrl:o,customEmojiDarkUrl:a,appearance:v,shouldUseLockIcon:g,lockIcon:(0,P.jsx)("span",{className:"gated-or-not",children:(0,P.jsx)(oe.JO,{type:"lock",useWithFillCurrentColor:!0,className:"text-dark"})})}),(0,P.jsxs)("div",{className:"profile-spaces__details",children:[(0,P.jsx)("p",{className:"profile-spaces__title",children:l}),!s&&(0,P.jsx)("p",{className:"profile-spaces__members",children:(0,i.t)("profiles.members",{count:u})})]})]})},we=function(e){var t=e.memberPublicId,n=e.onClose,r=e.shouldOpenInNewTab,o=e.scrollableTarget,i=void 0===o?"panel":o,a=(0,be.u)({memberPublicId:t}),s=a.spaces,l=a.isLoading,c=a.fetchNextPage,u=a.hasNextPage;return l?(0,P.jsx)(M.m,{}):s.length<1?(0,P.jsx)(R.Z,{title:I18n.t("profile_drawer.spaces.empty_state.title"),subtitle:I18n.t("profile_drawer.spaces.empty_state.subtitle")}):(0,P.jsx)("div",{className:"h-full overflow-auto",id:"profile-spaces-scrollable-target",children:(0,P.jsx)(T.Z,{scrollThreshold:.5,next:c,hasMore:u,loader:(0,P.jsx)(M.m,{}),dataLength:s.length,className:"profile-spaces",scrollableTarget:i||"profile-spaces-scrollable-target",children:s.map((function(e){return(0,P.jsx)(je,{onClose:n,space:e,shouldOpenInNewTab:r},e.id)}))})})},Oe={ABOUT:(0,i.t)("profile_tabs.about"),POSTS:(0,i.t)("profile_tabs.posts"),COMMENTS:(0,i.t)("profile_tabs.comments"),SPACES:(0,i.t)("profile_tabs.spaces")},Se=Object.values(Oe).map((function(e){return{label:e}})),Pe=function(e){var t=e.member,n=e.onClose,r=void 0===n?s.noop:n,i=e.onOpenMessaging,a=e.memberPublicId,u=e.isFullPageProfile,d=e.shouldOpenInNewTab,m=void 0!==d&&d,f=e.shouldHideMessageButton,p=void 0!==f&&f,v=e.shouldHideBadge,h=void 0!==v&&v,b=e.isRenderedOnRailBar,g=void 0!==b&&b,y=e.shouldFixTabsOnTop,_=void 0!==y&&y,x=t.comments_count,j=t.posts_count,w=t.spaces_count,O=h?Se:[{label:Oe.ABOUT},{label:Oe.POSTS,badge:{value:j}},{label:Oe.COMMENTS,badge:{value:x}},{label:Oe.SPACES,badge:{value:w}}],S=u?"panel":null;return(0,P.jsx)("div",{className:o()({"profile-full-page":u,"profile-drawer trix-v2":!u,"flex h-full":t.is_deleted}),children:t.is_deleted?(0,P.jsx)(l.d8,{}):(0,P.jsxs)(c.O.Group,{className:o()("flex flex-col !overflow-hidden",{"!h-[calc(100vh-50px)] md:!h-[calc(100vh-60px)]":!u&&!g,"!h-[calc(100dvh-24px)] md:!h-[calc(100vh-2.5rem-64px)]":g&&!u}),children:[(0,P.jsxs)("div",{className:o()({"sticky top-0 z-30":_}),children:[(0,P.jsx)(he,{member:t,onSendMessageClick:u?s.noop:function(e){i?i(e):r()},isFullPageProfile:u,shouldHideMessageButton:p,shouldOpenInNewTab:m}),(0,P.jsx)("div",{className:"border-primary bg-primary border-b px-6",children:(0,P.jsx)(c.O.List,{children:Object.values(O).map((function(e){return(0,P.jsxs)(c.O,{className:"text-sm",children:[e.label,(0,P.jsx)(c.O.Counter,{children:e.badge&&e.badge.value>0&&e.badge.value})]},e.label)}))})})]}),(0,P.jsxs)(c.O.Panels,{className:o()({"h-full grow":!u}),children:[(0,P.jsx)(c.O.Panel,{children:(0,P.jsx)(E,{member:t})}),(0,P.jsx)(c.O.Panel,{children:(0,P.jsx)(J,{memberPublicId:a,onClose:u?s.noop:r,shouldOpenInNewTab:m,scrollableTarget:S})}),(0,P.jsx)(c.O.Panel,{children:(0,P.jsx)(V,{memberPublicId:a,member:t,onClose:u?s.noop:r,shouldOpenInNewTab:m,scrollableTarget:S})}),(0,P.jsx)(c.O.Panel,{children:(0,P.jsx)(we,{memberPublicId:a,onClose:u?s.noop:r,shouldOpenInNewTab:m,scrollableTarget:S})})]})]})})};Pe.displayName="Profile"},36970:(e,t,n)=>{n.d(t,{O:()=>c});var r=n(86013),o=n(82066),i=n(94281),a=n(81786),s=n(18605),l=n(85893),c=function(e){var t=e.member;return(0,l.jsx)(i.T,{placement:"bottom",content:(0,r.t)("post.share.view_as",{member_first_name:t.first_name}),interactive:!1,children:(0,l.jsx)(a.z,{variant:"secondary",onClick:function(){return(0,o.g)({entityId:t.id,entityType:"CommunityMember"}).then((function(e){return window.open(e.masquerade_url,"_self")})).catch((function(e){return console.error(e)}))},"aria-label":(0,r.t)("post.share.view_as",{member_first_name:t.first_name}),"data-testid":"view-as-masquerade",children:(0,l.jsx)(s.JO,{type:"16-eye-open",size:16,useWithStrokeCurrentColor:!0,"aria-hidden":!0})})})}},3764:(e,t,n)=>{n.d(t,{w:()=>u});var r=n(20640),o=n.n(r),i=n(86013),a=n(98338),s=n(50732),l=n(909),c=n(69647),u=function(e){var t=e.member,n=e.memberPublicId,r=e.isFullPageProfile,u=void 0!==r&&r,d=e.shouldHideMessageButton,m=void 0!==d&&d,f=(0,c.p)().success,p=(0,s.zd)({public_uid:n}),v=(0,l.H)(),h=v.showOwnProfileEdit,b=v.showMemberProfileEdit,g=(0,a.wh)(),y=g.currentCommunityMember,_=g.currentCommunitySettings,x=(null===y||void 0===y?void 0:y.id)==(null===t||void 0===t?void 0:t.id),j=null===y||void 0===y?void 0:y.is_admin;return{shouldShowEditProfileButton:!u&&!(null!==t&&void 0!==t&&t.is_deleted)&&_.account_profile_drawer_enabled&&(x||j),onClickOpenEditProfileDrawer:function(){j?b({member:t}):x&&h()},handleCopyProfileLink:function(){o()(window.location.origin+p),f((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},shouldShowMemberChatIcon:!m&&!(null!==t&&void 0!==t&&t.is_deleted)&&!x&&(null===y||void 0===y?void 0:y.messaging_enabled)&&(t.messaging_enabled||j&&!t.admin),canEditProfile:!(null!==t&&void 0!==t&&t.is_deleted)&&j,canViewOnlyMasquerade:j&&(null===y||void 0===y?void 0:y.id)!==t.id}}},59903:(e,t,n)=>{n.d(t,{o:()=>ut});var r=n(67294),o=n(94184),i=n.n(o),a=n(86013),s=n(96486),l=n(97082),c=n(68936),u=n(88437),d=n(112),m=n(57954),f=n(42599),p=n(27973),v=n(25830),h=n(54030),b=n(47619),g=n(51418),y=n(43574),_=n(8246),x=n(85893),j=function(e){var t,n=e.member,r=Object.prototype.hasOwnProperty.call(n,"email"),o=(0,g.aL)(),i=(0,g.R1)(),s=(0,v.rV)(),j=(0,p.V)(),w=(0,h.kK)(),O=null===(t=n.member_tags)||void 0===t?void 0:t.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.profile_page)})),S=(null===O||void 0===O?void 0:O.length)>0,P=r&&!j;return(0,x.jsxs)("div",{className:"text-dark px-0 py-4 text-sm md:px-6",children:[!o&&n.bio&&(0,x.jsx)(d.$,{dataTestId:"biography-section",title:(0,a.t)("profile_drawer.biography"),children:(0,x.jsx)(c.C,{info:n.bio,dataTestId:"profile-member-bio"})}),(P||n.location)&&(0,x.jsxs)(d.$,{dataTestId:"profile-info-section",children:[!j&&r&&(0,x.jsx)(c.C,{iconType:"at-symbol",info:n.email,dataTestId:"profile-member-email"}),!o&&(0,x.jsx)(c.C,{iconType:"map-pin",iconProps:{viewBox:"0 0 14 18"},info:n.location,dataTestId:"profile-member-location"})]}),s&&(0,x.jsx)(d.$,{dataTestId:"activity-score-section",children:(0,x.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,x.jsx)(_.Z.LabelSm,{weight:"semibold",children:(0,a.t)("activity_score.activity_score_title")}),(0,x.jsx)(b.XR,{ids:[n.id],children:(0,x.jsx)(m.z4,{memberId:n.id})})]})}),S&&!w&&(0,x.jsx)(d.$,{title:(0,a.t)("profile_drawer.tags"),children:(0,x.jsx)("div",{className:"profile-drawer__about__tags",children:(0,x.jsx)(y.m,{limit:1/0,memberTags:O})})}),i&&(0,x.jsx)(d.$,{title:(0,a.t)("profile_fields.upgrade_flow.title"),children:(0,x.jsx)(g.IA,{})}),o&&(0,x.jsx)(l.s,{profileFields:n.profile_fields}),!o&&(0,f.sR)(n)&&(0,x.jsxs)(d.$,{title:(0,a.t)("profile_drawer.social"),children:[(0,x.jsx)(u.o,{iconType:"globe",link:n.website_url}),(0,x.jsx)(u.o,{iconType:"facebook",link:n.facebook_url}),(0,x.jsx)(u.o,{iconType:"twitter",link:n.twitter_url}),(0,x.jsx)(u.o,{iconType:"linkedin",link:n.linkedin_url}),(0,x.jsx)(u.o,{iconType:"instagram",link:n.instagram_url})]})]})},w=n(29043),O=n(2469),S=n(44073),P=n(10950),C=n(75715),k=n(36589),N=n(18605),I=n(81786),A=function(){var e=(0,k.I)().isV3Enabled,t=(0,C.c8)().data,n=(0,O.k)(),r=(0,P.E)(),o=r.member,i=r.isLoading,s=(0,S.Y)({enabled:!i,member_ids:[null===o||void 0===o?void 0:o.id]}).data,l=null===s||void 0===s?void 0:s[0];return null!==t&&void 0!==t&&t.enabled&&e?(0,x.jsxs)("div",{className:"border-primary mb-0 block border-b pb-4 md:m-6 md:pb-6",children:[i||!l?(0,x.jsx)("div",{className:"bg-tertiary h-6 w-32 animate-pulse rounded-full text-center text-transparent md:text-left"}):(0,x.jsx)(w.U,{level:null===l||void 0===l?void 0:l.current_level,levelName:null===l||void 0===l?void 0:l.current_level_name}),(0,x.jsx)("br",{}),l&&(0,x.jsx)(I.z,{type:"button",variant:"text",className:"md:flex",onClick:function(){return n.show()},children:(0,x.jsx)(_.Z.LabelXs,{weight:"regular",children:(0,x.jsxs)("div",{className:"text-light",children:[0===l.points_to_next_level?(0,a.t)("leaderboard.maxed_out"):(0,a.t)("leaderboard.n_points_to_level_up",{count:null===l||void 0===l?void 0:l.points_to_next_level}),(0,x.jsx)(N.JO,{type:"question-mark",className:"text-light ml-1 !w-3"})]})})})]}):null},E=function(){var e=(0,P.E)().member;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(A,{}),(0,x.jsx)(j,{member:e})]})},T=n(58533),M=n(43227),L=n(8475);function R(e){var t=e.title,n=e.subtitle;return(0,x.jsxs)("div",{className:"profile-drawer__empty",children:[(0,x.jsx)("div",{className:"profile-drawer__empty__title",children:t}),(0,x.jsx)("div",{className:"profile-drawer__empty__subtitle",children:n})]})}var D=n(67142),F=n(49546),U=n(40160),B=n(32209),z=n(42991),H=n(51705),Z=n(50732),q=n(94281),V=n(34141),W=function(e){var t=e.comment,n=e.onClose,r=e.member,o=(0,F.default)(new Date(t.created_at),"MMM dd");return(0,x.jsxs)(U.rU,{to:(0,Z.LM)({slug:t.post_slug,spaceSlug:t.space_slug})+"#comment_wrapper_".concat(t.id),onClick:n,className:"flex items-start space-x-3 py-5 first:pt-0",children:[(0,x.jsx)("div",{className:"mt-1",children:(0,x.jsx)(D.sJ,{isFullRounded:!0,name:r.name,src:r.avatar_url,size:"10"})}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"flex w-full items-center justify-between space-x-2",children:[(0,x.jsxs)("div",{className:"text-default w-full flex-1 truncate text-sm",children:[(0,z.t)("profile_drawer.comments.commented_on")," ",(0,x.jsx)("span",{className:"text-darkest font-medium",children:t.post_name||t.post_truncated_content})]}),(0,x.jsx)("div",{children:(0,x.jsx)(q.T,{interactive:!1,content:(0,H.s4)(t.created_at),children:(0,x.jsx)("span",{className:"text-default text-sm",children:o})})})]}),"tiptap"===t.editor?(0,x.jsx)(B.G,{tiptapBody:t.tiptap_body},t.updated_at):(0,x.jsx)(V.P,{content:t.body_trix_content})]})]})},Q=function(){var e=(0,P.E)(),t=e.member,n=e.onClose,r=e.isFullPageView,o=(0,L.F)({memberPublicId:t.public_uid}),i=o.fetchNextPage,s=o.comments,l=o.hasNextPage;return o.isLoading?(0,x.jsx)(M.m,{}):s.length<1?(0,x.jsx)(R,{title:(0,a.t)("profile_drawer.comments.empty_state.title"),subtitle:(0,a.t)("profile_drawer.comments.empty_state.subtitle")}):(0,x.jsx)(T.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:i,hasMore:!!l,loader:(0,x.jsx)(M.m,{}),dataLength:s.length,scrollableTarget:r?"panel":tt,className:"divide-primary space-y-2 divide-y",children:s.map((function(e){return(0,x.jsx)(W,{onClose:function(){return null===n||void 0===n?void 0:n()},comment:e,member:t},e.id)}))})},$=n(96070),G=n(71179),J=n(98338),K=n(84710),Y=n(67675),X=function(){var e=(0,P.E)(),t=e.member,n=e.isFullPageView,r=(0,Y.t)({memberPublicId:t.public_uid}),o=r.fetchNextPage,i=r.posts,s=r.data,l=r.hasNextPage,c=r.isLoading,u=r.onPostChange;if(c)return(0,x.jsx)(M.m,{});if(i.length<1)return(0,x.jsx)(R,{title:(0,a.t)("profile_drawer.posts.empty_state.title"),subtitle:(0,a.t)("profile_drawer.posts.empty_state.subtitle")});var d=null===s||void 0===s?void 0:s.pages.map((function(e){return e.records.map((function(e){return e.id}))}));return(0,x.jsx)(K._x,{perPagePostIds:d,children:(0,x.jsx)(G.Fk,{hasNextPage:!!l,children:(0,x.jsx)(T.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:o,hasMore:!!l,loader:(0,x.jsx)(M.m,{}),dataLength:i.length,scrollableTarget:n?"panel":tt,className:"space-y-2",children:i.map((function(e){return(0,x.jsx)(J.mE,{spaceId:e.space_id,children:(0,x.jsx)($.Y,{onPostChange:u,post:e,shouldForceSamePageInteractions:!0,className:"!rounded-2xl"},e.id)},e.id)}))})})})},ee=n(22797),te=n(64687),ne=n.n(te),re=n(24185),oe=n(35102),ie=n(36611),ae=n(36970),se=n(3764),le=n(43535),ce=n(59887),ue=n(74666);function de(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var me=function(){var e=(0,P.E)().member,t=(0,J.wh)().isViewOnlyMasquerading,n=(0,ce.pB)().findOrCreateChatRoom,r=(0,oe.nC)().setLiveChatRoomUuid,o=(0,re.k6)(),i=(0,se.w)({memberPublicId:e.public_id,member:e,isFullPageProfile:!1,shouldHideMessageButton:!1}),l=i.shouldShowEditProfileButton,c=i.onClickOpenEditProfileDrawer,u=i.shouldShowMemberChatIcon,d=i.canViewOnlyMasquerade,m=function(){var t,i=(t=ne().mark((function t(){var i;return ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n({kind:ue.g8,community_member_ids:[e.id]});case 2:if(i=t.sent,!o.location.pathname.includes("/live")){t.next=7;break}return r(i),t.abrupt("return");case 7:o.push((0,Z.co)({url:(0,Z.so)({uuid:i})}));case 8:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){de(i,r,o,a,s,"next",e)}function s(e){de(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return i.apply(this,arguments)}}();return(0,x.jsx)(le.T,{children:(0,x.jsxs)("div",{className:"flex space-x-3",children:[u&&(0,x.jsx)(I.z,{onClick:t?s.noop:m,variant:"circle","data-testid":"chat-button",children:(0,a.t)("message")}),l&&(0,x.jsx)(I.z,{variant:"secondary",onClick:c,"aria-label":(0,a.t)("post.share.edit_profile"),children:(0,x.jsx)(N.JO,{type:"pencil",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0})}),(0,x.jsx)(ie.B,{member:e}),d&&(0,x.jsx)(ae.O,{member:e})]})})};function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var he=function(e){var t=e.iconType,n=e.iconProps,r=void 0===n?{}:n,o=e.info,a=e.dataTestId,s=e.className,l=void 0===s?"":s,c=e.iconClassName,u=void 0===c?"":c,d=e.color,m=void 0===d?"text-default":d;return o?(0,x.jsxs)("div",{className:i()("flex items-start space-x-1.5 whitespace-pre-line [word-break:break-word]",l),"data-testid":a,children:[t?(0,x.jsx)(N.JO,pe({useWithFillCurrentColor:!0,className:u,type:t,size:16},r)):null," ",(0,x.jsx)(_.Z.LabelSm,{color:m,weight:"regular",children:o})]}):null},be=n(39639),ge=n(73890),ye=function(){var e,t=(0,P.E)(),n=t.member,r=t.isLoading,o=(0,h.ef)(),s=(0,S.Y)({enabled:!r,member_ids:[null===n||void 0===n?void 0:n.id]}).data,l=null===s||void 0===s?void 0:s[0],c=null===n||void 0===n||null===(e=n.member_tags)||void 0===e?void 0:e.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.profile_page)})),u=(null===c||void 0===c?void 0:c.length)>0;return(0,x.jsxs)("div",{className:"flex flex-col items-center md:flex-row md:items-start md:space-x-5 md:pt-0","data-testid":"profile-modal-header",children:[(0,x.jsx)(ee.i,{name:n.name,avatarUrl:n.avatar_url,size:"large",level:null===l||void 0===l?void 0:l.current_level,progress:null===l||void 0===l?void 0:l.level_progress}),(0,x.jsxs)("div",{className:"mt-6 flex flex-1 flex-col items-center md:mt-0 md:items-start",children:[(0,x.jsxs)("div",{className:i()("flex flex-1 flex-row justify-between md:w-full",n.headline?"items-start":"items-end"),children:[(0,x.jsxs)("div",{className:"overflow-anywhere flex flex-col items-center space-y-1 md:min-w-[5rem] md:items-start","data-testid":"member-information",children:[(0,x.jsx)(_.Z.LabelLg,{weight:"semibold",color:"text-dark","data-testid":"member-name",children:n.name}),n.headline&&(0,x.jsx)(_.Z.LabelSm,{weight:"regular",color:"text-dark","data-testid":"member-headline",children:n.headline})]}),!o&&(0,x.jsx)(me,{})]}),(0,x.jsxs)("div",{className:"mt-2 flex flex-col items-center space-x-4 space-y-1 md:flex-row md:space-y-0",children:[n.last_seen_at&&(0,x.jsx)(he,{iconType:"16-clock",info:(0,a.t)("profile_drawer.last_seen",{last_seen:(0,ge.TF)(n.last_seen_at)}),dataTestId:"profile-member-email",className:"text-light"}),(0,x.jsx)(he,{iconType:"16-calendar",info:(0,a.t)("profile_drawer.member_since",{member_since:(0,be.ie)(n.created_at,{month:"long",year:"numeric",day:"numeric"})}),dataTestId:"profile-member-since",className:"text-light"})]}),u&&(0,x.jsx)("div",{className:"pt-3",children:(0,x.jsx)(y.m,{limit:1/0,memberTags:c})}),o&&(0,x.jsx)("div",{className:"mt-4",children:(0,x.jsx)(me,{})})]})]})},_e=n(30087),xe=n(23855),je=n(88767),we=n(81089),Oe=n(81649);function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){Ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ke="rewards",Ne=function(e){var t=[ke,e],n=(0,je.useInfiniteQuery)(t,(function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,we.UT)(Oe.a.gamification.pointAwards({params:{member_id:e,page:n}}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),o=(0,r.useMemo)((function(){var e,t;return n.isLoading?[]:(0,s.uniqBy)((0,s.flatten)(null!==(e=null===(t=n.data)||void 0===t?void 0:t.pages.map((function(e){return e.records})))&&void 0!==e?e:[]),(function(e){return"".concat(e.id,"-").concat(e.event_name)}))}),[n.data]);return Pe(Pe({},n),{},{rewards:o})},Ie=n(39068),Ae=n(36298),Ee=n(69647),Te=n(27025),Me=n(82177),Le="profile_drawer.rewards",Re=function(e){var t=e.isOpen,n=e.onClose,r=e.onConfirm,o=e.points,i=e.isLoading;return(0,x.jsxs)(Me.u_,{isOpen:t,onClose:n,children:[(0,x.jsx)(Me.u_.Overlay,{}),(0,x.jsxs)(Me.u_.Content,{size:"md",children:[(0,x.jsx)(Me.u_.Header,{children:(0,x.jsx)(Me.u_.Title,{children:(0,z.t)("".concat(Le,".revoke_confirmation.title"))})}),(0,x.jsx)(Me.u_.Body,{children:(0,x.jsx)("div",{className:"flex flex-col gap-4",children:(0,x.jsx)(_.Z.BodyMd,{color:"text-default",children:(0,z.t)("".concat(Le,".revoke_confirmation.description"),{points:Math.abs(o)})})})}),(0,x.jsx)(Me.u_.Footer,{children:(0,x.jsxs)("div",{className:"flex justify-end gap-x-3",children:[(0,x.jsx)(I.z,{variant:"secondary",onClick:n,children:(0,z.t)("cancel")}),(0,x.jsx)(I.z,{onClick:r,disabled:i,children:(0,z.t)("".concat(Le,".revoke_confirmation.confirm"))})]})})]})]})};function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ue="profile_drawer.rewards",Be=function(e){var t,n,o=e.reward,i=(0,J.wh)().currentCommunityMember,a=De((0,r.useState)(!1),2),s=a[0],l=a[1],c=(0,Ee.p)(),u=o.points,d=o.triggered_at,m=o.reason,f=o.id,p=o.event_name,v=o.revoked,h=(0,xe.default)(d),b=(0,Ae.w)({dateTime:h,format:Ae.f.short_month_and_date_with_year}),g=(t={pointAwardId:f}.pointAwardId,n=(0,je.useQueryClient)(),(0,je.useMutation)({mutationFn:function(){return(0,we.pC)(Oe.a.gamification.revokePointAward({pointAwardId:t}))},onSuccess:function(){n.invalidateQueries({queryKey:[ke]})}})),y=g.mutate,j=g.isLoading,w="gamification.member.points_revoked"===p,O=(0,Ie.vb)(i);return(0,x.jsxs)("div",{className:"border-primary mt-3 flex items-center justify-between border-b pb-3 pt-2 first:mt-0 last:border-b-0",children:[(0,x.jsxs)("div",{className:"flex flex-col",children:[(0,x.jsx)("div",{children:(0,x.jsx)(_.Z.LabelSm,{weight:"semibold",color:"text-dark",children:(0,z.t)("".concat(Ue,".n_points"),{points:w?"-"+u:"+"+u})})}),(0,x.jsxs)("div",{className:"text-default flex items-center gap-1",children:[(0,x.jsx)("div",{children:(0,x.jsx)(_.Z.LabelSm,{weight:"regular",color:"text-default",children:(0,z.t)("".concat(Ue,".").concat(w?"revoked":"rewarded"),{date:b})})}),o.reason&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"text-[10px]",children:(0,z.t)("separator_dot")}),(0,x.jsx)(_.Z.LabelSm,{weight:"regular",color:"text-default",children:m})]})]})]}),!w&&!v&&O&&(0,x.jsx)(Te.Lt,{buttonClassName:"flex items-center h-9 w-9 flex justify-center !rounded-lg p-1 transition-colors duration-150 hover:bg-tertiary focus-visible:outline-secondary focus-visible:rounded-lg focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:bg-tertiary",button:(0,x.jsx)(N.JO,{className:"text-default",type:"20-menu-dots-horizontal",size:20,"aria-label":(0,z.t)("".concat(Ue,".actions"))}),children:(0,x.jsx)(Te.Lt.ItemLink,{onClick:function(){return l(!0)},forceClose:!0,children:(0,z.t)("".concat(Ue,".revoke_points"))})}),(0,x.jsx)(Re,{isOpen:s,onClose:function(){return l(!1)},onConfirm:function(){y(void 0,{onSuccess:function(){c.success((0,z.t)("".concat(Ue,".revoke_success"))),l(!1)},onError:function(){c.error((0,z.t)("".concat(Ue,".revoke_error")))}})},points:u,isLoading:j})]})},ze=function(){var e=(0,P.E)(),t=e.member,n=e.isFullPageView,r=Ne(t.id),o=r.rewards,i=r.fetchNextPage,a=r.hasNextPage;return r.isLoading?(0,x.jsx)(M.m,{}):o.length<1?(0,x.jsx)(_e.Z,{title:(0,z.t)("profile_drawer.rewards.empty_state.title"),subtitle:(0,z.t)("profile_drawer.rewards.empty_state.subtitle")}):(0,x.jsx)(T.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:i,hasMore:!!a,loader:(0,x.jsx)(M.m,{}),dataLength:o.length,scrollableTarget:n?"panel":tt,children:o.map((function(e){return(0,x.jsx)(Be,{reward:e},e.id+e.event_name)}))})},He=n(3002),Ze=n(38503),qe=n(75149),Ve=n(95287),We=n(9951),Qe=function(e){var t=e.onClose,n=e.space,r=n.emoji,o=n.custom_emoji_url,i=n.custom_emoji_dark_url,s=n.hide_members_count,l=n.name,c=n.slug,u=n.member_count,d=n.is_private,m=n.show_lock_icon_for_non_members,f=n.is_space_member,p=(0,Ze.TC)().currentAppearance,v=(0,J.wh)().currentCommunityMember,h=(0,Ie.vb)(v),b=(0,qe.$)({shouldShowLockIconForNonMembers:m&&!f,isPrivate:d,isAdmin:h});return(0,x.jsxs)(U.rU,{to:(0,Z._v)({spaceSlug:c}),onClick:function(e){return!(0,Ve.n2)(e)&&t()},className:"hover:bg-secondary bg-primary flex items-center space-x-3 rounded-md px-4 py-3.5",children:[(0,x.jsx)(We.S,{wrapperClassName:"profile-spaces__emoji self-start",className:"gated-or-not with-emoji",emoji:r,customEmojiUrl:o,customEmojiDarkUrl:i,appearance:p,shouldUseLockIcon:b,lockIcon:(0,x.jsx)("span",{className:"gated-or-not",children:(0,x.jsx)(N.JO,{type:"lock",useWithFillCurrentColor:!0,className:"text-dark"})})}),(0,x.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,x.jsx)("span",{className:"text-darkest leading-none",children:(0,x.jsx)(_.Z.LabelMd,{weight:"semibold",children:l})}),!s&&(0,x.jsx)("span",{className:"text-light leading-none",children:(0,x.jsx)(_.Z.LabelSm,{children:(0,a.t)("profiles.members",{count:u})})})]})]})},$e=function(){var e=(0,P.E)(),t=e.member,n=e.onClose,r=e.isFullPageView,o=(0,He.u)({memberPublicId:t.public_uid}),i=o.spaces,s=o.isLoading,l=o.fetchNextPage,c=o.hasNextPage;return s?(0,x.jsx)(M.m,{}):i.length<1?(0,x.jsx)(R,{title:(0,a.t)("profile_drawer.spaces.empty_state.title"),subtitle:(0,a.t)("profile_drawer.spaces.empty_state.subtitle")}):(0,x.jsx)(T.Z,{scrollThreshold:.5,next:l,hasMore:!!c,loader:(0,x.jsx)(M.m,{}),dataLength:i.length,scrollableTarget:r?"panel":tt,children:i.map((function(e){return(0,x.jsx)(Qe,{onClose:function(){return null===n||void 0===n?void 0:n()},space:e},e.id)}))})},Ge=n(75357),Je=n(70254),Ke=function(e){var t=e.title,n=e.isActive,r=e.onClick,o=e.count;return(0,x.jsx)("button",{type:"button",className:i()("bg-primary border-primary hover:bg-secondary focus-visible:outline-secondary text-darkest cursor-pointer rounded-full border px-4 py-2 text-sm transition-colors duration-75 focus-visible:rounded-full focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"border-secondary":n}),onClick:r,children:(0,x.jsxs)(_.Z.LabelSm,{color:"text-darkest",weight:"medium",children:[t,(0,s.isNumber)(o)&&(0,x.jsx)("span",{className:"ml-1",children:o})]})})};function Ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var et=["posts","comments","spaces","about","rewards"],tt="profile-modal-scrollable-target",nt=function(){var e=(0,h.ef)(),t=(0,P.E)(),n=t.member,o=t.isFullPageView,l=(0,J.wh)(),c=l.currentCommunitySettings,u=l.currentCommunityMember,d=null===c||void 0===c?void 0:c.gamification_enabled,m=(0,Ge.S)(),f=Ye((0,r.useState)(e?"about":"posts"),2),p=f[0],v=f[1],b=(0,C.c8)().data,g=(null===u||void 0===u?void 0:u.id)===n.id,y=(0,Ie.vb)(u),_=d&&m&&(g||(null===b||void 0===b?void 0:b.is_member_rewards_tab_public)||y),j={posts:X,comments:Q,spaces:$e,about:E,rewards:_?ze:function(){return null}}[p],w=(0,Je.t)().tab;return(0,r.useEffect)((function(){var e;(0,s.isString)(w)&&(e=w,-1!==et.findIndex((function(t){return t===e})))&&v(w)}),[w]),(0,x.jsxs)("div",{className:i()("bg-primary flex flex-col overflow-auto",{"border-primary w-full rounded-xl border p-4 md:w-2/3 md:p-8":o,"col-span-12 md:col-span-9":!o}),children:[(0,x.jsx)(ye,{}),(0,x.jsxs)("div",{className:"my-6 flex items-center space-x-2 overflow-x-auto","data-testid":"tab-list",children:[e&&(0,x.jsx)(Ke,{onClick:function(){return v("about")},title:(0,a.t)("profile_drawer.about"),isActive:"about"===p}),(0,x.jsx)(Ke,{onClick:function(){return v("posts")},title:(0,a.t)("profile_drawer.posts.title"),isActive:"posts"===p,count:n.posts_count}),(0,x.jsx)(Ke,{onClick:function(){return v("comments")},title:(0,a.t)("profile_drawer.comments.title"),isActive:"comments"===p,count:n.comments_count}),(0,x.jsx)(Ke,{onClick:function(){return v("spaces")},title:(0,a.t)("profile_drawer.spaces.title"),isActive:"spaces"===p,count:n.spaces_count}),_&&(0,x.jsx)(Ke,{onClick:function(){return v("rewards")},title:(0,a.t)("profile_drawer.rewards.title"),isActive:"rewards"===p})]}),(0,x.jsx)("div",{id:tt,className:"flex-1 overflow-auto pb-6","data-testid":"profile-modal-tab-content",children:(0,x.jsx)(j,{})})]})},rt=function(){var e=(0,P.E)(),t=e.isLoading,n=e.isFullPageView;return t?null:(0,x.jsx)("div",{className:i()("border-primary bg-primary mb-9 hidden overflow-auto rounded-2xl border md:block",n?"w-1/3":"col-span-3"),children:(0,x.jsx)(E,{})})},ot=n(45188),it=function(){return(0,x.jsxs)("div",{className:"flex items-center space-x-5",children:[(0,x.jsx)("div",{className:"bg-tertiary h-[104px] w-[104px] animate-pulse rounded-full duration-300"}),(0,x.jsxs)("div",{className:"flex flex-1 items-start justify-between",children:[(0,x.jsxs)("div",{className:"flex flex-col",children:[(0,x.jsx)("div",{className:"bg-tertiary h-6 w-32 animate-pulse rounded-md duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary mt-1 h-5 w-20 animate-pulse rounded-md duration-300"}),(0,x.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[(0,x.jsx)("div",{className:"bg-tertiary h-5 w-24 animate-pulse rounded-md duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-5 w-44 animate-pulse rounded-md duration-300"})]})]}),(0,x.jsxs)("div",{className:"flex items-center justify-between space-x-3",children:[(0,x.jsx)("div",{className:"bg-tertiary h-[34px] w-24 animate-pulse rounded-full duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-[34px] w-[58px] animate-pulse rounded-full duration-300"})]})]})]})},at=function(){return(0,x.jsxs)("div",{className:"border-primary rounded-xl border px-5 pt-6",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,x.jsx)("div",{className:"bg-tertiary h-10 w-10 animate-pulse rounded-full"}),(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsx)("div",{className:"bg-tertiary h-5 w-36 animate-pulse rounded-md duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-3 w-20 animate-pulse rounded-md duration-300"})]})]}),(0,x.jsxs)("div",{className:"mb-5 mt-10 space-y-3",children:[(0,x.jsx)("div",{className:"bg-tertiary h-3 w-full animate-pulse rounded-md duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-3 w-full animate-pulse rounded-md duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-3 w-64 animate-pulse rounded-md duration-300"})]}),(0,x.jsxs)("div",{className:"border-primary -mx-5 flex h-12 items-center justify-between space-x-2 border-t px-5",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,x.jsx)("div",{className:"bg-tertiary h-6 w-6 animate-pulse rounded-md duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-6 w-6 animate-pulse rounded-md duration-300"})]}),(0,x.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,x.jsx)("div",{className:"bg-tertiary h-6 w-12 animate-pulse rounded-md duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-6 w-16 animate-pulse rounded-md duration-300"})]})]})]})},st=function(){return(0,x.jsxs)("div",{className:"border-primary col-span-3 mb-9 hidden overflow-auto rounded-2xl border p-6 md:block",children:[(0,x.jsx)("div",{className:"bg-tertiary mb-2 h-[28px] w-[124px] animate-pulse rounded-full duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-4 w-32 animate-pulse rounded-md duration-300"}),(0,x.jsx)("div",{className:"border-primary mt-6 h-px border-b"}),(0,x.jsxs)("div",{className:"space-y-8 py-4",children:[(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsx)("div",{className:"bg-tertiary h-5 w-[105px] animate-pulse rounded duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-5 w-[160px] animate-pulse rounded duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-5 w-[120px] animate-pulse rounded duration-300"})]}),(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsx)("div",{className:"bg-tertiary h-5 w-[105px] animate-pulse rounded duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-[30px] w-[110px] animate-pulse rounded-full duration-300"})]}),(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsx)("div",{className:"bg-tertiary h-5 w-[105px] animate-pulse rounded duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-5 w-10 animate-pulse rounded duration-300"})]}),(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsx)("div",{className:"bg-tertiary h-5 w-[105px] animate-pulse rounded duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-5 w-10 animate-pulse rounded duration-300"})]})]})]})},lt=function(){return(0,x.jsxs)("div",{className:"my-6 flex items-center space-x-2",children:[(0,x.jsx)("div",{className:"bg-tertiary w-18 h-[38px] animate-pulse rounded-full duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-[38px] w-[106px] animate-pulse rounded-full duration-300"}),(0,x.jsx)("div",{className:"bg-tertiary h-[38px] w-[84px] animate-pulse rounded-full duration-300"})]})},ct=function(){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"col-span-12 flex flex-col overflow-auto pb-9 md:col-span-9",children:[(0,x.jsx)(it,{}),(0,x.jsx)("div",{className:"border-primary mt-5 h-px border-b"}),(0,x.jsx)(lt,{}),(0,x.jsx)(at,{})]}),(0,x.jsx)(st,{})]})},ut=function(e){var t=e.member,n=e.isLoading,r=e.isFullPageView,o=void 0!==r&&r,i=e.onClose;return(0,x.jsx)(P.w,{isFullPageView:o,member:t,isLoading:n,onClose:i,children:t?t.is_deleted?(0,x.jsx)(ot.d,{wrapperClassName:"text-dark"}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(nt,{}),(0,x.jsx)(rt,{})]}):(0,x.jsx)(ct,{})})}},10950:(e,t,n)=>{n.d(t,{E:()=>s,w:()=>l});var r=n(67294),o=n(96486),i=n(85893),a=(0,r.createContext)({member:null,isLoading:!0,isFullPageView:!1,onClose:function(){}});a.displayName="ProfileContext";var s=function(){return(0,r.useContext)(a)},l=function(e){var t=e.member,n=e.isFullPageView,r=void 0!==n&&n,s=e.isLoading,l=e.children,c=e.onClose,u=void 0===c?o.noop:c;return(0,i.jsx)(a.Provider,{value:{member:t,isLoading:s,isFullPageView:r,onClose:u},children:l})}},20036:(e,t,n)=>{n.d(t,{M:()=>p});var r=n(67294),o=n(31736),i=n(86013),a=n(96486),s=n(22404),l=n(15953),c=n(18605),u=n(81786),d=n(85893);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t=e.cancelButtonText,n=void 0===t?(0,i.t)("quick_post.scheduled_post_ui.cancel"):t,f=e.children,p=e.className,v=e.datePickerVisible,h=e.minDate,b=void 0===h?new Date:h,g=e.onCancel,y=e.onClickOutside,_=e.onSave,x=e.placement,j=void 0===x?"top-end":x,w=e.saveButtonVariant,O=void 0===w?"primary":w,S=e.value,P=m((0,r.useState)(S),2),C=P[0],k=P[1];return(0,d.jsx)(o.ZP,{placement:j,className:p,onClickOutside:y,content:(0,d.jsxs)("div",{className:"bg-primary border-primary rounded-lg border shadow-xl",style:{maxWidth:"284px"},children:[(0,d.jsx)(l.Z,{options:{enableTime:!0,dateFormat:"F d, Y G:i K",disableMobile:!0,inline:!0,altInput:!0,altInputClass:"hidden",minDate:b,animate:!1,prevArrow:(0,s.renderToString)((0,d.jsx)(c.JO,{type:"20-chevron-left",size:20})),nextArrow:(0,s.renderToString)((0,d.jsx)(c.JO,{type:"20-chevron-right",size:20})),minuteIncrement:1},value:S,onValueUpdate:function(e){(0,a.first)(e)&&k(e[0].toISOString())}}),(0,d.jsxs)("div",{className:"border-primary flex gap-3 border-t px-5 py-3",children:[(0,d.jsx)(u.z,{type:"button",variant:"secondary",onClick:g,full:!0,children:n}),(0,d.jsx)(u.z,{type:"button",variant:O,disabled:!C,onClick:function(e){e&&e.preventDefault(),_(C)},full:!0,children:(0,i.t)("quick_post.scheduled_post_ui.save")})]})]}),visible:v,allowHTML:!0,interactive:!0,duration:0,arrow:!1,delay:0,theme:"modal-footer-actions",appendTo:"parent",children:(0,d.jsx)("div",{children:f})})}},65631:(e,t,n)=>{n.d(t,{Y:()=>je});var r=n(64687),o=n.n(r),i=n(86013),a=n(96486),s=n(24185),l=n(34334),c=n(74666),u=n(51705),d=n(93144),m=n(98338),f=n(67687),p=n(13288),v=n(69647),h=n(67294),b=n(87536),g=n(81786),y=n(85893),_=function(e){var t=e.submitDisabled,n=e.post,r=e.isSubmitting,o=!!n.id,a=["quick_post","scheduled_post_ui"];a.push(r?"submitting_button":"submit_button"),n.status!==u.lv?a.push("publish_post"):a.push(o?"save":"post");var s=(0,i.t)(a.join("."));return(0,y.jsx)(g.z,{type:"submit",variant:"primary",disabled:t,children:s})},x=n(90789),j=n(54030),w=n(94184),O=n.n(w),S=n(20036),P=n(1881),C=n(36298),k=n(18605),N=n(5057);function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t=e.publishedAt,n=e.updatePublishedAt,r=e.status,o=e.revertToDraftState,i=I((0,P.k)(!1),3),a=i[0],s=i[1],l=i[2],c=(0,h.useMemo)((function(){return t?(0,C.w)({dateTime:new Date(t),format:"date_time_with_short_timezone"}):null}),[t]);if(r!==u.W3)return null;return(0,y.jsx)(S.M,{value:t,datePickerVisible:a,onCancel:function(){event&&event.preventDefault(),l(!1)},onSave:function(e){n(e),l(!1)},children:(0,y.jsx)(N.C,{onButtonClick:function(e){e&&e.preventDefault(),s()},onClick:function(e){e&&e.preventDefault(),o(),l(!1)},children:(0,y.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,y.jsx)(k.JO,{type:"16-calendar",className:"text-default",size:16}),(0,y.jsx)("span",{className:"font-medium",children:c})]})})})},T=n(93526);function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=function(e){var t=e.submitDisabled,n=void 0!==t&&t,r=e.isSubmitting,o=void 0!==r&&r,s=e.datepickerPlacement,l=void 0===s?"top":s,c=function(e){var t=["quick_post","scheduled_post_ui"];return t.push(o?"submitting_button":"submit_button"),t.push(e),(0,i.t)(t.join("."))},u={icon:"16-download",label:c("save_draft"),value:"draft"},d={icon:"16-calendar",label:c("schedule_post"),value:"scheduled"},m={icon:"16-publish",label:c("publish_post"),value:"published"},f=[u,d,m],p=(0,b.Gc)(),v=p.watch,h=p.setValue,g=v(),_=g.published_at,x=g.status,j=M((0,P.k)(!1),3),w=j[0],C=j[2],k=(0,a.find)(f,{value:x}),N=function(e){h("published_at",e)},I=function(e){(null===e||void 0===e?void 0:e.value)===d.value?C(!0):(h("status",null===e||void 0===e?void 0:e.value),C(!1),N(null))},A=function(){I(u)};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(E,{publishedAt:_,updatePublishedAt:N,status:x,revertToDraftState:A}),(0,y.jsx)(S.M,{datePickerVisible:w,onCancel:function(e){e&&e.preventDefault(),C(!1),x===d.value&&A()},value:_,onSave:function(e){N(e),h("status",d.value),C(!1)},className:O()({"-bottom-11":"top"===l,"-top-7":"bottom"===l}),children:w?(0,y.jsx)("span",{}):(0,y.jsx)(T.F,{type:"submit",disabled:n,selectedAction:k,setSelectedAction:I,options:f})})]})},D=function(e){var t=e.post,n=e.space,r=e.submitDisabled,o=e.isSubmitting,i=e.datepickerPlacement,a=!(0,j.Fs)()&&n&&(0,x.k8)(n)&&!(0,u.Hz)(t);return(0,y.jsx)(y.Fragment,{children:a?(0,y.jsx)(R,{submitDisabled:r,isSubmitting:o,datepickerPlacement:i}):(0,y.jsx)(_,{post:t,submitDisabled:r,isSubmitting:o})})},F=n(64419),U=n(92694),B=n(957),z=n(80023),H=n(24590),Z=n(62057),q=n(32282),V=n(10647),W=n(23127),Q=n(94347),$=function(e){var t=e.space,n=e.showAddCoverBtn,r=(0,(0,b.Gc)().watch)("id")?void 0:(0,Q.k)();return(0,y.jsxs)("div",{className:"quickpost-modal__post-form",children:[(0,u.J4)(t)&&(0,y.jsx)("div",{className:"quickpost-modal__cover-image-container",children:(0,y.jsx)(V.D,{name:"cover_image",alt:"",showAddCoverBtn:n})}),(0,u.tp)(t)&&(0,y.jsx)("div",{className:"form-section__title-input",children:(0,y.jsx)(q.D,{ref:r,name:"name",autoComplete:"title",placeholder:(0,i.t)("quick_post_v2.title_placeholder"),maxLength:"255",size:"255",type:"text",id:"post_name",tabIndex:0})}),(0,y.jsx)("div",{className:"trix-content trix-content--post",children:(0,y.jsx)(W.O,{ref:(0,u.tp)(t)?void 0:r,preventAccidentalLeave:!1,id:"post_body",name:"body",is_private_space:!1,space_id:t&&t.id,placeholder:(0,i.t)("quick_post_v2.body_placeholder"),tabIndex:0})})]})},G=n(99658),J=n(39068),K=n(5848),Y=n(43204),X=n(48088),ee=n(20292);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oe=(0,h.forwardRef)((function(e,t){return(0,y.jsx)("textarea",ne(ne({},e),{},{ref:t}))}));oe.displayName="TextArea";var ie=(0,h.forwardRef)((function(e,t){return(0,y.jsx)("input",ne(ne({},e),{},{ref:t}))}));ie.displayName="Input";var ae=function(e){var t=e.name,n=e.variant,r=void 0===n?"":n,o=e.label,i=void 0===o?"":o,a=e.description,s=void 0===a?"":a,l=e.autofocus,c=void 0!==l&&l,u=e.fullWidth,d=void 0!==u&&u;i=i||I18n.t("post.".concat(t)),s=s||I18n.t("post.".concat(t,"_description"));var m=(0,b.Gc)().register,f="post_".concat(t),p=ie;return"textarea"===r&&(p=oe),(0,y.jsxs)("div",{className:w("form-group",{"form-group--column":d}),children:[(0,y.jsx)(ee.Q,{field:f,label:i,description:s}),(0,y.jsx)("div",{className:"form-input",children:(0,y.jsx)(p,ne(ne({},m(t)),{},{id:f,className:"form-control placeholder:text-light placeholder:opacity-100",name:t,autofocus:c}))})]})},se=["meta_title","meta_description","opengraph_title","opengraph_description"],le=function(){return(0,y.jsxs)("div",{className:"form-section","data-controller":"toggle",children:[(0,y.jsx)("div",{className:"form-section__header has-toggle",children:(0,y.jsx)("button",{type:"button","data-action":"click->toggle#toggle","data-target":"toggle.toggleTrigger","data-open":"false",className:"block-toggle",children:(0,i.t)("meta_tag_attributes.meta_tags")})}),(0,y.jsxs)("div",{className:"form-section__content","data-target":"toggle.toggleable",children:[se.map((function(e){return(0,y.jsx)(ae,{id:e,label:(0,i.t)("meta_tag_attributes.".concat(e)),description:(0,i.t)("meta_tag_attributes.".concat(e,"_description"),{obj:"post"}),name:"meta_tag_attributes.".concat(e)},e)})),(0,y.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,y.jsx)(ee.Q,{field:"opengraph_image",label:(0,i.t)("meta_tag_attributes.open_graph_image")}),(0,y.jsx)(X.a,{name:"meta_tag_attributes.opengraph_image",aspectRatio:c.pI.OPEN_GRAPH})]})]})]})},ce=function(e){var t=e.name;return(0,y.jsx)(f.l.Item,{id:"post_".concat(t),name:t,label:(0,i.t)("post.".concat(t)),hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,y.jsx)(f.l.ToggleSwitch,{variant:"small"})})},ue=function(e){var t=e.space,n=(0,G.m)().post,r=(0,b.Gc)().watch,o=r("created_at"),a=r("is_comments_disabled"),s=!!(0,x.k8)(t||{}),l=(0,m.nT)().helpers.spacesWithPostCreationAllowed(),c=(0,m.wh)().currentCommunityMember,d=(new Date).toUTCString(),v=(0,K.k)({enabled:(0,J.vb)(c)}),h=v.data,g=void 0===h?{}:h,_=v.isLoading,j=Boolean(n.id)&&(0,u.Hz)(n);return _?(0,y.jsx)(p.a,{}):(0,y.jsx)("div",{className:"settings-menu__wrapper",children:(0,y.jsx)("div",{className:"form-wrapper quickpost-modal__form-settings",children:(0,y.jsxs)("div",{className:"form-content",children:[(0,y.jsxs)("div",{className:"-space-y-2",children:[(0,y.jsx)(ce,{name:"hide_meta_info"}),(0,y.jsx)(ce,{name:"is_comments_disabled"}),!a&&(0,y.jsx)(ce,{name:"is_comments_closed"}),(0,y.jsx)(ce,{name:"is_liking_disabled"}),(0,y.jsx)(ce,{name:"is_truncation_disabled"}),j&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ce,{name:"pin_to_top"}),(0,y.jsx)(ce,{name:"pinned_at"})]}),!t.hide_from_featured_areas&&(0,y.jsx)(ce,{name:"hide_from_featured_areas"}),j&&(0,y.jsxs)("div",{className:"form-group form-group--column !mt-0",children:[(0,y.jsx)(ee.Q,{field:"created_at",label:(0,i.t)("publish_date"),description:(0,i.t)("publish_date_description")}),(0,y.jsx)(Y.W,{name:"created_at",maxDate:d})]})]}),(0,y.jsx)(z.If,{condition:(0,u.rq)(t),children:(0,y.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,y.jsx)(ee.Q,{field:"cardview_thumbnail",label:(0,i.t)("cardview_thumbnail")}),(0,y.jsx)(X.a,{name:"cardview_thumbnail",aspectRatio:2})]})}),(0,J.vb)(c)&&g.internal_custom_html_enabled&&(0,y.jsx)(ae,{name:"internal_custom_html",variant:"textarea",fullWidth:!0}),(0,y.jsx)(f.l.Item,{name:"space_id",translationRoot:"post",fullWidth:!0,children:(0,y.jsx)(Z.M,{name:"space_id",variant:"form-input",spaces:l})}),(0,y.jsx)(ae,{name:"slug",fullWidth:!0}),(0,y.jsx)(z.If,{condition:s,children:(0,y.jsx)(f.l.Item,{name:"user_id",translationRoot:"post",fullWidth:!0,children:(0,y.jsx)(f.l.CommunityMemberSelect,{direction:"up",valueField:"user_id"})})}),(0,y.jsx)(z.If,{condition:!!o,children:(0,y.jsx)(le,{})})]})})})};function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fe=function(e){var t=e.show,n=e.closeModal,r=de((0,h.useState)(!1),2),o=r[0],a=r[1],s=de((0,h.useState)(!1),2),l=s[0],u=s[1],f=de((0,h.useState)(),2),p=f[0],v=f[1],g=(0,m.nT)(),_=(0,m.Zh)().helpers.postForTrixEditor(),w=(0,j.kK)(),O=g.helpers.isDataLoaded()&&_,S=g.helpers.basicSpacesWithPostCreationAllowed(),P=(0,b.Gc)(),C=P.watch,N=P.formState,I=N.dirtyFields,A=N.errors,E=N.isSubmitting,T=N.isDirty,M=N.isSubmitSuccessful,L=C(),R=L.space_id,q=L.name,V=L.body,W=L.id,Q=S.find((function(e){return e.id===R})),G=function(){a(!1)},J=!q&&!V||E||M,K=function(){if(Object.keys(I).length>0){var e=(0,i.t)("post.errors.unsaved_post_warning");confirm(e)&&n()}else n()};(0,F.M)({enabled:!J}),function(e){(0,h.useEffect)((function(){var t="Are you sure you want to leave?",n=function(n){e&&(n.preventDefault(),n.returnValue=t)},r=function(n){e&&!confirm(t)&&n.preventDefault()};return window.addEventListener("beforeunload",n),document.addEventListener("turbolinks:before-visit",r),function(){window.removeEventListener("beforeunload",n),document.removeEventListener("turbolinks:before-visit",r)}}),[e])}(T&&!M);var Y=!!W,X=Y?"Edit Post":"Create Post",ee=W?"Save":"Post";(E||M)&&(ee=W?"Saving...":"Posting..."),(0,d.K)({cacheKey:c._7,fields:["name","body","space_id","cover_image"],enabled:!Y&&!M});return(0,y.jsxs)(H.Js,{show:t,onClose:K,fullscreen:!0,closeOnEscape:!o,trixMode:"quickpost-modal ".concat(l&&"quickpost-modal__fullpage"),children:[(0,y.jsxs)(H.Js.Header,{onClose:!o&&K,children:[(0,y.jsxs)("div",{className:"modal__header__inside",children:[(0,y.jsxs)("div",{className:"mr-4 flex items-center gap-4",children:[(0,y.jsxs)(z.If,{condition:!o,children:[(0,y.jsx)(z.If,{condition:!w,children:(0,y.jsx)("button",{type:"button",onClick:function(){return u(!l)},children:(0,y.jsx)(k.JO,{type:l?"shrink":"expand",size:16})})}),(0,y.jsx)(z.If,{condition:(0,x.Y_)(Q),children:(0,y.jsx)("button",{type:"button",onClick:function(){return a(!0)},children:(0,y.jsx)(k.JO,{type:"settings"})})})]}),(0,y.jsx)(z.If,{condition:!!o,children:(0,y.jsx)("button",{className:"flex",type:"button",onClick:G,children:(0,y.jsx)(k.JO,{type:"back-arrow-v2",size:16})})})]}),(0,y.jsxs)("div",{className:"modal__header--center",children:[(0,y.jsxs)("span",{className:"quickpost-modal__title",children:[(0,y.jsx)(z.If,{condition:o,children:(0,i.t)("post.post_settings")}),(0,y.jsxs)(z.If,{condition:!o,children:[X,(0,y.jsx)("span",{className:"title-separator",children:"/"})]})]}),(0,y.jsx)(z.If,{condition:!o,children:(0,y.jsx)(Z.M,{spaces:S,name:"space_id",rules:{required:(0,i.t)("post.errors.space_is_required")}})})]}),(0,y.jsxs)("div",{className:"modal__header--right",children:[!o&&l&&O&&(0,y.jsx)("div",{className:"flex items-center justify-end gap-4",children:(0,y.jsx)(D,{post:_,space:Q,submitDisabled:J,isSubmitting:E||M,datepickerPlacement:"bottom"})}),(0,y.jsx)(z.If,{condition:o,children:(0,y.jsx)("button",{type:"submit",onClick:G,className:"btn modal__btn--save",children:(0,i.t)("post.done")})})]})]}),(0,y.jsx)(z.If,{condition:!o,children:(0,y.jsx)(B.X,{errors:A})})]}),(0,y.jsx)(H.Js.Body,{children:(0,y.jsx)("div",{className:"form-section form-section__topic-content trix-v2",children:(0,y.jsxs)("div",{className:"form-section__content",onMouseEnter:function(){return v(!0)},onMouseLeave:function(){return v(!1)},children:[Q&&(0,x.Y_)(Q)&&o&&(0,y.jsx)(ue,{space:Q,spaces:S}),(0,y.jsx)(U.L,{condition:!!o,children:(0,y.jsx)($,{space:Q,showAddCoverBtn:p})})]})})}),!o&&!l&&(0,y.jsx)("div",{className:"quickpost-modal__footer",children:(0,y.jsx)("div",{className:"quickpost-modal__footer--actions h-8 gap-4",children:(0,y.jsx)(D,{post:_,space:Q,submitDisabled:J,submitButtonText:ee,isSubmitting:E||M})})})]})},pe=n(68975),ve=function(e){var t=e.open,n=e.onClose,r=e.children,o=e.version,i=void 0===o?2:o,a=e.maxZIndexEnabled,s=void 0!==a&&a;return(0,y.jsx)(pe.V,{className:O()("z-150 standard-layout-modal fixed inset-0 md:overflow-y-auto",{"quick-post-wrapper--v2":2===i},{"z-2000":s}),open:t,onClose:n,children:(0,y.jsxs)("div",{className:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0",children:[(0,y.jsx)(pe.V.Overlay,{className:"fixed inset-0 transition-opacity"}),(0,y.jsx)("span",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true",style:{content:"&#8203;"}}),(0,y.jsx)("div",{children:r})]})})},he=["maxZIndexEnabled","shouldSkipRedirectAfterSubmit","onSubmitSuccess"];function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function xe(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var je=function(e){var t=e.maxZIndexEnabled,n=void 0!==t&&t,r=e.shouldSkipRedirectAfterSubmit,h=void 0!==r&&r,b=e.onSubmitSuccess,g=xe(e,he),_=g.show,x=g.closeModal,j=(0,m.nT)(),w=(0,m.Zh)(),O=w.helpers.postForTrixEditor(),S=j.helpers.isDataLoaded()&&w.record,P=(0,s.k6)(),C=(0,d.d)({cacheKey:c._7}).resetValues,k=(0,v.p)(),N=k.success,I=k.error,A=function(e){var t=e.responseData,n=(0,u.RG)({post:t});w.onPostChange(t),P?(t.status===O.status?N((0,i.t)("quick_post.toasts.changes_saved")):N((0,i.t)("quick_post.toasts.".concat(t.status,"_saved"))),x(),C(),h||P.push(n)):(x(),C(),h||(window.location.href=n)),b&&b(t)},E=function(){var e,t=(e=o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Fv.createOrUpdate({post:ge(ge({},O),{},{space_id:O.space_id||t.space_id}),formData:t});case 2:if(!(n=e.sent).ok){e.next=9;break}return e.next=6,n.json();case 6:return r=e.sent,A({responseData:r}),e.abrupt("return",!0);case 9:return O.id?I((0,i.t)("quick_post.toasts.failed_to_update")):I((0,i.t)("quick_post.toasts.failed_to_create")),e.abrupt("return",Promise.reject(new Error("Failed to create or update the post")));case 11:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){_e(i,r,o,a,s,"next",e)}function s(e){_e(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),T=ge({status:u.lv},O);return S?(0,y.jsx)("div",{children:(0,y.jsx)(ve,{open:_,onClose:a.noop,version:2,maxZIndexEnabled:n,children:(0,y.jsx)(f.l,{onSubmit:E,defaultValues:T,children:(0,y.jsx)(fe,ge({},g))})})}):(0,y.jsx)(p.a,{variant:"fullscreen"})}},96669:(e,t,n)=>{n.d(t,{a:()=>s});var r=n(86013),o=n(51837),i=n(81786),a=n(85893),s=function(e){var t=e.isDisabled,n=e.isEdit,s=(0,o.L)().isSubmitting;return(0,a.jsx)(i.z,{disabled:t,type:"submit",variant:"circle",children:(0,r.t)("quick_post.scheduled_post_ui.".concat(s?"submitting_button":"submit_button",".").concat(n?"save":"publish"))})}},50045:(e,t,n)=>{n.d(t,{e:()=>v});var r=n(67294),o=n(86013),i=n(36298),a=n(20036),s=n(77700),l=n(18605),c=n(54482),u=n(97479),d=n(8246),m=n(85893);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function(e){var t=e.publishedAt,n=e.updatePublishedAt,p=e.status,v=e.revertToDraftState,h=e.variant,b=void 0===h?"default":h,g=f((0,r.useState)(!1),2),y=g[0],_=g[1],x=function(){return _(!1)},j=(0,i.w)({dateTime:new Date(t),format:"short_date_at_short_time"});return"scheduled"!==p?null:(0,m.jsx)(u.h,{selectorQuery:"#".concat(s.U),children:(0,m.jsx)(a.M,{value:t,datePickerVisible:y,onCancel:x,onSave:function(e){n(e),x()},placement:"bottom-end",saveButtonVariant:"circle",children:(0,m.jsxs)("div",{className:"border-primary bg-secondary -mt-px flex flex-col border-y px-5 py-3",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)(l.JO,{type:"16-clock",size:16}),(0,m.jsx)(d.Z.LabelSm,{weight:"2-lines"===b?"semibold":"medium",children:"default"===b?(0,o.t)("quick_post_v2.scheduled_for",{date:j}):(0,o.t)("quick_post_v2.post_scheduled")})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,m.jsx)(c.h,{variant:"secondary",name:"16-edit",iconClassName:"!text-dark",onClick:function(){return _(!0)},ariaLabel:(0,o.t)("edit")}),(0,m.jsx)(c.h,{variant:"secondary",name:"16-trash-bin",iconClassName:"!text-dark",onClick:v,ariaLabel:(0,o.t)("delete")})]})]}),"2-lines"===b&&(0,m.jsx)("div",{className:"mt-1",children:(0,m.jsx)(d.Z.LabelSm,{weight:"normal",children:j})})]})})})}},49420:(e,t,n)=>{n.d(t,{$:()=>I,F:()=>N});var r=n(76234),o=n(94184),i=n.n(o),a=n(86013),s=n(96486),l=n(67294),c=n(87536),u=n(20036),d=n(96669),m=n(50045),f=n(88503),p=n(51837),v=n(56200),h=n(98338),b=n(51705),g=n(90789),y=n(94281),_=n(93526),x=n(85893);function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O=function(){var e,t=(0,h.wh)().currentCommunitySettings,n=null===t||void 0===t?void 0:t.tiptap_post_enabled,r=(0,c.Gc)(),o=r.watch,i=r.setValue,w=r.getValues,O=o(),S=O.published_at,P=O.status,C=j((0,l.useState)(!1),2),k=C[0],N=C[1],I=(0,p.L)().isSubmitting,A=w(),E=A.name,T=A.body,M=A.tiptap_body,L=A.space_id,R=A.topics,D=(0,h.Zh)(),F=D.record,U=D.helpers,B=D.isSubmitEnabled,z=Boolean(null===U||void 0===U?void 0:U.isTiptapPost),H=!(null===F||void 0===F||!F.id),Z=(0,b.Hz)(F),q=(H?z:n)?(0,v.NU)(M):(0,v.bG)(T),V="quick_post.scheduled_post_ui.".concat(I?"submitting_button":"submit_button"),W=[{icon:"16-download",label:(0,a.t)("".concat(V,".save_draft")),value:"draft"},{icon:"16-calendar",label:(0,a.t)("".concat(V,".schedule_post")),value:"scheduled"},{icon:"16-publish",label:(0,a.t)("".concat(V,".publish")),value:"published"}],Q=(0,s.find)(W,{value:P||"published"}),$=function(e){"scheduled"===e.value?N(!0):(i("status",e.value),N(!1),G(null))},G=function(e){i("published_at",e)},J=function(){$(W[0])},K=o("space_id"),Y=(0,h.nT)();(0,f.f)(Y)&&(e=Y.helpers.findById(K));var X=(0,l.useMemo)((function(){var t;return(0,v.r1)(E)||q?L?null!==(t=e)&&void 0!==t&&t.require_topic_selection&&Number(null===R||void 0===R?void 0:R.length)<=0?(0,a.t)("quick_post_v2.error_messages.no_topics"):null:(0,a.t)("quick_post_v2.error_messages.no_space"):(0,a.t)("quick_post_v2.error_messages.no_title_or_body")}),[E,L,q,R,e]),ee=!!X||I||!B,te=e&&(0,g.k8)(e)&&!Z;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(m.e,{publishedAt:S,revertToDraftState:J,status:P,updatePublishedAt:G}),(0,x.jsx)(u.M,{datePickerVisible:k,onCancel:function(e){e&&e.preventDefault(),N(!1),"scheduled"===P&&J()},value:S,onSave:function(e){G(e),i("status","scheduled"),N(!1)},className:"-bottom-11",saveButtonVariant:"circle",children:(0,x.jsx)(y.T,{disabled:!ee,content:X,trigger:"mouseenter click focus focusin",children:te?(0,x.jsx)(_.F,{type:"submit",disabled:ee,selectedAction:Q,setSelectedAction:$,options:W,variant:"circle"}):(0,x.jsx)(d.a,{isEdit:H,isDisabled:ee})})})]})},S=n(18605),P=n(62057),C=n(54030),k=n(8246),N=function(e){var t;return!(null===e||void 0===e||null===(t=e.helpers)||void 0===t||!t.basicSpacesWithPostCreationAllowed)},I=function(){var e=(0,C.Be)(),t=(0,h.nT)(),n=N(t)?t.helpers.basicSpacesWithPostCreationAllowed():[];return(0,x.jsxs)("footer",{className:"border-primary flex items-center justify-between border-t px-5 py-4","data-testid":"quick-post-footer",children:[(0,x.jsx)("nav",{"aria-label":(0,a.t)("quick_post_v2.footer_menu_aria_label"),id:"quick-post-v2-footer-toolbar"}),(0,x.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,x.jsx)(r.Z,{disablePortal:e,container:document.getElementById("space-select-for-mobile"),children:(0,x.jsx)(P.M,{dropdownClassName:e?"bottom-14":"bottom-32 right-1",spaces:n,containerClassname:i()("!max-w-full",{"border-t border-primary":!e}),name:"space_id",customButton:function(t){var n=t.toggleDropdown,r=t.selectedSpace,o=t.isOpen;return(0,x.jsxs)("button",{type:"button",className:i()("hover:bg-secondary focus-visible:bg-secondary flex w-full cursor-pointer items-center rounded-md",{"bg-secondary":o,"px-5 py-4":!e,"px-3 py-2":e}),onClick:n,children:[(0,x.jsx)("div",{className:i()("flex items-center space-x-1",{"flex-1":!e}),children:null!==r&&void 0!==r&&r.name?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(k.Z.LabelSm,{weight:"medium",color:"text-default",children:[(0,a.t)("quick_post_v2.posting_in")," "]}),(0,x.jsx)(k.Z.LabelSm,{weight:"medium",color:"text-default",children:(0,x.jsx)("span",{className:"text-dark",title:r.name,children:(0,s.truncate)(r.name,{length:e?24:36})})})]}):(0,x.jsx)(k.Z.LabelSm,{weight:"medium",color:"text-default",children:(0,x.jsx)("span",{className:"text-light",children:(0,a.t)("quick_post_v2.choose_a_space")})})}),(0,x.jsx)(S.JO,{className:"!text-dark",type:"16-chevron-down",size:16})]})}})}),(0,x.jsx)(O,{})]})]})}},23529:(e,t,n)=>{n.d(t,{w:()=>u});var r=n(87536),o=n(4977),i=n(85893),a=["name","rules"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=function(e){var t=e.name,n=e.rules,u=c(e,a),d=(0,r.Gc)().control;return(0,i.jsx)(r.Qr,{control:d,name:t,rules:n,render:function(e){var t=e.field;return(0,i.jsx)(o.ap,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({value:t.value,onChange:t.onChange},u))}})}},4977:(e,t,n)=>{n.d(t,{tt:()=>ne,ap:()=>re});var r=n(67294),o=n(79752),i=n(45587),a=n(94789),s=n(94184),l=n.n(s),c=n(87360),u=n.n(c),d=n(73935),m=n(77294),f=n(86013),p=n(96486),v=n(18605),h=n(14189),b=n(85893),g=function(e){var t=e.filter,n=e.createTopicMutation;return(0,b.jsxs)(h.W,{option:"create",onClick:function(e){e.preventDefault(),e.stopPropagation(),n.isLoading||n.mutate(t)},className:"flex items-center",children:[(0,b.jsx)(v.JO,{className:"mr-1",size:16,type:n.isLoading?"loader":"plus-v2"}),(0,f.t)(n.isLoading?"quick_post_v2.topics.creating":"quick_post_v2.topics.create"),(0,b.jsx)("span",{className:"text-dark ml-1 font-semibold",children:(0,f.t)("quick_post_v2.topics.topic_quoted",{topic:t})})]},"create")},y=n(8246),_=function(){return(0,b.jsx)("div",{className:"px-5 py-1.5",children:(0,b.jsx)(y.Z.LabelSm,{color:"text-light",children:(0,f.t)("quick_post_v2.topics.loading")})})},x=n(51803),j=n(61563);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(e){var t=e.shouldShowDropdown,n=e.popperElement,r=e.styles,o=e.attributes,i=e.isLoading,a=e.filter,s=e.filteredTopics,c=e.shouldShowCreateTopic,u=e.createTopicMutation;return(0,b.jsx)("div",O(O({className:l()("z-10 max-w-[min(90vw,288px)]",{invisible:!t}),ref:n,style:r.popper},o.popper),{},{children:(0,b.jsx)(x.E,{className:"!relative",dataTestId:"topics-options-list",children:(0,b.jsxs)(j.H,{children:[i&&(0,b.jsx)(_,{}),s.map((function(e){return(0,b.jsx)(h.W,{option:e.id,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(y.Z.LabelSm,{children:(0,p.truncate)(e.name,{length:25})}),e.admin_only&&(0,b.jsx)(y.Z.LabelXs,{color:"text-light",children:(0,f.t)("quick_post_v2.topics.admin_only")})]})},e.id)})),c&&(0,b.jsx)(g,{createTopicMutation:u,filter:a})]})})}))},C=function(e){var t=e.targetElement,n=e.filter,r=e.maxTopicsAllowed,o=e.setFilter,i=e.buttonElement,s=e.activeOption,l=e.createTopicMutation,c=e.resetSelectedTopics,u=e.removeLastTopic;return(0,b.jsx)(a.h.Input,{className:"min-w-[200px] flex-1 border-none bg-transparent p-0 px-1 py-[5px] text-sm focus:ring-0",ref:t,value:n,placeholder:(0,f.t)("quick_post_v2.topics.search",{count:r}),onChange:function(e){return o(e.target.value)},onFocus:function(){var e;return null===i||void 0===i||null===(e=i.current)||void 0===e?void 0:e.click()},onKeyDown:function(e){(e.ctrlKey||e.metaKey)&&"Backspace"===e.key&&c(),"Backspace"===e.key&&0===(null===n||void 0===n?void 0:n.length)&&u(),"Enter"===e.key&&null!==n&&void 0!==n&&n.trim()&&"create"===s&&(e.preventDefault(),l.isLoading||l.mutate(n))}})},k=n(98338),N=n(39068),I=n(94281),A=function(e){var t=e.topic,n=e.isDragOverlay,r=e.isDraggable,o=e.setActiveTopicIDs,i=(0,k.wh)().currentCommunityMember,a=(0,N.vb)(i)||(0,N.I$)(i),s=!a&&t.admin_only;return(0,b.jsx)(I.T,{placement:"top",content:(0,f.t)("quick_post_v2.topics.admin_only"),interactive:!1,disabled:!s,trigger:"mouseenter click focus focusin",children:(0,b.jsxs)("div",{className:l()("border-primary bg-primary text-dark inline-flex items-center justify-start gap-1.5 whitespace-nowrap rounded-[32px] border py-1.5 pr-2",n?"rotate-1 scale-[1.01] opacity-75 shadow-lg":r?"cursor-move":"cursor-default",s?"pl-2":"pl-3.5",{"pointer-events-none":s}),children:[(0,b.jsx)(y.Z.LabelXs,{weight:"medium",children:null===t||void 0===t?void 0:t.name}),(a||!t.admin_only)&&(0,b.jsx)(v.JO,{className:"cursor-pointer",onClick:function(){null===o||void 0===o||o((function(e){return e.filter((function(e){return e!==t.id}))}))},type:"12-close",size:12})]})})},E=n(64687),T=n.n(E),M=n(88767),L=n(81089),R=n(50732),D=n(69647);function F(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var U=function(e){var t,n,r=e.onSuccess,o=e.spaceId,i=(0,D.p)();return(0,M.useMutation)({mutationFn:(t=T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,L.Cu)(R.av.settings.topics.create(),{topic:{name:t,space_ids:[o]}}));case 1:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){F(i,r,o,a,s,"next",e)}function s(e){F(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onSuccess:r,onError:function(e){"Name has already been taken"===e.errorDetails&&i.error("A topic with this name already exists. Add it to your space instead from the customize space screen.")}})},B=n(47080),z=function(e){var t=e.activeTopicIDs,n=e.topics,r=e.skipSort;return t.map((function(e){return null===n||void 0===n?void 0:n.records.find((function(t){return t.id===e}))})).filter((function(e){return!!e})).sort((function(e,t){return r?0:e.admin_only&&!t.admin_only?-1:!e.admin_only&&t.admin_only?1:0}))},H=n(42991),Z=n(84721),q=n(54482),V=n(24285),W=["topic"];function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var K=function(e){var t=e.topic,n=J(e,W),r=(0,i.nB)({id:(null===t||void 0===t?void 0:t.id)||""}),o=r.attributes,a=r.listeners,s=r.setNodeRef,l=r.transform,c=r.transition,u=r.isDragging,d={transform:V.ux.Translate.toString(l),transition:c,opacity:u?.33:1};return(0,b.jsx)("div",$($($({ref:s,style:d},o),a),{},{children:(0,b.jsx)(A,$({topic:t},n))}))};function Y(e){return function(e){if(Array.isArray(e))return te(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||ee(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){if(e){if("string"===typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ne=20,re=function(e){var t=e.value,n=void 0===t?[]:t,s=e.onChange,c=e.spaceId,f=e.maxTopicsAllowed,p=void 0===f?5:f,v=e.sortable,h=void 0!==v&&v,g=e.creatable,y=void 0!==g&&g,_=e.containerClassName,x=X((0,r.useState)(n),2),j=x[0],w=x[1],O=X((0,r.useState)(""),2),S=O[0],E=O[1],T=X((0,r.useState)(null),2),D=T[0],F=T[1],V=(0,k.wh)().currentCommunityMember,W=(0,r.useRef)(null),Q=(0,r.useRef)(null),$=(0,r.useRef)(null),G=(null===j||void 0===j?void 0:j.length)>0,J=(null===j||void 0===j?void 0:j.length)>=p,ee=function(e){var t=e.spaceId;return(0,M.useQuery)({queryKey:t?[B.Jl,t]:[B.Jl],queryFn:function(){return(0,L.UT)(t?R.av.topics.spaceTopics({spaceId:t}):R.av.settings.topics.index({params:{per_page:250}}))}})}({spaceId:c}),te=ee.data,re=ee.isLoading,oe=ee.refetch,ie=(0,o.Dy)((0,o.VT)(o.we,{activationConstraint:{distance:10}}),(0,o.VT)(o.Lg,{coordinateGetter:i.is})),ae=function(){return w((0,N.vb)(V)?[]:j.filter((function(e){var t=null===te||void 0===te?void 0:te.records.find((function(t){return t.id===e}));return null===t||void 0===t?void 0:t.admin_only})))},se=function(){return w((function(e){var t=h?e:function(e){var t=e.activeTopicIDs,n=e.topics;return t.sort((function(e,t){var r=null===n||void 0===n?void 0:n.records.find((function(t){return t.id===e})),o=null===n||void 0===n?void 0:n.records.find((function(e){return e.id===t}));return null===r||void 0===r||!r.admin_only||null!==o&&void 0!==o&&o.admin_only?null!==r&&void 0!==r&&r.admin_only||null===o||void 0===o||!o.admin_only?0:1:-1}))}({activeTopicIDs:e,topics:te}),n=null===te||void 0===te?void 0:te.records.find((function(e){return e.id===t[t.length-1]}));return!(0,N.vb)(V)&&null!==n&&void 0!==n&&n.admin_only?e:e.slice(0,-1)}))};(0,r.useEffect)((function(){te&&w((function(e){return e.filter((function(e){return null===te||void 0===te?void 0:te.records.some((function(t){return t.id===e}))}))}))}),[te]),(0,r.useEffect)((function(){null===s||void 0===s||s(j.filter((function(e){return!isNaN(Number(e))})))}),[s,j]);var le=(0,m.D)(W.current,Q.current,{placement:"top-start",strategy:"absolute",modifiers:[Z.Z,{name:"offset",options:{offset:[0,2]}}]}),ce=le.styles,ue=le.attributes,de=le.forceUpdate,me=function(){E(""),W.current&&(W.current.value="")},fe=U({spaceId:c,onSuccess:function(e){me(),oe(),null===de||void 0===de||de(),w((function(t){return[].concat(Y(t),[e.id])}))}}),pe=((null===te||void 0===te?void 0:te.records)||[]).filter((function(e){return!e.admin_only||(0,N.vb)(V)||(0,N.I$)(V)})).filter((function(e){return!j.includes(e.id)})),ve=pe.map((function(e){return e.name})),he=u().go(S,ve,{all:!0}).map((function(e){return e.target})),be=pe.filter((function(e){return he.includes(e.name)})),ge=y&&!J&&S.length>0&&!ve.includes(S);c&&(ge=ge&&Number(null===te||void 0===te?void 0:te.count)<ne);var ye=(re||be.length>0||ge)&&j.length<p;(0,r.useEffect)((function(){null===de||void 0===de||de()}),[de,j]);var _e=function(e){return F(e.active.id)},xe=function(e){var t=e.active,n=e.over;t.id!==n.id&&w((function(e){return(0,i.Rp)(e,e.indexOf(t.id),e.indexOf(n.id))})),F(null)},je=null===te||void 0===te?void 0:te.records.find((function(e){return e.id===D}));return null!==te&&void 0!==te&&te.records&&null!==te&&void 0!==te&&te.records.length||(0,N.vb)(V)?(0,b.jsx)(a.h,{value:j,onChange:function(e){w(e),me()},multiple:!0,nullable:!0,children:function(e){var t=e.activeOption;return(0,b.jsxs)("div",{className:l()("text-dark flex items-start justify-between p-2",_),children:[(0,b.jsxs)("div",{id:"quickpost-topics-picker-sortable",className:"w-full",children:[(0,b.jsx)(a.h.Button,{className:"hidden",ref:$}),(0,b.jsxs)(o.LB,{sensors:ie,collisionDetection:o.ey,onDragStart:_e,onDragEnd:xe,children:[(0,b.jsx)(i.Fo,{items:j,strategy:i.U2,disabled:!h,children:(0,b.jsxs)("div",{className:"flex w-full flex-row flex-wrap items-center gap-2",children:[z({activeTopicIDs:j,topics:te,skipSort:h}).map((function(e){return(0,b.jsx)(K,{topic:e,isDraggable:h,setActiveTopicIDs:w},e.id)})),!J&&(0,b.jsx)(C,{buttonElement:$,filter:S,setFilter:E,maxTopicsAllowed:p,targetElement:W,activeOption:t,createTopicMutation:fe,resetSelectedTopics:ae,removeLastTopic:se})]})}),(0,d.createPortal)((0,b.jsx)(o.y9,{zIndex:99999,children:je?(0,b.jsx)(A,{isDragOverlay:!0,topic:je}):null}),document.body)]}),(0,b.jsx)(P,{shouldShowDropdown:ye,popperElement:Q,styles:ce,filter:S,attributes:ue,isLoading:re,filteredTopics:be,shouldShowCreateTopic:ge,createTopicMutation:fe})]}),G&&(0,b.jsx)(I.T,{content:(0,H.t)("quick_post_v2.topics.remove_all"),placement:"top-end",children:(0,b.jsx)(q.h,{className:"h-7 w-7",iconClassName:"!text-dark",onClick:ae,name:"16-trash-bin-2",ariaLabel:(0,H.t)("quick_post_v2.topics.remove_all")})})]})}}):null}},77700:(e,t,n)=>{n.d(t,{V:()=>z,U:()=>B});var r=n(67294),o=n(87536),i=n(95172),a=n(51837),s=n(74666),l=n(98338),c=n(93144),u=n(94184),d=n.n(u),m=n(86013),f=n(90789),p=n(24185),v=n(26813),h=n(54482),b=n(54030),g=n(94281),y=n(8246),_=n(85893),x="quick-post-v2-thumbnail-button",j=function(){var e=(0,a.L)(),t=e.isFullscreen,n=e.toggleFullscreen,r=e.isDirty,i=(0,v.c)({shouldPrevent:r}),s=(0,p.k6)(),c=(0,l.Zh)().record,u=(0,l.nT)(),d=(0,o.Gc)().watch,j=!(null===c||void 0===c||!c.id),w=d("space_id"),O=u.helpers.findById(w),S=(0,b.kK)();return(0,_.jsxs)("header",{className:"border-primary flex items-center justify-between border-b px-5 py-4","data-testid":"quick-post-header",children:[(0,_.jsx)(y.Z.TitleSm,{weight:"semibold",children:(0,m.t)(j?"quick_post_v2.edit_title":"quick_post_v2.create_title")}),(0,_.jsxs)("ul",{className:"text-darkest flex list-none items-center space-x-2",children:[(0,_.jsx)("li",{id:x}),O&&(0,f.Y_)(O)&&(0,_.jsx)("li",{children:(0,_.jsx)(g.T,{placement:"bottom",content:(0,m.t)("quick_post_v2.header.settings"),children:(0,_.jsx)(h.h,{variant:"secondary",iconSize:20,iconClassName:"!text-dark",name:"20-settings",onClick:function(){return s.push("/settings")},ariaLabel:(0,m.t)("quick_post_v2.header.settings")})})}),!S&&(0,_.jsx)("li",{children:(0,_.jsx)(g.T,{placement:"bottom",content:(0,m.t)("quick_post_v2.header.fullscreen"),children:(0,_.jsx)(h.h,{variant:"secondary",iconSize:20,className:"hidden sm:flex",onClick:n,iconClassName:"!text-dark",name:t?"20-fullscreen-exit":"20-fullscreen",ariaLabel:(0,m.t)("quick_post_v2.header.fullscreen")})})}),(0,_.jsx)("li",{children:(0,_.jsx)(g.T,{placement:"bottom",content:(0,m.t)("quick_post_v2.header.close"),children:(0,_.jsx)(h.h,{variant:"secondary",iconSize:20,onClick:i,iconClassName:"!text-dark",name:"20-close",ariaLabel:(0,m.t)("quick_post_v2.header.close")})})})]})]})},w=n(23529),O=n(88503),S=n(877),P=n(31280),C=n(51705),k=n(94347),N=n(10647),I=n(97479),A=n(23127),E=n(81625);function T(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=function(){var e,t=(0,l.wh)().currentCommunitySettings,n=null===t||void 0===t?void 0:t.tiptap_post_enabled,r=null===t||void 0===t?void 0:t.topics_enabled,i=(0,o.Gc)(),a=i.watch,c=i.setValue,u=a("tiptap_body.sgids_to_object_map")||{},p=a("name"),v="tiptap_body.inline_attachments",b=a(v)||[],y=(0,l.Zh)(),j=y.record,M=y.helpers,L=Boolean(null===M||void 0===M?void 0:M.isTiptapPost),D=(0,k.k)(),F=j||{},U=F.id,B=F.tiptap_body,z=Boolean(U)?L:n,H=a("space_id"),Z=a("cover_image"),q=(0,l.nT)();(0,O.f)(q)&&(e=q.helpers.findById(H));var V=e&&(0,f.Y_)(e);return(0,_.jsx)("div",{className:"flex-1 overflow-auto px-5 py-4","data-ai-scrollable":!0,children:(0,_.jsxs)("div",{className:"trix-v2 mx-auto grid h-full max-w-3xl grid-rows-[auto,auto,1fr]",children:[(0,_.jsx)("div",{children:(0,C.J4)(e)&&(0,_.jsx)(N.D,{name:"cover_image",className:d()("relative",{"mb-2":Boolean(Z)}),showAddCoverBtn:!0,aspectRatio:s.pI.DEFAULT,changeImageText:(0,m.t)("replace"),customAddCoverBtn:(0,_.jsx)(I.h,{selectorQuery:"#".concat(x),children:(0,_.jsx)(g.T,{placement:"bottom",content:(0,m.t)("quick_post_v2.header.add_cover"),children:(0,_.jsx)(h.h,{variant:"secondary",iconSize:20,iconClassName:"!text-dark",name:"20-cover-image",ariaLabel:(0,m.t)("quick_post_v2.header.add_cover")})})})})}),(0,_.jsx)("div",{children:(0,C.tp)(e)&&(0,_.jsx)(S.n,{maxLength:255,draggable:!1,name:"name",autoFocus:!0,ref:D,placeholder:(0,m.t)("quick_post_v2.title_placeholder"),className:"bg-primary text-dark mb-2 block w-full resize-none border-none p-0 text-2xl font-bold focus:ring-0",rows:1,onKeyPress:function(e){"Enter"===e.key&&e.preventDefault()},tabIndex:0,"data-testid":"post_name"})}),(0,_.jsx)("div",{children:z?(0,_.jsx)(P.$,{placeholder:(0,m.t)("quick_post_v2.body_placeholder"),name:"tiptap_body.body",toolbars:[{portalId:"quick-post-v2-footer-toolbar",component:E.o}],className:"h-full",editorClassName:"h-full quick-post-modal--v2",spaceId:H,sgidToObjectMap:null===B||void 0===B?void 0:B.sgids_to_object_map,inlineAttachments:null===B||void 0===B?void 0:B.inline_attachments,onLocalSgidToObjectMapChange:function(e){var t=R(R({},u),e);c("tiptap_body.sgids_to_object_map",t)},onLocalAttachmentsChange:function(e){return c(v,[].concat(T(b),T(e)))},aiCopilotTitle:p}):(0,_.jsx)(A.O,{id:"post_body",name:"body",is_private_space:!1,space_id:H,placeholder:(0,m.t)("quick_post_v2.body_placeholder"),tabIndex:0,toolbarPortalId:"quick-post-v2-footer-toolbar"})}),r&&!!H&&(0,_.jsx)(I.h,{selectorQuery:"#topics-picker-portal",children:(0,_.jsx)(w.w,{containerClassName:"border-t border-primary",name:"topics",spaceId:H,creatable:null!==V&&void 0!==V&&V})})]})})},U=n(49420),B="scheduled-post-date-render-portal",z=function(){var e=(0,a.L)().setIsDirty,t=(0,o.Gc)(),n=t.formState,u=n.isDirty,d=n.isSubmitSuccessful,m=(0,l.Zh)().record,f=!(null===m||void 0===m||!m.id);return(0,r.useEffect)((function(){e(u)}),[e,u]),(0,c.K)({cacheKey:s._7,fields:["name","body","tiptap_body","space_id","cover_image"],enabled:!f&&!d}),(0,i.y1)("cmd+enter, ctrl+enter",(function(){"triggerFormSubmit"in t&&t.triggerFormSubmit()}),{enableOnContentEditable:!0,enableOnTags:["INPUT","TEXTAREA"]},[t]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(j,{}),(0,_.jsx)("div",{id:B}),(0,_.jsx)(F,{}),(0,_.jsx)("div",{id:"space-select-for-mobile"}),(0,_.jsx)("div",{id:"topics-picker-portal"}),(0,_.jsx)(U.$,{})]})}},66866:(e,t,n)=>{n.d(t,{L:()=>S});var r=n(96486),o=n(11049),i=n(82177),a=n(13288),s=n(85893),l=function(){return(0,s.jsx)(i.u_.Content,{className:"flex min-h-[400px] items-center justify-center",children:(0,s.jsx)(a.a,{})})},c=n(46037),u=n(98338),d=n(84710),m=n(97782),f=function(e){var t=e.post,n=e.onSubmitSuccess,r=e.onPostChange,o=e.shouldSkipRedirectAfterSubmit,i=(0,m.t)({spaceId:t.space_id,postSlug:t.slug,queryOptions:{cacheTime:0},context:"edit-post-modal"}),a=i.post,f=i.isLoading,p=(0,d.hD)(t.id).isLoading;return f||p?(0,s.jsx)(l,{}):(0,s.jsx)(u.DW,{post:a,onPostChange:r,children:(0,s.jsx)(c.H,{shouldSkipRedirectAfterSubmit:o,onSubmitSuccess:n})})},p=n(51837),v=n(32611),h=n(26813),b=n(93788),g=n(48077),y=n(98843),_=n(69289);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){var t=e.post,n=e.onSubmitSuccess,a=e.onPostChange,l=e.shouldSkipRedirectAfterSubmit,c=(0,o.dd)(),u=(0,p.L)().isDirty,m=(0,h.c)({shouldPrevent:u}),x=(0,y.Z)(),j=(0,_.d)(),w=(0,g.d)(),O=x.visible||j.visible||w.visible;return(0,v.u)({disabled:O,onClose:m}),(0,s.jsxs)(i.u_,{isOpen:c.visible,onClose:r.noop,className:"quick-post-v2-modal w-full max-w-3xl",children:[(0,s.jsx)(i.u_.Overlay,{onClick:m}),(0,s.jsx)(b.H,{children:(0,s.jsx)(d._x,{perPagePostIds:[[t.id]],queryOptions:{cacheTime:0},queryContext:"edit-post-modal",children:(0,s.jsx)(f,{post:t,onPostChange:a,onSubmitSuccess:n,shouldSkipRedirectAfterSubmit:l})})})]})},O=o.gk.create((function(e){return(0,s.jsx)(w,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),S=function(){return(0,o.dd)(O)}},46037:(e,t,n)=>{n.d(t,{H:()=>E});var r=n(64687),o=n.n(r),i=n(67294),a=n(94184),s=n.n(a),l=n(86013),c=n(96486),u=n(88767),d=n(24185),m=n(34334),f=n(11049),p=n(77700),v=n(88503),h=n(54482),b=n(81786),g=n(8246),y=n(85893),_=function(){var e=(0,d.k6)(),t=function(){return e.push("/")};return(0,y.jsxs)("div",{className:"border-primary bg-primary sticky top-0 z-10 flex items-center justify-between border-b px-5 py-3.5 sm:rounded-t-2xl",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(h.h,{name:"20-arrow-left",iconSize:20,className:"!p-0",iconClassName:"!h-5 !w-5",onClick:t,ariaLabel:(0,l.t)("previous")}),(0,y.jsx)(g.Z.TitleSm,{weight:"semibold",children:(0,l.t)("quick_post_v2.settings")})]}),(0,y.jsx)(b.z,{type:"button",onClick:t,variant:"circle",children:(0,l.t)("quick_post_v2.done")})]})},x=function(){return(0,y.jsxs)("div",{className:"h-full overflow-auto",children:[(0,y.jsx)(_,{}),(0,y.jsx)(v.l,{})]})},j=n(51837),w=n(56200),O=n(74666),S=n(98338),P=n(51705),C=n(93144),k=n(82177),N=n(67687),I=n(69647);function A(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var E=function(e){var t,n,r=e.shouldSkipRedirectAfterSubmit,a=e.onSubmitSuccess,v=(0,f.dd)(),h=(0,j.L)(),b=h.isFullscreen,g=h.setIsSubmitting,_=(0,I.p)(),E=_.success,T=_.error,M=(0,d.k6)(),L=(0,S.wh)().currentCommunitySettings,R=null===L||void 0===L?void 0:L.tiptap_post_enabled,D=(0,S.Zh)(),F=D.onPostChange,U=D.helpers,B=null===U||void 0===U?void 0:U.postForTrixEditor,z=Boolean(null===U||void 0===U?void 0:U.isTiptapPost),H=B&&B(),Z=!!H.id,q=Z?z:R,V=(0,C.d)({cacheKey:O._7}).resetValues,W=(0,u.useMutation)((function(e){return m.Fv.createOrUpdate({post:{id:H.id,slug:H.slug,space_id:H.space_id||e.space_id},formData:e})}),{onSuccess:(t=o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,(0,c.isFunction)(F)&&F(n),(0,c.isFunction)(a)&&a(),Z||V(),E((0,l.t)(Z?"quick_post.toasts.changes_saved":"quick_post.toasts.".concat(n.status,"_saved"))),v.remove(),i=(0,P.RG)({post:n}),r||M.push(i);case 10:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){A(i,r,o,a,s,"next",e)}function s(e){A(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){return T((0,l.t)("quick_post.toasts.failed_to_create"))}});return(0,i.useEffect)((function(){g(W.isLoading)}),[W.isLoading,g]),(0,y.jsx)(N.l,{id:"quick-post-form",defaultValues:H,mode:"all",className:"h-full",formClassName:"h-full flex flex-col",onSubmit:function(e){return W.mutate(e)},validationSchema:q?w.vY:w.gR,children:(0,y.jsx)(k.u_.Content,{size:b?"screen":"auto",className:s()("overflow-visible",{"max-h-none":b,"h-full max-h-full max-w-[720px] !rounded-t-none sm:h-full sm:!rounded-t-lg md:max-h-[80vh] lg:max-h-[550px]":!b}),animations:"fadeIn",children:(0,y.jsx)(d.VA,{children:(0,y.jsxs)(d.rs,{children:[(0,y.jsx)(d.AW,{component:p.V,path:"/",exact:!0}),(0,y.jsx)(d.AW,{component:x,path:"/settings"})]})})})})}},88503:(e,t,n)=>{n.d(t,{l:()=>S,f:()=>O});var r=n(87536),o=n(86013),i=n(33986),a=n(20292),s=n(62057),l=n(98338),c=n(39068),u=n(51705),d=n(90789),m=n(5848),f=n(43204),p=n(67687),v=n(48088),h=n(13288),b=n(85893),g=function(e){var t,n,r=e.space,g=(0,i.m)().post,y="object"===typeof(null===(t=r)||void 0===t?void 0:t.current_user_roles)&&!!(0,d.k8)(r),_=(0,l.nT)();(function(e){var t;return"function"===typeof(null===e||void 0===e||null===(t=e.helpers)||void 0===t?void 0:t.spacesWithPostCreationAllowed)})(_)&&(n=_.helpers.spacesWithPostCreationAllowed());var x,j=(0,l.wh)().currentCommunityMember,w=(new Date).toUTCString(),O=(0,m.k)({enabled:(0,c.vb)(j)}),S=O.data,P=void 0===S?{}:S,C=O.isLoading,k=void 0!==(null===(x=P)||void 0===x?void 0:x.internal_custom_html_enabled)&&P.internal_custom_html_enabled,N=Boolean(g.id)&&(0,u.Hz)(g);return C?(0,b.jsx)(h.a,{}):(0,b.jsxs)(b.Fragment,{children:[N&&(0,b.jsxs)("div",{className:"form-group form-group--column !mt-0",children:[(0,b.jsx)(a.Q,{field:"created_at",label:(0,o.t)("publish_date"),description:(0,o.t)("publish_date_description")}),(0,b.jsx)(f.W,{name:"created_at",maxDate:w})]}),(0,u.rq)(r)&&(0,b.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,b.jsx)(a.Q,{field:"cardview_thumbnail",label:(0,o.t)("cardview_thumbnail")}),(0,b.jsx)(v.a,{name:"cardview_thumbnail",aspectRatio:2,title:(0,o.t)("upload_a_cardview_thumbnail")})]}),(0,c.vb)(j)&&k&&(0,b.jsx)(p.l.Item,{hideBorder:!0,name:"internal_custom_html",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,variant:"extra-bottom-margin",children:(0,b.jsx)(p.l.TextArea,{name:"internal_custom_html"})}),(0,b.jsx)(p.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"space_id",translationRoot:"post",fullWidth:!0,children:(0,b.jsx)(s.M,{name:"space_id",variant:"form-input",spaces:n})}),(0,b.jsx)(p.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"slug",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,children:(0,b.jsx)(p.l.Input,{name:"slug"})}),y&&(0,b.jsx)(p.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"user_id",translationRoot:"post",fullWidth:!0,children:(0,b.jsx)(p.l.CommunityMemberSelect,{name:"user_id",direction:"up",valueField:"user_id"})})]})},y=n(74666),_=["meta_title","meta_description","opengraph_title","opengraph_description"],x=function(){return(0,b.jsx)("div",{className:"form-section",children:(0,b.jsxs)("div",{className:"form-section__content",children:[_.map((function(e){return(0,b.jsx)(p.l.Item,{label:(0,o.t)("meta_tag_attributes.".concat(e)),description:(0,o.t)("meta_tag_attributes.".concat(e,"_description"),{obj:"post"}),name:"meta_tag_attributes.".concat(e),hideBorder:!0,variant:"extra-bottom-margin",children:(0,b.jsx)(p.l.Input,{id:e,name:"meta_tag_attributes.".concat(e)},e)},e)})),(0,b.jsx)(p.l.Item,{name:"meta_tag_attributes.opengraph_image",label:(0,o.t)("meta_tag_attributes.opengraph_image"),hideBorder:!0,hideDescription:!0,variant:"extra-bottom-margin",children:(0,b.jsx)(v.a,{name:"meta_tag_attributes.opengraph_image",aspectRatio:y.pI.OPEN_GRAPH})})]})})},j=function(e){var t=e.name;return(0,b.jsx)(p.l.Item,{id:"post_".concat(t),name:t,label:(0,o.t)("post.".concat(t)),hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,b.jsx)(p.l.ToggleSwitch,{name:t,variant:"small"})})},w=function(e){var t=e.space,n=(0,i.m)().post,o=(0,(0,r.Gc)().watch)("is_comments_disabled"),a=Boolean(n.id)&&(0,u.Hz)(n);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{name:"hide_meta_info"}),(0,b.jsx)(j,{name:"is_comments_disabled"}),!o&&(0,b.jsx)(j,{name:"is_comments_closed"}),(0,b.jsx)(j,{name:"is_liking_disabled"}),(0,b.jsx)(j,{name:"is_truncation_disabled"}),a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{name:"pin_to_top"}),!(null!==t&&void 0!==t&&t.hide_right_sidebar)&&(0,b.jsx)(j,{name:"pinned_at"})]}),!(null!==t&&void 0!==t&&t.hide_from_featured_areas)&&(0,b.jsx)(j,{name:"hide_from_featured_areas"})]})},O=function(e){var t;return"function"===typeof(null===e||void 0===e||null===(t=e.helpers)||void 0===t?void 0:t.findById)},S=function(){var e,t=(0,r.Gc)().watch,n=t("created_at"),o=t("space_id"),i=(0,l.nT)();return O(i)&&(e=i.helpers.findById(o)),(0,b.jsxs)("div",{className:"mx-auto max-w-3xl px-5 pb-5 pt-2",children:[(0,b.jsx)(w,{space:e}),(0,b.jsx)("div",{className:"my-4"}),(0,b.jsx)(g,{space:e}),!!n&&(0,b.jsx)(x,{})]})}},51837:(e,t,n)=>{n.d(t,{L:()=>r});var r=(0,n(73445).Ue)((function(e){return{isFullscreen:!1,toggleFullscreen:function(){return e((function(e){return{isFullscreen:!e.isFullscreen}}))},isSubmitting:!1,setIsSubmitting:function(t){return e({isSubmitting:t})},isDirty:!1,setIsDirty:function(t){return e({isDirty:t})}}}))},32611:(e,t,n)=>{n.d(t,{u:()=>o});var r=n(95172),o=function(e){var t=e.disabled,n=e.onClose;(0,r.y1)("esc",n,{enabled:!t,enableOnContentEditable:!0,enableOnTags:["INPUT","TEXTAREA"]},[t])}},26813:(e,t,n)=>{n.d(t,{c:()=>i});var r=n(86013),o=n(11049),i=function(e){var t=e.shouldPrevent,n=e.message,i=(0,o.dd)();return function(){t&&!confirm(n||(0,r.t)("quick_post_v2.accidental_leave_confirmation"))||i.remove()}}},56200:(e,t,n)=>{n.d(t,{bG:()=>o,r1:()=>i,NU:()=>s,gR:()=>c,vY:()=>u});var r=n(87561),o=function(e){return!!e},i=function(e){return!!e},a=["image","file","embed","mention","horizontalRule"],s=function(e){var t,n;return!(null===e||void 0===e||null===(t=e.body)||void 0===t||null===(n=t.content)||void 0===n||!n.length)&&e.body.content.some((function(e){return!!e.content||a.includes(e.type)}))},l=r.Ry().shape({space_id:r.Rx().required()}),c=r.Ry().shape({name:r.Z_().when("body",{is:function(e){return!o(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()}),body:r.Z_().when("name",{is:function(e){return!i(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()})},[["name","body"]]).concat(l),u=r.Ry().shape({name:r.Z_().when("tiptap_body",{is:function(e){return!s(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()}),tiptap_body:r.Ry().when("name",{is:function(e){return!i(e)},then:r.Ry().test({test:function(e){return s(e)}}),otherwise:r.Ry().nullable()})},[["name","tiptap_body"]]).concat(l)},83783:(e,t,n)=>{n.d(t,{V:()=>r});var r={thumbsup:"\ud83d\udc4d",heart:"\u2764\ufe0f",tada:"\ud83c\udf89",joy:"\ud83e\udd23",open_mouth:"\ud83d\ude2e",cry:"\ud83d\ude22",pray:"\ud83d\ude4f"}},48121:(e,t,n)=>{n.d(t,{D:()=>P});var r=n(67294),o=n(86215),i=n(94184),a=n.n(i),s=n(86013),l=n(73935),c=n(77294),u=n(17845),d=n(18605),m=n(82732),f=n(94281),p=n(83783),v=n(96486),h=n(98338),b=n(12700),g=n(85893);var y=function(e){var t=e.emoji,n=e.reactionableId,r=e.reactionableType,o=e.currentCommunityMemberId,i=e.onClose,a=e.reactions,s=(0,h.wh)().isViewOnlyMasquerading,l=p.V[t],c=(0,b.z)({currentCommunityMemberId:o,emoji:t,reactionableId:n}),u=c.addReaction,d=c.removeReaction;return l?(0,g.jsx)("button",{type:"button",className:"hover:bg-secondary focus-visible:!outline-secondary relative flex gap-1 rounded-md border-transparent px-2 py-0.5 text-sm focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:s?v.noop:function(){var e,s,l,c=(l=n,(s=r)in(e={emoji:t})?Object.defineProperty(e,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[s]=l,e),m=a.find((function(e){return e.emoji===t}));m?m.community_member_ids.includes(o)?d(c):u(c):u(c);i()},children:l}):null},_=function(e){var t=e.reactionableId,n=e.reactionableType,r=e.reactions,o=e.onClose,i=e.currentCommunityMemberId;return(0,g.jsx)("div",{className:"bg-primary flex gap-1 rounded-lg p-1","data-testid":"popover-content",children:Object.keys(p.V).map((function(e){return(0,g.jsx)(y,{emoji:e,reactionableId:t,reactionableType:n,reactions:r,onClose:o,currentCommunityMemberId:i},e)}))})};function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=function(e){var t=e.reactions,n=e.currentCommunityMemberId,i=e.reactionableId,p=e.reactionableType,v=e.showBorder,h=void 0!==v&&v,b=e.setActiveMessageId,y=e.isMessageThread,x=void 0!==y&&y,w=O((0,r.useState)(null),2),S=w[0],P=w[1],C=O((0,r.useState)(null),2),k=C[0],N=C[1],I=(0,c.D)(S,k,{placement:h?"top-start":"bottom-end"}),A=I.styles,E=I.attributes,T=(0,m.O)().scrollerId,M=T&&document.getElementById(T)||(0,u.j_)();return(0,g.jsx)(o.J,{className:"relative",children:function(e){var r=e.open,c=e.close;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.J.Button,{ref:P,className:a()("hover:bg-secondary focus:bg-secondary flex items-center justify-center rounded transition-transform",{"border-primary rounded-full border px-1 hover:border-gray-400":h,"h-6 w-6":!h}),onClick:function(){return!r&&b&&b((0,u.h7)(i,x))},children:(0,g.jsx)(f.T,{placement:"bottom",interactive:!1,content:(0,s.t)("tiptap.add_reaction"),dataTestId:"add_reaction",className:"flex",children:(0,g.jsx)(d.JO,{"aria-label":(0,s.t)("tiptap.add_reaction"),type:"16-reaction",viewBox:"-2 -2 20 20",className:"text-default"})})}),M&&(0,l.createPortal)((0,g.jsx)(o.J.Panel,j(j({ref:N,style:A.popper,className:"z-10","data-testid":"filter_component"},E.popper),{},{children:(0,g.jsx)("div",{className:"border-primary mt-1 rounded-lg border shadow-xl",children:(0,g.jsx)(_,{reactions:t,reactionableId:i,reactionableType:p,onClose:c,currentCommunityMemberId:n})})})),M)]})}})}},12700:(e,t,n)=>{n.d(t,{z:()=>c});var r=n(67294),o=n(88767),i=n(34334),a=n(59887);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e){var t=e.currentCommunityMemberId,n=e.emoji,l=e.reactionableId,c=e.reactionableType,u=e.setCommunityMembers,d=e.communityMemberIds,m=void 0===d?[]:d,f=(0,a.QP)(),p=f.createReactionFromMessage,v=f.removeReactionFromMessage,h=(0,a.NF)(),b=h.createReactionFromThread,g=h.removeReactionFromThread,y=(0,a.$Y)(),_=y.createReactionFromThreadList,x=y.removeReactionFromThreadList,j=s((0,r.useState)(!1),2),w=j[0],O=j[1],S=(0,o.useMutation)((function(e){return i.ob.addReaction(e)}),{onSettled:function(){O(!1)}}).mutateAsync,P=(0,o.useMutation)((function(e){return i.ob.removeReaction(e)}),{onSettled:function(){O(!1)}}).mutateAsync,C=(0,o.useQuery)(["reaction",l,c,n],(function(){return i.ob.fetchCommunityMemberDetails({ids:m.join(",")})}),{onSuccess:function(e){u&&u(e)},enabled:!1}).refetch,k=function(e){null===p||void 0===p||p(e),null===b||void 0===b||b(e),null===_||void 0===_||_()},N=function(e){null===v||void 0===v||v(e),null===g||void 0===g||g(e),null===x||void 0===x||x()};return{addReaction:function(e){O(!0),k({communityMemberId:t,emoji:e.emoji,reactionableId:e.chat_room_message}),S(e)},removeReaction:function(e){O(!0),N({communityMemberId:t,emoji:e.emoji,reactionableId:e.chat_room_message}),P(e)},fetchCommunityMembers:C,isLoading:w}}},95089:(e,t,n)=>{n.d(t,{pC:()=>r,Kj:()=>o,Rm:()=>i});var r="text-[#6C58E8]",o="copilot",i="activity_scores"},52205:(e,t,n)=>{n.d(t,{b:()=>L});var r=n(11049),o=n(64687),i=n.n(o),a=n(86013),s=n(3321),l=n(79016),c=n(39974),u=n(85760),d=n(82177),m=n(8246),f=n(85893),p=function(e){var t=e.property,n=e.number,r=e.red,o=void 0!==r&&r,i=o?"bg-red-500":"bg-green-700",a=o?"text-red-500":"text-green-700",s=10*parseFloat(n);return(0,f.jsxs)("div",{className:"flex flex-col",children:[(0,f.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,f.jsx)(m.Z.BodyXs,{children:t}),(0,f.jsx)(m.Z.LabelXxs,{weight:"bold",color:a,children:n})]}),(0,f.jsx)("div",{className:"bg-tertiary h-1 w-full rounded",children:(0,f.jsx)("div",{className:"h-full rounded ".concat(i),style:{width:"".concat(s,"%")}})})]})},v=function(){var e="settings.community_ai.marketing_modal";return(0,f.jsxs)("div",{className:"border-primary rounded border p-5",children:[(0,f.jsx)("div",{className:"mb-1",children:(0,f.jsx)(m.Z.LabelLg,{weight:"bold",color:"text-default",children:(0,a.t)("".concat(e,".activity_score.title"))})}),(0,f.jsx)(m.Z.BodySm,{color:"text-default",children:(0,a.t)("".concat(e,".activity_score.description"))}),(0,f.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,f.jsx)(p,{property:(0,a.t)("".concat(e,".params.presence")),number:"9.5"}),(0,f.jsx)(p,{property:(0,a.t)("".concat(e,".params.contribution")),number:"5.0",red:!0}),(0,f.jsx)(p,{property:(0,a.t)("".concat(e,".params.participation")),number:"8.3"}),(0,f.jsx)(p,{property:(0,a.t)("".concat(e,".params.connection")),number:"8.5"})]})]})},h=n(18605),b=function(e){var t=e.localeItem;return(0,f.jsx)("span",{className:"bg-primary rounded-full px-3 py-1",children:(0,f.jsx)(m.Z.BodyXs,{children:(0,a.t)(["settings.community_ai.marketing_modal","copilot_items",t])})})},g=n(95089),y=function(){var e="settings.community_ai.marketing_modal";return(0,f.jsxs)("div",{className:"border-primary rounded border p-5 pb-0",children:[(0,f.jsx)("div",{className:"mb-1",children:(0,f.jsx)(m.Z.LabelLg,{weight:"bold",color:"text-default",children:(0,a.t)("".concat(e,".copilot.title"))})}),(0,f.jsx)(m.Z.BodySm,{color:"text-default",children:(0,a.t)("".concat(e,".copilot.description"))}),(0,f.jsxs)("div",{className:"relative mt-4 grid grid-cols-2 gap-1 p-4",children:[(0,f.jsx)("div",{className:"absolute inset-0 z-[-1] rounded-t-lg bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600 opacity-5"}),(0,f.jsxs)("div",{className:"flex flex-row",children:[(0,f.jsx)(h.JO,{type:"16-artificial-intelligence",className:"text-blue-100"}),(0,f.jsx)(m.Z.LabelXs,{weight:"semibold",color:g.pC,children:(0,a.t)("".concat(e,".ask_ai_to"))})]}),(0,f.jsx)("div",{className:"col-span-2 flex justify-around",children:["give_me_ideas","translate","generate_a_paragraph"].map((function(e){return(0,f.jsx)(b,{localeItem:e},e)}))}),(0,f.jsx)("div",{className:"col-span-2 mt-2 flex justify-around",children:["improve_writing","summarize","adjust_spelling"].map((function(e){return(0,f.jsx)(b,{localeItem:e},e)}))})]})]})},_=n(10161),x=function(e){var t=e.localeItem;return(0,f.jsxs)("li",{className:"mb-4 flex items-start justify-start last:mb-0",children:[(0,f.jsx)("div",{className:"mt-1 flex h-5 w-5 items-center justify-center",children:(0,f.jsx)(h.JO,{size:14,type:"14-magic-ai"})}),(0,f.jsx)("span",{className:"ml-3 text-blue-100",children:(0,f.jsx)(m.Z.BodySm,{color:"text-default",children:(0,f.jsx)(_.w,{content:(0,a.t)(["settings.community_ai.marketing_modal","marketing_items",t]),as:"span"})})})]})},j=function(e){var t=e.feature;return(0,f.jsx)(d.u_.Body,{children:(0,f.jsx)("div",{className:"flex h-full w-full pt-2",children:(0,f.jsxs)("div",{className:"max-w-xl",children:[t===g.Kj&&(0,f.jsx)(y,{}),t===g.Rm&&(0,f.jsx)(v,{}),(0,f.jsxs)("div",{className:"bg-tertiary mt-6 rounded p-4 pt-2",children:[(0,f.jsx)("div",{className:"mb-2",children:(0,f.jsx)(m.Z.LabelXxs,{color:"text-default",children:(0,a.t)("settings.community_ai.marketing_modal.plus")})}),t===g.Kj&&(0,f.jsx)(x,{localeItem:"activity_scores"}),t===g.Rm&&(0,f.jsx)(x,{localeItem:"copilot"}),(0,f.jsx)(x,{localeItem:"transcriptions"})]})]})})})},w=n(24185),O=n(50732),S=n(25830),P=n(77162),C=n(81786);function k(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){k(i,r,o,a,s,"next",e)}function s(e){k(i,r,o,a,s,"throw",e)}a(void 0)}))}}var I=function(e){var t=e.plan,n=e.handleClose,r=e.onSuccess,o=e.source,s=(0,P.w)(),l=(0,w.k6)(),c=(0,S.$2)(),u=function(){var e=N(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.push(O.lA.settings.community_ai),r&&r(),e.next=4,n();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=N(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=6;break}return l.push(O.lA.settings.community_ai),e.next=4,n();case 4:e.next=8;break;case 6:return e.next=8,s.show({planId:t.id,onSuccess:u,source:o,successButtonLabel:(0,a.t)("settings.community_ai.marketing_modal.go_to_community_ai"),showPlanDetails:!0});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)(d.u_.Footer,{children:[(0,f.jsx)("div",{children:(0,f.jsx)(C.z,{onClick:p,large:!0,full:!0,variant:"circle",children:(0,a.t)("settings.community_ai.marketing_modal.submit")})}),!c&&(0,f.jsx)("div",{className:"my-3 text-center",children:(0,f.jsx)(m.Z.BodySm,{color:"text-default",children:(0,f.jsx)(_.w,{content:(0,a.t)("settings.community_ai.marketing_modal.by_proceeding",{plan_name:t.display_name,price:t.monthly_base_amount_with_interval}),as:"span"})})})]})},A=function(e){var t=e.handleClose;return(0,f.jsxs)(d.u_.Header,{children:[(0,f.jsxs)(d.u_.Title,{size:"md",className:"w-full text-center",children:[(0,f.jsx)("div",{className:"my-2 inline-block w-auto",children:(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsxs)(m.Z.TitleLg,{children:[(0,a.t)("settings.community_ai.marketing_modal.title.unlock")," ",(0,f.jsx)("span",{className:g.pC,children:(0,a.t)("settings.community_ai.marketing_modal.title.community_ai")})]}),(0,f.jsx)(h.JO,{type:"16-artificial-intelligence",className:"absolute -right-5 -top-1 text-blue-100"})]})}),(0,f.jsx)(m.Z.BodyMd,{color:"text-default",children:(0,a.t)("settings.community_ai.marketing_modal.subtitle")})]}),(0,f.jsx)(d.u_.HeaderActions,{className:"absolute right-0 top-0 mr-6 mt-6",children:(0,f.jsx)(d.u_.CloseButton,{onClick:t})})]})};function E(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var T=function(e){var t=e.afterClose,n=e.feature,o=void 0===n?g.Rm:n,m=e.source,p=e.onSuccess,v=(0,l.E)().changePlanModalParams,h=(0,r.dd)(),b=v(s.o),y=b.planTier,_=b.planId,x=(0,u.R)({planTier:y,planId:_}),w=x.plan,O=x.isPlanLoading,S=function(){var e,n=(e=i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t(),e.next=3,h.hide();case 3:h.remove();case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){E(i,r,o,a,s,"next",e)}function s(e){E(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,f.jsxs)(d.u_,{title:"".concat((0,a.t)("settings.community_ai.marketing_modal.title.unlock")," ").concat((0,a.t)("settings.community_ai.marketing_modal.title.community_ai")),isOpen:h.visible,onClose:S,children:[(0,f.jsx)(d.u_.Overlay,{}),(0,f.jsx)(d.u_.Content,{size:"md",children:O?(0,f.jsx)("div",{className:"my-28",children:(0,f.jsx)(c.u,{})}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(A,{handleClose:S}),(0,f.jsx)(j,{feature:o}),(0,f.jsx)(I,{handleClose:S,plan:w,source:m,onSuccess:p})]})})]})},M=r.gk.create((function(e){var t=e.afterClose,n=e.feature,r=void 0===n?g.Rm:n,o=e.source,i=e.onSuccess;return(0,f.jsx)(T,{afterClose:t,feature:r,source:o,onSuccess:i})})),L=function(){return(0,r.dd)(M)}},3321:(e,t,n)=>{n.d(t,{o:()=>r});var r=n(20758).Gb.business},56179:(e,t,n)=>{n.d(t,{aO:()=>s,Or:()=>l,vO:()=>c});var r=n(67294),o=n(35102);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s={FIRST_LOAD:"FIRST_LOAD",PAGINATION:"PAGINATION",NEW_MESSAGE:"NEW_MESSAGE"},l="scrollableMessagesDiv",c=function(){var e=i((0,r.useState)(null),2),t=e[0],n=e[1],a=(0,o.Dk)(),c=a.scrollAction,u=a.setScrollAction,d=(0,r.useRef)(null),m=(0,r.useCallback)((function(){switch(c){case s.PAGINATION:if(t){var e=document.getElementById(null===t||void 0===t?void 0:t.id);null===e||void 0===e||e.scrollIntoView()}break;case s.FIRST_LOAD:var n=document.getElementById(l);if(!n)return;d.current=setTimeout((function(){n.scrollTop=n.scrollHeight}),500);break;case s.NEW_MESSAGE:var r=document.getElementById(l);if(!r)return;r.scrollTop=r.scrollHeight}}),[t,c]);return(0,r.useEffect)((function(){return function(){d.current&&clearTimeout(d.current)}}),[]),{setFirstMessage:n,setScrollAction:u,adjustScroller:m}}},75715:(e,t,n)=>{n.d(t,{F8:()=>l,c8:()=>c,g:()=>u});var r=n(88767),o=n(81089),i=n(50732);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l="gamification/settings",c=function(){return(0,r.useQuery)({queryKey:l,queryFn:function(){return(0,o.UT)(i.av.gamification.settings())}})},u=function(e){return(0,r.useMutation)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({mutationFn:function(e){return(0,o.aU)(i.av.gamification.settings(),e)}},e))}},52439:(e,t,n)=>{n.d(t,{p6:()=>s,uf:()=>l,ze:()=>c,f$:()=>u});var r=n(12274),o=n(49546),i=n(86013),a=n(96486),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PP";if(!e)return"\u2500";var n=new Date(e);return(0,r.default)(n)?(0,a.startCase)((0,o.default)(n,t)):"\u2500"},l=function(e){return"CommunityMember"===e.type?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.admin?(0,i.t)("role_admin"):e.moderator?(0,i.t)("moderator"):(0,i.t)("member")}(e.roles):"\u2500"},c=function(e){return e?(0,i.t)("settings.manage_members.subscribed"):(0,i.t)("settings.manage_members.unsubscribed")},u=function(e){return e?(0,i.t)(["invitation_status_column",e]):"\u2500"}},57954:(e,t,n)=>{n.d(t,{QB:()=>c,z4:()=>p,p6:()=>r.p6,uf:()=>r.uf,ze:()=>r.ze,f$:()=>r.f$});var r=n(52439),o=n(42991),i=n(909),a=n(64422),s=n(8246),l=n(85893),c=function(e){var t=e.member,n=e.isAvatarHidden,r=void 0!==n&&n,c=e.children,u=(0,i.H)().showMemberProfileEdit,d=t.name,m=t.avatar_url;return d?(0,l.jsxs)("div",{className:"group flex items-center justify-between gap-x-1",children:[(0,l.jsxs)("button",{className:"flex items-center gap-3 text-left",type:"button",onClick:function(){return u({member:t})},children:[!r&&(0,l.jsx)(a.s,{src:m,name:d,size:"6"}),(0,l.jsx)(s.Z.LabelSm,{weight:"medium",children:d})]}),c]}):(0,l.jsx)(l.Fragment,{children:(0,o.t)("dash")})},u=n(86013),d=n(25830),m=n(47619),f=function(e){return{activityScore:{label:e?(0,u.t)("activity_score.view"):(0,u.t)("activity_score.view_score"),activity:"disabled"}}};function p(e){var t=e.memberId,n=e.shortDisabledLabel,r=void 0!==n&&n,o=e.shouldHideIfNoScore,i=void 0!==o&&o,a=(0,m.wW)(),c=a.data,p=a.isLoading,v=(0,d.m3)();if(p)return null;if(v){var h=f(r);return(0,l.jsx)("div",{children:(0,l.jsx)(m.uy,{activityScore:h.activityScore})})}var b=null===c||void 0===c?void 0:c.get(t);return i&&!b?null:b?(0,l.jsx)(m.Yf,{scoreDetail:b}):(0,l.jsx)(s.Z.LabelSm,{color:"text-default",children:(0,u.t)("n/a")})}},65311:(e,t,n)=>{n.d(t,{Q:()=>v});var r=n(86013),o=n(8246),i=n(94184),a=n.n(i),s=n(10161),l=n(85893),c=function(e){var t=e.reported_reason_type,n=e.profanity_filter_matches,i=e.reported_reason_body;return t&&n||i?(0,l.jsxs)("div",{className:a()("bg-tertiary ml-12 flex flex-col gap-1.5 rounded-lg px-4 py-3"),children:[t&&n&&(0,l.jsx)(o.Z.LabelSm,{children:(0,l.jsx)(s.w,{content:(0,r.t)(["settings.moderation.review_flagged_content_modal","report_reasons",t],{matches:n}),as:"span"})}),i&&(0,l.jsx)(o.Z.LabelSm,{as:"p","data-testid":"report-reason-body",children:i})]}):null},u=n(18605),d=n(64422),m=n(65591),f="settings.moderation.review_flagged_content_modal",p=function(e){var t=e.reporter,n=e.reported_at,i=e.reported_reason_type,a=e.profanity_filter_matches,s=[null===t||void 0===t?void 0:t.first_name,null===t||void 0===t?void 0:t.last_name].filter((function(e){return e})).join(" ");return t?(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(d.s,{name:s,src:t.avatar_url,size:"8"}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(o.Z.LabelSm,{weight:"semibold",children:s}),(0,l.jsx)(o.Z.LabelSm,{color:"text-dark",children:(0,r.t)([f,"reason_labels.reported_for"])}),(0,l.jsx)(o.Z.LabelSm,{color:"text-dark",weight:"semibold","data-testid":"report-reason-type",children:(0,r.t)([f,"report_reasons",i])})]}),(0,l.jsx)(o.Z.LabelXs,{color:"text-dark",children:(0,m.p)(n)})]})]}):(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-black",children:(0,l.jsx)(u.JO,{type:"lightning",size:16,className:"text-white"})}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(o.Z.LabelSm,{weight:"semibold","data-testid":"report-reason-type",children:(0,r.t)([f,"automatically_flagged"])}),a?(0,l.jsx)(o.Z.LabelSm,{color:"text-dark",children:(0,r.t)([f,"reason_labels.profanity_filter"])}):(0,l.jsx)(o.Z.LabelSm,{color:"text-dark",children:(0,r.t)([f,"reason_labels.for_approval"])})]}),(0,l.jsx)(o.Z.LabelXs,{color:"text-dark",children:(0,m.p)(n)})]})]})},v=function(e){var t=e.reports,n=void 0===t?[]:t;return(0,l.jsxs)("div",{className:"flex flex-col gap-6 px-8 py-6",children:[n.map((function(e){var t=e.id,n=e.reported_reason_type,r=void 0===n?"":n,o=e.reported_reason_body,i=e.reported_at,a=void 0===i?"":i,s=e.reporter,u=e.profanity_filter_matches,d=void 0===u?"":u;return(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsx)(p,{reporter:s,reported_at:a,reported_reason_type:r,profanity_filter_matches:d}),(0,l.jsx)(c,{reported_reason_type:r,profanity_filter_matches:d,reported_reason_body:o})]},t)})),0===n.length&&(0,l.jsx)(o.Z.LabelSm,{color:"text-lightest",children:(0,r.t)(["settings.moderation.review_flagged_content_modal","empty"])})]})}},92027:(e,t,n)=>{n.d(t,{z:()=>s});var r=n(86013),o=n(8246),i=n(85893),a="settings.moderation.review_flagged_content_modal.visibility_info",s=function(e){var t=e.content;if(null===t||void 0===t||!t.flagged_contentable)return null;var n=t.flagged_contentable,s=n.flagged_for_approval_at,l=n.removed_at,c=s||l?(0,r.t)([a,"hidden_until_approved"]):(0,r.t)([a,"visible_to_all_members"]);return(0,i.jsx)("div",{className:"flex items-center gap-4 px-8 py-0",children:(0,i.jsx)(o.Z.LabelSm,{children:c})})}},65591:(e,t,n)=>{n.d(t,{p:()=>o});var r=n(70297),o=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,r.Z)(new Date(e),new Date,{addSuffix:t})}},57637:(e,t,n)=>{n.d(t,{ij:()=>a,MG:()=>s,N$:()=>l,lU:()=>c,Iq:()=>u,G7:()=>m});var r,o=n(86013);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=10,s="all",l="draft",c="scheduled",u="published",d="settings.posts",m=Object.freeze((i(r={},s,(0,o.t)([d,"tabs","all"])),i(r,l,(0,o.t)([d,"tabs","drafts"])),i(r,c,(0,o.t)([d,"tabs","scheduled"])),r))},11300:(e,t,n)=>{n.d(t,{D:()=>d,T:()=>m});var r=n(64687),o=n.n(r),i=n(88767),a=n(81089),s=n(50732),l=n(57637);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var u=["settings","posts"],d=function(e){var t,n,r=e.page,d=void 0===r?1:r,m=e.filter,f=e.sort,p=function(){var e,t=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,a.UT)(s.av.settings.posts.index({params:{filter:m,page:d,per_page:l.ij,sort:f}})));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}(),v=(0,i.useQuery)([].concat(u,[m,d,f]),p,{keepPreviousData:!0}),h=v.data,b=v.isLoading,g=v.refetch;return{posts:null!==(t=null===h||void 0===h?void 0:h.records)&&void 0!==t?t:[],postsCount:null!==(n=null===h||void 0===h?void 0:h.count)&&void 0!==n?n:0,isLoadingPosts:b,refetchPosts:g}},m=function(){var e=(0,i.useQueryClient)();return{invalidatePostsApiQueries:function(){return e.invalidateQueries(u)}}}},51065:(e,t,n)=>{n.d(t,{s:()=>r});var r=["/settings","/audience/manage","/members/invite","/members/invitation_links","/members/onboarding","/members/bulk_import","/members/edit","/members/profile_fields","/settings/members/activity_logs"]},75357:(e,t,n)=>{n.d(t,{S:()=>o});var r=n(98338),o=function(){var e=(0,r.wh)().currentCommunitySettings;return Boolean(null===e||void 0===e?void 0:e.gamification_custom_point_awards_enabled)}},9405:(e,t,n)=>{n.d(t,{V:()=>I});var r=n(64687),o=n.n(r),i=n(67294),a=n(86013),s=n(96486),l=n(58533),c=n(88767),u=n(24185),d=n(32535),m=n(64660),f=n(74666),p=n(50732),v=n(59887),h=n(8246),b=n(98338),g=n(81089),y=n(44032),_=n(25680),x=n(94353),j=n(54482),w=n(27025),O=n(69647),S=n(85893);function P(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){P(i,r,o,a,s,"next",e)}function s(e){P(i,r,o,a,s,"throw",e)}a(void 0)}))}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=function(e){var t=e.spaceMembers,n=e.space,r=e.refetchSpaceMembers,P=e.hasMoreSpaceMembers,N=void 0!==P&&P,I=e.fetchNextPage,A=(0,O.p)(),E=(0,u.k6)(),T=(0,v.pB)().findOrCreateChatRoom,M=k((0,i.useState)(!1),2),L=M[0],R=M[1],D=k((0,i.useState)(null),2),F=D[0],U=D[1],B=(0,m.r)(),z=(0,b.wh)(),H=z.currentCommunityMember,Z=z.isViewOnlyMasquerading,q="members_directory.community_members.actions.space",V=(0,c.useMutation)(C(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.pC)(p.av.spaceMembers.leaveSpace({spaceId:n.id,memberId:null===F||void 0===F?void 0:F.community_member_id}));case 2:case"end":return e.stop()}}),e)}))),{onError:function(e){A.error(e.message)},onSuccess:function(){A.success((0,a.t)("".concat(q,".successfully_removed"))),r()},onSettled:function(){R(!1)}}),W=V.mutate,Q=V.isLoading,$=function(e){var t=function(){var t=C(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T({kind:f.g8,community_member_ids:[null===e||void 0===e?void 0:e.community_member_id]});case 2:n=t.sent,E.push((0,p.co)({url:(0,p.so)({uuid:n})}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=[{value:"profile",label:(0,a.t)("view_profile"),onClick:function(){return B.show({memberPublicId:null===e||void 0===e?void 0:e.user_public_uid})}}];return function(e,t){return!((null===e||void 0===e?void 0:e.id)===t.community_member_id)&&(null===e||void 0===e?void 0:e.messaging_enabled)&&(t.messaging_enabled||e.is_admin)}(H,e)&&n.push({value:"message",label:(0,a.t)("message"),onClick:Z?s.noop:t}),function(e,t){return!((null===e||void 0===e?void 0:e.id)===t.community_member_id)&&(null===e||void 0===e?void 0:e.is_admin)}(H,e)&&n.push({value:"remove",label:(0,a.t)("remove"),onClick:function(){U(e),R(!0)}}),n},G=(0,d.bb)(t),J=G.onlineParticipants,K=G.offlineParticipants,Y=function(e){return e.map((function(e){return(0,S.jsxs)("button",{type:"button",className:"hover:bg-tertiary chat-space-rail__content--member flex w-full cursor-pointer justify-between",onClick:function(){return B.show({memberPublicId:null===e||void 0===e?void 0:e.user_public_uid})},children:[(0,S.jsxs)("div",{className:"text-dark flex w-[90%] items-center text-left",children:[(0,S.jsx)("div",{className:"mr-3",children:(0,S.jsx)(_.g,{name:null===e||void 0===e?void 0:e.name,src:null===e||void 0===e?void 0:e.avatar_url,status:null===e||void 0===e?void 0:e.status,size:"9"})}),(0,S.jsx)("div",{children:null===e||void 0===e?void 0:e.name}),null!==e&&void 0!==e&&e.community_admin?(0,S.jsx)(x.g,{square:!0,className:"ml-2 uppercase",label:(0,a.t)("admin")}):(null===e||void 0===e?void 0:e.moderator)&&(0,S.jsx)(x.g,{square:!0,className:"ml-2 uppercase",label:(0,a.t)("moderator")})]}),(0,S.jsx)("button",{type:"button",onClick:function(e){e.stopPropagation()},children:!Z&&(0,S.jsx)(w.Lt,{direction:"bottom-start",menuButtonEl:"div",button:(0,S.jsx)(w.Lt.MenuButton,{id:"action-block",children:(0,S.jsx)(j.h,{name:"20-menu-dots-horizontal",iconSize:20,ariaLabel:(0,a.t)("chat_space.view_member_actions")})}),options:$(e)})})]},null===e||void 0===e?void 0:e.id)}))};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{id:"scrollableDiv",className:"chat-space-rail__content p-0 md:py-4",style:{height:"100%",overflow:"auto"},children:(0,S.jsxs)(l.Z,{scrollThreshold:.8,next:I,hasMore:N,dataLength:t.length,className:"p-0 px-6 pb-12",scrollableTarget:"scrollableDiv",loader:(0,S.jsx)("div",{className:"flex justify-center",children:(0,S.jsx)(h.Z.LabelXxs,{weight:"semibold",children:(0,a.t)("toggle_with_loader.loading")})}),children:[J.length>0&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:"text-default mb-2",children:(0,S.jsx)(h.Z.LabelXxs,{weight:"semibold",children:(0,a.t)("chat_space.online_now")})}),Y(J)]}),K.length>0&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:"text-default my-2",children:(0,S.jsx)(h.Z.LabelXxs,{weight:"semibold",children:(0,a.t)("chat_space.offline")})}),Y(K)]})]})}),(0,S.jsx)(y.c,{isOpen:L,title:(0,a.t)("remove"),onClose:function(){return R(!1)},onCancel:function(){return R(!1)},onConfirm:W,confirmText:Q?(0,a.t)("removing"):(0,a.t)("remove"),disabled:Q,confirmVariant:"danger",children:(0,a.t)("".concat(q,".confirm_remove"),{community_member:null===F||void 0===F?void 0:F.name,space:n.name})})]})}},42218:(e,t,n)=>{n.d(t,{G:()=>O});var r=n(86013),o=n(82177),i=n(11049),a=n(6952),s=n(46266),l=n(96778),c=n(81786),u=n(67687),d=n(8246),m=n(85893),f=function(e){var t=e.createEmbed,n=e.onClose;return(0,m.jsx)(u.l,{onSubmit:function(e){t(e.url),n()},validationSchema:(0,l.o)(),children:(0,m.jsxs)("div",{className:"mx-8 flex h-full flex-col items-center rounded-md",role:"tabpanel",children:[(0,m.jsx)(u.l.Item,{name:"url",fullWidth:!0,hideBorder:!0,hideLabel:!0,hideDescription:!0,className:"!pt-0",placeholder:(0,r.t)("courses.edit.lesson.embed_placeholder"),children:(0,m.jsx)(u.l.Input,{})}),(0,m.jsxs)("div",{className:"mt-12 text-center",children:[(0,m.jsx)(c.z,{type:"submit",variant:"primary",children:(0,r.t)("courses.edit.lesson.embed_media")}),(0,m.jsx)("div",{className:"mt-2",children:(0,m.jsxs)(d.Z.LabelSm,{weight:"semibold",className:"text-light",children:[(0,r.t)("courses.edit.lesson.embed_description")," ",(0,m.jsx)("span",{className:"border-primary inline-flex border-b border-dotted",children:(0,m.jsx)(s.Y,{placement:"bottom-end",content:(0,r.t)("courses.edit.lesson.embed_providers_list"),className:"inline-flex",children:(0,r.t)("courses.edit.lesson.embed_description_more")})})]})})]})]})})},p=n(18605);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){var t=e.getRootProps,n=e.openFilePicker;return(0,m.jsxs)("div",h(h({className:"border-primary mx-8 my-6 flex flex-col items-center justify-center rounded-md border border-dotted py-6",role:"tabpanel"},t()),{},{children:[(0,m.jsx)(p.JO,{size:42,className:"h-[42px] !w-[42px]",type:"new-file-plus"}),(0,m.jsx)("div",{className:"text-dark mb-1 mt-5",children:(0,m.jsx)(d.Z.LabelSm,{weight:"semibold",children:(0,r.t)("courses.edit.lesson.drop_here")})}),(0,m.jsx)("div",{className:"text-default mb-6",children:(0,m.jsx)(d.Z.LabelSm,{children:(0,r.t)("courses.edit.lesson.drop_placeholder")})}),(0,m.jsx)(c.z,{type:"button",onClick:n,variant:"primary",children:(0,r.t)("courses.edit.lesson.choose_a_file")})]}))};function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x={upload:(0,r.t)("courses.edit.lesson.upload"),embed:(0,r.t)("courses.edit.lesson.embed")},j=function(e){var t=e.createEmbed,n=e.openFilePicker,r=e.getRootProps,s=(0,i.dd)(),l=s.remove;return(0,m.jsxs)(o.u_,{isOpen:s.visible,onClose:s.remove,children:[(0,m.jsx)(o.u_.Overlay,{}),(0,m.jsx)(o.u_.Content,{size:"lg",className:"h-64 py-3",children:(0,m.jsxs)(a.O.Group,{className:"mt-3 overflow-hidden md:mt-0",children:[(0,m.jsxs)(a.O.List,{className:"border-b px-8",children:[(0,m.jsx)(a.O,{className:"!text-sm md:!text-base",children:x.upload}),(0,m.jsx)(a.O,{className:"!text-sm md:!text-base",children:x.embed})]}),(0,m.jsxs)(a.O.Panels,{children:[(0,m.jsx)(a.O.Panel,{children:(0,m.jsx)(g,{getRootProps:r,openFilePicker:n})}),(0,m.jsx)(a.O.Panel,{className:"py-[52px]",children:(0,m.jsx)(f,{onClose:l,createEmbed:t})})]})]})})]})},w=i.gk.create((function(e){return(0,m.jsx)(j,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),O=function(){return(0,i.dd)(w)}},2541:(e,t,n)=>{n.d(t,{S:()=>_});var r=n(64687),o=n.n(r),i=n(67294),a=n(33315),s=n(48465),l=n(96486),c=n(8322),u=n.n(c),d=n(50732);function m(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){m(i,r,o,a,s,"next",e)}function s(e){m(i,r,o,a,s,"throw",e)}a(void 0)}))}}var p=function(){var e=f(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t);case 2:return n=e.sent,r=document.querySelector("meta[name=csrf-token]").content,e.next=6,fetch((0,d.hq)(),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":r},body:JSON.stringify({blob:{filename:t.name,content_type:t.type,byte_size:t.size,checksum:n}})});case 6:return i=e.sent,e.next=9,i.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=f(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=2097152,o=Math.ceil(t.size/r),i=0,a=new(u().ArrayBuffer),s=new FileReader,l=function(){if(i<o||0===i&&0===o){var e=i*r,n=Math.min(e+r,t.size),a=(File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice).call(t,e,n);return s.readAsArrayBuffer(a),i++,!0}return!1};s.addEventListener("load",(function(t){if(a.append(t.target.result),!l()){var n=a.end(!0),r=btoa(n);e(r)}})),s.addEventListener("error",(function(){return n("Error reading ".concat(t.name))})),l()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=n(42218);function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t=e.onUploadStarted,n=void 0===t?l.noop:t,r=e.onUploadComplete,c=void 0===r?l.noop:r,u=e.onUploadFailed,d=void 0===u?l.noop:u,m=e.allowedFileTypes,f=void 0===m?void 0:m,v=g((0,i.useState)(!1),2),y=v[0],_=v[1],x=g((0,i.useState)(!1),2),j=x[0],w=x[1],O=g((0,i.useState)(0),2),S=O[0],P=O[1],C=g((0,i.useState)(!1),2),k=C[0],N=C[1],I=(0,h.G)(),A=(0,i.useMemo)((function(){return new s.ZP({restrictions:{maxNumberOfFiles:1,allowedFileTypes:f},autoProceed:!1}).use(a.Z,{limit:10,companionUrl:"/",getChunkSize:function(e){return Math.max(26214400,Math.ceil(e.size/500))}}).on("file-added",function(){var e,t=(e=o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I.hide(),_(!0),e.prev=2,e.next=5,p(t.data);case 5:n=e.sent,A.setState(n),A.setState({retries:2}),A.setFileMeta(t.id,{key:n.key}),A.upload(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(2),console.error(e.t0),_(!1),d();case 17:case"end":return e.stop()}}),e,null,[[2,12]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}()).on("upload",(function(){_(!1),w(!0),n()})).on("upload-progress",(function(e,t){var n=0;0!==t.bytesUploaded&&(n=t.bytesUploaded/t.bytesTotal),P(100*n)})).on("upload-success",(function(e){var t=A.getState(),n=t.checksum,r=t.id,o=t.created_at,i=t.attachable_sgid,a=t.service_name,s=t.signed_id,l=t.key,u={attachable_sgid:i,byte_size:e.size,checksum:n,content_type:e.type,created_at:o,filename:e.name,id:r,service_name:a,signed_id:s,key:l};c(u),w(!1)})).on("error",(function(){_(!1),w(!1);var e=A.getState().retries;0!==e?(N(!0),setTimeout((function(){A.setState({retries:e-1}),N(!1),A.retryAll()}),5e3)):d()})).on("cancel-all",(function(){w(!1),_(!1)}))}),[]);return{uppy:A,isUploading:j,isRetrying:k,progress:S,isProcessingChecksum:y}}},9831:(e,t,n)=>{n.d(t,{z:()=>m});var r=n(86013),o=n.n(r),i=n(88767),a=n(24185),s=n(81089),l=n(50732),c=n(98338),u=n(47330),d=n(69647),m=function(e){var t=e.forEdition,n=void 0!==t&&t,r=(0,a.UO)(),m=r.lessonId,f=r.sectionId,p=(0,i.useQueryClient)(),v=(0,c.L2)().data,h=(0,d.p)(),b=(0,i.useQuery)(["lesson",m,null===v||void 0===v?void 0:v.id,f],(function(){return(0,s.UT)(l.av.courses.getLesson({courseId:v.id,lessonId:m,sectionId:f,params:{for_edition:n}}))}),{enabled:!!m&&!!v&&!!f,refetchOnWindowFocus:!1,retry:0,onError:function(e){401===(null===e||void 0===e?void 0:e.status)&&(window.location.href="/")}}),g=b.data,y=b.isLoading,_=b.remove,x=(0,i.useMutation)((function(e){return(0,s.aU)(l.av.courses.updateLesson({courseId:v.id,lessonId:m,sectionId:f}),{course_lesson:e})}),{onSuccess:function(){_(),p.removeQueries((0,u.hE)(m)),h.success(o().t("courses.edit.lesson.changes_saved"))},onError:function(e){h.error(e.errorDetails)}});return{currentLesson:g,isLoading:y,updateLesson:x.mutate,isUpdatingLesson:x.isLoading,updateFilesOrder:(0,i.useMutation)((function(e){var t=e.filesOrder;return(0,s.aU)(l.av.courses.updateLesson({courseId:v.id,lessonId:m,sectionId:f}),{course_lesson:{files_order:t}})})).mutate}}},32808:(e,t,n)=>{n.d(t,{l:()=>Z});var r=n(67294),o=n(94184),i=n.n(o),a=n(96486),s=n(45338),l=n(99658),c=n(89777),u=n(11049),d=n(98338),m=n(84710),f=n(82177),p=n(85893);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){var t=e.post,n=e.spaceId,r=e.startingImageIndex,o=(0,u.dd)();return(0,p.jsx)(d.mE,{spaceId:n,children:(0,p.jsx)(m._x,{perPagePostIds:[[null===t||void 0===t?void 0:t.id]],children:(0,p.jsx)(d.DW,{post:t,usedIn:"mobile-full-carousel-modal",children:(0,p.jsxs)(f.u_,{isOpen:o.visible,onClose:o.remove,contentPortalId:"mobile-full-carousel-modal-portal",children:[(0,p.jsx)(f.u_.Overlay,{}),(0,p.jsx)(f.u_.Content,{size:"full",className:"h-full",children:(0,p.jsx)(Z,{startingImageIndex:r})})]})})})})},g=u.gk.create((function(e){return(0,p.jsx)(b,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),y=n(86013),_=n(18605),x=n(90673),j=function(e){var t=e.image,n=e.canDownload,r=(0,u.dd)();return(0,p.jsxs)("div",{className:"flex justify-end gap-2 pr-2 pt-2",children:[n&&(0,p.jsx)("a",{href:t.original_url,download:!0,"aria-label":(0,y.t)("download"),className:"text-dark hover:text-dark focus:text-dark",children:(0,p.jsx)(_.JO,{type:"16-download",size:16,useWithFillCurrentColor:!0})}),(0,p.jsx)(x.o,{onClick:r.remove})]})},w=n(54030),O=function(e){var t,n=e.image,r=(0,d.Zh)().record,o=(0,w.en)();return(0,p.jsx)("div",{className:i()("absolute right-4 top-4 z-[2] flex",{"hidden group-hover:flex":o}),children:(null===r||void 0===r||null===(t=r.gallery)||void 0===t?void 0:t.downloadable_images)&&(0,p.jsx)("a",{href:n.original_url,download:!0,"aria-label":(0,y.t)("download"),className:"flex h-8 w-8 justify-center rounded-full bg-black p-1 text-white transition-transform hover:text-white focus:text-white",children:(0,p.jsx)(_.JO,{type:"16-download",size:16,useWithFillCurrentColor:!0})})})};function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){var t=e.image,n=e.positionClassName,o=e.containerWidth,a=e.currentImageIndex,s=e.index,l=e.usedIn,c=e.shouldAnimate,u=e.zoomLevel,d=e.zoomPosition,m=S((0,r.useState)(),2),f=m[0],v=m[1],h=S((0,r.useState)("lazy"),2),b=h[0],g=h[1];return!f&&a+1>=s&&(v(t.url),s>1&&g("eager")),f&&f!==t.url&&v(t.url),(0,p.jsxs)("div",{className:i()("relative flex h-full w-full shrink-0 grow-0 basis-full items-center justify-center",{"transition-transform duration-300":c,"z-[1]":a===s}),style:{transform:o?"translateX(-".concat(o*a,"px)"):void 0},children:["full-post-modal"===l&&a===s&&(0,p.jsx)(O,{image:t}),"mobile-full-carousel-modal"!==l&&(0,p.jsx)("div",{className:"carousel-image absolute inset-0 scale-110 bg-cover bg-center blur-lg",style:{backgroundImage:f&&"url(".concat(f,")")}}),(0,p.jsx)("img",{className:i()("carousel-image relative select-none",{"transition-transform":u},n),draggable:!1,loading:b,alt:"",src:f,style:{transform:u&&u>1?"translate(".concat(d[0],"px, ").concat(d[1],"px) scale(").concat(u,")"):void 0}})]})},k=n(54482),N=function(e){var t=e.direction,n=e.onClick;return(0,p.jsx)(k.h,{name:"20-chevron-".concat("prev"===t?"left":"right"),iconSize:20,onClick:n,iconClassName:"!text-gray-600",className:i()("absolute top-1/2 z-[2] hidden -translate-y-1/2 rounded-full border border-gray-300 bg-white hover:!bg-[#F7F9FA] focus:!bg-[#F7F9FA] sm:group-hover:flex",{"left-4":"prev"===t,"right-4":"next"===t}),ariaLabel:"prev"===t?(0,y.t)("previous"):(0,y.t)("next")})};function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=16/9,T=function(e){var t=e.images,n=e.currentImageIndex,o=e.onPrevImage,a=e.onNextImage,s=e.usedIn,l=e.shouldAnimate,c=e.zoomLevel,u=e.zoomPosition,d=e.shouldHaveRoundedBottomCorners,m=void 0!==d&&d,f=(0,r.useRef)(null),v=t[0].width/t[0].height,h=function(e,t,n){var o,i=I((0,r.useState)(),2),a=i[0],s=i[1],l=I((0,r.useState)(),2),c=l[0],u=l[1],d=I((0,r.useState)(),2),m=d[0],f=d[1];return(0,r.useEffect)((function(){if(e&&t.current){var r=t.current,o=r.clientWidth,i=r.clientHeight,a=e>E?E:e,l=o/a;"full-post-modal"===n?(s("100%"),f(o/i)):l>678?(s(678),f(o/678)):(s(l),f(a)),u(o)}}),[t,e,n,null===(o=t.current)||void 0===o?void 0:o.clientWidth]),{containerCalculatedHeight:a,containerWidth:c,containerRatio:m}}(v,f,s),b=h.containerRatio,g=h.containerCalculatedHeight,y=h.containerWidth,_=function(e,t){var n;return e&&t&&(n=e>t?"w-full":e<t?"h-full":"h-full w-full"),n}(v,b);return(0,p.jsxs)("div",{className:i()("group relative flex items-center overflow-hidden",{"lg:h-full":"full-post-modal"===s,"md:rounded-b-lg":m}),style:{height:"full-post-modal"!==s?g:void 0},ref:f,children:[t.map((function(e,t){return(0,p.jsx)(C,{image:e,currentImageIndex:n,index:t,positionClassName:_,containerWidth:y,usedIn:s,shouldAnimate:l,zoomLevel:c,zoomPosition:u},e.id)})),n>0&&(0,p.jsx)(N,{onClick:o,direction:"prev"}),n<t.length-1&&(0,p.jsx)(N,{onClick:a,direction:"next"})]})},M=function(e){var t=e.images,n=e.currentImageIndex,r=e.setCurrentImageIndex,o=e.usedIn,a=(0,w.en)(),s=(0,l.m)().isPostBodyEmpty;return t.length<2?"mobile-full-carousel-modal"===o?(0,p.jsx)("div",{className:"!pt-0 pb-12"}):null:(0,p.jsx)("div",{className:i()("z-[2] w-full justify-center pt-5",{"absolute bottom-4 left-1/2 flex w-auto -translate-x-1/2 !pt-0":a,"pb-5":!a&&("full-post-modal"===o||s),"!pt-0 pb-12":"mobile-full-carousel-modal"===o}),children:(0,p.jsx)("div",{className:i()("bg-primary flex justify-center gap-1 rounded-xl p-0",{"!bg-white !p-2":a}),children:t.map((function(e,o){return(0,p.jsx)("button",{type:"button","aria-label":(0,y.t)("image_space.carousel.indicator_button",{image_index:o+1,total_images:t.length}),onClick:function(){return r(o)},className:i()("border-3 h-1.5 w-1.5 rounded-full",{"border-dark":!a&&o!==n,"border-gray-300":a&&o!==n,"border-darkest":!a&&o===n,"border-gray-900":a&&o===n})},e.id)}))})})};function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=function(e){var t=L((0,r.useState)(e?1:void 0),2),n=t[0],o=t[1],i=L((0,r.useState)([0,0]),2),s=i[0],l=i[1],c=(0,r.useMemo)((function(){return(0,a.throttle)((function(e){l((function(t){return function(e,t,n){if(void 0===t||1===t)return n;if(!(e.target instanceof HTMLImageElement))return n;var r=e.target,o=r.parentNode;if(!(o instanceof HTMLDivElement))return n;var i=o.getBoundingClientRect(),a=r.getBoundingClientRect(),s=i.left+i.width/2,l=i.top+i.height/2,c=function(e){var t,n;return"clientX"in e&&"clientY"in e?(t=e.clientX,n=e.clientY):"touches"in e&&e.touches.length>0&&(t=e.touches[0].clientX,n=e.touches[0].clientY),[t,n]}(e),u=L(c,2),d=u[0],m=u[1];if(void 0===d||void 0===m)return n;var f=(s-d)*(t-1),p=(l-m)*(t-1),v=f-n[0],h=p-n[1];return(a.left+v>i.left||a.right+v<i.right)&&(f=n[0]),(a.top+h>i.top||a.bottom+h<i.bottom)&&(p=n[1]),[f,p]}(e,n,t)}))}),50)}),[n,l]),u=(0,r.useCallback)((function(e){e.persist(),c(e)}),[c]);return{zoomLevel:n,resetZoom:function(){l([0,0]),o(1)},cycleZoom:function(){o((function(e){return 1===e?2:2===e?3:1}))},zoomPosition:s,setZoomPosition:l,onMouseMove:u}};function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Z=function(e){var t,n,o=e.onPostChange,m=void 0===o?a.noop:o,f=e.onPostDestroy,v=void 0===f?a.noop:f,h=e.startingImageIndex,b=void 0===h?0:h,y=e.className,_=void 0===y?"":y,x=(0,d.Zh)(),O=x.record,S=x.usedIn,P="full-post-modal"===S,C="mobile-full-carousel-modal"===S,k="full-post-modal"!==S&&"mobile-full-carousel-modal"!==S,N=P,I=(0,d.wh)().currentCommunitySettings,A=(0,l.m)().isPostBodyEmpty,E=k&&(null===O||void 0===O?void 0:O.is_liking_disabled)&&(null===O||void 0===O?void 0:O.is_comments_disabled)&&A,L=null===I||void 0===I?void 0:I.tailwind_posts_enabled,R=z((0,r.useState)(b),2),F=R[0],B=R[1],H=D(N),Z=H.zoomLevel,q=H.onMouseMove,V=H.resetZoom,W=H.cycleZoom,Q=H.zoomPosition,$=z((0,r.useState)(0===b),2),G=$[0],J=$[1],K=(0,d.L2)().data,Y=(0,c.F)(),X=(0,u.dd)(g),ee=(0,w.WJ)(),te=!(0,w.WJ)(),ne=P||C,re=(0,l.m)(),oe=re.isSharedPostView,ie=re.isSharedPostWithTeaserLayout,ae=re.isSharedPostViewWithMinimalLayout,se=null===O||void 0===O||null===(t=O.gallery)||void 0===t?void 0:t.images,le=ie&&se?se.slice(0,1):se,ce=function(){N&&V(),J(!0),B((function(e){return Math.min(e+1,le?le.length-1:e+1)}))},ue=function(){N&&V(),J(!0),B((function(e){return Math.max(e-1,0)}))},de=(0,s.QS)({onSwipedRight:Z&&Z>1?void 0:ue,onSwipedLeft:Z&&Z>1?void 0:ce,onTap:function(e){e.event.target.classList.contains("carousel-image")&&!ie&&(N?W():te?X.show({post:O,spaceId:null===K||void 0===K?void 0:K.id,startingImageIndex:F}):ee&&Y.show({post:O,spaceId:null===K||void 0===K?void 0:K.id,onPostChange:m,onPostDestroy:v,isSharedPostView:oe,startingImageIndex:F}))},trackMouse:!0});return O&&le?(0,p.jsxs)("div",U(U({className:i()("group relative w-full cursor-pointer px-0 pt-5",{"!pt-16":O.hide_meta_info&&k&&!L,"!py-0 lg:h-full":P,"flex h-full flex-col justify-between !py-0":C,"!cursor-zoom-in":N,"!pt-0":ae&&!L||L&&!A,"mb-5":L&&!A&&!ne},_),onMouseMove:N?q:void 0,onTouchMove:N?q:void 0},de),{},{children:[C&&(0,p.jsx)(j,{canDownload:null===O||void 0===O||null===(n=O.gallery)||void 0===n?void 0:n.downloadable_images,image:le[F]}),(0,p.jsx)(T,{images:le,currentImageIndex:F,onPrevImage:ue,onNextImage:ce,usedIn:S,shouldAnimate:G,zoomLevel:Z,zoomPosition:Q,shouldHaveRoundedBottomCorners:E}),(0,p.jsx)(M,{images:le,currentImageIndex:F,setCurrentImageIndex:function(e){N&&V(),B(e)},usedIn:S})]})):null}},89777:(e,t,n)=>{n.d(t,{F:()=>P});var r=n(67294),o=n(94184),i=n.n(o),a=n(88767),s=n(97782),l=n(5036),c=n(11049),u=n(98338),d=n(84710),m=n(82177),f=n(32808),p=n(86013),v=n(55470),h=n(21904),b=n(90673),g=n(8246),y=n(85893),_=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.autofocusReplyForm,o=(0,c.dd)(),i=(0,u.wh)().currentCommunitySettings,s=(0,u.Zh)().record,d=null===i||void 0===i?void 0:i.tailwind_posts_enabled,m=d?h.D:v.D,f=(0,a.useQueryClient)();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"border-primary flex justify-between border-y p-6 pb-5 sm:border-t-0",children:[(0,y.jsx)(g.Z.TitleSm,{weight:"semibold",children:(0,p.t)("image_space.grid_view.post_details")}),(0,y.jsx)(b.o,{onClick:function(){f.invalidateQueries([l.bx,s.id]),o.remove()}})]}),(0,y.jsx)(m,{defaultShowComment:!0,autofocusReplyForm:r,onPostChange:t,onPostDestroy:function(e){o.remove(),n(e)},hideShareLink:!0,hidePinnedToTopIcon:!0,hideBookmarkButton:!0,hideAuthorHeadline:!d,tagsLimit:1,tagsShowMoreLabelVariant:"numbers",metaInfoWrapperClassName:"!pr-0"})]})},x=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.startingImageIndex,o=e.autofocusReplyForm;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"flex max-h-full w-full flex-col overflow-auto lg:h-full lg:w-3/5 xl:w-2/3",children:(0,y.jsx)(f.l,{startingImageIndex:r})}),(0,y.jsx)("div",{className:"border-primary flex w-full flex-col lg:h-full lg:w-2/5 lg:overflow-scroll lg:border-l xl:w-1/3",children:(0,y.jsx)(_,{onPostChange:t,onPostDestroy:n,autofocusReplyForm:o})})]})};function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){var t=e.post,n=e.spaceId,o=e.onPostChange,f=e.onPostDestroy,p=e.startingImageIndex,v=e.autofocusReplyForm,h=void 0!==v&&v,b=e.isSharedPostView,g=void 0!==b&&b,_=(0,c.dd)(),j=(0,r.useRef)(null),w=(0,s.t)({spaceId:null===t||void 0===t?void 0:t.space_id,spaceSlug:null===t||void 0===t?void 0:t.space_slug,postSlug:null===t||void 0===t?void 0:t.slug}),O=w.post,S=w.onPostChange,P=(0,u.wh)().currentCommunitySettings,C=null===P||void 0===P?void 0:P.tailwind_posts_enabled,k=(0,a.useQueryClient)();return(0,y.jsx)(u.mE,{spaceId:n,children:(0,y.jsx)(d._x,{perPagePostIds:[[null===t||void 0===t?void 0:t.id]],isSharedPostView:g,children:(0,y.jsx)(u.DW,{post:O||t,usedIn:"full-post-modal",children:(0,y.jsxs)(m.u_,{initialFocus:j,isOpen:_.visible,onClose:function(){k.invalidateQueries([l.bx,null===t||void 0===t?void 0:t.id]),_.remove()},contentPortalId:"full-post-modal-portal",children:[(0,y.jsx)(m.u_.Overlay,{}),(0,y.jsxs)(m.u_.Content,{size:"full",className:i()("flex !flex-row flex-wrap content-start sm:!max-h-[836px] sm:!max-w-[1256px]",{"post-v2":!C}),children:[(0,y.jsx)("div",{ref:j,tabIndex:-1}),(0,y.jsx)(x,{onPostChange:function(e,t){o(e),S(e,t)},onPostDestroy:f,startingImageIndex:p,autofocusReplyForm:h})]})]})})})})},S=c.gk.create((function(e){return(0,y.jsx)(O,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),P=function(){return(0,c.dd)(S)}},14068:(e,t,n)=>{n.d(t,{d:()=>S});var r=n(94184),o=n.n(r),i=n(41165),a=n(8340),s=n(89777),l=n(51705),c=n(54030),u=n(38503),d=n(98338),m=n(11355),f=n(64422),p=n(8246),v=n(85893);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){var t,n,r,h=e.post,y=e.onPostChange,_=e.onPostDestroy,x=(0,m.O)({public_uid:null!==(t=h.community_member.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0}}),j=(0,u.TC)().isDarkAppearance,w=(0,c.en)(),O=(0,s.F)(),S=(0,d.L2)().data,P=j?"bg-[#2B2E33CC] backdrop-blur-[1px]":"bg-[#FFFFFFCC] backdrop-blur-[1px]",C=(0,d.wh)().currentCommunitySettings,k=null===C||void 0===C?void 0:C.tailwind_posts_enabled,N=k?a.S:i.S;return(0,v.jsxs)("div",{className:o()("mt-2 flex w-full flex-row-reverse items-center justify-between gap-2",{"absolute bottom-2 mt-0 hidden px-2 focus:flex focus-visible:flex group-hover:flex peer-hover:flex peer-focus-visible:flex":w}),children:[(0,v.jsx)("div",{className:"flex shrink-0 items-center justify-end gap-2",children:(0,v.jsx)(N,b({type:"image-card",wrapperClassName:"!mr-0",commentButtonClassName:o()("rounded-md p-1",(n={},g(n,P,w),g(n,"pr-0",!k),n)),commentIconClassName:"text-selector-active md:!mr-0",likeButtonClassName:o()("rounded-md p-1",(r={},g(r,P,w),g(r,"pr-0",!k),r)),likeIconClassName:"text-selector-active md:!mr-0",likedSpanClassName:"text-brand",showLikesCount:!w,showCommentsCount:!w},w&&{onCommentsClick:function(e){e.preventDefault(),O.show({post:h,spaceId:null===S||void 0===S?void 0:S.id,onPostChange:y,onPostDestroy:_,autofocusReplyForm:!0})}}))}),!(0,l.A8)(h)&&(0,v.jsxs)("a",b(b({},x),{},{className:o()("flex items-center justify-start gap-2 overflow-hidden rounded-md py-1 pl-1 pr-2",g({},P,w)),children:[(0,v.jsx)(f.s,{src:h.community_member.avatar_url||"",name:h.community_member.name||"",size:"5"}),(0,v.jsx)(p.Z.LabelSm,{weight:"medium",truncate:!0,children:h.community_member.name})]}))]})},_=n(18605),x=n(86013),j=function(e){var t=e.post,n=e.children,r=e.onPostChange,o=e.onPostDestroy,i=(0,s.F)(),a=(0,d.L2)().data;return(0,v.jsx)("button",{type:"button",className:"focus-visible:outline-secondary peer w-full focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2","aria-label":(0,x.t)("image_space.grid_view.open_full_post"),onClick:function(){return i.show({post:t,spaceId:null===a||void 0===a?void 0:a.id,onPostChange:r,onPostDestroy:o})},children:n})},w=n(74374),O=function(e){var t=e.post,n=e.children;return(0,v.jsx)(w.s,{post:t,className:"focus-visible:outline-secondary peer inline-block focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:n})},S=function(e){var t=e.post,n=e.isSquareGrid,r=void 0===n||n,i=e.onPostChange,a=e.onPostDestroy,s=(0,c.WJ)()?j:O;return(0,v.jsxs)("div",{className:"group relative",children:[(0,v.jsxs)("div",{className:"absolute right-2 top-2 flex",children:[t.gallery.images.length>1&&(0,v.jsx)(_.JO,{type:"16-multiple-images",size:16}),t.pinned_at_top_of_space&&(0,v.jsx)(_.JO,{type:"16-pin-sm-white",size:16})]}),(0,v.jsx)(s,{post:t,onPostChange:i,onPostDestroy:a,children:(0,v.jsx)("img",{loading:"lazy",src:t.gallery.images[0].url,alt:t.truncated_content,className:o()("pointer-events-none inline-block w-full rounded-md md:rounded-none",{"aspect-square object-cover":r})})}),(0,v.jsx)(y,{post:t,onPostChange:i,onPostDestroy:a})]})}},19752:(e,t,n)=>{n.d(t,{p:()=>i});var r=n(14068),o=n(85893),i=function(e){var t=e.post,n=e.onPostChange,i=e.onPostDestroy;return(0,o.jsx)(r.d,{post:t,onPostChange:n,onPostDestroy:i,isSquareGrid:!1})}},47080:(e,t,n)=>{n.d(t,{Jl:()=>a,X2:()=>s});var r=n(88767),o=n(81089),i=n(50732),a="topics",s=function(e){var t=e.isCourseDirectory,n=e.spaceId,s=t?["courseTopics"]:[a,n],l=(0,r.useQuery)(s,(function(){return t?(0,o.UT)(i.av.courseTopics.index()):(0,o.UT)(i.av.topics.spaceTopics({spaceId:n}))}),{enabled:t||!!n}),c=l.data,u=l.isLoading;return{topics:(null===c||void 0===c?void 0:c.records)||[],isLoading:u}}},75149:(e,t,n)=>{n.d(t,{$:()=>r});var r=function(e){var t=e.shouldShowLockIconForNonMembers,n=e.isPrivate,r=e.isAdmin;return!(void 0!==r&&r)&&n&&t}},64248:(e,t,n)=>{n.d(t,{O:()=>s});var r=n(94184),o=n.n(r),i=n(86013),a=n(85893),s=function(e){var t=e.value,n=e.handleFeedback,r=e.isFeedbackGiven,s=void 0===r?null:r;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:o()("w-full rounded-lg border px-6 py-2.5 align-baseline font-medium",{"text-dark border-gray-300 dark:border-gray-500":null===t||!1===t,"border-circle text-circle border-2":!0===t,"!cursor-not-allowed":s,"hover:border-secondary dark:hover:border-secondary":!s}),onClick:function(){return!0!==t&&n(!0)},type:"button",children:(0,i.t)("support_widget.feedback_yes")}),(0,a.jsx)("button",{className:o()("w-full rounded-lg border px-6 py-2.5 align-baseline font-medium",{"text-dark border-gray-300 dark:border-gray-500":null===t||!0===t,"border-circle text-circle border-2":!1===t,"!cursor-not-allowed":s,"hover:border-secondary dark:hover:border-secondary":!s}),onClick:function(){return!1!==t&&n(!1)},type:"button",children:(0,i.t)("support_widget.feedback_no")})]})}},96146:(e,t,n)=>{n.d(t,{H:()=>u});var r=n(67294),o=n(87536),i=n(98338),a=n(53242),s=n(67687),l=n(13288),c=n(85893),u=function(e){var t=e.formItemName,n=e.formItemTranslationRoot,u=e.formItemRules,d=e.formItemTooltipText,m=e.disabled,f=e.markDefaultCurrencyDirty,p=void 0!==f&&f,v=(0,o.Gc)(),h=v.watch,b=v.setValue,g=h(t),y=(0,i.wh)(),_=y.data.current_community_settings,x=y.isLoading,j=(0,a.K)(),w=j.data,O=j.isLoading;if((0,r.useEffect)((function(){if(!g){var e=(w||[]).find((function(e){return e.is_default}));e&&(p?b(t,"".concat(e.id),{shouldDirty:!0}):b(t,"".concat(e.id)))}}),[t,b,w,g]),x||O||!w)return(0,c.jsx)(l.a,{});if(!_.currencies_enabled)return null;var S=w.map((function(e){return{label:e.code.toUpperCase(),value:"".concat(e.id)}}));return(0,c.jsx)(s.l.Item,{fullWidth:!1,hideBorder:!0,hideDescription:!0,hidePlaceholder:!0,name:t,rules:u,translationRoot:n,tooltipText:d,children:(0,c.jsx)(s.l.SelectNative,{name:t,options:S,disabled:m})})}},43535:(e,t,n)=>{n.d(t,{T:()=>i});var r=n(98338),o=n(85893),i=function(e){var t=e.children;return(0,r.wh)().isViewOnlyMasquerading?(0,o.jsx)("div",{className:"!cursor-not-allowed",children:(0,o.jsx)("div",{className:"!pointer-events-none",children:t})}):t}},64717:(e,t,n)=>{n.d(t,{d:()=>l,D:()=>c});var r=n(67294),o=n(85893);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=(0,r.createContext)({});s.displayName="CurrentLessonContext";var l=function(e){var t=e.children,n=i((0,r.useState)(!0),2),a=n[0],l=n[1],c=i((0,r.useState)({}),2),u={isSubmitEnabled:a,setIsSubmitEnabled:l,currentLesson:c[0],setCurrentLesson:c[1]};return(0,o.jsx)(s.Provider,{value:u,children:t})},c=function(){var e=(0,r.useContext)(s);if(!e)throw new Error("useCurrentLessonContext must be used within a CurrentLessonContextProvider");return e}},42393:(e,t,n)=>{n.d(t,{hg:()=>q,Vu:()=>V});var r=n(67294),o=n(96486),i=n(11049),a=n(98338),s=n(88767),l=n(69293),c=n(81089),u=n(50732),d=n(82066),m=n(52255),f=n(82177),p=n(86013),v=n(18605),h=n(8246),b=n(85893),g=function(){return(0,b.jsx)("div",{className:"bg-primary m-auto text-center",children:(0,b.jsxs)("div",{className:"m-auto flex h-32 max-w-md flex-col items-center justify-center gap-4 p-8","data-testid":"empty-search",children:[(0,b.jsx)(v.JO,{type:"32-search-v2",className:"text-default !h-8 !w-8",size:32}),(0,b.jsx)("div",{className:"flex flex-col gap-2",children:(0,b.jsx)(h.Z.BodySm,{color:"text-default",children:(0,p.t)("view_only_masquerading.empty_search_placeholder")})})]})})},y=n(27887),_=function(e){var t=e.setCategory,n=e.setQuery;return(0,b.jsxs)("div",{className:"mx-auto flex h-32 flex-col items-center justify-center pb-8 pt-6 leading-tight",children:[(0,b.jsx)("div",{className:"pb-2",children:(0,b.jsx)(h.Z.TitleSm,{weight:"semibold",children:(0,p.t)("view_only_masquerading.no_results")})}),(0,b.jsx)("div",{children:(0,b.jsx)(h.Z.BodySm,{color:"text-default",children:(0,p.t)("view_only_masquerading.try_a_different_term")})}),(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)("button",{type:"button",onClick:function(){"function"==typeof t&&t(""),n("")},children:(0,b.jsx)(y.Di,{color:"text-circle",weight:"semibold",children:(0,p.t)("view_only_masquerading.back")})})})]})},x=function(e){var t=e.isLoading,n=e.query,r=e.setQuery;return(0,b.jsx)("div",{className:"bg-primary sticky top-0 isolate z-10 flex items-center justify-between p-4 md:static md:top-auto md:p-0",children:(0,b.jsx)("div",{className:"mr-0 flex w-full items-center md:p-5",children:(0,b.jsxs)("div",{className:"bg-secondary sm:bg-primary border-secondary flex w-full items-center gap-3 rounded-md border px-2 py-1 sm:rounded-md sm:px-2 sm:py-1",children:[(0,b.jsx)("div",{className:"flex",children:t?(0,b.jsx)(v.JO,{type:"loader",className:"text-default",size:20,useWithFillCurrentColor:!0}):(0,b.jsx)(v.JO,{type:"16-search",className:"text-default",size:16,useWithFillCurrentColor:!0})}),(0,b.jsx)("input",{className:"text-dark sm:bg-primary placeholder:text-light h-6 w-full rounded bg-transparent text-sm outline-none placeholder:opacity-100 sm:rounded-none",placeholder:(0,p.t)("view_only_masquerading.input_placeholder"),"aria-autocomplete":"list",value:n,onChange:function(e){return r(e.target.value)}}),(0,b.jsx)("button",{type:"submit",className:"text-default flex pt-1",onClick:function(){return r("")},children:!!n&&(0,b.jsx)(v.JO,{type:"20-close-md",useWithFillCurrentColor:!0})})]})})})},j=n(57166),w=n(64422),O=function(e){var t,n=e.id,r=e.type,o=e.name,i=e.avatarUrl,a=e.onClick;return"CommunityMember"==r?t=(0,b.jsx)(w.s,{src:i,name:o,size:"5"}):"Paywall"==r?t=(0,b.jsx)(v.JO,{type:"credit-card",className:"text-default shrink-0",size:16}):"InvitationLink"==r&&(t=(0,b.jsx)(v.JO,{type:"16-link",className:"text-default shrink-0",size:16})),(0,b.jsx)("li",{children:(0,b.jsx)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:function(){return a(n,r)},children:(0,b.jsxs)("div",{className:"truncate-one-line flex items-center gap-3",children:[t,(0,b.jsx)(j.T1,{children:o})]})})})};function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(){var e=(0,i.dd)(),t=(0,r.useRef)(null),n=(0,r.useRef)(null);(0,l.Z)(t,(function(){e.remove()}));var o=S((0,r.useState)(""),2),a=o[0],p=o[1],v=S((0,r.useState)([]),2),h=v[0],y=v[1],j=S((0,r.useState)(!1),2),w=j[0],P=j[1],C=(0,m.c)(a,500),k=(0,s.useQuery)({queryKey:["masquerading/entities",C],queryFn:function(){return(0,c.UT)(u.av.masquerading.entities.index({query:C,members_only:!0}))},refetchOnWindowFocus:!1,enabled:!!C,staleTime:3e5}),N=k.data,I=k.isLoading;(0,r.useEffect)((function(){C||(P(!1),y([]))}),[C]),(0,r.useEffect)((function(){if(N){var e=N.records,t=N.category,n=N.query;t||n?(P(0===e.length),y(e)):(P(!1),y([]))}}),[N]);var A=function(e,t){return(0,d.g)({entityId:e,entityType:t,mode:"edit"}).then((function(e){return window.open(e.masquerade_url,"_self")})).catch((function(e){console.error(e)}))};return(0,b.jsx)(f.u_,{isOpen:e.visible,onClose:e.remove,children:(0,b.jsx)(f.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,b.jsxs)("div",{ref:t,children:[(0,b.jsx)(x,{isLoading:I,query:a,setQuery:p}),h.length>0?(0,b.jsx)("div",{className:"overflow-y-auto md:max-h-96",ref:n,children:(0,b.jsx)("ul",{className:"list-none",children:h.map((function(e){return(0,b.jsx)(O,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:A},"".concat(e.type,"-").concat(e.id))}))})}):w?(0,b.jsx)(_,{setQuery:p}):(0,b.jsx)(g,{})]})})})};function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=function(){var e=(0,i.dd)(),t=(0,r.useRef)(null),n=(0,r.useRef)(null);(0,l.Z)(t,(function(){e.remove()}));var a=k((0,r.useState)(""),2),c=a[0],d=a[1],h=k((0,r.useState)([]),2),y=h[0],x=h[1],j=k((0,r.useState)(!1),2),w=j[0],S=j[1],P=(0,r.useCallback)((function(){d(""),x([]),S(!1)}),[]),C=(0,m.c)(c,500),N=(0,s.useQuery)(u.av.masquerading.entities.index({query:C}),{refetchOnWindowFocus:!1,enabled:!1}),I=N.data,A=N.isLoading,E=N.refetch;return(0,r.useEffect)((function(){C&&E()}),[C,E]),(0,r.useEffect)((function(){if(c&&null!==I&&void 0!==I&&I.records){var e=I.records;x(e),S(0===e.length)}else x([]),S(!1)}),[I,c]),(0,b.jsx)(f.u_,{isOpen:e.visible,onClose:e.remove,children:(0,b.jsx)(f.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,b.jsxs)("div",{ref:t,children:[(0,b.jsx)("div",{className:"bg-primary sticky top-0 isolate z-10 flex items-center justify-between p-4 md:static md:top-auto md:p-0",children:(0,b.jsx)("div",{className:"mr-0 flex w-full items-center md:p-5",children:(0,b.jsxs)("div",{className:"bg-secondary sm:bg-primary border-secondary flex w-full items-center gap-3 rounded-md border px-2 py-1 sm:rounded-md sm:px-2 sm:py-1",children:[(0,b.jsx)("div",{className:"flex",children:A?(0,b.jsx)(v.JO,{type:"loader",className:"text-default",size:20,useWithFillCurrentColor:!0}):(0,b.jsx)(v.JO,{type:"16-search",className:"text-default",size:16,useWithFillCurrentColor:!0})}),(0,b.jsx)("input",{className:"text-dark sm:bg-primary placeholder:text-light h-6 w-full rounded bg-transparent text-sm outline-none placeholder:opacity-100 sm:rounded-none",placeholder:(0,p.t)("view_only_masquerading.input_placeholder"),"aria-autocomplete":"list",value:c,onChange:function(e){return d(e.target.value)}}),(0,b.jsx)("button",{type:"submit",className:"text-default flex pt-1",onClick:P,children:!!c&&(0,b.jsx)(v.JO,{type:"20-close-md",useWithFillCurrentColor:!0})})]})})}),y.length>0?(0,b.jsx)("div",{className:"overflow-y-auto md:max-h-96",ref:n,children:(0,b.jsx)("ul",{className:"list-none",children:y.map((function(e){return(0,b.jsx)(O,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:o.noop},"community-member-".concat(e.id))}))})}):w?(0,b.jsx)(_,{}):(0,b.jsx)(g,{})]})})})},A=n(33396),E=function(e){var t=e.category,n=e.setCategory;return(0,b.jsx)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:function(){return n("")},children:(0,b.jsxs)("div",{className:"flex items-center gap-3 text-gray-500",children:[(0,b.jsx)(v.JO,{type:"chevron-left",className:"text-default",size:16}),(0,b.jsx)(A.c,{color:"text-gray-500",children:(0,p.t)("view_only_masquerading.categories.".concat(t))})]})})},T=function(e){var t=e.name,n=e.icon,r=e.onClick;return(0,b.jsx)("li",{children:(0,b.jsxs)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:r,children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(v.JO,{type:n,className:"text-default",size:16}),(0,b.jsx)(j.T1,{children:t})]}),(0,b.jsx)(v.JO,{type:"16-chevron-right",className:"text-default",size:16})]})})},M=function(e){var t=e.setCategory;return(0,b.jsx)("div",{className:"mb-2 overflow-y-auto md:max-h-96",children:(0,b.jsxs)("ul",{className:"list-none",children:[(0,b.jsx)(T,{name:(0,p.t)("view_only_masquerading.categories.members"),icon:"16-account",onClick:function(){return t("members")}}),(0,b.jsx)(T,{name:(0,p.t)("view_only_masquerading.categories.paywalls"),icon:"credit-card",onClick:function(){return t("paywalls")}}),(0,b.jsx)(T,{name:(0,p.t)("view_only_masquerading.categories.links"),icon:"16-link",onClick:function(){return t("links")}})]})})};function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=function(){var e=(0,i.dd)(),t=(0,r.useRef)(null),n=(0,r.useRef)(null);(0,l.Z)(t,(function(){e.remove()}));var o=L((0,r.useState)(""),2),a=o[0],p=o[1],v=L((0,r.useState)(""),2),h=v[0],g=v[1],y=L((0,r.useState)(""),2),j=y[0],w=y[1],S=L((0,r.useState)(""),2),P=S[0],C=S[1],k=L((0,r.useState)([]),2),N=k[0],I=k[1],A=L((0,r.useState)(!1),2),T=A[0],R=A[1],D=(0,m.c)(h,500),F=(0,s.useQuery)({category:a,queryKey:["masquerading/entities",D,a],queryFn:function(){return(0,c.UT)(u.av.masquerading.entities.index({query:D,category:a}))},refetchOnWindowFocus:!1,enabled:!(!D&&!a),staleTime:3e5}),U=F.data,B=F.isLoading;(0,r.useEffect)((function(){D||a||(R(!1),I([]))}),[D,a]),(0,r.useEffect)((function(){if(U){var e=U.records,t=U.category,n=U.query;w(t),C(n),t||n?(R(0===e.length),I(e)):(R(!1),I([]))}}),[U]);var z=function(e,t){return(0,d.g)({entityId:e,entityType:t}).then((function(e){return window.open(e.masquerade_url,"_self")})).catch((function(e){console.error(e)}))};return(0,b.jsx)(f.u_,{isOpen:e.visible,onClose:e.remove,children:(0,b.jsx)(f.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,b.jsxs)("div",{ref:t,children:[(0,b.jsx)(x,{isLoading:B,query:h,setQuery:g}),N.length>0?(0,b.jsxs)("div",{className:"mb-2 overflow-y-auto md:max-h-96",ref:n,children:[j&&!P&&(0,b.jsx)(E,{category:j,setCategory:p}),(0,b.jsx)("ul",{className:"list-none",children:N.map((function(e){return(0,b.jsx)(O,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:z},"".concat(e.type,"-").concat(e.id))}))})]}):T?(0,b.jsx)(_,{setCategory:p,setQuery:g}):(0,b.jsx)(M,{setCategory:p})]})})})},F=i.gk.create((function(){return(0,b.jsx)(C,{})})),U=i.gk.create((function(){var e=(0,a.wh)().currentCommunitySettings;return null!==e&&void 0!==e&&e.masquerading_entities_enabled?(0,b.jsx)(D,{}):(0,b.jsx)(I,{})}));function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var H={isBannerVisible:!1,showBanner:o.noop,hideBanner:o.noop,openViewMasqueradingSearch:o.noop,openEditMasqueradingSearch:o.noop},Z=(0,r.createContext)(H);Z.displayName="MasqueradeContext";var q=function(e){var t=e.children,n=B((0,r.useState)(!1),2),o=n[0],a=n[1],s=(0,i.dd)(U),l=(0,i.dd)(F),c={isBannerVisible:o,showBanner:function(){a(!0),s.show()},hideBanner:function(){return a(!1)},openViewMasqueradingSearch:function(){s.show()},openEditMasqueradingSearch:function(){l.show()}};return(0,b.jsx)(Z.Provider,{value:c,children:t})},V=function(){var e=(0,r.useContext)(Z);if(!e)throw new Error("useMasqueradeContext must be used within a MasqueradeContextProvider");return e}},14692:(e,t,n)=>{n.d(t,{Rl:()=>h,h4:()=>b,Wj:()=>g});var r=n(67294),o=n(85893);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e,t){var n=t.type,r=t.payload;switch(n){case"SET_SPACE_NOTIFICATIONS":return r;case"UPDATE_SPACE_NOTIFICATIONS":var o=e.spaces,i=o.findIndex((function(e){return e.id===r.space.id}));return i>-1?u(u({},e),{},{spaces:[].concat(a(o.slice(0,i)),[r.space],a(o.slice(i+1)))}):e;default:throw new Error("Unhandled action type: ".concat(n))}},f=(0,r.createContext)();f.displayName="SpaceNotificationsStateContext";var p=(0,r.createContext)();p.displayName="SpaceNotificationsDispatchContext";var v={spaces:[]},h=function(e){var t=e.children,n=i((0,r.useReducer)(m,v),2),a=n[0],s=n[1];return(0,o.jsx)(f.Provider,{value:a,children:(0,o.jsx)(p.Provider,{value:s,children:t})})},b=function(){var e=(0,r.useContext)(f);if(void 0===e)throw new Error("useSpaceNotificationsState must be used within a SpaceNotificationsProvider");return e},g=function(){var e=(0,r.useContext)(p);if(void 0===e)throw new Error("useSpaceNotificationsDispatch must be used within a SpaceNotificationsProvider");return e}},26334:(e,t,n)=>{n.d(t,{I:()=>l});var r=n(88767),o=n(50732);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){var t,n=e.spaceId,i=e.enabled,s=void 0===i||i,l=o.av.spaces.activeMembersCount({id:n}),c=(0,r.useQuery)(l,{enabled:!!n&&s});return a(a({},c),{},{count:(null===(t=c.data)||void 0===t?void 0:t.members_count)||0})}},51832:(e,t,n)=>{n.d(t,{ND:()=>i,GL:()=>a,G5:()=>s,BU:()=>l,el:()=>c});var r=n(56163),o=n.n(r),i=function(e){return o()(e,{defaultProtocol:"https",target:{url:"_blank"},rel:{url:"noreferrer"},ignoreTags:["a","style","script","img","iframe","action-text-attachment","video","audio"],validate:{url:function(e){return/^[^A-Z]/.test(e)}}})},a=function(e){e.querySelectorAll("video").forEach((function(e){e.setAttribute("controlsList","nodownload")}))},s=function(e){var t=e.containerElement,n=e.shouldIncludeInternalLinks,r=void 0!==n&&n;t.querySelectorAll("a").forEach((function(e){"A"!==e.tagName||e.isContentEditable||!r&&e.host===window.location.host||(e.setAttribute("target","_blank"),e.setAttribute("rel","noreferrer"))}))},l=function(e){e.querySelectorAll("[data-background-image]").forEach((function(e){var t=document.createElement("img");t.src=e.dataset.backgroundImage,e.style.backgroundImage='url("'.concat(e.dataset.backgroundImage,'")'),t.onload=function(){var t=e.parentElement;t.classList.add("show"),t.classList.remove("hide")}}))};function c(e){e.querySelectorAll("[data-target~='downloadAttachment']").forEach((function(e){e.addEventListener("click",u)}))}function u(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget.dataset,n=t.url,r=t.fileName,o=t.logUrl;!function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.setAttribute("download",t),n.click()}(n,r),function(e){fetch(e,{method:"POST"})}(o)}},94719:(e,t,n)=>{n.d(t,{Q_:()=>a,RA:()=>s,mB:()=>l,ac:()=>c,Om:()=>u,YG:()=>m,d_:()=>f,BH:()=>p,vw:()=>v,eV:()=>h,U8:()=>b,Kz:()=>g});var r=n(86013),o=n(68997),i=n(42550),a={INCOMPLETE:"incomplete",PROCESSING:"processing",PAID:"paid",CANCELED:"canceled",REFUNDED:"refunded",FAILED:"failed",PARTIAL_REFUNDED:"partial_refunded"},s={PARTIAL_REFUND:(0,r.t)("community_member_charge_presenter.display_status.partial_refund"),INCOMPLETE:(0,r.t)("community_member_charge_presenter.display_status.incomplete"),PROCESSING:(0,r.t)("community_member_charge_presenter.display_status.processing"),PAID:(0,r.t)("community_member_charge_presenter.display_status.paid"),CANCELED:(0,r.t)("community_member_charge_presenter.display_status.canceled"),REFUNDED:(0,r.t)("community_member_charge_presenter.display_status.refunded"),FAILED:(0,r.t)("community_member_charge_presenter.display_status.failed")},l=[a.PAID,a.PARTIAL_REFUNDED,a.REFUNDED,a.FAILED],c=function(e){return(null===e||void 0===e?void 0:e.status)===a.REFUNDED||d(e)},u=function(e){return(null===e||void 0===e?void 0:e.status)===a.PAID},d=function(e){return(null===e||void 0===e?void 0:e.status)!==a.REFUNDED&&(null===e||void 0===e?void 0:e.amount_refunded_raw)>0},m=function(e){return(null===e||void 0===e?void 0:e.payment_method_type)===i.Lt.PIX},f=function(e){return(null===e||void 0===e?void 0:e.payment_method_type)===i.Lt.CARD},p=function(e){return(null===e||void 0===e?void 0:e.payment_method_type)===i.Lt.GOOGLE_PAY},v=function(e){return(null===e||void 0===e?void 0:e.payment_method_type)===i.Lt.APPLE_PAY},h=function(e){return(null===e||void 0===e?void 0:e.payment_method_type)===i.Lt.LINK},b=function(e){return null===(null===e||void 0===e?void 0:e.payment_method_type)},g=function(e){return[o.VT.APP_STORE,o.VT.PLAY_STORE].includes(null===e||void 0===e?void 0:e.platform)}},95132:(e,t,n)=>{n.d(t,{N:()=>i});var r=n(96486),o=n(3852),i=function(e,t){var n,i,a;try{var s,l,c=new Date(e),u=(0,o.Ed)(),d=new Intl.DateTimeFormat(u,{day:"numeric",month:"short",timeZone:t}).formatToParts(c);a=null===(s=d.find((function(e){return"month"===e.type})))||void 0===s?void 0:s.value,n=null===(l=d.find((function(e){return"day"===e.type})))||void 0===l?void 0:l.value,i=(0,r.upperFirst)(a).replace(".","")}catch(m){m instanceof Error&&console.error("dateComponents - Could not parse date: ".concat(m.message))}return{dayOfMonth:n,shortMonthString:i}}},88884:(e,t,n)=>{n.d(t,{H:()=>s});var r=n(28366),o=n(34587),i=n(86013),a=n(36298),s=function(e){var t=new Date(e),n=new Date,s=(0,r.Z)(),l=(0,o.Z)();return{day:t.getFullYear()===n.getFullYear()?t>s?(0,i.t)("today"):t>l?(0,i.t)("yesterday"):(0,a.w)({dateTime:t,format:"short_month_and_date"}):(0,a.w)({dateTime:t,format:"short_date"}),time:(0,a.w)({dateTime:t,format:"short_time"})}}},39639:(e,t,n)=>{n.d(t,{ie:()=>i,Dk:()=>a,r_:()=>s});var r=n(96486),o=n(3852),i=function(e,t){try{if(!e)throw new Error("Missing date string");var n=(0,o.Ed)(),i=new Intl.DateTimeFormat(n,t);return(0,r.upperFirst)(i.format(new Date(e)))}catch(a){return a instanceof Error&&console.error("Could not parse date: ".concat(a.message)),""}},a=function(e,t){return i(e,{hour12:!0,hour:"2-digit",minute:"2-digit",timeZone:t})},s=function(e,t){return i(e,{month:"long",year:"numeric",timeZone:t})}},20846:(e,t,n)=>{n.d(t,{UZ:()=>s,mM:()=>l,ZY:()=>c,cz:()=>u,Rc:()=>m});var r=n(49546),o=n(96486),i=n(42991),a=n(58837),s=function(e){try{return(0,o.capitalize)((0,r.default)(new Date(e),"EEEE"))}catch(t){return console.error(t),""}},l=function(e){try{return(0,o.capitalize)((0,r.default)(new Date(e),"EEE")).substring(0,2)}catch(t){return console.error(t),""}},c=function(e){try{return(0,o.capitalize)((0,r.default)(new Date(e),"MMMM"))}catch(t){return console.error(t),""}},u=function(e){try{return(0,r.default)(new Date(e),"do")}catch(t){return console.error(t),""}},d={1:(0,i.t)("date.ordinal.first"),2:(0,i.t)("date.ordinal.second"),3:(0,i.t)("date.ordinal.third"),4:(0,i.t)("date.ordinal.fourth"),5:(0,i.t)("date.ordinal.last")},m=function(e){try{var t=(0,a.SA)(e),n=s(e);return"".concat(d[t]||""," ").concat(n)}catch(r){return console.error(r),""}}},58837:(e,t,n)=>{n.d(t,{eC:()=>u,aA:()=>d,qG:()=>m,He:()=>f,Cp:()=>v,Xz:()=>h,TP:()=>b,ZX:()=>g,Gs:()=>y,tq:()=>_,ED:()=>x,bl:()=>j,SA:()=>w,tX:()=>O,qe:()=>S,qB:()=>P,DT:()=>C});var r=n(64687),o=n.n(r),i=n(3852),a=n(20846);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var u=function(e,t){return Math.round((t.getTime()-e.getTime())/864e5)},d=function(e){var t=new Date,n=new Date(e);return!n.valueOf()||n<t},m=function(e){var t=new Date,n=new Date(e);return Math.floor((t.getTime()-n.getTime())/1e3)},f=function(e){var t=function(e){return("0"+e).slice(-2)};if(e>=0&&e<3600){var n=Math.floor(e/60),r=e-60*n;return"".concat(t(n),":").concat(t(r))}var o=Math.floor(e/3600),i=Math.floor((e-3600*o)/60),a=e-60*i-3600*o;return"".concat(t(o),":").concat(t(i),":").concat(t(a))},p=function(e){return new Promise((function(t){return setTimeout(t,e)}))},v=function(){var e,t=(e=o().mark((function e(t){var n,r,i,a,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p(l.length>1&&void 0!==l[1]?l[1]:1500),e.next=4,Promise.all([t,n]);case 4:return r=e.sent,i=s(r,1),a=i[0],e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),h=function(e,t){var n=new Date(e);return n.setDate(n.getDate()+t),n},b=function(e){return e.setMinutes(e.getMinutes()+60),e.setMinutes(0,0,0),e},g=function(e,t){var n=e?new Date(e):new Date;return n.setSeconds(n.getSeconds()+t),n},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;return(new Date).getTime()>=new Date(e).getTime()-60*t*1e3},_=Intl.DateTimeFormat().resolvedOptions().timeZone,x=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=(0,i.Ed)();return(null===(t=new Intl.DateTimeFormat([r,"en-US"],{timeZone:e,timeZoneName:"short"}).formatToParts(n).find((function(e){return"timeZoneName"==e.type})))||void 0===t?void 0:t.value)||""},j=function(e){return e?new Date(e):new Date},w=function(e){var t=new Date(e);return Math.ceil(t.getDate()/7)},O=function(e){var t=w(e);return"".concat(5==t?"-1":t).concat((0,a.mM)(e))},S=function(e){var t=9e5;return new Date(Math.ceil(e.getTime()/t)*t)},P=function(e){return 0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()},C=new Date(Date.now()+864e5)},73890:(e,t,n)=>{n.d(t,{lc:()=>u,TF:()=>d,_z:()=>m});var r=n(11699),o=n(69295),i=n(86013),a=n(88391),s=n(21795),l=n(1483),c=n(3852);a.Z.addDefaultLocale(s.Z),a.Z.addLocale(l.Z);var u={default:"default",short:"short"},d=function(e,t){return m(new Date(e),t)},m=function(e,t){var n=(null===t||void 0===t?void 0:t.format)||"default",s=(0,c.Ed)(),l=new a.Z(s);return"short"===n?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,n=new Date;return(0,r.Z)(n,e)<t}(e)?(0,i.t)("time_format.just_now"):function(e){var t=new Date;return 0===(0,o.Z)(t,e)}(e)?l.format(e,"mini"):l.format(e,"twitter-minute-now"):l.format(e)}},70755:(e,t,n)=>{function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{y:()=>u,q:()=>d});var l="OvDGLovptOPNSO5JjplEIssLF1x8Yxc3",c=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new URL("".concat("https://api.giphy.com/v1/gifs","/").concat(e)),r=0,o=Object.entries(t);r<o.length;r++){var i=a(o[r],2),s=i[0],l=i[1];n.searchParams.set(s,l)}return n.toString()},u=function(e){return fetch(c("search",o(o({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{q:e,api_key:l}))).then((function(e){return e.json()}))},d=function(){return fetch(c("trending",o(o({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},{api_key:l}))).then((function(e){return e.json()}))}},85239:(e,t,n)=>{function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{LV:()=>a,H0:()=>s,_d:()=>l,Bk:()=>c,VM:()=>u,iD:()=>d,wA:()=>m,ln:()=>p,SS:()=>v,fN:()=>h,B8:()=>b,UT:()=>g,ee:()=>y,$e:()=>_,Gi:()=>x,HN:()=>j,Zo:()=>w,kx:()=>O,If:()=>S,vX:()=>P,eM:()=>C,lH:()=>k,_V:()=>N,L6:()=>I,a_:()=>A,dF:()=>E,Vq:()=>T,mP:()=>M,Hq:()=>L,jN:()=>R,g5:()=>D,pp:()=>F});var a=Object.freeze({INITIALIZING:"initializing",BACKSTAGE:"backstage",LIVE:"active",ENDED:"inactive",CLOSING:"closing"}),s=Object.freeze({CONFERENCE:"conference",STREAM:"stream",EVENT:"event"}),l=Object.freeze({OPEN:"open",SECRET:"secret",PUBLIC_STREAM:"public_stream"}),c=Object.freeze({SPEAKER:"speaker_view",GRID:"grid_view"}),u=Object.freeze({HOST:"host",SPECTATOR:"spectator",HLS_SPECTATOR:"hlsspectator",MODERATOR:"moderator"}),d=Object.freeze({HOST:"host",MODERATOR:"moderator",COHOST:"cohost",PARTICIPANT:"participant"}),m=Object.freeze({JOINING:"joining",ACTIVE:"active",INACTIVE:"inactive"}),f=Object.freeze({HMS:"hms",LIVEKIT:"livekit"}),p=1,v=function(e){return(null===e||void 0===e?void 0:e.status)===a.BACKSTAGE},h=function(e){return(null===e||void 0===e?void 0:e.status)===a.LIVE},b=function(e){return(null===e||void 0===e?void 0:e.status)===a.CLOSING},g=function(e){return(null===e||void 0===e?void 0:e.status)===a.ENDED},y=function(e){return(null===e||void 0===e?void 0:e.room_type)===s.STREAM},_=function(e){return(null===e||void 0===e?void 0:e.room_type)===s.CONFERENCE},x=function(e){return!0===(null===e||void 0===e?void 0:e.recording_enabled)},j=function(e){return!(null===e||void 0===e||!e.can_manage)},w=function(e){return!(null===e||void 0===e||!e.can_host)},O=function(e){return!(null===e||void 0===e||!e.host_capacity_reached)},S=function(e){return!(null===e||void 0===e||!e.spectator_capacity_reached)},P=function(e){return(null===e||void 0===e?void 0:e.room_type)||s.STREAM},C=function(e){return!(null!==e&&void 0!==e&&e.view_type)||(null===e||void 0===e?void 0:e.view_type)===c.SPEAKER},k=function(e){return(null===e||void 0===e?void 0:e.view_type)===c.GRID},N=function(e){return(null===e||void 0===e?void 0:e.access_type)===l.SECRET},I=function(e){return(null===e||void 0===e?void 0:e.access_type)===l.PUBLIC_STREAM},A=function(e){return"inactive"===(null===e||void 0===e?void 0:e.status)},E=function(e){return(null===e||void 0===e?void 0:e.role)===u.SPECTATOR},T=function(e){return(null===e||void 0===e?void 0:e.role)===u.HLS_SPECTATOR},M=function(e){return(null===e||void 0===e?void 0:e.room_provider)===f.LIVEKIT},L=function(e){return I(e)&&j(e)},R=function(e){return!0===(null===e||void 0===e?void 0:e.limit_url_sharing)},D=function(e){return function(e){return!(null===e||void 0===e||!e.hide_participants_list)}(e)&&!j(e)&&!function(e){return!(null===e||void 0===e||!e.can_moderate)}(e)},F=function(e){var t=null===e||void 0===e?void 0:e.metadata;if(!t)return null;try{return o(o({},JSON.parse(t)),{},{role:e.roleName})}catch(n){return console.error("Error parsing peer metadata",n),null}}},10281:(e,t,n)=>{n.d(t,{J:()=>o,U:()=>i});var r=n(50732),o=function(e){if(e){var t=window.location.href;e.querySelectorAll("a[data-dynamic-login-link]").forEach((function(e){var n=new URL(e.href),r=new URLSearchParams(n.search);r.set("post_login_redirect",encodeURI(t)),n.search=r.toString(),e.href=n.toString()}))}},i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?{post_login_redirect:window.location.href}:{post_login_redirect:window.location.href,signup:!0};return e?t:r.$T.signIn({params:n})}},42599:(e,t,n)=>{n.d(t,{cT:()=>r,sR:()=>o,$q:()=>i});var r=function(e){var t;return(null===(t=e.member_tags)||void 0===t?void 0:t.length)>0},o=function(e){return!!e.website_url||!!e.facebook_url||!!e.twitter_url||!!e.linkedin_url||!!e.instagram_url},i={SIGNUP:"signup",EDIT_PROFILE:"edit_profile",PROFILE_VIEW:"profile_view"}},42550:(e,t,n)=>{n.d(t,{Sr:()=>r,p0:()=>o,eq:()=>i,Lt:()=>a,kh:()=>s,F_:()=>l,y9:()=>c});var r=function(){return"".concat(window.location.origin,"/checkout/")},o=function(e,t){var n,o="".concat(r()).concat(e);if(null!==(n=navigator)&&void 0!==n&&n.clipboard)navigator.clipboard.writeText(o);else{var i=document.createElement("input");i.style="position: absolute; left: -1000px; top: -1000px",i.value=o,document.querySelector(t).appendChild(i),i.focus(),i.setSelectionRange(0,i.value.length),document.execCommand("copy")}},i={MINIMUM:50,MAXIMUM:15e5},a={CARD:"card",PIX:"pix",GOOGLE_PAY:"google_pay",APPLE_PAY:"apple_pay",LINK:"link"},s=function(e){return e===a.PIX},l=function(e){return e===a.CARD},c=function(e,t){return e&&!(null!==t&&void 0!==t&&t.can_be_repurchased)}},31018:(e,t,n)=>{n.d(t,{I:()=>c});var r=n(3852),o=n(14246);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={decimal:2,zero_decimal:0,three_decimals:3},c=function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=(0,r.Kd)((null===(n=window)||void 0===n?void 0:n.locale)||"en"),c=e.smallest_unit||"decimal",u=a(a({},{amountInCents:!0,includeCurrencyCode:!0,includeCurrencySymbol:!0,forceMaxFractionDigits:!1}),i),d=u.amountInCents?t/Math.pow(10,l[c]):t,m=u.forceMaxFractionDigits||d%1!==0?l[c]:0,f=new Intl.NumberFormat(s,{style:"decimal",minimumFractionDigits:m,maximumFractionDigits:m}).format(d),p=u.includeCurrencyCode?e.code.toUpperCase():"",v=u.includeCurrencySymbol?e.symbol:"";return(e.direction===o.RV.rtl?"".concat(p," ").concat(f).concat(v):"".concat(v).concat(f," ").concat(p)).trim()}},23647:(e,t,n)=>{n.d(t,{B:()=>s,H:()=>l});var r=n(86013),o=n(96486),i=n(50732);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e){return(0,o.isString)(e)?e.replace(/(^\w+:|^)\/\//,""):e},l=function(e){var t=e.isProfileDrawerEnabled,n=e.name,s=e.params,l=e.publicUid,c=e.shouldOpenInNewTab,u=void 0!==c&&c,d=e.showMemberProfileDrawer,m=n||(0,r.t)("view_user_profile_name"),f=(0,r.t)("view_user_profile",{user:m});return l?a(u?{href:(0,i.zd)({public_uid:l,params:s}),target:"_blank",rel:"noreferrer"}:t?{onClick:function(e){e.preventDefault(),d({memberPublicId:l,params:s})},href:(0,i.zd)({public_uid:l})}:{href:(0,i.zd)({public_uid:l,params:s})},"aria-label",f):a({onClick:o.noop,href:"#"},"aria-label","")}},3383:(e,t,n)=>{n.d(t,{i:()=>r,h:()=>o});var r=function(e){var t;return null===e||void 0===e||null===(t=e.currentCommunitySettings)||void 0===t?void 0:t.profile_drawer_enabled},o=function(e){var t;return!(null===e||void 0===e||null===(t=e.currentUser)||void 0===t||!t.id)}},4079:(e,t,n)=>{n.d(t,{lu:()=>r,i4:()=>o,OT:()=>i});var r=/[(http(s)?)://(www.)?a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,15}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/,o=/^[-a-zA-Z0-9%_+.~#?&//=]+$/,i=/(^mailto:(?!.*\.\.)[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$)|(^https?:\/\/(?!.*\.\.)[-a-zA-Z0-9_]+\.[a-zA-Z0-9-.]+[^ ]*$)/},20426:(e,t,n)=>{n.d(t,{r:()=>o});var r=n(38503),o=function(){return(0,r.ww)().isAdminUsageContext?"circle":"primary"}},43917:(e,t,n)=>{function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{y:()=>l,z:()=>c});var l=function(e){var t=e.chatMessages,n=e.setChatRoomMessages,o=e.newMessage,i=o.parent_message_id,s=o.sent_at,l=o.sender,c=t.map((function(e){return e.id})).indexOf(i);if(c>-1){var u=t[c],d=u.thread_participants_preview,m=void 0===d?[]:d,f=u.replies_count,p=void 0===f?0:f,v=a(a({},u),{},{replies_count:p+1,last_reply_at:s});l&&m.length<3&&!m.some((function(e){return e.community_member_id===l.community_member_id}))&&(v.thread_participants_preview=[].concat(r(m),[a({},l)])),n([].concat(r(t.slice(0,c)),[v],r(t.slice(c+1))))}},c=function(e){if(!e)return!1;var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.right<=window.innerWidth&&t.bottom<=window.innerHeight}},59887:(e,t,n)=>{n.d(t,{Cz:()=>s.Cz,Nh:()=>a.N,G5:()=>N.G,x3:()=>z,Kb:()=>K,Bk:()=>le,Lx:()=>q,QP:()=>re,ub:()=>r.u,K$:()=>o.K,uk:()=>i.u,pB:()=>W.p,aK:()=>Q.a,$Y:()=>ue,NF:()=>pe,Tl:()=>l.T,nw:()=>b,Mk:()=>k,TC:()=>a.T,_q:()=>s._q,xX:()=>N.x,KR:()=>I.K,ih:()=>ce,rZ:()=>H,gJ:()=>V.g});var r=n(94739),o=n(57526),i=n(59256),a=n(27434),s=n(21451),l=n(58783),c=n(67294),u=n(96486),d=n(88767),m=n(81089),f=n(50732),p=n(69647);function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e){var t=e.parentMessage,n=e.threadMessageId,r=e.successCallback,o=void 0===r?u.noop:r,i=v((0,c.useState)([]),2),a=i[0],s=i[1],l=(0,p.p)().error,h=(0,d.useQuery)(["THREAD_MESSAGES",null===t||void 0===t?void 0:t.id,null===t||void 0===t?void 0:t.chat_room_uuid],(function(e){var r=e.previousPerPage,o=void 0===r?15:r,i=e.nextPerPage,a={previous_per_page:o,next_per_page:void 0===i?0:i,parent_message_id:t.id,id:n};return(0,m.UT)(f.av.chatRoomMessages.index({uuid:t.chat_room_uuid,params:a}))}),{enabled:!!t,onSuccess:function(e){s(e.records),o()},onError:function(e){l(e.message)}}),b=h.isLoading;return{fetchThreadMessages:h.refetch,threadMessages:a,isLoading:b}},g=n(64687),y=n.n(g),_=n(98338);function x(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function j(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=["chat-threads-list"],k=function(){var e,t=(0,_.wh)().currentCommunityMember,n=(0,d.useQueryClient)(),r=function(e){n.setQueryData(C,(function(t){return S(S({},t),{},{pages:t.pages.map((function(t,n){return S(S({},t),{},{records:e.slice(10*n,10*(n+1))})}))})}))},o=(0,d.useInfiniteQuery)(C,(function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,m.UT)(f.av.chatThreads.index({params:{page:t,per_page:10}}))}),{select:function(e){var t=e.pages,n=void 0===t?[]:t;return(0,u.flatten)(n.map((function(e){return e.records})))},enabled:!(null===t||void 0===t||null===(e=t.policies)||void 0===e||!e.can_access_threads_tab),getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),i=o.data,a=void 0===i?[]:i,s=o.isLoading,l=o.refetch,c=o.hasNextPage,p=o.fetchNextPage,v=function(){var e,t=(e=y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,m.UT)(f.av.chatThreads.show({id:t}));case 3:n=e.sent,r([n].concat(j(a))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){x(i,r,o,a,s,"next",e)}function s(e){x(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),h=function(e){if(null===e||void 0===e||!e.unread_flow)if(a.every((function(t){return t.parent_message.id!==e.parent_message_id})))v(e.chat_thread_id);else{var t=a.map((function(t){if(t.parent_message.id===e.parent_message_id){var n=t.parent_message,r=t.replies;return S(S({},t),{},{parent_message:S(S({},n),{},{replies_count:n.replies_count+1}),replies:[].concat(j(r),[e])})}return t}));r(t)}},b=function(e){if((0,u.isNull)(e.parent_message_id))!function(e){var t=a.map((function(t){return t.parent_message.id!==e.id?t:S(S({},t),{},{parent_message:S(S({},t.parent_message),e)})}));r(t)}(e);else{var t=a.map((function(t){if(t.parent_message.id!==e.parent_message_id)return t;var n=t.replies.map((function(t){return t.id===e.id?e:t}));return S(S({},t),{},{replies:n})}));r(t)}},g=function(e){var t=e||{},n=t.id,o=t.parent_message,i=o||{},s=i.id,l=i.replies_count;if(a.some((function(e){return e.parent_message.id===n})))r(a.filter((function(e){return e.parent_message.id!==n})));else if(0===l)r(a.filter((function(e){return e.parent_message.id!==s})));else{var c=a.map((function(e){if(e.parent_message.id!==s)return e;var t=e.replies.filter((function(e){return e.id!==n}));return S(S({},e),{},{parent_message:o,replies:t})}));r(c)}},w=a.length>0;return{chatThreads:a,setChatThreads:r,isLoading:s,refetchChatThreads:l,isChatThreadsAvailable:w,hasNextPage:c,fetchNextPage:p,onEventReceive:function(e){switch(e.event){case"newMessage":h(e.json_message);break;case"updatedMessage":b(e.json_message);break;case"deletedMessage":g(e)}},updateChatThreads:function(e){var t=e[0].parent_message_id,n=a.map((function(n){return n.parent_message.id===t?S(S({},n),{},{replies:(0,u.uniqBy)([].concat(j(e),j(n.replies)),"id")}):n}));r(n)}}},N=n(41320),I=n(91008),A=n(24185),E=n(34914),T=n(43917),M=n(85893);function L(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||D(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||D(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){if(e){if("string"===typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var U=(0,c.createContext)(B);U.displayName="UnreadChatThreadsContext";var B={chatThreadIds:[]},z=function(e){var t,n=e.children,r=(0,_.wh)().currentCommunityMember,o=R((0,c.useState)([]),2),i=o[0],a=o[1],s=R((0,c.useState)(!1),2),l=s[0],u=s[1],v=(0,p.p)().error,h="/threads"===(0,A.TH)().pathname;(0,E.s)({channel:"Chats::CommunityMemberThreadsChannel",onMessageReceive:function(e){x(e)},community_member_id:null===r||void 0===r?void 0:r.id,canCreateConnection:Boolean(null===r||void 0===r?void 0:r.id)},[null===r||void 0===r?void 0:r.id]);var b=(0,d.useQuery)(["thread_messages","unread",null===r||void 0===r?void 0:r.id],(function(){return(0,m.UT)(f.av.chatThreads.unreadChatThreads())}),{enabled:!(null===r||void 0===r||null===(t=r.policies)||void 0===t||!t.can_access_threads_tab),onSuccess:function(e){a(e.chat_thread_ids)},onError:function(e){v(e.message)}}),g=b.isLoading,y=b.refetch,x=function(e){"chatThreadRead"===e.event?j(e.chat_thread_id):"newMessage"===e.event&&w(e.json_message)},j=function(e){if(i.includes(e)){var t=i.filter((function(t){return t!==Number(e)}));a(t)}},w=function(e){var t;null!==e&&void 0!==e&&e.unread_flow&&u(!0);var n=(null===(t=e.sender)||void 0===t?void 0:t.community_member_id)===(null===r||void 0===r?void 0:r.id),o=!e.chat_thread_id,s=i.includes(e.chat_thread_id);if(!(o||n||s)){if(h){var l=e.chat_thread_id,c=document.getElementById(l);if((0,T.z)(c))return}a((function(t){return[].concat(L(t),[e.chat_thread_id])}))}},O={fetchUnreadChatThreads:y,unreadChatThreadIds:i,unreadThreadsCount:i.length,isLoading:g,onEventReceive:x,isUnreadThreadFlow:l};return(0,M.jsx)(U.Provider,{value:O,children:n})},H=function(){return(0,c.useContext)(U)},Z=n(74666),q=function(e){var t=e.current_participant,n=e.chat_room_kind===Z.g8,r=null===t||void 0===t?void 0:t.can_send_message_in_room,o=!(0,u.isEmpty)(t)&&!t.deleted_at;return{canSendMessage:n?r:o,canParticipantsMessage:r}},V=n(18738),W=n(64621),Q=n(58790);function $(e,t){return $=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$(e,t)}function G(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J(e);if(t){var o=J(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}var K=new(function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(n,e);var t=G(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).toggleMessageBookmark=function(t){e.emit("onBookmarkToggle",t)},e}return n}(n(17187).EventEmitter)),Y=n(35102),X=n(82732);function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re=function(){var e=(0,Y.f4)(),t=e.chatRoomMessages,n=e.setChatRoomMessages,r=e.setScrollInfo,o=(0,X.O)().calculateScrollInfo,i=(0,N.x)(),a=i.parentMessage,s=i.updateParentMessage,l=function(e){var i=e.communityMemberId,l=e.emoji,c=e.reactionableId,u=structuredClone(t),d=u.findIndex((function(e){return e.id===c}));if(-1!==d){var m,f,p=u[d].reactions.findIndex((function(e){return e.emoji===l}));if(null!==(m=u[d].reactions[p])&&void 0!==m&&null!==(f=m.community_member_ids)&&void 0!==f&&f.includes(i))return;if(-1!==p?(u[d].reactions[p].community_member_ids.push(i),u[d].reactions[p].count+=1):u[d].reactions.push({emoji:l,community_member_ids:[i],count:1}),r(o({event:"reaction"})),n(u),(null===a||void 0===a?void 0:a.id)===c){var v=t.find((function(e){return e.id===a.id}));v&&s(te({},v))}}},c=function(e){var i=e.communityMemberId,l=e.emoji,c=e.reactionableId,u=structuredClone(t),d=u.findIndex((function(e){return e.id===c}));if(-1!==d){var m,f,p=u[d].reactions.findIndex((function(e){return e.emoji===l}));if(null===(m=u[d].reactions[p])||void 0===m||null===(f=m.community_member_ids)||void 0===f||!f.includes(i))return;if(-1!==p&&(1===u[d].reactions[p].count?u[d].reactions.splice(p,1):(u[d].reactions[p].community_member_ids=u[d].reactions[p].community_member_ids.filter((function(e){return e!==i})),u[d].reactions[p].count-=1)),r(o({event:"reaction"})),n(u),(null===a||void 0===a?void 0:a.id)===c){var v=t.find((function(e){return e.id===a.id}));v&&s(te({},v))}}},u=function(e){if("ChatRoomMessage"===e.json_message.reactionable_type){var t=e.json_message,n=t.community_member_id,r=t.emoji,o=t.reactionable_id;"createReaction"===e.event?l({communityMemberId:n,emoji:r,reactionableId:o}):"destroyReaction"===e.event&&c({communityMemberId:n,emoji:r,reactionableId:o})}};return{createReactionFromMessage:l,removeReactionFromMessage:c,handleReactionFromWebsocket:u,onReactionWebsocketEvent:function(e){switch(e.event){case"createReaction":case"destroyReaction":u(e)}}}};function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function se(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var le=function(e,t){var n=(0,c.useCallback)(function(){var n,r=(n=y().mark((function n(r){var o,i,a;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.find((function(e){return e.id===r}))){n.next=3;break}return n.abrupt("return");case 3:if(null===o||void 0===o||!o.bookmark_id){n.next=7;break}i=ie(ie({},o),{},{bookmark_id:null}),n.next=10;break;case 7:return n.next=9,(0,m.UT)(f.av.chatRoomMessages.show({uuid:o.chat_room_uuid,id:o.id}));case 9:i=n.sent;case 10:if(i){n.next=12;break}return n.abrupt("return");case 12:a=e.map((function(e){return e.id===o.id?i:e})),t(a);case 14:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){se(i,r,o,a,s,"next",e)}function s(e){se(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}(),[e,t]);return(0,c.useEffect)((function(){var e=function(e){n(e)};return K.on("onBookmarkToggle",e),function(){K.off("onBookmarkToggle",e)}}),[n]),n},ce=function(e){var t=e.communityId,n=(0,_.wh)().currentCommunity,r=t||(null===n||void 0===n?void 0:n.id),o=(0,Q.a)().unreadChatRoomUuids;return(0,u.isNull)(r)?[]:o[r]||[]},ue=function(){var e=(0,d.useQueryClient)(),t=function(){e.invalidateQueries(["chat-threads-list"])},n=function(){t()},r=function(){t()};return{createReactionFromThreadList:n,removeReactionFromThreadList:r,handleReactionFromWebsocket:function(e){"ChatRoomMessage"===e.json_message.reactionable_type&&("createReaction"===e.event?n():"destroyReaction"===e.event&&r())}}};function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pe=function(){var e=(0,N.x)(),t=e.parentMessage,n=e.updateParentMessage,r=(0,Y.qN)(),o=r.chatMessages,i=r.setChatMessages,a=r.scrollInfo,s=r.setScrollInfo,l=function(e){var r=e.communityMemberId,l=e.emoji,c=e.reactionableId;if((null===t||void 0===t?void 0:t.id)===c){var u,d,m=structuredClone(t),f=m.reactions.findIndex((function(e){return e.emoji===l}));if(null!==(u=m.reactions[f])&&void 0!==u&&null!==(d=u.community_member_ids)&&void 0!==d&&d.includes(r))return;-1!==f?(m.reactions[f].community_member_ids.push(r),m.reactions[f].count+=1):m.reactions.push({emoji:l,community_member_ids:[r],count:1}),n(m)}else{var p=structuredClone(o),v=p.findIndex((function(e){return e.id===c}));if(-1!==v){var h,b,g=p[v].reactions.findIndex((function(e){return e.emoji===l}));if(null!==(h=p[v].reactions[g])&&void 0!==h&&null!==(b=h.community_member_ids)&&void 0!==b&&b.includes(r))return;-1!==g?(p[v].reactions[g].community_member_ids.push(r),p[v].reactions[g].count+=1):p[v].reactions.push({emoji:l,community_member_ids:[r],count:1}),s(me(me({},a),{},{action:"noScroll"})),i(p)}}},c=function(e){var r=e.communityMemberId,l=e.emoji,c=e.reactionableId;if((null===t||void 0===t?void 0:t.id)===c){var u,d,m=structuredClone(t),f=m.reactions.findIndex((function(e){return e.emoji===l}));if(null===(u=m.reactions[f])||void 0===u||null===(d=u.community_member_ids)||void 0===d||!d.includes(r))return;-1!==f&&(1===m.reactions[f].count?m.reactions.splice(f,1):(m.reactions[f].community_member_ids=m.reactions[f].community_member_ids.filter((function(e){return e!==r})),m.reactions[f].count-=1),n(m))}else{var p=structuredClone(o),v=p.findIndex((function(e){return e.id===c}));if(-1!==v){var h,b,g,y,_=null===(h=p[v])||void 0===h||null===(b=h.reactions)||void 0===b?void 0:b.findIndex((function(e){return e.emoji===l}));if(null===(g=p[v].reactions[_])||void 0===g||null===(y=g.community_member_ids)||void 0===y||!y.includes(r))return;-1!==_&&(1===p[v].reactions[_].count?p[v].reactions.splice(_,1):(p[v].reactions[_].community_member_ids=p[v].reactions[_].community_member_ids.filter((function(e){return e!==r})),p[v].reactions[_].count-=1)),s(me(me({},a),{},{action:"noScroll"})),i(p)}}};return{createReactionFromThread:l,removeReactionFromThread:c,handleReactionFromWebsocket:function(e){if("ChatRoomMessage"===e.json_message.reactionable_type){var t=e.json_message,n=t.community_member_id,r=t.emoji,o=t.reactionable_id;"createReaction"===e.event?l({communityMemberId:n,emoji:r,reactionableId:o}):"destroyReaction"===e.event&&c({communityMemberId:n,emoji:r,reactionableId:o})}}}}},35102:(e,t,n)=>{n.d(t,{qN:()=>d,nC:()=>m,Dk:()=>f,f4:()=>p});var r=n(277),o=n(58790);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){return e.threads},c=function(e){return e.ui},u=function(e){return e.inbox},d=function(){return(0,o.a)(l)},m=function(){return(0,o.a)(c)},f=function(){return(0,o.a)(u)},p=function(){return a(a({},(t=(0,o.a)().createNewChatRoom,n=(0,r.q)().chatRoomUuid,(0,o.a)((e=n,function(t){return t.chatRoomsMap[e]}))||t(n))),function(){var e=(0,o.a)().roomActions,t=(0,r.q)().chatRoomUuid;return{setChatRoomMessages:function(n){return e.setChatRoomMessages(t,n)},setIsLoading:function(n){return e.setIsLoading(t,n)},setIsInitialPageLoaded:function(n){return e.setIsInitialPageLoaded(t,n)},setHasNextPage:function(n){return e.setHasNextPage(t,n)},setHasPrevPage:function(n){return e.setHasPrevPage(t,n)},setScrollInfo:function(n){return e.setScrollInfo(t,n)},setFirstMessageId:function(n){return e.setFirstMessageId(t,n)},setLastMessageId:function(n){return e.setLastMessageId(t,n)},setShouldShowLatestMessageBtn:function(n){return e.setShouldShowLatestMessageBtn(t,n)},setTopMessageId:function(n){return e.setTopMessageId(t,n)},setActiveMessageId:function(n){return e.setActiveMessageId(t,n)},resetChatRoom:function(){return e.resetChatRoom(t)}}}());var e,t,n}},58790:(e,t,n)=>{n.d(t,{a:()=>j});var r=n(73445),o=n(32714),i={chatRoomMessages:[],isLoading:!1,hasNextPage:!1,hasPrevPage:!1,scrollInfo:{},firstMessageId:null,lastMessageId:null,shouldShowLatestMessageBtn:!1,topMessageId:null,isInitialPageLoaded:!1,activeMessageId:null},a=(0,o.n)((function(e){return{chatRoomsMap:{},createNewChatRoom:function(t){return e((function(e){e.chatRoomsMap[t]=i})),i},roomActions:{setChatRoomMessages:function(t,n){return e((function(e){e.chatRoomsMap[t].chatRoomMessages=n}))},setIsLoading:function(t,n){return e((function(e){e.chatRoomsMap[t].isLoading=n}))},setIsInitialPageLoaded:function(t,n){return e((function(e){e.chatRoomsMap[t].isInitialPageLoaded=n}))},setHasNextPage:function(t,n){return e((function(e){e.chatRoomsMap[t].hasNextPage=n}))},setHasPrevPage:function(t,n){return e((function(e){e.chatRoomsMap[t].hasPrevPage=n}))},setScrollInfo:function(t,n){return e((function(e){e.chatRoomsMap[t].scrollInfo=n}))},setFirstMessageId:function(t,n){return e((function(e){e.chatRoomsMap[t].firstMessageId=n}))},setLastMessageId:function(t,n){return e((function(e){e.chatRoomsMap[t].lastMessageId=n}))},setShouldShowLatestMessageBtn:function(t,n){return e((function(e){e.chatRoomsMap[t].shouldShowLatestMessageBtn=n}))},setTopMessageId:function(t,n){return e((function(e){e.chatRoomsMap[t].topMessageId=n}))},setActiveMessageId:function(t,n){return e((function(e){e.chatRoomsMap[t].activeMessageId=n}))},resetChatRoom:function(t){return e((function(e){e.chatRoomsMap[t]=i}))}}}})),s=n(56179),l=n(40179);function c(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=(0,o.n)((function(e,t){return{inbox:{currentChatId:null,setCurrentChatId:function(t){return e((function(e){e.inbox.currentChatId=t}))},chats:[],setChats:function(t){return e((function(e){e.inbox.chats=t}))},appendChat:function(n){t().inbox.chats.some((function(e){return e.id===n.id}))||e((function(e){e.inbox.chats=[n].concat(c(e.inbox.chats))}))},updateChat:function(t){e((function(e){var n=e.inbox.chats.findIndex((function(e){return e.id===t.id}));-1!==n&&(e.inbox.chats[n]=t)}))},destroyChat:function(t){e((function(e){e.inbox.chats=e.inbox.chats.filter((function(e){return e.id!==t}))}))},adminMarkAsRead:function(t){l.MW.adminMarkAsRead({id:t}).then((function(){e((function(e){var n=e.inbox.chats.findIndex((function(e){return e.id===t}));-1!==n&&(e.inbox.chats[n].has_unread_messages_for_admin=!1)}))})).catch((function(e){console.error(e)}))},memberMarkAsRead:function(t){l.MW.memberMarkAsRead({id:t}).then((function(){e((function(e){var n=e.inbox.chats.findIndex((function(e){return e.id===t}));-1!==n&&(e.inbox.chats[n].has_unread_messages_for_member=!1)}))})).catch((function(e){console.error(e)}))},messages:[],setMessages:function(t){return e((function(e){e.inbox.messages=t}))},appendMessage:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"member";n.community_inbox_chat_id===Number(t().inbox.currentChatId)?t().inbox.messages.some((function(e){return e.id===n.id}))||e((function(e){e.inbox.messages=[].concat(c(e.inbox.messages),[n])})):e((function(e){var t=e.inbox.chats.findIndex((function(e){return e.id===n.community_inbox_chat_id}));-1!==t&&("member"===r?e.inbox.chats[t].has_unread_messages_for_member=!0:e.inbox.chats[t].has_unread_messages_for_admin=!0)}))},updateMessage:function(n){n.community_inbox_chat_id===Number(t().inbox.currentChatId)&&e((function(e){var t=e.inbox.messages.findIndex((function(e){return e.id===n.id}));-1!==t&&(e.inbox.messages[t]=n)}))},destroyMessage:function(t){e((function(e){e.inbox.messages=e.inbox.messages.filter((function(e){return e.id!==t}))}))},resetMessages:function(){return e((function(e){e.inbox.messages=[]}))},scrollAction:s.aO.FIRST_LOAD,setScrollAction:function(t){e((function(e){e.inbox.scrollAction=t}))},currentBotProfile:null,setCurrentBotProfile:function(t){e((function(e){e.inbox.currentBotProfile=t}))}}}}));function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v={chatMessages:[],isLoading:!1,hasNextPage:!1,hasPrevPage:!1,scrollInfo:{},firstMessageId:null,lastMessageId:null,totalMessagesCount:0,metaData:{}},h=(0,o.n)((function(e){return{threads:f(f({},v),{},{setChatMessages:function(t){return e((function(e){e.threads.chatMessages=t}))},setIsLoading:function(t){return e((function(e){e.threads.isLoading=t}))},setHasNextPage:function(t){return e((function(e){e.threads.hasNextPage=t}))},setHasPrevPage:function(t){return e((function(e){e.threads.hasPrevPage=t}))},setScrollInfo:function(t){return e((function(e){e.threads.scrollInfo=t}))},setFirstMessageId:function(t){return e((function(e){e.threads.firstMessageId=t}))},setLastMessageId:function(t){return e((function(e){e.threads.lastMessageId=t}))},setTotalMessagesCount:function(t){return e((function(e){e.threads.totalMessagesCount=t}))},setMetaData:function(t){return e((function(e){e.threads.metaData=t}))}})}})),b=(0,o.n)((function(e){return{ui:{liveChatRoomUuid:null,setLiveChatRoomUuid:function(t){return e((function(e){e.ui.liveChatRoomUuid=t}))},dmSelectedTabIndex:0,setDmSelectedTabIndex:function(t){return e((function(e){e.ui.dmSelectedTabIndex=t}))}}}})),g=(0,o.n)((function(e){return{unreadChatRoomUuids:{},setUnreadChatRoomUuids:function(t,n){return e((function(e){e.unreadChatRoomUuids[t]=n}))},appendUnreadChatRoomUuids:function(t,n){return e((function(e){e.unreadChatRoomUuids[t]||(e.unreadChatRoomUuids[t]=[]),e.unreadChatRoomUuids[t].push(n)}))}}}));function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=(0,r.Ue)()((function(){return _(_(_(_(_({},a.apply(void 0,arguments)),h.apply(void 0,arguments)),g.apply(void 0,arguments)),b.apply(void 0,arguments)),d.apply(void 0,arguments))}))},94739:(e,t,n)=>{n.d(t,{u:()=>w});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(81089),l=n(50732),c=n(35102),u=n(41320),d=n(43917),m=n(88767),f=n(82732);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){g(i,r,o,a,s,"next",e)}function s(e){g(i,r,o,a,s,"throw",e)}a(void 0)}))}}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(){var e=(0,c.f4)(),t=e.chatRoomMessages,n=e.setChatRoomMessages,r=e.isLoading,p=e.setIsLoading,h=e.hasNextPage,g=e.hasPrevPage,x=e.setHasNextPage,j=e.setHasPrevPage,w=e.scrollInfo,O=e.setScrollInfo,S=e.firstMessageId,P=e.setFirstMessageId,C=e.lastMessageId,k=e.setLastMessageId,N=e.shouldShowLatestMessageBtn,I=e.setShouldShowLatestMessageBtn,A=e.topMessageId,E=e.setTopMessageId,T=e.isInitialPageLoaded,M=e.setIsInitialPageLoaded,L=e.resetChatRoom,R=_((0,i.useState)(!1),2),D=R[0],F=R[1],U=(0,u.x)(),B=U.parentMessage,z=U.updateParentMessage,H={markChatRoomAsRead:(0,m.useMutation)((function(e){var t=l.av.chatRooms.markAllAsRead({uuid:e});return(0,s.Cu)(t)})).mutateAsync}.markChatRoomAsRead,Z=(0,f.O)(),q=Z.calculateScrollInfo,V=Z.getScrollingElement,W=Z.scrollerId,Q=function(){var e=y(o().mark((function e(i){var c,u,d,m,f,v,y,_,w,S,C,N,I,A,T;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=i.id,u=i.previousPerPage,d=void 0===u?20:u,m=i.nextPerPage,f=void 0===m?0:m,v=i.chatRoomUuid,y=i.isInitialPage,_=void 0!==y&&y,w=i.parentMessageId,!(S=0===d)||!r){e.next=4;break}return e.abrupt("return");case 4:return p(!0),C={previous_per_page:d,next_per_page:f},c&&(C.id=c),w&&(C.parent_message_id=w),e.next=10,(0,s.UT)(l.av.chatRoomMessages.index({uuid:v,params:C}));case 10:N=e.sent,_?(O(q({event:"chatRoomLoad"})),N.records&&n(N.records),x(N.has_next_page),j(N.has_previous_page),P(N.first_id),k(N.last_id),M(!0)):(S?(O(q({event:"nextPaginatedMessageLoad"})),k(N.last_id)):(O(q({event:"paginatedMessageLoad"})),P(N.first_id)),(I=b(t)).length>60?S?(I=I.slice(0,40),A=(0,a.sortBy)(I,"sent_at"),P(A[0].id),j(!0)):(E(c),I=I.slice(0,40),T=(0,a.sortBy)(I,"sent_at"),k(T[I.length-1].id),x(!0)):E(null),n([].concat(b(N.records),b(I))),h&&x(N.has_next_page),g&&j(N.has_previous_page)),!N.has_next_page&&!D&&H(v),p(!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=y(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,L(),r={chatRoomUuid:t,isInitialPage:!0},n&&(r=v(v({},r),{},{id:n,previousPerPage:20,nextPerPage:20})),e.next=6,Q(r);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),G=function(e,t){var r=e.id,o=e.parent_message;if(o){var i=t.map((function(e){return e.id===o.id?o:e}));n(i)}else{var a=t.filter((function(e){return e.id!==r}));n(a)}},J=function(e,t){O(q({event:"messageUpdated"}));var r=e.json_message,o=t.reduce((function(e,t){return t.id===r.id?e.push(v(v({},t),r)):e.push(t),e}),[]);n(b(o)),r.id===(null===B||void 0===B?void 0:B.id)&&z(r)},K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.json_message;r.parent_message_id&&(O(q({event:"parentMessageUpdated"})),(0,d.y)({chatMessages:t,setChatRoomMessages:n,newMessage:r}))};return{chatRoomMessages:t,setChatRoomMessages:n,messagesHasNextPage:h,messagesHasPrevPage:g,setScrollInfo:O,fetchChatMessages:Q,fetchChatMessagesFirstPage:$,calculateScrollInfo:q,adjustScroller:function(){var e=V(),t=document.getElementById("unread-message-breakpoint");switch(w.action){case"scrollToBottom":e.scrollTop=e.scrollHeight;break;case"adjustTop":if(A){var n=document.getElementById(A);null===n||void 0===n||n.scrollIntoView()}else e.scrollTop=e.scrollHeight-(w.scrollHeightValue-w.scrollTopValue);break;case"scrollToUnreadMessageIndicator":t?t.scrollIntoView({behavior:"smooth"}):e.scrollTop=e.scrollHeight}},isLoading:r,firstMessageId:S,lastMessageId:C,onEventReceive:function(e,t){switch(e.event){case"newMessage":K(e,t);break;case"deletedMessage":G(e,t);break;case"updatedMessage":J(e,t)}},isInitialPageLoaded:T,shouldShowLatestMessageBtn:N,setShouldShowLatestMessageBtn:I,setFirstMessageId:P,setMessagesHasPrevPage:j,setUnreadMessageFlow:F,scrollerId:W}}},57526:(e,t,n)=>{n.d(t,{K:()=>x});var r=n(67294),o=n(88767),i=n(81089),a=n(50732),s=n(64687),l=n.n(s),c=n(74666),u=n(59887),d=n(34334);function m(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e){var t=e.communityId,n=(0,u.aK)().setUnreadChatRoomUuids,s=(0,u.ih)({communityId:t}),v=p((0,r.useState)([]),2),h=v[0],b=v[1],g=p((0,r.useState)(null),2),y=g[0],_=g[1],x=(0,r.useRef)(s),j=(0,r.useRef)(h),w=function(e){return(0,o.useMutation)((function(){return d.MS.getChatRoomCurrentParticipant(e)}),{mutationKey:["chatroom","participant",e]})}(y),O=function(){var e,t=(e=l().mark((function e(t,n,r){var o,i,a,s,u,d,f,p,v,h,g,y,x;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.json_message,s=a.chat_room_uuid,u=a.chat_room_kind,d=a.sender,f=a.embedded,p=null===(o=window.location.pathname)||void 0===o?void 0:o.split("messages/")[1],v=d.community_member_id,h=p===s,g=u===c.g8,!0!==f&&!h){e.next=8;break}return e.abrupt("return");case 8:if(_(s),!g){e.next=13;break}e.t0={},e.next=16;break;case 13:return e.next=15,w.mutateAsync();case 15:e.t0=e.sent;case 16:if(y=e.t0,x=y.chat_room_participant,!(v===r||null!==x&&void 0!==x&&null!==(i=x.preferences)&&void 0!==i&&i.muted)){e.next=20;break}return e.abrupt("return");case 20:t.find((function(e){return e===s}))||(b([].concat(m(j.current),[s])),setTimeout((function(){return S()}),2e3));case 22:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e,n,r){return t.apply(this,arguments)}}(),S=function(){n(t,m(new Set([].concat(m(x.current),m(j.current)))))};return{unreadChatRoomUuids:s,onEventReceive:function(e,r,o){switch(r.event){case"newMessage":O(e,r,o);break;case"chatRoomRead":!function(e,r){var o=r.chat_room_uuid,i=e.filter((function(e){return e!==o})),a=j.current.filter((function(e){return e!==o}));b(a),n(t,i)}(e,r)}},fetchUnreadChatRoomUuids:function(e){(0,i.UT)(a.av.chatRooms.unreadChatRooms({params:{community_id:e}})).then((function(t){t.chat_room_uuids&&n(e,t.chat_room_uuids)})).catch((function(e){console.error(e)}))},unreadChatRoomUuidsRef:x,newUnreadChatRoomBatch:h,newUnreadChatRoomBatchRef:j,setUnreadChatRoomUuids:n}},g=n(34914),y=n(98338),_=n(78208),x=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).community,t=(0,y.wh)(),n=t.currentCommunity,s=t.currentCommunityMember,l=(0,_.gq)().showMessagesTab,c=e?e.community_member_id:null===s||void 0===s?void 0:s.id,u=e?e.id:null===n||void 0===n?void 0:n.id,d=b({communityId:u}),m=d.unreadChatRoomUuids,f=d.onEventReceive,p=d.setUnreadChatRoomUuids,v=d.unreadChatRoomUuidsRef,h=d.newUnreadChatRoomBatch,x=d.newUnreadChatRoomBatchRef;return(0,o.useQuery)(["UNREAD_CHAT_ROOMS_COUNT",u,c],(function(){return(0,i.UT)(a.av.chatRooms.unreadChatRooms({params:{community_id:u}}))}),{enabled:Boolean(u&&c&&l),onSuccess:function(e){e.chat_room_uuids&&p(u,e.chat_room_uuids)}}),(0,g.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){f(v.current,e,c)},community_member_id:c,canCreateConnection:Boolean(u&&c)}),(0,r.useEffect)((function(){v.current=m}),[m]),(0,r.useEffect)((function(){x.current=h}),[h]),{unreadChatCount:m.length,unreadChatRoomUuids:m}}},59256:(e,t,n)=>{n.d(t,{U:()=>f,u:()=>p});var r=n(96486),o=n(88767),i=n(81089),a=n(50732),s=n(14856),l=["shouldDisableCache"];function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var f=20,p=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shouldDisableCache:!1,per_page:f},c=["chat-participants",e],d=n.shouldDisableCache,p=m(n,l),v=function(){var e=(s.Eh.getQueryState({queryKey:c})||{}).data,t=(0,r.flatten)(((null===e||void 0===e?void 0:e.pages)||[]).map((function(e){return e.records})));return(0,r.uniqBy)(t,"id")},h=(0,o.useInfiniteQuery)(c,(function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,i.UT)(a.av.chatRoomParticipants.index({uuid:e,params:u({page:n},p)}))}),{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{participants:(0,r.uniqBy)((0,r.flatten)((n||[]).map((function(e){return e.records}))),"id"),totalCount:n[0].count}},enabled:(0===(null===(t=v())||void 0===t?void 0:t.length)||d)&&Boolean(e),getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),b=h.data,g=h.isLoading,y=h.refetch,_=h.hasNextPage,x=h.fetchNextPage,j=(b||{}).totalCount,w=void 0===j?0:j;return{chatParticipants:v(),isLoading:g,refetchChatParticipants:e?y:r.noop,hasNextPage:_,totalCount:w,fetchNextPage:x}}},64621:(e,t,n)=>{n.d(t,{p:()=>y});var r=n(64687),o=n.n(r),i=n(86013),a=n(24185),s=n(81089),l=n(19647),c=n(50732),u=n(69647),d=["shouldNavigate"],m=["shouldNavigate"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)}))}}var y=function(){var e=(0,a.k6)(),t=(0,u.p)(),n=function(){var n=g(o().mark((function n(r){var a,u,m,f,p,v;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.shouldNavigate,u=void 0!==a&&a,m=h(r,d),n.prev=1,f=m.community_member_ids,n.next=5,(0,s.UT)(c.av.chatRooms.fetch({params:{community_member_ids:f}}));case 5:return p=n.sent,v=p.uuid,u&&e.push((0,c.so)({uuid:v})),n.abrupt("return",v);case 11:n.prev=11,n.t0=n.catch(1),t.error((0,i.t)("something_went_wrong")),(0,l.d)(n.t0);case 15:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e){return n.apply(this,arguments)}}(),r=function(){var n=g(o().mark((function n(r){var a,u,d,f,v,b;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.shouldNavigate,u=void 0!==a&&a,d=h(r,m),n.prev=1,f={chat_room:d},n.next=5,(0,s.Cu)(c.av.chatRooms.create(),p({},f));case 5:return v=n.sent,b=v.chat_room.uuid,u&&e.push((0,c.so)({uuid:v.chat_room.uuid})),n.abrupt("return",b);case 11:n.prev=11,n.t0=n.catch(1),t.error((0,i.t)("something_went_wrong")),(0,l.d)(n.t0);case 15:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e){return n.apply(this,arguments)}}();return{findChatRoom:n,findOrCreateChatRoom:r}}},277:(e,t,n)=>{n.d(t,{A:()=>a,q:()=>s});var r=n(67294),o=n(85893),i=(0,r.createContext)({chatRoomUuid:"main"});i.displayName="ChatRoomContext";var a=function(e){var t=e.chatRoomUuid,n=e.isMessaging,r=e.children;return(0,o.jsx)(i.Provider,{value:{chatRoomUuid:t,isMessaging:n},children:r})},s=function(){return(0,r.useContext)(i)}},58783:(e,t,n)=>{n.d(t,{T:()=>_});var r=n(64687),o=n.n(r),i=n(67294),a=n(86013),s=n(96486),l=n(81089),c=n(50732),u=n(35102),d=n(34334),m=n(41320),f=n(69647),p=n(32548);function v(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _=function(){var e=(0,u.qN)(),t=e.chatMessages,n=e.setChatMessages,r=e.isLoading,g=e.setIsLoading,y=e.hasNextPage,_=e.hasPrevPage,x=e.setHasNextPage,j=e.setHasPrevPage,w=e.scrollInfo,O=e.setScrollInfo,S=e.setFirstMessageId,P=e.setLastMessageId,C=e.setTotalMessagesCount,k=e.setMetaData,N=b((0,i.useState)(!1),2),I=N[0],A=N[1],E=(0,p.j)().isMobileView,T=(0,m.x)(),M=T.parentMessage,L=T.updateParentMessage,R=(0,f.p)().error,D=function(){var e,i=(e=o().mark((function e(i){var u,m,f,p,h,b,w,N,I,E,T,M,L;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=i.id,m=i.previousPerPage,f=void 0===m?20:m,p=i.nextPerPage,h=void 0===p?0:p,b=i.chatRoomUuid,w=i.isInitialPage,N=void 0!==w&&w,I=i.parentMessage,!(E=0===f)&&!N||!r){e.next=4;break}return e.abrupt("return");case 4:return g(!0),T={previous_per_page:f,next_per_page:h,parent_message_id:I.id},u&&(T.id=u),e.prev=7,e.next=10,(0,l.UT)(c.av.chatRoomMessages.index({uuid:b,params:T}));case 10:M=e.sent,N?(null!==(L=M.meta)&&void 0!==L&&L.chat_thread_participant_id&&(O(F({event:"chatThreadsLoad"})),(0,d.ex)(I.chat_thread_id)),k(M.meta),n(M.records),x(M.has_next_page),j(M.has_previous_page),C(M.total_count),S(M.first_id),P(M.last_id),A(!0)):(E?(O(F({event:"nextPaginatedMessageLoad"})),P(M.last_id)):(O(F({event:"paginatedMessageLoad"})),S(M.first_id)),n((0,s.uniqBy)([].concat(v(M.records),v(t)),"id")),y&&x(M.has_next_page),_&&j(M.has_previous_page)),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),R((0,a.t)("request_failure_message")),console.error(e.t0);case 18:return e.prev=18,g(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[7,14,18,21]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,s,"next",e)}function s(e){h(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return i.apply(this,arguments)}}(),F=function(e){var t=e.event,n=document.getElementById("message-thread-scroll-view"),r="noScroll";switch(t){case"messageSent":r="scrollToBottom";break;case"messageReceived":var o=n.scrollTop-n.scrollHeight+n.offsetHeight;(E()&&0===o||(o<=1||o>14))&&(r="scrollToBottom");break;case"chatThreadsLoad":r="scrollToUnreadMessageIndicator";break;case"paginatedMessageLoad":r="adjustTop";break;case"nextPaginatedMessageLoad":case"messageUpdated":case"messageDeleted":r="noScroll"}return{action:r,scrollTopValue:n.scrollTop,scrollHeightValue:n.scrollHeight}},U=function(e,t){var r=e.id,o=t.filter((function(e){return e.id!==r}));n(o)},B=function(e,t){var r=e.json_message,o=t.reduce((function(e,t){return t.id===r.id?e.push(r):e.push(t),e}),[]);n(v(o)),r.id===(null===M||void 0===M?void 0:M.id)&&L(r)},z=function(e,r){var o=e.json_message;O(F({event:o.sender.id===r.id?"messageSent":"messageReceived"})),n([].concat(v(t),[o]))};return{fetchChatMessages:D,calculateScrollInfo:F,adjustScroller:function(){var e=document.getElementById("message-thread-scroll-view"),t=document.getElementById("unread-thread-message-breakpoint");switch(w.action){case"scrollToBottom":e.scrollTop=e.scrollHeight;break;case"adjustTop":e.scrollTop=e.scrollHeight-(w.scrollHeightValue-w.scrollTopValue);break;case"scrollToUnreadMessageIndicator":t?t.scrollIntoView({behavior:"smooth"}):e.scrollTop=e.scrollHeight}},onEventReceive:function(e,t,n){switch(e.event){case"newMessage":z(e,n);break;case"deletedMessage":U(e,t);break;case"updatedMessage":B(e,t)}},isInitialPageLoaded:I}}},27434:(e,t,n)=>{n.d(t,{N:()=>b,T:()=>y});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(88767),l=n(81089),c=n(50732);function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=["sidebar","chat-rooms","all"],b=["messaging","chat-rooms","all"],g=["sidebar","chat-rooms","unread"],y=function(e){var t=e.openChatRoomUuid,n=e.uuids,r=(0,s.useQueryClient)(),m=(0,i.useMemo)((function(){return n?g:t?b:h}),[n,t]),f=function(e){r.setQueryData(m,(function(t){return p(p({},t),{},{pages:t.pages.map((function(t,n){return p(p({},t||{}),{},{records:e.slice(20*n,20*(Number(n)+1))})}))})}))},v=(0,s.useInfiniteQuery)(m,(function(e){var t,r=e.pageParam;return t={page:void 0===r?1:r,per_page:20},n&&(t.uuids=n),(0,l.UT)(c.av.chatRooms.index({params:t}))}),{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,a.uniqBy)((0,a.flatten)(n.map((function(e){return e.records}))),"uuid"),pageParams:n.map((function(e){return e.page}))}},onSuccess:function(){N(t)},getNextPageParam:function(e){return e.has_next_page?Number(e.page)+1:void 0}}),y=v.isLoading,_=v.refetch,x=v.data,j=(x=void 0===x?{}:x).pages,w=void 0===j?[]:j,O=v.hasNextPage,S=void 0!==O&&O,P=v.fetchNextPage,C=function(e){return w.find((function(t){return t.uuid===e}))},k=function(e){(0,l.UT)(c.av.chatRooms.show({uuid:e})).then((function(e){e.chat_room&&f([e.chat_room].concat(d(w)))}))},N=function(e){e&&"new"!==e&&(w.find((function(e){var t=e.isOpen;return Boolean(t)}))&&k(e))},I=function(e,t){var n=e.json_message,r=n.chat_room_uuid,o=n.sender,i=n.embedded,a=o.community_member_id,s=C(r);if(s){var l=s.isOpen,c=s.unread_messages_count,u=l?0:a===t?c:Number(c)+1;!function(e){if(e.pinned_at){var t=w.map((function(t){return t.uuid===e.uuid?e:t}));f(t)}else{var n=[],r=[];w.forEach((function(t){t.pinned_at?n.push(t):t.uuid!==e.uuid&&r.push(t)})),f([].concat(n,[e],r))}}(p(p({},s),{},{last_message:n,unread_messages_count:u}))}else!0!==i&&k(r)},A=function(e){var t=e.chat_room_uuid,n=w.filter((function(e){return e.uuid!==t}));f(n)},E=function(){var e,t=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.invalidateQueries(m);case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return{chatRooms:w,setChatRooms:f,fetchChatRoomForUuid:C,onEventReceive:function(e,t){switch(e.event){case"newMessage":I(e,t);break;case"chatRoomRead":!function(e){var t=e.chat_room_uuid,n=w.findIndex((function(e){return e.uuid===t}));if(n>-1){var r=w[n],o=[].concat(d(w.slice(0,n)),[p(p({},r),{},{unread_messages_count:0})],d(w.slice(Number(n)+1)));f(o)}}(e);break;case"chatRoomCreated":E();break;case"chatRoomUpdated":!function(e){var t="string"===typeof e.chat_room?JSON.parse(e.chat_room):e.chat_room,n=w.map((function(e){return e.uuid===t.uuid?p(p({},e),{},{chat_room_name:t.chat_room_name}):e}));f(n)}(e);break;case"chatRoomDeleted":case"chatRoomParticipantDestroy":A(e);break;case"chatRoomParticipantsUpdated":!function(e){var t=JSON.parse(e.chat_room),n=w.map((function(e){return e.uuid===t.uuid?t:e}));f(n)}(e);break;case"chatRoomPinned":!function(e){var t=e||{},n=t.chat_room_id,r=t.pinned_at,o={},i=[];w.forEach((function(e){e.id!==n?i.push(e):o=p(p({},e),{},{pinned_at:r})})),f([o].concat(i))}(e);break;case"chatRoomUnPinned":!function(e){var t=(e||{}).chat_room_id,n=w.map((function(e){return e.id===t?p(p({},e),{},{pinned_at:null}):e}));f(d(n)),_()}(e)}},chatRoomsHasNextPage:S,hasNextPage:S,fetchNextPage:P,fetchUserChatRooms:_,isLoading:y}}},21451:(e,t,n)=>{n.d(t,{Cz:()=>k,tF:()=>I,_q:()=>N});var r=n(64687),o=n.n(r),i=n(67294),a=n(86013),s=n(88767),l=n(24185),c=n(81089),u=n(19647),d=n(50732),m=n(69647),f=n(74666),p=n(43990),v=n(51792),h=n(85893);function b(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function j(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){x(i,r,o,a,s,"next",e)}function s(e){x(i,r,o,a,s,"throw",e)}a(void 0)}))}}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=(0,i.createContext)(C);P.displayName="ChatRoomsContext";var C={chatRooms:[]},k=function(e){var t,n=e.children,r=w((0,i.useState)(C.chatRooms),2),g=r[0],_=r[1],x=(0,v.j)().addDirectMessageParticipantNameInTitle,O=(0,l.k6)(),S=(0,m.p)(),k=(0,s.useQueryClient)(),N=(t=(0,i.useRef)(null),(0,i.useEffect)((function(){return clearTimeout(t.current)}),[]),{debouncedFunction:function(e,n){for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];clearTimeout(t.current),t.current=setTimeout((function(){e.apply(void 0,o)}),n)}}),A=N.debouncedFunction,E=function(e,t){return e.find((function(e){return e.uuid===t}))},T=function(){var e=j(o().mark((function e(t){var n,r,i,s,l,m,f,p,v,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.chatRoom,r=t.rich_text_body,i=t.currentCommunityMember,s=t.localAttachments,l=t.localSgidToObjectMap,m=t.parentMessageId,e.prev=1,f=n.current_participant.id,!B){e.next=12;break}return p={chat_room_participant_id:f,rich_text_body:r},m&&(p.parent_message_id=m),e.next=8,(0,c.Cu)(d.av.chatRoomMessages.create({uuid:n.uuid}),{chat_room_message:p});case 8:v=e.sent,h={id:null,rich_text_body:y(y({},r),{},{attachments:s,sgids_to_object_map:l}),body:null,chat_room_uuid:n.uuid,chat_room_participant_id:f,creation_uuid:v.creation_uuid,sender:n.current_participant,sent_at:v.sent_at},m&&(h.parent_message_id=m),M({json_message:h},i.id,g);case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),S.error((0,a.t)("something_went_wrong")),(0,u.d)(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),M=function(e,t,n,r){var o=e.json_message,i=o.chat_room_uuid,a=o.sender,s=o.embedded;if(!o.parent_message_id){var l=a.community_member_id,u=E(n,i);if(u){var m=u.unread_messages_count;r&&A(I,2e3,i);var f=n.filter((function(e){return e!==u})),p=r?0:l===t?m:m+1,v=y(y({},u),{},{last_message:o,unread_messages_count:p});_([v].concat(b(f)))}else!0!==s&&function(e,t){(0,c.UT)(d.av.chatRooms.show({uuid:e})).then((function(e){e.chat_room&&_(b(new Set([e.chat_room].concat(b(t)))))})).catch((function(e){console.error(e)}))}(i,n)}},L=function(e){var t=e.chat_room_uuid,n=g.findIndex((function(e){return e.uuid===t}));if(n>-1){var r=g[n],o=[].concat(b(g.slice(0,n)),[y(y({},r),{},{unread_messages_count:0})],b(g.slice(n+1)));_(o)}},R=function(e){var t="object"===typeof e.chat_room?e.chat_room:JSON.parse(e.chat_room),n=g.map((function(e){return e.uuid===t.uuid?t:e}));_(n),k.invalidateQueries((0,p.S)(t.uuid))},D=function(e){var t=e.chat_room_uuid,n=g.filter((function(e){return e.uuid!==t}));_(n),O.push((0,d.yg)())},F=function(){var e=j(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.chatRoomUuid,r=t.rich_text_body,i=t.messageId,e.prev=1,e.next=4,(0,c.gN)(d.av.chatRoomMessages.update({uuid:n,id:i}),{chat_room_message:{rich_text_body:r}});case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),S.error((0,a.t)("something_went_wrong")),(0,u.d)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=j(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.chatRoomUuid,r=t.messageId,e.prev=1,e.next=4,(0,c.pC)(d.av.chatRoomMessages.delete({uuid:n,id:r}));case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),S.error((0,a.t)("something_went_wrong")),(0,u.d)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),B={chatRooms:g,setChatRooms:_,fetchChatRoomForUuid:E,onEventReceive:function(e,t,n,r){switch(e.event){case"newMessage":M(e,t,n,r);break;case"chatRoomRead":L(e);break;case"chatRoomCreated":!function(e){var t=(e||{}).chat_room;-1==g.findIndex((function(e){return e.uuid==t.uuid}))&&_((function(e){return[t].concat(b(e))}))}(e);break;case"chatRoomUpdated":!function(e){var t=(e||{}).chat_room,n=g.map((function(e){return e.uuid===t.uuid?y(y({},e),{},{chat_room_name:t.chat_room_name}):e}));_(n)}(e);break;case"chatRoomParticipantsUpdated":R(e);break;case"chatRoomParticipantDestroy":case"chatRoomDeleted":D(e)}},onEmbedEventReceive:function(e,t){switch(e.event){case"chatRoomRead":L(e);break;case"chatRoomUpdated":!function(){var e=arguments.length>1?arguments[1]:void 0,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).chat_room,n=g.map((function(n){return n.uuid===e?y(y({},n),{},{chat_room_description:t.chat_room_description,chat_room_show_history:t.chat_room_show_history,pinned_message:t.pinned_message}):n}));_(n)}(e,t);break;case"chatRoomParticipantsUpdated":R(e);break;case"chatRoomParticipantDestroy":D(e)}},updateTitleBar:function(e,t){var n=E(e,t);n&&x(n.chat_room_kind===f.g8?n.other_participants_preview[0].name:n.chat_room_name)},sendRichTextMessage:T,updateRichTextMessage:F,deleteRichTextMessage:U};return(0,h.jsx)(P.Provider,{value:B,children:n})},N=function(){return(0,i.useContext)(P)},I=function(e){return(0,c.Cu)(d.av.chatRooms.markAllAsRead({uuid:e}))}},41320:(e,t,n)=>{n.d(t,{G:()=>$,x:()=>G});var r=n(67294),o=n(72772),i=n(86013),a=n(86732),s=n(74666),l=n(42599),c=n(59256),u=n(69733),d=n(49142),m=n(43760),f=n(336),p=n(58533),v=n(88767),h=n(34334),b=n(64660),g=n(8246),y=n(59887),_=n(25680),x=n(94353),j=n(54482),w=n(13288),O=n(27025),S=n(69647),P=n(32535),C=n(85893);function k(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=function(e){var t=e.chatRoom,n=e.refetchChatRoom,r=(0,S.p)(),o=(0,b.r)(),a=t.uuid,s=t.current_participant,l=(0,y.uk)(a),c=l.chatParticipants,u=void 0===c?[]:c,d=l.refetchChatParticipants,m=l.totalCount,f=l.hasNextPage,N=l.fetchNextPage,I=k((0,P.F2)(u)),A=(0,v.useMutation)((function(e){var t=e.participantId,n=e.status;return h.M.update({uuid:a,id:t,admin:n},{forReactQuery:!0})}),{onSuccess:function(e){var t=e.chat_room_participant,o=t.name,a=t.roles.admin,s=o||(0,i.t)("messaging.member");d(),n(),r.success(a?(0,i.t)("messaging.member_made_admin",{name:s}):(0,i.t)("messaging.member_removed_as_admin",{name:s}),{duration:"short",shouldUseProgress:!1})},onError:function(){r.error((0,i.t)("request_failure_message"))}}).mutateAsync,E=(0,v.useMutation)((function(e){var t=e.participantId;return h.M.destroy({uuid:a,id:t},{forReactQuery:!0})}),{onSuccess:function(e){var t=e.message;d(),n(),r.success(t)},onError:function(){r.error((0,i.t)("request_failure_message"))}}).mutateAsync,T=function(e){return o.show({memberPublicId:e})},M=(0,P.bb)(I),L=M.onlineParticipants,R=M.offlineParticipants,D=function(e){return e.map((function(e){var t=function(e){return[{value:"view-profile",label:(0,i.t)("messaging.actions.view_profile"),onClick:function(){return T(e.user_public_uid)}},{value:e.admin?"remove-admin":"make-admin",label:e.admin?(0,i.t)("messaging.remove_admin"):(0,i.t)("messaging.make_admin"),onClick:function(){return A({participantId:e.id,status:!e.admin})}},{value:"remove",label:(0,i.t)("messaging.remove"),onClick:function(){return E({participantId:e.id})}}]}(e),n=s.id===e.id,r=!n&&s.admin;return(0,C.jsxs)("button",{type:"button",className:"hover:bg-tertiary messaging-rail__content--member focus-visible:bg-tertiary w-full","aria-label":(0,i.t)("messaging.open_member_profile_button_aria_label",{name:e.name}),onClick:function(){return T(e.user_public_uid)},children:[(0,C.jsxs)("div",{className:"text-dark flex w-[90%] items-center text-left",children:[(0,C.jsx)("div",{className:"mr-3",children:(0,C.jsx)(_.g,{name:e.name,src:e.avatar_url,status:e.status,size:"9"})}),(0,C.jsx)("div",{children:n?(0,i.t)("messaging.you"):e.name}),e.admin&&(0,C.jsx)(x.g,{className:"ml-2 uppercase",square:!0,label:(0,i.t)("moderator")})]}),r&&(0,C.jsx)(O.Lt,{direction:"bottom-start",menuButtonEl:"div",button:(0,C.jsx)(O.Lt.MenuButton,{id:"action-block",children:(0,C.jsx)(j.h,{name:"20-menu-dots-horizontal",iconSize:20,ariaLabel:(0,i.t)("options_dropdown")})}),options:t})]},e.id)}))};return(0,C.jsx)("div",{id:"scrollableDiv",className:"messaging-rail__content h-full overflow-auto",children:(0,C.jsxs)(p.Z,{scrollThreshold:.8,next:N,hasMore:Boolean(f),dataLength:m,className:"px-6 pb-6",scrollableTarget:"scrollableDiv",loader:(0,C.jsx)(w.a,{center:!0}),children:[L.length>0&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"text-default mb-2",children:(0,C.jsx)(g.Z.LabelXxs,{weight:"semibold",children:(0,i.t)("chat_space.online_now")})}),D(L)]}),R.length>0&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"text-default my-2",children:(0,C.jsx)(g.Z.LabelXxs,{weight:"semibold",children:(0,i.t)("chat_space.offline")})}),D(R)]})]})})},A=function(e){var t=e.chatRoom,n=e.isDirect,r=e.refetchChatRoom,o=e.otherParticipant,i=e.member;return n?(0,C.jsx)(f.N,{memberPublicId:null===o||void 0===o?void 0:o.user_public_uid,member:i,isFullPageProfile:!1,isRenderedOnRailBar:!0,shouldHideMessageButton:!0,shouldHideBadge:!0,shouldFixTabsTop:!0}):(0,C.jsx)(I,{chatRoom:t,refetchChatRoom:r})},E=n(66438),T={page_name:l.$q.PROFILE_VIEW},M=function(e){var t=e.chatRoom,n=void 0===t?{}:t,r=e.chatRoomUuid,o=e.refetchChatRoom,l=n.chat_room_name,f=n.chat_room_kind,p=n.chat_room_description,v=n.current_participant,h=f===s.g8,b=(0,c.u)(r),g=b.chatParticipants,y=b.isLoading,_=b.totalCount,x=(g||[]).find((function(e){return e.id!==(null===v||void 0===v?void 0:v.id)})),j=G().toggleShowRailBar,w=(0,u.P)({publicId:null===x||void 0===x?void 0:x.user_public_uid,params:T}).getProfileInfoQuery,O=w.data,S=void 0===O?{}:O,P=w.isLoading,k=(0,d.T)(),N=k.ref,I=k.height;return(0,C.jsxs)(a.x,{isLoading:h&&P||y,loaderVariant:h?"rail-profile":"rail-member-list",children:[(0,C.jsx)("div",{ref:N,children:(0,C.jsx)(m.S0.Header,{className:"!min-h-[4rem]",children:(0,C.jsx)(E.h,{title:h?(0,i.t)("profile"):l,memberCount:_,isDirect:h,description:p,onClose:j})})}),(0,C.jsx)(m.S0.Content,{noPadding:!0,heightGap:I,children:(0,C.jsx)(A,{chatRoom:n,isDirect:h,otherParticipant:x,member:S,refetchChatRoom:o})})]})},L=n(9405),R=n(96486),D=n(18605),F=n(54030),U=function(e){var t=e.description,n=e.shouldHideMembersCount,r=e.memberCount,o=void 0===r?0:r,a=e.onClose,s=void 0===a?R.noop:a,l=(0,F.BT)();return(0,F.kK)()?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"border-primary border-b px-6 py-4",children:(0,C.jsx)(j.h,{name:"16-arrow-left",onClick:s})}),(0,C.jsxs)("div",{className:"px-6 py-4",children:[(0,C.jsxs)("div",{className:"flex items-center justify-between",children:[(0,C.jsx)(g.Z.TitleSm,{as:"h2",weight:"semibold",children:(0,i.t)("chat_space.details")}),!n&&(0,C.jsxs)("div",{className:"flex items-center",children:[(0,C.jsx)("div",{className:"text-default mr-2",children:(0,C.jsx)(g.Z.LabelSm,{weight:"medium",children:o})}),(0,C.jsx)(D.JO,{type:"20-members",size:20,className:"text-dark",useWithFillCurrentColor:!0})]})]}),t&&(0,C.jsx)("div",{className:"text-default mt-4 max-h-[200px] overflow-y-auto whitespace-pre-line",children:(0,C.jsx)(g.Z.BodySm,{children:t})})]})]}):(0,C.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,C.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,C.jsx)(g.Z.TitleSm,{as:"h2",weight:"semibold",children:(0,i.t)("chat_space.details")}),l?(0,C.jsx)("button",{type:"submit",onClick:s,children:(0,C.jsx)(D.JO,{type:"close-v2",className:"text-dark mr-1 mt-2.5 cursor-pointer",useWithFillCurrentColor:!0})}):(0,C.jsx)(C.Fragment,{children:!n&&(0,C.jsxs)("div",{className:"flex",children:[(0,C.jsx)("div",{className:"text-dark mr-2",children:(0,C.jsx)(g.Z.LabelSm,{weight:"medium",children:o})}),(0,C.jsx)(D.JO,{type:"space-chat-members",className:"mt-1"})]})})]}),t&&(0,C.jsx)("div",{className:"text-dark max-h-[200px] overflow-y-auto whitespace-pre-line",children:(0,C.jsx)(g.Z.BodySm,{children:t})})]})},B=function(e){var t=e.space,n=(0,c.u)(t.chat_room_uuid),r=n.chatParticipants,o=n.isLoading,i=n.refetchChatParticipants,s=n.hasNextPage,l=n.fetchNextPage,u=n.totalCount,f=G().toggleShowRailBar,p=(0,d.T)(),v=p.ref,h=p.height;return(0,C.jsxs)(a.x,{isLoading:o,loaderVariant:"rail-member-list",children:[(0,C.jsx)(m.S0.Header,{className:"mb-4 !p-0 sm:!px-6 md:mb-0 md:!py-4",children:(0,C.jsx)("div",{ref:v,className:"w-full",children:(0,C.jsx)(U,{shouldHideMembersCount:t.hide_members_count,memberCount:u,description:t.chat_room_description,onClose:f})})}),(0,C.jsx)(m.S0.Content,{heightGap:h,noPadding:!0,children:(0,C.jsx)(L.V,{spaceMembers:r,hasMoreSpaceMembers:s,space:t,refetchSpaceMembers:i,fetchNextPage:l})})]})},z=n(1881);function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q="PARTICIPANTS",V="CHAT_THREADS",W={chatRoom:null,closeThreadsRailbar:function(){},isCourseSpace:!1,isLiveStream:!1,isDrawer:!1,messageHighlightId:null,openThreadsRailbar:function(){},parentMessage:null,RailbarComponent:function(){return null},setMessageHighlightId:function(){},shouldShowRailBar:!1,toggleShowRailBar:function(){},type:q,updateParentMessage:function(){}},Q=(0,r.createContext)(W);Q.displayName="RailbarContext";var $=function(e){var t=e.isChatSpace,n=void 0!==t&&t,i=e.children,a=e.isLiveStream,s=void 0!==a&&a,l=e.isCourseSpace,c=void 0!==l&&l,u=e.isDrawer,d=void 0!==u&&u,m=H((0,r.useState)(W.type),2),f=m[0],p=m[1],v=H((0,z.k)(!1),3),h=v[0],b=v[1],g=v[2],y=H((0,r.useState)(W.parentMessage),2),_=y[0],x=y[1],j=H((0,r.useState)(W.chatRoom),2),w=j[0],O=j[1],S=H((0,r.useState)(W.messageHighlightId),2),P=S[0],k=S[1],N=(0,F.BT)();(0,r.useEffect)((function(){g(!N)}),[N]);var I={chatRoom:w,closeThreadsRailbar:function(){x(null),O(null),p(q),N&&g(!1)},isCourseSpace:c,isLiveStream:s,isDrawer:d,messageHighlightId:P,openThreadsRailbar:function(e,t){x(e),O(t),p(V),g(!0)},parentMessage:_,RailbarComponent:f===q?n?B:M:o.I,setMessageHighlightId:k,shouldShowRailBar:h,toggleShowRailBar:b,type:f,updateParentMessage:function(e){x(e)}};return(0,C.jsx)(Q.Provider,{value:I,children:i})},G=function(){return(0,r.useContext)(Q)}},82732:(e,t,n)=>{n.d(t,{O:()=>s});var r=n(67294),o=n(32548),i=n(35102),a=n(277),s=function(){var e=(0,i.f4)().setShouldShowLatestMessageBtn,t=(0,a.q)(),n=t.chatRoomUuid,s=t.isMessaging,l=(0,o.j)().isMobileView,c=(0,r.useMemo)((function(){return s&&n?"message-scroll-view-".concat(n):"message-scroll-view"}),[n,s]),u=function(){return document.getElementById(c)};return{calculateScrollInfo:function(t){var n=t.event,r=u();if(!r)return{};var o="noScroll";switch(n){case"messageSent":o="scrollToBottom",e(!1);break;case"messageReceived":var i=r.scrollTop-r.scrollHeight+r.offsetHeight,a=l()&&0===i,s=i>=-.8*r.offsetHeight||i>14;a||s?(o="scrollToBottom",e(!1)):e(!0);break;case"chatRoomLoad":o="scrollToUnreadMessageIndicator";break;case"paginatedMessageLoad":o="adjustTop";break;case"nextPaginatedMessageLoad":case"messageUpdated":case"messageDeleted":case"parentMessageUpdated":o="noScroll";break;case"reaction":r.scrollTop-r.scrollHeight+r.offsetHeight>=-80&&(o="scrollToBottom")}return{action:o,scrollTopValue:r.scrollTop,scrollHeightValue:r.scrollHeight}},scrollerId:c,getScrollingElement:u}}},91008:(e,t,n)=>{n.d(t,{K:()=>s});var r=n(96486),o=n(24185),i=n(70254),a=n(41320),s=function(){var e=(0,o.k6)(),t=(0,a.x)(),n=t.openThreadsRailbar,s=t.setMessageHighlightId,l=t.messageHighlightId,c=(0,i.t)().message_id;return{removeThreadIdUrlParam:function(){l&&(e.replace({search:"",hash:window.location.hash}),s(null))},openThreadsRailbarOnThreadsNotification:function(e){var t=e.messageHashId,o=e.chatRoomMessages,i=e.chatRoom;if(c){var a=o.find((function(e){return e.id===Number(t)}));a&&(0,r.delay)((function(){s(Number(c)),n(a,i)}),500)}}}}},18738:(e,t,n)=>{n.d(t,{g:()=>f});var r=n(96486),o=n(88767),i=n(81089),a=n(50732),s=n(59256);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e){var t=e.uuid,n=e.ids,l=e.enabled,u=e.shouldUpdateCache,m=void 0===u||u,f=(0,o.useQueryClient)(),p=(0,o.useQuery)(["chatroom","missing-participants",n],(function(){return(0,i.UT)(a.av.chatRoomParticipants.index({uuid:t,params:{ids:n}}))}),{enabled:l,select:function(e){return e.records},onSuccess:function(e){var n;m&&(n=e,f.setQueryData(["chat-participants",t],(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pages:[]},t=(0,r.flatten)((e.pages||[]).map((function(e){return e.records}))),o=[].concat(d(t),d(n)),i=Math.ceil(o.length/s.U);return i>e.pages.length&&(e.pages=Array.from({length:i}).fill(e.pages[i]||e.pages[e.pages.length-1])),c(c({},e),{},{pages:e.pages.map((function(e,t){return c(c({},e||{}),{},{records:o.slice(s.U*t,s.U*(t+1))})}))})})))},onError:function(e){console.error("err:",e)}}),v=p.isLoading,h=p.data;return{isLoading:v,participants:void 0===h?[]:h}}},47330:(e,t,n)=>{n.d(t,{bD:()=>a,rF:()=>s,hE:()=>l,RN:()=>c});var r=n(88767),o=n(81089),i=n(50732),a=function(e){return"course-sections-".concat(e)},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.useQuery)(a(e),(function(){return(0,o.UT)(i.av.courses.listSections({courseId:e}))}),t)},l=function(e){return"lesson-".concat(e)},c=function(e){var t=e.courseId,n=e.lessonId,a=e.sectionId,s=e.options,c=void 0===s?{}:s;return(0,r.useQuery)(l(n),(function(){return(0,o.UT)(i.av.courses.getLesson({courseId:t,lessonId:n,sectionId:a}))}),c)}},32548:(e,t,n)=>{n.d(t,{j:()=>r});var r=function(){return{isMobileView:function(){return window.matchMedia("(max-width: 992px)").matches}}}},43990:(e,t,n)=>{n.d(t,{S:()=>d,m:()=>m});var r=n(96486),o=n(88767),i=n(81089),a=n(50732),s=n(14856);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){return"embeddable-chat-room-".concat(e)},m=function(e){var t=(0,o.useQueryClient)(s.Vr),n=function(n){t.setQueryData(d(e),(function(){return c(c({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},{chat_room:n})}))},l=(0,o.useQuery)({queryKey:d(e),queryFn:function(){return(0,i.UT)(a.av.chatRooms.show({uuid:e}))},enabled:!!e&&"new"!==e,refetchOnWindowFocus:!1}),u=l.isLoading,m=l.refetch,f=l.data,p=(f=void 0===f?{}:f).chat_room;return{isLoading:u,chatRoom:p,refetchChatRoom:e?m:r.noop,onEventReceive:function(e){var t,r;"chatRoomUpdated"===e.event&&function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).chat_room;n(c(c({},p||{}),{},{chat_room_name:e.chat_room_name,chat_room_description:e.chat_room_description,chat_room_show_history:e.chat_room_show_history,pinned_message:e.pinned_message}))}(e),"updatedMessage"===e.event&&(null===(t=p.pinned_message)||void 0===t?void 0:t.id)===e.json_message.id&&n(c(c({},p||{}),{},{pinned_message:e.json_message})),"deletedMessage"===e.event&&(null===(r=p.pinned_message)||void 0===r?void 0:r.id)===e.id&&n(c(c({},p||{}),{},{pinned_message:null}))}}}},14337:(e,t,n)=>{n.d(t,{K:()=>u});var r=n(67294),o=n(86013),i=n(88767),a=n(34334),s=n(69647);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e){var t=e.event,n=l((0,r.useState)([]),2),c=n[0],u=n[1],d=(0,s.p)().error,m=function(e){return d(null!==e&&void 0!==e&&e.message?null===e||void 0===e?void 0:e.message:(0,o.t)("something_went_wrong"))},f=(0,i.useMutation)((function(){return a.S1.fetchRecurring({event:t})}),{onSuccess:function(e){return u(e)},onError:m}),p=f.mutate;return{isLoading:f.isLoading,events:c,fetchEvents:p,onRecurringRsvpSubmit:(0,i.useMutation)((function(e){return a.S1.recurringRsvp({event:t,params:e})}),{onError:m}).mutateAsync,onRecurringUnRsvpSubmit:(0,i.useMutation)((function(e){return a.S1.recurringUnRsvp({event:t,params:e})}),{onError:m}).mutateAsync}}},51792:(e,t,n)=>{n.d(t,{j:()=>l});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=/^\(\d+\)\s/,s=/| [a-z 0-9@_\-#.!]+ $/i,l=function(){var e=o((0,r.useState)(document.title.replace(a,"")),1)[0];return{originalTitle:e,prependTitle:function(t){return document.title="".concat(t).concat(e)},resetTitleToOriginal:function(){return document.title=e},addDirectMessageParticipantNameInTitle:function(t){var n=document.title.match(a),r=e.replace(s,"".concat(t," "));n&&(r="".concat(n[0]).concat(r)),document.title=r}}}},43333:(e,t,n)=>{n.d(t,{I:()=>o});var r=n(34914),o=function(e,t){(0,r.s)({channel:"NotificationChannel",onMessageReceive:t,community_member_id:e,canCreateConnection:!!e},[e])}},53242:(e,t,n)=>{n.d(t,{K:()=>u});var r=n(88767),o=n(81089),i=n(50732);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,o.UT)(i.av.supportedCurrencies.index(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e?{include_traded:!0}:{})))},c={includeTraded:!1},u=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:c).includeTraded,t=void 0!==e&&e;return(0,r.useQuery)(["paywalls-currencies",t],(function(){return l(t)}))}},98661:(e,t,n)=>{n.d(t,{N:()=>b,P:()=>g});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(88767),l=n(81089),c=n(3209),u=n(98338),d=n(90789),m=n(81649);function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],p=arguments.length>2?arguments[2]:void 0,h=(0,s.useQueryClient)(),b=(0,c.d)(),g=b.removeRecord,y=b.findAndReplaceRecord;n=v(v({},n),{},{per_page:(null===(e=n)||void 0===e?void 0:e.per_page)||12}),Object.keys(n).forEach((function(e){"undefined"===typeof n[e]&&delete n[e]}));var _=(0,u.L2)().data,x=["posts",null===_||void 0===_?void 0:_.id,n],j="calendar"===(null===(t=n)||void 0===t?void 0:t.used_on),w=(0,s.useInfiniteQuery)(x,(function(e){var t,r=e.pageParam;return t=void 0===r?1:r,(0,l.UT)(m.a.posts.index({spaceId:_.id,params:v({page:t},n)}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},keepPreviousData:j,enabled:r&&!(null===_||void 0===_||!_.id)&&((0,d.H3)(_)||(0,d.V5)(_)||(0,d.Ds)(_)),onSuccess:function(e){(0,a.isFunction)(p)&&p(e)}}),O=w.data,S=w.hasNextPage,P=w.isLoading,C=w.refetch,k=w.fetchNextPage,N=(0,i.useCallback)(function(){var e,t=(e=o().mark((function e(t){var n,r,i,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(a.length>1&&void 0!==a[1]?a[1]:{}).refetch,r=t,void 0!==n&&!n){e.next=13;break}return e.prev=3,i=m.a.posts.show({spaceId:t.space_id,postSlug:t.slug}),e.next=7,h.fetchQuery(i);case 7:r=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0);case 13:y(r,x);case 14:case"end":return e.stop()}}),e,null,[[3,10]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),[y]),I=(0,i.useCallback)((function(e){g(e,x)}),[g]),A=[];!P&&O&&(A=(0,a.uniqBy)((0,a.flatten)(O.pages.map((function(e){return e.records}))),"id"));return{mapPages:function(e){return P||!O?[]:O.pages.map(e)},hasNextPage:S,refetch:C,isLoading:P,fetchNextPage:k,posts:A,onPostChange:N,onPostDestroy:I}},g=function(e){return b({only_pinned:!0,per_page:e||50,used_on:"pinned_post_sidebar"})}},97782:(e,t,n)=>{n.d(t,{j:()=>m,t:()=>f});var r=n(64687),o=n.n(r),i=n(88767),a=n(81089),s=n(50732);function l(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m="post-show",f=function(e){var t=e.spaceId,n=e.postSlug,r=e.spaceSlug,c=void 0===r?"":r,d=e.queryOptions,f=void 0===d?{}:d,p=e.context,v=void 0===p?"default":p,h=e.disabled,b=void 0!==h&&h,g=[m,n,t||c,v],y=s.av.posts.show({spaceId:t,spaceSlug:c,postSlug:n}),_=(0,i.useQuery)(g,(function(){return(0,a.UT)(y)}),u(u({enabled:!b&&!(!t&&!c||!n),staleTime:0},f),{},{retry:function(e,t){return 404!==(null===t||void 0===t?void 0:t.status)}})),x=(0,i.useQueryClient)(),j=function(){var e,t=(e=o().mark((function e(t){var n,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=(r.length>1&&void 0!==r[1]?r[1]:{}).refetch)||n){e.next=3;break}return e.abrupt("return",x.setQueryData(g,(function(){return t})));case 3:return e.abrupt("return",_.refetch());case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return u(u({},_),{},{post:_.data,onPostChange:j})}},8475:(e,t,n)=>{n.d(t,{F:()=>d});var r=n(67294),o=n(96486),i=n(88767),a=n(81089),s=n(50732);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){var t=e.memberPublicId,n=e.params,l=void 0===n?{per_page:10}:n,u=["profile-comments",t],d=(0,i.useInfiniteQuery)(u,(function(e){var n,r=e.pageParam;return n=void 0===r?1:r,(0,a.UT)(s.av.profile.comments({memberPublicId:t,params:c({page:n},l)}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),m=(0,r.useMemo)((function(){return d.isLoading?[]:(0,o.uniqBy)((0,o.flatten)(d.data.pages.map((function(e){return e.records}))),"id")}),[d.data]);return c(c({},d),{},{comments:m})}},11355:(e,t,n)=>{n.d(t,{O:()=>p});var r=n(67294),o=n(64660),i=n(98338),a=n(95287),s=n(23647),l=n(3383),c=n(18701),u=n(59887);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(e){var t=e.name,n=e.params,d=void 0===n?{}:n,f=e.public_uid,p=(0,i.wh)(),v=(0,o.r)().show,h=(0,c.I)(),b=(0,u.xX)().isDrawer,g=(0,r.useCallback)((function(e){!((0,a.n2)(e)||h||b)&&(0,l.i)(p)&&(e.preventDefault(),v({memberPublicId:f,params:d}))}),[h,b,p,f,d,v]);return m(m({},(0,s.H)({isProfileDrawerEnabled:(0,l.i)(p),name:t,params:d,publicUid:f,shouldOpenInNewTab:h,showMemberProfileDrawer:v})),{},{onClick:g})}},67675:(e,t,n)=>{n.d(t,{t:()=>v});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(88767),l=n(81089),c=n(50732),u=n(3209);function d(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(e){var t=e.memberPublicId,n=e.params,r=void 0===n?{per_page:10}:n,m=e.enabled,p=void 0===m||m,v=e.onSuccess,h=void 0===v?a.noop:v,b=["profile-posts",t],g=(0,u.d)().findAndReplaceRecord,y=(0,s.useQueryClient)(),_=function(){var e,t=(e=o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.fetchQuery(c.av.posts.show({spaceId:t.space_id,postSlug:t.slug}));case 2:return n=e.sent,e.abrupt("return",g(n,b));case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){d(i,r,o,a,s,"next",e)}function s(e){d(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),x=(0,s.useInfiniteQuery)(b,(function(e){var n,o=e.pageParam;return n=void 0===o?1:o,(0,l.UT)(c.av.profile.posts({memberPublicId:t,params:f({page:n},r)}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},enabled:p,onSuccess:function(e){(0,a.isFunction)(h)&&h(e)}}),j=(0,i.useMemo)((function(){var e,t;return x.isLoading?[]:(0,a.uniqBy)((0,a.flatten)(null!==(e=null===(t=x.data)||void 0===t?void 0:t.pages.map((function(e){return e.records})))&&void 0!==e?e:[]),"id")}),[x.data,x.isLoading]);return f(f({},x),{},{onPostChange:_,posts:j})}},3002:(e,t,n)=>{n.d(t,{u:()=>d});var r=n(67294),o=n(96486),i=n(88767),a=n(81089),s=n(50732);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){var t=e.memberPublicId,n=e.params,l=void 0===n?{per_page:12}:n,u=["PROFILE_SPACES",t,l],d=(0,i.useInfiniteQuery)(u,(function(e){var n,r=e.pageParam;return n=void 0===r?1:r,(0,a.UT)(s.av.profile.spaces({memberPublicId:t,params:c({page:n},l)}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),m=(0,r.useMemo)((function(){return d.isLoading?[]:(0,o.uniqBy)((0,o.flatten)(d.data.pages.map((function(e){return e.spaces}))),"id")}),[d.data]);return c(c({},d),{},{spaces:m})}},909:(e,t,n)=>{n.d(t,{H:()=>u});var r=n(67294),o=n(86013),i=n(24185),a=n(98338),s=n(39068),l=n(50732),c=n(58706),u=function(){var e=(0,i.TH)(),t=(0,i.k6)(),n=(0,a.wh)().currentCommunityMember,u=(0,s.vb)(n),d=(0,c.j)();return{showOwnProfileEdit:(0,r.useCallback)((function(){t.push(l.du.profile(e))}),[t,e]),showMemberProfileEdit:(0,r.useCallback)((function(e){var t;console.assert(u,{message:(0,o.t)("show_member_profile_no_admin"),currentCommunityMember:n});var r=e.member,i=e.memberPublicId,a=i||(null===r||void 0===r?void 0:r.public_uid),s=null!==(t=null===r||void 0===r?void 0:r.type)&&void 0!==t?t:"CommunityMember";return d({publicId:a,type:s})}),[n,u,d])}}},3209:(e,t,n)=>{n.d(t,{d:()=>l});var r=n(67294),o=n(88767);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){var e=(0,o.useQueryClient)();return{findAndReplaceRecord:(0,r.useCallback)((function(t,n){if(!n)throw new Error("queryKey is required");return e.setQueryData(n,(function(e){return{pages:e.pages.map((function(e){return a(a({},e),{},{records:e.records.map((function(e){return e.id===t.id?t:e}))})})),pageParams:e.pageParams}}))}),[e]),removeRecord:(0,r.useCallback)((function(t,n){if(!n)throw new Error("queryKey is required");return e.setQueryData(n,(function(e){return{pages:e.pages.map((function(e){return a(a({},e),{},{records:e.records.filter((function(e){return e.id!==t}))})})),pageParams:e.pageParams}}))}),[e])}}},78599:(e,t,n)=>{n.d(t,{m:()=>u});var r=n(88767),o=n(81089);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=Array.isArray(n)?n:[n||e],a=(0,r.useInfiniteQuery)(i,(function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,o.UT)(d(e,{page:n}))}),l({getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}},t));return l(l({},a),{},{mapPages:function(e){var t=a.isLoading,n=a.data;return t||!n?[]:n.pages.map(e)}})},d=function(e,t){for(var n=new URL(window.location.origin+e),r=0,o=Object.entries(t);r<o.length;r++){var a=i(o[r],2),s=a[0],l=a[1];n.searchParams.set(s,l)}return n.pathname+n.search}},58706:(e,t,n)=>{n.d(t,{j:()=>i});var r=n(24185),o=n(50732),i=function(){var e=(0,r.TH)(),t=(0,r.k6)();return function(n){var r=n.publicId,i=n.type,a=void 0===i?"CommunityMember":i;t.push((0,o.l9)({publicId:r,previousLocation:e,type:a}).index)}}},42658:(e,t,n)=>{n.d(t,{H:()=>o});var r=n(67294),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,r.useEffect)((function(){if(e){var t=e.split(" ");return t.forEach((function(e){document.body.classList.add(e)})),function(){t.forEach((function(e){document.body.classList.remove(e)}))}}}),[e])}},79311:(e,t,n)=>{n.d(t,{U:()=>o});var r=n(74666),o=function(){return{isMessagingModalOpen:(e=document.getElementById(r.vl),Boolean(e))};var e}},89052:(e,t,n)=>{n.d(t,{k:()=>o});var r=n(67294),o=function(e){return(0,r.useCallback)((function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e(t))}),[e])}},33071:(e,t,n)=>{n.d(t,{n:()=>o});var r=n(98338),o=function(){var e=(0,r.wh)().currentCommunitySettings||{};return{eventsThumbnailEnabled:e.events_thumbnail_enabled,limitUrlSharingEnabled:e.limit_url_sharing_enabled,selfUpdateCalendarEnabled:e.self_updating_calendar_invites_enabled}}},4110:(e,t,n)=>{n.d(t,{$:()=>s});var r=n(67294),o=n(75473);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e){var t=i((0,r.useState)("unset"),2),n=t[0],a=t[1],s=(0,o.Y)(e);(0,r.useEffect)((function(){return s&&(a(s.style.display||"unset"),s.style.display="none"),function(){s&&(s.style.display=n)}}),[s])}},40533:(e,t,n)=>{n.d(t,{t:()=>o});var r=n(4110),o=function(){(0,r.$)("#beacon-container")}},25830:(e,t,n)=>{n.d(t,{ov:()=>o,rV:()=>i,$2:()=>a,m3:()=>s});var r=n(98338);function o(){var e=(0,r.wh)().currentCommunity;return Boolean(null===e||void 0===e?void 0:e.activity_score_ui_enabled)}function i(){var e=(0,r.wh)(),t=e.currentCommunitySettings,n=e.currentCommunityMember,i=null===n||void 0===n?void 0:n.is_admin,a=o(),s=null===t||void 0===t?void 0:t.upgrade_flows_for_activity_scores_enabled;return Boolean(i&&(a||s))}function a(){var e=(0,r.wh)().currentCommunity;return Boolean(null===e||void 0===e?void 0:e.community_ai_feature_flag_enabled)}function s(){var e=(0,r.wh)(),t=e.currentCommunitySettings,n=e.currentCommunityMember,i=null===n||void 0===n?void 0:n.is_admin,s=null===t||void 0===t?void 0:t.upgrade_flows_for_activity_scores_enabled,l=!a(),c=!o();return i&&s&&(l||c)}},78208:(e,t,n)=>{n.d(t,{z1:()=>o,fP:()=>i,B5:()=>a,gq:()=>s});var r=n(98338),o=function(){var e=(0,r.wh)().currentCommunityMember;return Boolean((null===e||void 0===e?void 0:e.messaging_enabled)||!1)},i=function(){var e=((0,r.wh)().currentCommunitySettings||{}).community_bot_enabled;return Boolean(e)},a=function(){var e=o(),t=i();return e||t},s=function(){var e,t=(0,r.wh)().currentCommunityMember,n=i(),o=(null===t||void 0===t?void 0:t.messaging_enabled)||!1,a=!o&&(null===t||void 0===t||null===(e=t.policies)||void 0===e?void 0:e.can_direct_message)||(null===t||void 0===t?void 0:t.messaging_enabled_by_admin)&&o;return{shouldShowMessagingRoutes:Boolean(n||a),showMessagesTab:a}}},20290:(e,t,n)=>{n.d(t,{h:()=>o});var r=n(98338),o=function(){var e=(0,r.wh)().currentCommunitySettings;return!(null===e||void 0===e||!e.workflows_v2_enabled)}},35639:(e,t,n)=>{n.d(t,{R:()=>o});var r=n(98338),o=function(){var e=(0,r.wh)(),t=e.currentCommunitySettings||{};return{isLoading:e.isLoading,liveStreamsHlsEnabled:t.live_streams_hls_enabled,liveStreamsLimitsEnabled:t.live_streams_limits_enabled,livekitEnabled:t.livekit_enabled,liveMobileWebEnabled:t.live_mobile_web_enabled,liveMobileWebRTCEnabled:t.live_mobile_webrtc_enabled,publicLiveStreamsEnabled:t.public_live_streams_enabled,limitUrlSharingEnabled:t.limit_url_sharing_enabled,isLargeLiveStreamsEnabled:t.large_live_streams_enabled}}},62113:(e,t,n)=>{n.d(t,{f:()=>i});var r=n(42393),o=n(38503),i=function(){var e=(0,o.wC)().masquerade_referrer_url,t=(0,r.Vu)().isBannerVisible;return!!e||t}},93016:(e,t,n)=>{n.d(t,{k:()=>s});var r=n(67294),o=n(34914);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e){var t,n=e.enabled,a=void 0===n||n,s=e.signedId,l=e.mediaTranscoding,c=e.onSuccess,u=e.onError,d=i((0,r.useState)(null!==(t=null===l||void 0===l?void 0:l.status)&&void 0!==t?t:"pending"),2),m=d[0],f=d[1],p=a&&Boolean(s)&&function(e){return"pending"===e||"started"===e}(m);return(0,o.s)({canCreateConnection:p,channel:"MediaTranscodingChannel",blob_signed_id:s,onMessageReceive:function(e){"transcodingStatusUpdated"===e.event&&(f(e.json_message.status),"succeeded"===e.json_message.status?null===c||void 0===c||c(e.json_message.hls_url):"failed"===e.json_message.status&&(null===u||void 0===u||u()))}}),{status:m}}},5848:(e,t,n)=>{n.d(t,{k:()=>i});var r=n(88767),o=n(50732),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.useQuery)(o.av.planFeatureFlags.show(),e)}},47969:(e,t,n)=>{n.d(t,{J:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e,t){var n=o((0,r.useReducer)(e,t),2),i=n[0],a=n[1],s=(0,r.useRef)((function(){return i}));(0,r.useEffect)((function(){s.current=function(){return i}}),[i]);var l=(0,r.useCallback)((function(e){"function"===typeof e?e(l,s.current):a(e)}),[]);return[i,l]}},66965:(e,t,n)=>{n.d(t,{L:()=>l,d:()=>c});var r=n(88767),o=n(98338),i=n(14692),a=n(81089),s=n(50732),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,i.Wj)(),n=(0,r.useQuery)(["space-sidebar-notifications",e],(function(){return(0,a.UT)(s.av.sidebarNotifications.index({space_ids:e}))}),{enabled:!1,onSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];1===e.length?t({type:"UPDATE_SPACE_NOTIFICATIONS",payload:{space:e[0]}}):t({type:"SET_SPACE_NOTIFICATIONS",payload:{spaces:e||[]}})},onError:function(e){console.error("Something went wrong",e)}}),o=n.isLoading;return{refetchSpaceNotifications:n.refetch,isLoading:o}},c=function(e){var t=(0,o.nT)(),n=l([e]).refetchSpaceNotifications;return{resetUnreadCount:(0,r.useMutation)((function(){return(0,a.Cu)(s.av.spaces.resetUnreadCount({spaceId:e}),{forReactQuery:!0})}),{onSuccess:function(e){t.actions.updateSpace(e),n()},onError:function(e){console.error("Error while resetting the unread count",e)}}).mutateAsync}}},75473:(e,t,n)=>{n.d(t,{Y:()=>u});var r=n(64687),o=n.n(r),i=n(67294),a=n(11449);function s(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,n=l((0,i.useState)(null),2),r=n[0],c=n[1];return(0,i.useEffect)((function(){var n=function(){var n,r=(n=o().mark((function n(){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,a.g)(e,{timeout:t});case 2:r=n.sent,c(r);case 4:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){s(i,r,o,a,l,"next",e)}function l(e){s(i,r,o,a,l,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();n()}),[e,t]),r}},34914:(e,t,n)=>{n.d(t,{s:()=>v});var r=n(67294),o=n(96486),i=(0,n(40924).tx)(),a=["channel"],s=["channel"];function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=new Map,u=["channel","onMessageReceive","canCreateConnection"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.channel,d=e.onMessageReceive,v=e.canCreateConnection,h=void 0===v||v,b=p(e,u),g=(0,r.useRef)(d),y=(0,r.useRef)({});return(0,r.useEffect)((function(){g.current=d}),[n,d]),(0,r.useEffect)((function(){if(h){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.channel,r=l(e,a);if(n&&t){c.has(n)||c.set(n,[]);var s=c.get(n),u=s.find((function(e){var t=e.params;return(0,o.isEqual)(r,t)}));return u?u.callbacks.push(t):(u={subscription:i.subscribeTo(n,r),params:r,callbacks:[t]},s.push(u),u.subscription.on("message",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];u.callbacks.forEach((function(e){return e.apply(void 0,t)}))}))),u}}(m({channel:n},b),g.current);return e&&(y.current=m(m({},y.current),{},f({},n,e))),function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.channel,r=l(e,s);if(n&&t){var i=c.get(n);if(i){var a=i.find((function(e){var t=e.params;return(0,o.isEqual)(r,t)}));a&&(a.callbacks=a.callbacks.filter((function(e){return e!==t})),a.callbacks.length||(a.subscription.disconnect(),c.set(n,i.filter((function(e){var t=e.params;return!(0,o.isEqual)(r,t)})))))}}}(m({channel:n},b),g.current),y.current[n]=null}}}),[n,h,b,t]),y.current[n]}},95e3:(e,t,n)=>{n.d(t,{m:()=>r});var r=function(e,t){var n={};return Object.keys(t).forEach((function(t){n["".concat(e,"--").concat(t)]=t})),{modifiers:n}}},1881:(e,t,n)=>{n.d(t,{k:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=o((0,r.useState)(e),2),n=t[0],i=t[1];return[n,(0,r.useCallback)((function(){return i((function(e){return!e}))}),[i]),i]}},52255:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e,t){var n=o((0,r.useState)(e),2),i=n[0],a=n[1];return(0,r.useEffect)((function(){var n=setTimeout((function(){a(e)}),t);return function(){clearTimeout(n)}}),[e,t]),i}},49142:(e,t,n)=>{n.d(t,{T:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(){var e=o((0,r.useState)(),2),t=e[0],n=e[1];return{ref:(0,r.useCallback)((function(e){e&&n(e.clientHeight)}),[]),height:t}}},70562:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(){var e=(0,r.useRef)(null),t=o((0,r.useState)(!0),2),n=t[0],i=t[1];return(0,r.useEffect)((function(){var t=new IntersectionObserver((function(e){i(null===e||void 0===e?void 0:e[0].isIntersecting)}));return e.current&&t.observe(e.current),function(){t.disconnect()}}),[]),[e,n]}},73495:(e,t,n)=>{n.d(t,{t:()=>s});var r=n(67294),o=n(45697),i=n.n(o),a=n(96486),s=function(e){var t=e.onArrowDown,n=e.onArrowUp,o=e.onEnter,i=e.onEscape,s=e.enabled,l=void 0===s||s,c=e.elementRef,u=void 0===c?null:c;(0,r.useEffect)((function(){var e=(null===u||void 0===u?void 0:u.current)||document,r={ArrowDown:t,ArrowUp:n,Enter:o,Escape:i},s=function(e){var t=r[null===e||void 0===e?void 0:e.key];(0,a.isFunction)(t)&&t(e)};return l&&e?e.addEventListener("keydown",s):null===e||void 0===e||e.removeEventListener("keydown",s),function(){return null===e||void 0===e?void 0:e.removeEventListener("keydown",s)}}),[l,t,n,o,i,u])};s.propTypes={options:i().shape({onArrowDown:i().func,onArrowUp:i().func,onEnter:i().func,onEscape:i().func,enabled:i().bool})}},93144:(e,t,n)=>{n.d(t,{K:()=>s,d:()=>l});var r=n(67294),o=n(96486),i=n(87536),a=n(62447),s=function(e){var t=e.cacheKey,n=e.fields,s=void 0===n?[]:n,l=e.enabled,c=void 0===l||l,u=(0,i.qo)(),d=(0,o.pick)(u,s),m=(0,a._)(t).setValue;(0,r.useEffect)((function(){c&&m(d)}),[d])},l=function(e){var t=e.cacheKey;if(!t)throw new Error("CacheKey is required");var n=(0,a._)(t);return{getPersistedFormFieldValues:n.getValue,resetValues:n.resetValue}}},22050:(e,t,n)=>{n.d(t,{g:()=>o});var r=n(67294),o=function(e){var t=(0,r.useRef)(null);return(0,r.useLayoutEffect)((function(){var n=t.current;e&&n&&n.scrollIntoView({behavior:"smooth",block:"center"})}),[e]),t}},64419:(e,t,n)=>{n.d(t,{M:()=>i});var r=n(67294),o=n(87536),i=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).enabled,t=void 0===e||e,n=(0,o.Gc)().triggerFormSubmit;(0,r.useEffect)((function(){if(t){var e=function(e){"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&n()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}}),[t,n])}},14246:(e,t,n)=>{n.d(t,{kW:()=>s,RV:()=>r,Wo:()=>o,E4:()=>a,Ex:()=>i});var r={ltr:"ltr",rtl:"rtl"},o={decimal:"decimal",zero_decimal:"zero_decimal",three_decimals:"three_decimals"},i={space:"space",event:"event"},a={onetime:"onetime",subscription:"subscription",installments:"installments"},s=function(e){return e&&e.failure&&e.failure.category&&e.failure.code&&e.failure.level&&e.failure.message}},99663:(e,t,n)=>{n.d(t,{o:()=>l});var r=n(11355),o=n(85893);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){var t=e.member,n=e.children,i=t.name,s=t.public_uid,l=(0,r.O)({public_uid:s});return(0,o.jsx)("a",a(a({},l),{},{title:i,children:n}))}},80809:(e,t,n)=>{function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{W:()=>a});var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element=t}var t,n,o;return t=e,(n=[{key:"addAttachmentClickEventHandler",value:function(e){var t=this;this.element.addEventListener("click",(function(n){var r=n.target.closest("action-text-attachment");if(r){var o=t.parseAttachmentAttributes(r);if(t.isPreviewableAttachment(o)){var i=t.getSimilarAttachments(o),a=i.findIndex((function(e){return e.sgid===o.sgid}));e({attachments:i,currentIndex:a})}}}))}},{key:"getSimilarAttachments",value:function(e){var t=this.isImageAttachment(e)&&this.isImageAttachment||this.isPdfAttachment(e)&&this.isPdfAttachment;return r(this.element.querySelectorAll("action-text-attachment")).map(this.parseAttachmentAttributes).filter(t)}},{key:"isPreviewableAttachment",value:function(e){return this.isPdfAttachment(e)||this.isImageAttachment(e)}},{key:"isImageAttachment",value:function(e){var t=e.contentType;return["image/png","image/jpeg","image/jpg","image/gif"].includes(t)}},{key:"isPdfAttachment",value:function(e){var t=e.contentType;return["application/pdf"].includes(t)}},{key:"parseAttachmentAttributes",value:function(e){var t,n;return{sgid:e.getAttribute("sgid"),contentType:e.getAttribute("content-type"),url:null===(t=e.querySelector("[data-target~='blob-container']"))||void 0===t||null===(n=t.dataset)||void 0===n?void 0:n.blobUrl,filename:e.getAttribute("filename"),filesize:e.getAttribute("filesize"),width:e.getAttribute("width"),height:e.getAttribute("height")}}}])&&i(t.prototype,n),o&&i(t,o),e}()},28582:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(86013),o=n.n(r),i=n(67617);o().translations=i;const a=o()},64289:(e,t,n)=>{e.exports=n.p+"static/assets/images/avatar-empty-272048dbcfb49b1970df.png"},56065:(e,t,n)=>{e.exports=n.p+"static/assets/images/logo-27b43009da10b6d9d05f.svg"},78712:(e,t,n)=>{e.exports=n.p+"static/components/Chat/TypingIndicator/typing-972856ec20cb4c0600c6.gif"},62596:(e,t,n)=>{e.exports=n.p+"static/components/Events/Rsvp/RsvpAction/RsvpIcons/img/attending-6f58a1aa030cb2a57df3.svg"}}]);
//# sourceMappingURL=/packs/js/2269-7e415880dc59b95d3330.js.map